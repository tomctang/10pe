(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46059,       1150]
NotebookOptionsPosition[     39711,       1059]
NotebookOutlinePosition[     40064,       1075]
CellTagsIndexPosition[     40021,       1072]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "This Mathematica code is part of the lecture script ",
 StyleBox["Introduction to Computational Quantum Mechanics",
  FontSlant->"Italic"],
 " by Roman Schmied. It is licensed under a ",
 ButtonBox["Creative Commons Attribution-ShareAlike 4.0 International License",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://creativecommons.org/licenses/by-sa/4.0/"], None},
  ButtonNote->"http://creativecommons.org/licenses/by-sa/4.0/"],
 "."
}], "Text",
 CellChangeTimes->{{3.669434091682116*^9, 3.669434147842166*^9}, {
  3.669435842013185*^9, 3.669435866952169*^9}, {3.669435915352921*^9, 
  3.669435921977655*^9}},ExpressionUUID->"59e15e35-b139-4ab1-8d52-\
a0a6429b9d4e"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1: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
yoV9Oe0/TXxfaElz99px38MJ1qr/AASW71I=
    "], {{0, 31}, {88, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{88, 31},
  PlotRange->{{0, 88}, {0, 31}}]], "Text",
 CellChangeTimes->{
  3.669607172458665*^9},ExpressionUUID->"5ba186e8-492a-4ced-8bd1-\
f275d540436f"],

Cell[TextData[{
 "You can download the associated lecture script at ",
 ButtonBox["http://arxiv.org/abs/1403.7050",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://arxiv.org/abs/1403.7050"], None},
  ButtonNote->"http://arxiv.org/abs/1403.7050"]
}], "Text",
 CellChangeTimes->{{3.669434151914299*^9, 3.669434159778274*^9}, {
  3.669435746836981*^9, 3.669435760656741*^9}, {3.669435890511055*^9, 
  3.6694358923333282`*^9}, {3.682242719652669*^9, 
  3.6822427205773983`*^9}},ExpressionUUID->"77450482-7a40-48bf-9d59-\
40c9a94b74c8"],

Cell[CellGroupData[{

Cell["particle in a 1D gravity well", "Title",
 CellChangeTimes->{{3.669356489273039*^9, 3.669356492332947*^9}, {
  3.672571380907549*^9, 3.6725713873462048`*^9}, {3.735018400618972*^9, 
  3.735018409132845*^9}},ExpressionUUID->"53a7277b-506a-411e-8251-\
5a4b806581a4"],

Cell[CellGroupData[{

Cell["units", "Subsection",
 CellChangeTimes->{{3.735577582186695*^9, 
  3.735577582608306*^9}},ExpressionUUID->"8e6317c8-51ad-417a-af6e-\
805f9c3eadda"],

Cell["we use natural units for simplicity:", "Text",
 CellChangeTimes->{{3.735577584023155*^9, 3.735577602680982*^9}, {
  3.751371921838215*^9, 
  3.751371922209155*^9}},ExpressionUUID->"8e02522f-4f01-428f-a978-\
80bca989cf14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"\[HBar]", "=", 
    RowBox[{"g", "=", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735577590355571*^9, 3.735577592584391*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5e066122-d64b-4b35-ac5d-dfe861f7c36f"],

Cell["Other unit systems can be defined here.", "Text",
 CellChangeTimes->{{3.735577840461472*^9, 
  3.7355778546570187`*^9}},ExpressionUUID->"8bdb61fd-4446-4152-aca7-\
54a7dade7666"]
}, Open  ]],

Cell[CellGroupData[{

Cell["analytic calculation", "Subsection",
 CellChangeTimes->{{3.7350181370997953`*^9, 3.735018138277676*^9}, {
  3.735018393831444*^9, 
  3.7350183952138567`*^9}},ExpressionUUID->"0426b6b4-44c8-4714-b6d4-\
f04f6c59d388"],

Cell["Hamiltonian:", "Text",
 CellChangeTimes->{{3.735018163442339*^9, 3.735018188468483*^9}, 
   3.735577610726668*^9},ExpressionUUID->"f0663002-ad1d-4bf0-9025-\
e5408fe9f75a"],

Cell[BoxData[
 FormBox[
  RowBox[{
   OverscriptBox["H", "^"], "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["\[HBar]", "2"], 
      RowBox[{"2", "m"}]]}], 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[DifferentialD]", "2"], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["x", "2"]}]], 
     RowBox[{"+", "m"}]}], " ", "g", " ", 
    OverscriptBox["x", "^"]}]}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.734887544388846*^9, 3.734887561393697*^9}, {
  3.734887675739938*^9, 3.734887707573909*^9}, {3.734888007142597*^9, 
  3.734888013970707*^9}, {3.7350181999581003`*^9, 3.735018207308563*^9}, {
  3.735577612675668*^9, 3.735577626113103*^9}, {3.735637682909617*^9, 
  3.7356376856259327`*^9}},ExpressionUUID->"e9655d90-a754-48f4-afbd-\
2c42db558de9"],

Cell["exact energy eigenstates and energies:", "Text",
 CellChangeTimes->{{3.735018159586482*^9, 3.735018162042945*^9}, {
  3.735018208703059*^9, 3.735018209541144*^9}, {3.73557787785734*^9, 
  3.7355778803260612`*^9}},ExpressionUUID->"5c165c6e-585d-4d42-95ac-\
bc1f4fd81c0c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", 
    RowBox[{"k_", ",", "x_"}], "]"}], "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"2", 
        SuperscriptBox["m", "2"], "g"}], 
       SuperscriptBox["\[HBar]", "2"]], ")"}], 
     FractionBox["1", "6"]], 
    FractionBox[
     RowBox[{"AiryAi", "[", 
      RowBox[{
       RowBox[{"AiryAiZero", "[", "k", "]"}], "+", 
       RowBox[{"x", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{"2", 
            SuperscriptBox["m", "2"], "g"}], 
           SuperscriptBox["\[HBar]", "2"]], ")"}], 
         FractionBox["1", "3"]]}]}], "]"}], 
     RowBox[{
      RowBox[{"AiryAi", "'"}], "[", 
      RowBox[{"AiryAiZero", "[", "k", "]"}], "]"}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"AiryAiZero", "[", "k", "]"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       RowBox[{"m", " ", 
        SuperscriptBox["g", "2"], 
        SuperscriptBox["\[HBar]", "2"]}], "2"], ")"}], 
     FractionBox["1", "3"]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7350176339421577`*^9, 3.735017633944515*^9}, {
  3.7350179513018*^9, 3.7350179535906477`*^9}, {3.735577629498457*^9, 
  3.735577664247426*^9}, {3.735637688273038*^9, 3.7356376910133266`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"6c5be16d-bc32-40c7-8201-b5abddbe6435"],

Cell["show lowest energy eigenstates:", "Text",
 CellChangeTimes->{{3.7350189393146143`*^9, 
  3.735018949487673*^9}},ExpressionUUID->"300cff4b-7463-42bc-bfd6-\
87053e2ed315"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"k", ",", "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.735018950487122*^9, 3.735018970624002*^9}, {
  3.7355778722861967`*^9, 3.735577873924685*^9}, {3.73563770179624*^9, 
  3.735637702984705*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"5587a397-a267-4282-872d-5110375f04e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["system setup", "Subsection",
 CellChangeTimes->{{3.68267845722009*^9, 
  3.6826784815236273`*^9}},ExpressionUUID->"b1b21674-37d9-4fc8-a18f-\
b9b564169153"],

Cell["basis set size:", "Text",
 CellChangeTimes->{{3.682678482763608*^9, 
  3.6826784847316732`*^9}},ExpressionUUID->"de513c41-8c93-4797-80f6-\
29802fa04587"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nmax", "=", "12"}], ";"}]], "Input",
 CellChangeTimes->{{3.682678485416091*^9, 3.68267848673153*^9}, 
   3.6826848702035227`*^9, 3.682757181910033*^9, {3.7336553478537083`*^9, 
   3.733655367241531*^9}, 3.735145026417994*^9, 3.735145968587099*^9, {
   3.735381379955559*^9, 3.735381380386653*^9}, {3.73538154686455*^9, 
   3.735381554283099*^9}, {3.735579084438632*^9, 3.735579100568405*^9}, {
   3.735640031444365*^9, 3.735640031632203*^9}, {3.7356410888515663`*^9, 
   3.7356410890160503`*^9}, {3.745133096401739*^9, 3.74513309704808*^9}, {
   3.745133337930876*^9, 3.74513333830324*^9}, {3.745133388457546*^9, 
   3.745133389060109*^9}, {3.7451334258839293`*^9, 3.745133426322241*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"6ebafd86-d1a9-4adf-8df7-24d5a911deb3"],

Cell["computational box size:", "Text",
 CellChangeTimes->{{3.73557836806222*^9, 
  3.7355783727498083`*^9}},ExpressionUUID->"d3267872-1c3e-410d-a4d4-\
2bf2b904045f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "=", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.7355783733865128`*^9, 3.735578374724312*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"1e518986-9657-446f-a422-1446bf4a9a8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["basis set", "Subsection",
 CellChangeTimes->{{3.735381418788225*^9, 
  3.7353814203917522`*^9}},ExpressionUUID->"efe8b451-a419-4d8a-b2a6-\
162f2dc3115c"],

Cell["momentum-basis functions:", "Text",
 CellChangeTimes->{{3.735018738168988*^9, 
  3.735018745668674*^9}},ExpressionUUID->"3b3320b9-98d6-48bb-9ea1-\
02f6d4b388cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"n_", ",", "x_"}], "]"}], "=", 
   RowBox[{
    SqrtBox[
     FractionBox["2", "a"]], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"n", " ", "\[Pi]", " ", "x"}], "a"], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{
  3.735018747286161*^9, {3.735577966039876*^9, 3.735577968325334*^9}, {
   3.735637709503599*^9, 3.735637711297014*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"600ae0eb-db08-4211-a502-7ad873c97a9b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["numerical solution (I): momentum basis", "Subsection",
 CellChangeTimes->{{3.672572898149839*^9, 
  3.672572909149979*^9}},ExpressionUUID->"1578ce56-fb42-426b-9b26-\
e30fb32fcd07"],

Cell[TextData[{
 "kinetic-energy operator ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["T", "^"], TraditionalForm]],ExpressionUUID->
  "66ee5d56-40a3-4390-9a12-a1848e9677de"],
 ":"
}], "Text",
 CellChangeTimes->{{3.735018520610821*^9, 3.73501852524585*^9}, {
  3.735577985199341*^9, 
  3.735577991837817*^9}},ExpressionUUID->"be8bfa1f-f1cb-41c9-b2be-\
d2a4cc93dab4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TM", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"Band", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Range", "[", "nmax", "]"}], "2"], "*", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Pi]", "2"], 
        SuperscriptBox["\[HBar]", "2"]}], 
       RowBox[{"2", "m", " ", 
        SuperscriptBox["a", "2"]}]]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735018517380213*^9, 3.73501854037395*^9}, {
  3.7353814631403933`*^9, 3.735381465671145*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e04f2e67-a8b4-40e4-8fbf-ef6597061fe4"],

Cell[TextData[{
 "position operator ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["x", "^"], TraditionalForm]],ExpressionUUID->
  "d0e4ef45-c986-4dfd-a01a-51cc5960f160"],
 ":"
}], "Text",
 CellChangeTimes->{{3.735018553347481*^9, 3.735018555842681*^9}, {
  3.735577994129443*^9, 3.735577996747631*^9}, {3.735637716598675*^9, 
  3.735637716598731*^9}},ExpressionUUID->"abbde63b-b4cc-4d4a-a0db-\
ea893f615f7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xM", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Band", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
        FractionBox["a", "2"]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n1_", ",", "n2_"}], "}"}], "/;", 
         RowBox[{"OddQ", "[", 
          RowBox[{"n1", "-", "n2"}], "]"}]}], "\[Rule]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"8", " ", "a", " ", "n1", " ", "n2"}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["n1", "2"], "-", 
              SuperscriptBox["n2", "2"]}], ")"}], "2"], " ", 
           SuperscriptBox["\[Pi]", "2"]}]]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nmax", ",", "nmax"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735018551352385*^9, 3.735018576841412*^9}, {
   3.735577979999897*^9, 3.73557800578393*^9}, 3.735637718063549*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"20446bac-32fb-4ce9-9851-d2e8d03d5fc3"],

Cell["potential-energy operator:", "Text",
 CellChangeTimes->{{3.735018585816964*^9, 
  3.73501859067869*^9}},ExpressionUUID->"6d64cd06-db50-4e30-bac9-\
ff6022ad36cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VM", "=", 
   RowBox[{"m", "*", "g", "*", "xM"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735018551352385*^9, 3.735018562050844*^9}, {
   3.7355780141305857`*^9, 3.7355780174610558`*^9}, 3.735637723209693*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"ef3bccff-a58e-4934-bcff-a96b41badaab"],

Cell["Hamiltonian in the momentum representation:", "Text",
 CellChangeTimes->{{3.735018595712686*^9, 3.735018597157838*^9}, {
  3.735018814124281*^9, 
  3.735018819060484*^9}},ExpressionUUID->"ae1f6432-92a3-484a-82a5-\
138b7dd656b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HM", "=", 
   RowBox[{"TM", "+", "VM"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7349769548140182`*^9, 3.734976954816228*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"4e117c32-866e-4476-861f-0a678a43007f"],

Cell["ground state:", "Text",
 CellChangeTimes->{{3.735018599090639*^9, 
  3.735018602632951*^9}},ExpressionUUID->"f8035b2c-85d5-42d3-98eb-\
146c87cd6287"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gsM", "=", 
   RowBox[{"-", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"N", "[", "HM", "]"}]}], ",", "1", ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Arnoldi\>\"", ",", 
         RowBox[{"\"\<Criteria\>\"", "\[Rule]", "\"\<RealPart\>\""}], ",", 
         RowBox[{"MaxIterations", "\[Rule]", 
          SuperscriptBox["10", "6"]}]}], "}"}]}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7349769628773603`*^9, 3.734976962879696*^9}, {
   3.735018841976534*^9, 3.735018843030253*^9}, 3.735019281531815*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"12fccf49-c506-443d-8426-d6d8e8a85e4d"],

Cell["ground-state energy, compared to analytic result:", "Text",
 CellChangeTimes->{{3.7350186086230993`*^9, 
  3.735018632893797*^9}},ExpressionUUID->"493b0f6e-bc2c-4a96-88eb-\
4dd496047078"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"gsM", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{"\[Epsilon]", "[", "1", "]"}], "//", "N"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.734976971322545*^9, 3.734976971324738*^9}, {
   3.735018614116296*^9, 3.735018623924879*^9}, 3.735019284122386*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"8efc5898-4fee-49ba-8675-757c566e51d5"],

Cell["numerical ground-state wavefunction:", "Text",
 CellChangeTimes->{{3.735018636733629*^9, 3.735018640718356*^9}, {
  3.7350186835247*^9, 
  3.735018684583047*^9}},ExpressionUUID->"9f3e9ad7-003f-4a1c-9005-\
4de0648cff7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]0", "[", "x_", "]"}], "=", 
   RowBox[{
    RowBox[{"gsM", "\[LeftDoubleBracket]", 
     RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ".", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"n", ",", "x"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "nmax"}], "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.734976987586136*^9, 3.734976987589594*^9}, {
   3.7349770565407677`*^9, 3.734977065211673*^9}, {3.735018645437904*^9, 
   3.735018663575322*^9}, 3.7350187344960127`*^9, 3.735019286525606*^9, {
   3.735578030473062*^9, 3.735578034215639*^9}, {3.735637729042898*^9, 
   3.7356377307518787`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"bdc79936-2a9e-479d-b758-f8ed2d5cd7e1"],

Cell["overlap with the exact ground state:", "Text",
 CellChangeTimes->{{3.7350186705926437`*^9, 
  3.735018681435062*^9}},ExpressionUUID->"5356762f-023f-4c7f-8697-\
f31e451fc813"],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"Abs", "[", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Psi]0", "[", "x", "]"}], "*", 
      RowBox[{"\[Psi]", "[", 
       RowBox[{"1", ",", "x"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "a"}], "}"}]}], "]"}], "]"}], "2"]], "Input",\

 CellChangeTimes->{
  3.734977075622974*^9, {3.735018687458519*^9, 3.73501869074181*^9}, {
   3.735578037272428*^9, 3.735578041075746*^9}, {3.735637733638522*^9, 
   3.7356377356742992`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"bf1b74de-d6a7-4249-9b5e-2fcf0fd90de2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["numerical solution (II): mixed basis", "Subsection",
 CellChangeTimes->{{3.672572898149839*^9, 3.672572909149979*^9}, {
  3.682407178874838*^9, 
  3.6824071844026127`*^9}},ExpressionUUID->"d8534b45-13eb-4df3-9a2a-\
897444032577"],

Cell["computational grid:", "Text",
 CellChangeTimes->{{3.73514366444119*^9, 
  3.735143670701551*^9}},ExpressionUUID->"653f5c76-5d53-456f-8022-\
906744b7bd13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalDelta]", "=", 
   FractionBox["a", 
    RowBox[{"nmax", "+", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xgrid", "=", 
   RowBox[{
    RowBox[{"Range", "[", "nmax", "]"}], "*", "\[CapitalDelta]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.735143671247781*^9, 3.7351436852512712`*^9}, 
   3.7351438031821404`*^9, {3.7351439704463377`*^9, 3.7351439706387987`*^9}, 
   3.7351450242437563`*^9, 3.735145967325892*^9, {3.735146139901506*^9, 
   3.735146140116096*^9}, {3.735147431364602*^9, 3.7351474315550013`*^9}, 
   3.735381383449677*^9, 3.7355779218129473`*^9, 3.735578394319273*^9, 
   3.7356377386214027`*^9, 3.751372883415463*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"d0e9e773-25cb-4644-8678-7945d6e690e0"],

Cell["convert the kinetic-energy operator into the position basis:", "Text",
 CellChangeTimes->{{3.735018520610821*^9, 3.73501852524585*^9}, {
  3.7350187618352203`*^9, 
  3.735018772681734*^9}},ExpressionUUID->"0f4824b7-9242-40c4-a82a-\
9e5294c68c41"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TM", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"Band", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Range", "[", "nmax", "]"}], "2"], "*", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Pi]", "2"], 
        SuperscriptBox["\[HBar]", "2"]}], 
       RowBox[{"2", "m", " ", 
        SuperscriptBox["a", "2"]}]]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TP", "=", 
   RowBox[{"FourierDST", "[", 
    RowBox[{"TM", ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7350094781780787`*^9, 3.73500947818123*^9}, 
   3.7350188548096237`*^9, {3.735381508281335*^9, 3.7353815108107567`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"ed079093-1b66-409e-9b39-246c3b5670f7"],

Cell[TextData[{
 "potential-energy operator: gravity well ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", "x", ")"}], "=", 
    RowBox[{"m", " ", "g", " ", "x"}]}], TraditionalForm]],ExpressionUUID->
  "4d233f2d-2a37-4573-83ec-05869d0134d9"]
}], "Text",
 CellChangeTimes->{{3.682678491243311*^9, 3.682678492619259*^9}, {
  3.734863460541471*^9, 3.734863466946596*^9}, {3.734870063307316*^9, 
  3.7348700772014713`*^9}, {3.7351436248258467`*^9, 3.735143633199037*^9}, {
  3.735578768065033*^9, 3.735578772656106*^9}, {3.735578849646043*^9, 
  3.7355788504780407`*^9}, {3.735637744815085*^9, 
  3.73563774612572*^9}},ExpressionUUID->"912cab47-6293-47d4-b411-\
fc7b3e5f356e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", "x_", "]"}], "=", 
   RowBox[{"m", "*", "g", "*", "x"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Wgrid", "=", 
   RowBox[{"W", "/@", "xgrid"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"VP", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"Band", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "Wgrid"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.734870096232786*^9, 3.734870152825303*^9}, {
   3.73514364005796*^9, 3.735143642592679*^9}, 3.735143989405788*^9, {
   3.735577915190679*^9, 3.735577919538455*^9}, {3.735577954367375*^9, 
   3.7355779597612743`*^9}, 3.735578858278077*^9, {3.735637748161334*^9, 
   3.735637751103297*^9}, {3.751372885175428*^9, 3.7513728878903923`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"9adb3fc7-7d41-4b9e-82fc-105c874d0d0a"],

Cell["Hamiltonian in the position representation:", "Text",
 CellChangeTimes->{{3.735018595712686*^9, 3.735018597157838*^9}, {
  3.735018814124281*^9, 
  3.7350188254487753`*^9}},ExpressionUUID->"faf6d941-15a8-47d4-bbd2-\
3f422cf07f21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HP", "=", 
   RowBox[{"TP", "+", "VP"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735009501407352*^9, 3.735009501409659*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"fd230afe-6bb8-46f9-872b-7cd31251d527"],

Cell["ground state:", "Text",
 CellChangeTimes->{{3.735018599090639*^9, 
  3.735018602632951*^9}},ExpressionUUID->"296d95d5-6337-4c28-a83b-\
56da869a504f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gsP", "=", 
   RowBox[{"-", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"N", "[", "HP", "]"}]}], ",", "1", ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Arnoldi\>\"", ",", 
         RowBox[{"\"\<Criteria\>\"", "\[Rule]", "\"\<RealPart\>\""}], ",", 
         RowBox[{"MaxIterations", "\[Rule]", 
          SuperscriptBox["10", "6"]}]}], "}"}]}]}], "]"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.735009512961823*^9, 3.7350095129640827`*^9}, {
   3.7350188370415907`*^9, 3.735018839445723*^9}, 3.735019290952951*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"7938957a-a3e5-4e51-baea-b3c8e241afc2"],

Cell["ground-state energy, compared to analytic result:", "Text",
 CellChangeTimes->{{3.7350186086230993`*^9, 
  3.735018632893797*^9}},ExpressionUUID->"a9102401-883c-48d5-8a2f-\
c505bc0dad75"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"gsP", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{"\[Epsilon]", "[", "1", "]"}], "//", "N"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.734976971322545*^9, 3.734976971324738*^9}, {
   3.735018614116296*^9, 3.735018623924879*^9}, 3.7350192931722393`*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"36d9a2b5-4859-42fa-a242-64f8b8b62d9d"],

Cell["\<\
ground-state wavefunction as linear interpolation between grid points:\
\>", "Text",
 CellChangeTimes->{{3.735018885151911*^9, 
  3.7350189041293592`*^9}},ExpressionUUID->"1a0979c9-b464-48c2-a68d-\
d76043db6cd2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Gamma]", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"xgrid", ",", 
        RowBox[{
         RowBox[{"gsP", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "/", 
         SqrtBox["\[CapitalDelta]"]}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "0"}], "}"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{"ListLinePlot", "[", "\[Gamma]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P2", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"\[Psi]0", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "a"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Orange"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"P2", ",", "P1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.735010321637865*^9, 3.735010321640903*^9}, {
   3.7350103527673483`*^9, 3.73501035307124*^9}, {3.735010464860284*^9, 
   3.7350104672898912`*^9}, {3.7350189097742*^9, 3.735018915797415*^9}, {
   3.7350190100775547`*^9, 3.735019037301498*^9}, 3.735019297697845*^9, {
   3.7355789661139603`*^9, 3.73557896675453*^9}, 3.735637758265448*^9, 
   3.751372889375211*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"a51420f7-c210-4ee3-a696-e6a5ed774290"],

Cell[CellGroupData[{

Cell["Wigner distribution", "Subsubsection",
 CellChangeTimes->{{3.735060942665676*^9, 
  3.7350609494616213`*^9}},ExpressionUUID->"1bd35c7e-8df7-4ae4-a1e4-\
27f98b949ebc"],

Cell[TextData[{
 "calculate the ",
 Cell[BoxData[
  FormBox["k", TraditionalForm]],ExpressionUUID->
  "d61832a8-c0fa-4f66-b47a-d0b7a9309dba"],
 "-dependent Wigner distribution of a pure state with coefficient vector ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["v", "\[RightVector]"], TraditionalForm]],ExpressionUUID->
  "726b4430-0864-40e6-a384-58fda2b74bf3"],
 " on the spatial grid\nreturn a function of one parameter ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Kappa]", "=", 
    RowBox[{"k", " ", "a"}]}], TraditionalForm]],ExpressionUUID->
  "8e82a0dc-7138-489e-aee6-ed47672a4db1"],
 "\n- ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "d0e450e2-4b8b-4f92-8642-3c9639509fa6"],
 " is the size of the grid\n- ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "107d4eb6-1bc3-4872-8414-1575762017a1"],
 " is the number of grid points (the length of the vector ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["v", "\[RightVector]"], TraditionalForm]],ExpressionUUID->
  "d6ecefd2-ca20-4b1b-8b3f-5cca2a111027"],
 ")\n- ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "=", 
    FractionBox["a", 
     RowBox[{"n", "+", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "f04a1c03-eac3-412f-910a-650a3255a4a2"],
 " is the grid spacing\n- ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "j"], "=", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"j", "|", "\[Psi]"}], "\[RightAngleBracket]"}]}], 
   TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "3a124e12-1de7-4b66-994d-96e3621c5fb2"],
 " is the projection of the pure state onto the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["j", "th"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2ccd5092-76e7-46ee-a861-1275f13a314d"],
 " spatial basis function"
}], "Text",
 CellChangeTimes->{{3.684122683674528*^9, 3.684122690801345*^9}, {
  3.684122744824644*^9, 3.684122746750985*^9}, {3.684123531732957*^9, 
  3.6841235399340477`*^9}, {3.684554110003357*^9, 3.684554121500444*^9}, {
  3.689684180539316*^9, 3.689684181146093*^9}, {3.696532849644061*^9, 
  3.69653288796278*^9}, {3.6965330757464237`*^9, 3.696533132044814*^9}, {
  3.696533215941654*^9, 3.696533236387302*^9}, {3.696534095932616*^9, 
  3.696534107652169*^9}, {3.7332059061229486`*^9, 3.733205917301057*^9}, {
  3.733210155195997*^9, 3.73321016219687*^9}, {3.735061177474017*^9, 
  3.7350611774741297`*^9}, {3.735636092977955*^9, 3.7356361624835663`*^9}, {
  3.7356362307550583`*^9, 3.7356362925787687`*^9}, {3.735636423963317*^9, 
  3.73563643249165*^9}},ExpressionUUID->"bd85194e-1a3a-466e-8851-\
234bea845ba1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WignerDistribution", "[", 
   RowBox[{"v_", "?", "VectorQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nmax", "=", 
      RowBox[{"Length", "[", "v", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"Function", "[", 
     RowBox[{"\[Kappa]", ",", 
      RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
       RowBox[{
        FractionBox[
         RowBox[{"Sinc", "[", 
          FractionBox["\[Kappa]", 
           RowBox[{"nmax", "+", "1"}]], "]"}], "\[Pi]"], "\[Times]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"v", "\[LeftDoubleBracket]", 
                RowBox[{"j", "-", "m"}], "\[RightDoubleBracket]"}], 
               RowBox[{"Conjugate", "[", 
                RowBox[{"v", "\[LeftDoubleBracket]", 
                 RowBox[{"j", "+", "m"}], "\[RightDoubleBracket]"}], "]"}], 
               RowBox[{"Exp", "[", 
                FractionBox[
                 RowBox[{"2", "\[ImaginaryI]", " ", "\[Kappa]", " ", "m"}], 
                 RowBox[{"nmax", "+", "1"}]], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", 
                RowBox[{"-", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"j", "-", "1"}], ",", 
                   RowBox[{"nmax", "-", "j"}]}], "]"}]}], ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"j", "-", "1"}], ",", 
                  RowBox[{"nmax", "-", "j"}]}], "]"}]}], "}"}]}], "]"}], "//",
             "Re"}], "//", "ComplexExpand"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"nmax", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6841227245487223`*^9, 3.684122830237604*^9}, {
   3.684122864594195*^9, 3.6841228669675837`*^9}, {3.684123404855945*^9, 
   3.684123412071602*^9}, {3.684123864076064*^9, 3.684123865291625*^9}, {
   3.6841251788234577`*^9, 3.684125184695759*^9}, {3.68412629667706*^9, 
   3.684126308972628*^9}, {3.684553551369974*^9, 3.6845536225491133`*^9}, {
   3.684553713404811*^9, 3.684553718444765*^9}, {3.684553762544963*^9, 
   3.684553773828665*^9}, {3.684553989853073*^9, 3.684554018810454*^9}, {
   3.6845545003212023`*^9, 3.684554500460227*^9}, {3.689684190890637*^9, 
   3.689684194107884*^9}, {3.694944781825428*^9, 3.694944816475986*^9}, {
   3.6965326107268476`*^9, 3.6965326712302847`*^9}, 3.6965327102286777`*^9, {
   3.696532758028421*^9, 3.696532806096507*^9}, {3.696532894664604*^9, 
   3.696532896222192*^9}, {3.696533139676977*^9, 3.696533172157187*^9}, {
   3.696533868338451*^9, 3.696533874126708*^9}, {3.696534060917121*^9, 
   3.696534091767954*^9}, {3.6965342047541237`*^9, 3.696534236153768*^9}, {
   3.70220527233394*^9, 3.702205274112383*^9}, {3.7332058999279346`*^9, 
   3.733205927099094*^9}, 3.733206040747456*^9, {3.735640088191555*^9, 
   3.7356401091426077`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"92750828-fc75-43ce-8d14-0edf44f9db55"],

Cell[TextData[{
 "plot the Wigner function of a pure state with coefficient vector ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "=", 
    OverscriptBox["v", "\[RightVector]"]}], TraditionalForm]],ExpressionUUID->
  "e97064c8-0521-4b54-b0ae-0f5fff593a31"],
 " or density matrix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Y", "=", "R"}], TraditionalForm]],ExpressionUUID->
  "96f52c6d-2446-4edc-a88a-139100f3716c"],
 ":\n(needs the grid coordinates, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "\[Element]", 
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["x", "min"], ",", 
      SubscriptBox["x", "max"]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "0940ce13-8e29-495a-b1c4-abe55d82ae5d"],
 ", for labeling the axes; ",
 Cell[BoxData[
  FormBox[
   RowBox[{"a", "=", 
    RowBox[{
     SubscriptBox["x", "max"], "-", 
     SubscriptBox["x", "min"]}]}], TraditionalForm]],ExpressionUUID->
  "c23f5d4d-92bd-44af-bf9a-4b00fab74374"],
 ")\ncolor scale is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    RowBox[{
     RowBox[{"-", 
      FormBox[
       FractionBox["1", "\[Pi]"],
       TraditionalForm]}], ",", 
     RowBox[{"+", 
      FormBox[
       FractionBox["1", "\[Pi]"],
       TraditionalForm]}]}], "]"}], TraditionalForm]],ExpressionUUID->
  "bf9b0efc-d9ae-4b59-81dc-3edbaa583d4a"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", 
    FormBox[
     FractionBox["1", "\[Pi]"],
     TraditionalForm]}], TraditionalForm]],ExpressionUUID->
  "c0134649-19a1-46ae-8f2c-f95cde84c1f7"],
 "=blue, ",
 Cell[BoxData[
  FormBox["0", TraditionalForm]],ExpressionUUID->
  "e070d5c4-5b65-4627-97ec-949e81923d19"],
 "=white, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"+", 
    FractionBox["1", "\[Pi]"]}], TraditionalForm]],ExpressionUUID->
  "e1fa8c61-0d04-450e-94f1-9c888d41c7d6"],
 "=red"
}], "Text",
 CellChangeTimes->{{3.696535963129311*^9, 3.69653597331999*^9}, {
  3.6965361356512623`*^9, 3.6965361470612698`*^9}, {3.696579844268025*^9, 
  3.696579871030807*^9}, {3.7332059902221947`*^9, 3.733205994471569*^9}, {
  3.735061182159693*^9, 3.73506118215981*^9}, {3.735102062878407*^9, 
  3.735102126369197*^9}, {3.735102400783058*^9, 3.73510240887987*^9}, {
  3.735102513492247*^9, 
  3.7351025219266453`*^9}},ExpressionUUID->"7776528a-0e73-4ff2-8b66-\
7d9f0ebba1ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WignerDistributionPlot", "[", 
   RowBox[{
    RowBox[{"v_", "?", "VectorQ"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"xmin_", "?", "NumericQ"}], ",", 
       RowBox[{"xmax_", "?", "NumericQ"}]}], "}"}], "/;", 
     RowBox[{"xmax", ">", "xmin"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nmax", ",", "qmax", ",", "w", ",", "W"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"number", " ", "of", " ", "grid", " ", "points"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nmax", "=", 
      RowBox[{"Length", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"calculate", " ", "the", " ", "Wigner", " ", "distribution"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"WignerDistribution", "[", "v", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "evaluate", " ", "it", " ", "on", " ", "the", " ", "natural", " ", 
       "dimensionless", " ", "momentum", " ", "grid"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"qmax", "=", 
      RowBox[{"Floor", "[", 
       FractionBox["nmax", "2"], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"W", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"q", " ", "\[Pi]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", 
          RowBox[{"-", "qmax"}], ",", "qmax"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"make", " ", "a", " ", "plot"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{"W", ",", 
       RowBox[{"FrameTicks", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{
           FractionBox[
            RowBox[{"qmax", " ", "\[Pi]"}], 
            RowBox[{"xmax", "-", "xmin"}]], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{
           FractionBox[
            RowBox[{"qmax", " ", "\[Pi]"}], 
            RowBox[{"xmax", "-", "xmin"}]], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{"1", "/", "GoldenRatio"}]}], ",", 
       RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Blend", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Blue", ",", "White", ",", "Red"}], "}"}], ",", 
            FractionBox[
             RowBox[{
              RowBox[{"\[Pi]", "#"}], "+", "1"}], "2"]}], "]"}], "&"}], 
         ")"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6965359845306787`*^9, 3.6965361307427692`*^9}, {
  3.6965362532082663`*^9, 3.696536254635394*^9}, {3.696537441382687*^9, 
  3.696537441572617*^9}, {3.696579875806356*^9, 3.696579915028823*^9}, {
  3.696579945717936*^9, 3.696579949129374*^9}, {3.696580164085631*^9, 
  3.6965801642096767`*^9}, {3.7332059983368597`*^9, 3.733206006193927*^9}, {
  3.735102334910421*^9, 3.7351023604926157`*^9}, {3.735102422800293*^9, 
  3.735102455315316*^9}, {3.7351025530459127`*^9, 3.735102568267737*^9}, {
  3.73564013984133*^9, 3.7356401531523123`*^9}, {3.7356402241415873`*^9, 
  3.735640230726774*^9}, {3.745133256954236*^9, 3.7451332774057283`*^9}, {
  3.745133372735708*^9, 3.745133375766877*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a52c59a6-0bdf-451d-b05e-576d5dd5d200"],

Cell["plot the Wigner distribution of the ground state:", "Text",
 CellChangeTimes->{{3.684122683674528*^9, 3.684122690801345*^9}, {
  3.684122744824644*^9, 3.684122746750985*^9}, {3.684123531732957*^9, 
  3.6841235496322308`*^9}},ExpressionUUID->"b4dd0c7e-0c4b-47e8-ac04-\
1d0451b9c698"],

Cell[BoxData[
 RowBox[{"WignerDistributionPlot", "[", 
  RowBox[{
   RowBox[{"gsP", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "a"}], "}"}]}], "]"}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"8064dbf2-de37-45a4-b972-ff1b148e7c3e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 778},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 695, 15, 58, "Text",ExpressionUUID->"59e15e35-b139-4ab1-8d52-a0a6429b9d4e"],
Cell[1256, 37, 2693, 50, 46, "Text",ExpressionUUID->"5ba186e8-492a-4ced-8bd1-f275d540436f"],
Cell[3952, 89, 541, 12, 35, "Text",ExpressionUUID->"77450482-7a40-48bf-9d59-40c9a94b74c8"],
Cell[CellGroupData[{
Cell[4518, 105, 269, 4, 98, "Title",ExpressionUUID->"53a7277b-506a-411e-8251-5a4b806581a4"],
Cell[CellGroupData[{
Cell[4812, 113, 153, 3, 54, "Subsection",ExpressionUUID->"8e6317c8-51ad-417a-af6e-805f9c3eadda"],
Cell[4968, 118, 227, 4, 35, "Text",ExpressionUUID->"8e02522f-4f01-428f-a978-80bca989cf14"],
Cell[5198, 124, 266, 6, 30, "Input",ExpressionUUID->"5e066122-d64b-4b35-ac5d-dfe861f7c36f"],
Cell[5467, 132, 183, 3, 35, "Text",ExpressionUUID->"8bdb61fd-4446-4152-aca7-54a7dade7666"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5687, 140, 221, 4, 54, "Subsection",ExpressionUUID->"0426b6b4-44c8-4714-b6d4-f04f6c59d388"],
Cell[5911, 146, 177, 3, 35, "Text",ExpressionUUID->"f0663002-ad1d-4bf0-9025-e5408fe9f75a"],
Cell[6091, 151, 826, 21, 49, "DisplayFormulaNumbered",ExpressionUUID->"e9655d90-a754-48f4-afbd-2c42db558de9"],
Cell[6920, 174, 276, 4, 35, "Text",ExpressionUUID->"5c165c6e-585d-4d42-95ac-bc1f4fd81c0c"],
Cell[7199, 180, 1476, 44, 126, "Input",ExpressionUUID->"6c5be16d-bc32-40c7-8201-b5abddbe6435"],
Cell[8678, 226, 175, 3, 35, "Text",ExpressionUUID->"300cff4b-7463-42bc-bfd6-87053e2ed315"],
Cell[8856, 231, 599, 15, 30, "Input",ExpressionUUID->"5587a397-a267-4282-872d-5110375f04e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9492, 251, 161, 3, 54, "Subsection",ExpressionUUID->"b1b21674-37d9-4fc8-a18f-b9b564169153"],
Cell[9656, 256, 159, 3, 35, "Text",ExpressionUUID->"de513c41-8c93-4797-80f6-29802fa04587"],
Cell[9818, 261, 801, 12, 30, "Input",ExpressionUUID->"6ebafd86-d1a9-4adf-8df7-24d5a911deb3"],
Cell[10622, 275, 166, 3, 35, "Text",ExpressionUUID->"d3267872-1c3e-410d-a4d4-2bf2b904045f"],
Cell[10791, 280, 214, 4, 30, "Input",ExpressionUUID->"1e518986-9657-446f-a422-1446bf4a9a8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11042, 289, 159, 3, 54, "Subsection",ExpressionUUID->"efe8b451-a419-4d8a-b2a6-162f2dc3115c"],
Cell[11204, 294, 167, 3, 35, "Text",ExpressionUUID->"3b3320b9-98d6-48bb-9ea1-02f6d4b388cc"],
Cell[11374, 299, 503, 15, 68, "Input",ExpressionUUID->"600ae0eb-db08-4211-a502-7ad873c97a9b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11914, 319, 186, 3, 54, "Subsection",ExpressionUUID->"1578ce56-fb42-426b-9b26-e30fb32fcd07"],
Cell[12103, 324, 367, 11, 37, "Text",ExpressionUUID->"be8bfa1f-f1cb-41c9-b2be-d2a4cc93dab4"],
Cell[12473, 337, 696, 19, 52, "Input",ExpressionUUID->"e04f2e67-a8b4-40e4-8fbf-ef6597061fe4"],
Cell[13172, 358, 408, 11, 35, "Text",ExpressionUUID->"abbde63b-b4cc-4d4a-a0db-ea893f615f7f"],
Cell[13583, 371, 1165, 32, 54, "Input",ExpressionUUID->"20446bac-32fb-4ce9-9851-d2e8d03d5fc3"],
Cell[14751, 405, 167, 3, 35, "Text",ExpressionUUID->"6d64cd06-db50-4e30-bac9-ff6022ad36cd"],
Cell[14921, 410, 324, 6, 30, "Input",ExpressionUUID->"ef3bccff-a58e-4934-bcff-a96b41badaab"],
Cell[15248, 418, 234, 4, 35, "Text",ExpressionUUID->"ae1f6432-92a3-484a-82a5-138b7dd656b3"],
Cell[15485, 424, 241, 5, 30, "Input",ExpressionUUID->"4e117c32-866e-4476-861f-0a678a43007f"],
Cell[15729, 431, 155, 3, 35, "Text",ExpressionUUID->"f8035b2c-85d5-42d3-98eb-146c87cd6287"],
Cell[15887, 436, 707, 17, 33, "Input",ExpressionUUID->"12fccf49-c506-443d-8426-d6d8e8a85e4d"],
Cell[16597, 455, 193, 3, 35, "Text",ExpressionUUID->"493b0f6e-bc2c-4a96-88eb-4dd496047078"],
Cell[16793, 460, 448, 9, 30, "Input",ExpressionUUID->"8efc5898-4fee-49ba-8675-757c566e51d5"],
Cell[17244, 471, 225, 4, 35, "Text",ExpressionUUID->"9f3e9ad7-003f-4a1c-9005-4de0648cff7d"],
Cell[17472, 477, 802, 18, 30, "Input",ExpressionUUID->"bdc79936-2a9e-479d-b758-f8ed2d5cd7e1"],
Cell[18277, 497, 180, 3, 35, "Text",ExpressionUUID->"5356762f-023f-4c7f-8697-f31e451fc813"],
Cell[18460, 502, 608, 16, 30, "Input",ExpressionUUID->"bf1b74de-d6a7-4249-9b5e-2fcf0fd90de2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19105, 523, 235, 4, 54, "Subsection",ExpressionUUID->"d8534b45-13eb-4df3-9a2a-897444032577"],
Cell[19343, 529, 160, 3, 35, "Text",ExpressionUUID->"653f5c76-5d53-456f-8022-906744b7bd13"],
Cell[19506, 534, 778, 16, 68, "Input",ExpressionUUID->"d0e9e773-25cb-4644-8678-7945d6e690e0"],
Cell[20287, 552, 252, 4, 35, "Text",ExpressionUUID->"0f4824b7-9242-40c4-a82a-9e5294c68c41"],
Cell[20542, 558, 842, 23, 76, "Input",ExpressionUUID->"ed079093-1b66-409e-9b39-246c3b5670f7"],
Cell[21387, 583, 687, 15, 35, "Text",ExpressionUUID->"912cab47-6293-47d4-b411-fc7b3e5f356e"],
Cell[22077, 600, 873, 21, 73, "Input",ExpressionUUID->"9adb3fc7-7d41-4b9e-82fc-105c874d0d0a"],
Cell[22953, 623, 236, 4, 35, "Text",ExpressionUUID->"faf6d941-15a8-47d4-bbd2-3f422cf07f21"],
Cell[23192, 629, 239, 5, 30, "Input",ExpressionUUID->"fd230afe-6bb8-46f9-872b-7cd31251d527"],
Cell[23434, 636, 155, 3, 35, "Text",ExpressionUUID->"296d95d5-6337-4c28-a83b-56da869a504f"],
Cell[23592, 641, 709, 17, 33, "Input",ExpressionUUID->"7938957a-a3e5-4e51-baea-b3c8e241afc2"],
Cell[24304, 660, 193, 3, 35, "Text",ExpressionUUID->"a9102401-883c-48d5-8a2f-c505bc0dad75"],
Cell[24500, 665, 450, 9, 30, "Input",ExpressionUUID->"36d9a2b5-4859-42fa-a242-64f8b8b62d9d"],
Cell[24953, 676, 222, 5, 35, "Text",ExpressionUUID->"1a0979c9-b464-48c2-a68d-d76043db6cd2"],
Cell[25178, 683, 1506, 39, 102, "Input",ExpressionUUID->"a51420f7-c210-4ee3-a696-e6a5ed774290"],
Cell[CellGroupData[{
Cell[26709, 726, 172, 3, 45, "Subsubsection",ExpressionUUID->"1bd35c7e-8df7-4ae4-a1e4-27f98b949ebc"],
Cell[26884, 731, 2671, 66, 157, "Text",ExpressionUUID->"bd85194e-1a3a-466e-8851-234bea845ba1"],
Cell[29558, 799, 3192, 67, 141, "Input",ExpressionUUID->"92750828-fc75-43ce-8d14-0edf44f9db55"],
Cell[32753, 868, 2276, 70, 85, "Text",ExpressionUUID->"7776528a-0e73-4ff2-8b66-7d9f0ebba1ef"],
Cell[35032, 940, 4024, 99, 296, "Input",ExpressionUUID->"a52c59a6-0bdf-451d-b05e-576d5dd5d200"],
Cell[39059, 1041, 288, 4, 35, "Text",ExpressionUUID->"b4dd0c7e-0c4b-47e8-ac04-1d0451b9c698"],
Cell[39350, 1047, 321, 7, 30, "Input",ExpressionUUID->"8064dbf2-de37-45a4-b972-ff1b148e7c3e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

