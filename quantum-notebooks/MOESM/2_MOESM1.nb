(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     24971,        702]
NotebookOptionsPosition[     22228,        651]
NotebookOutlinePosition[     22581,        667]
CellTagsIndexPosition[     22538,        664]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "This Mathematica code is part of the lecture script ",
 StyleBox["Introduction to Computational Quantum Mechanics",
  FontSlant->"Italic"],
 " by Roman Schmied. It is licensed under a ",
 ButtonBox["Creative Commons Attribution-ShareAlike 4.0 International License",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://creativecommons.org/licenses/by-sa/4.0/"], None},
  ButtonNote->"http://creativecommons.org/licenses/by-sa/4.0/"],
 "."
}], "Text",
 CellChangeTimes->{{3.669434091682116*^9, 3.669434147842166*^9}, {
  3.669435842013185*^9, 3.669435866952169*^9}, {3.669435915352921*^9, 
  3.669435921977655*^9}},ExpressionUUID->"3c1158a8-b075-4ed7-8d32-\
6dfdd45784c5"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1: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
yoV9Oe0/TXxfaElz99px38MJ1qr/AASW71I=
    "], {{0, 31}, {88, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{88, 31},
  PlotRange->{{0, 88}, {0, 31}}]], "Text",
 CellChangeTimes->{
  3.669607172458665*^9},ExpressionUUID->"0df2e90a-9e30-4c31-81c7-\
410041b545d4"],

Cell[TextData[{
 "You can download the associated lecture script at ",
 ButtonBox["http://arxiv.org/abs/1403.7050",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://arxiv.org/abs/1403.7050"], None},
  ButtonNote->"http://arxiv.org/abs/1403.7050"]
}], "Text",
 CellChangeTimes->{{3.669434151914299*^9, 3.669434159778274*^9}, {
  3.669435746836981*^9, 3.669435760656741*^9}, {3.669435890511055*^9, 
  3.6694358923333282`*^9}, {3.682249494738699*^9, 
  3.682249495771936*^9}},ExpressionUUID->"52ef9869-cb6c-4eb3-9cfd-\
1672ae8b4ff9"],

Cell[CellGroupData[{

Cell["reduced density matrices", "Title",
 CellChangeTimes->{{3.669352573273164*^9, 3.669352578882872*^9}, {
  3.669353620618896*^9, 3.669353630933281*^9}, {3.6693537023163443`*^9, 
  3.669353707514772*^9}, {3.6702116673599443`*^9, 
  3.670211670675909*^9}},ExpressionUUID->"f9eb999e-a051-41ac-a82f-\
66d4825d4fc9"],

Cell[TextData[{
 "We operate in a Hilbert space that is the direct product (tensor product) \
of three Hilbert subspaces associated with three subsystems A, B, C, which \
have dimensions ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["d", "A"], TraditionalForm]],ExpressionUUID->
  "90474da7-ef7e-4081-aea5-2ae98976f949"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["d", "B"], TraditionalForm]],ExpressionUUID->
  "0872eb88-1079-43dc-915d-d56d75bce173"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["d", "C"], TraditionalForm]],ExpressionUUID->
  "f5d57a5a-af00-4d08-945c-ec535a3e7aba"],
 ", respectively. The goal is to calculate the reduced density matrix of the \
system after tracing out (forgetting, cutting out) subsystem B."
}], "Text",
 CellChangeTimes->{{3.6702116790797653`*^9, 3.670211743531171*^9}, {
  3.6702117829851093`*^9, 3.670211796271476*^9}, {3.751372086520791*^9, 
  3.7513720869048853`*^9}},ExpressionUUID->"351e6ff2-11a7-4883-83b4-\
43e20cf48cdb"],

Cell[CellGroupData[{

Cell["tripartite cases", "Subsection",
 CellChangeTimes->{{3.695953150960042*^9, 
  3.695953154337151*^9}},ExpressionUUID->"ee1a10b7-9f00-4d3b-833c-\
80f9f09bf120"],

Cell[CellGroupData[{

Cell[TextData[{
 "starting from a density matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "ABC"], TraditionalForm]],ExpressionUUID->
  "5f3ad4d1-2dfb-40f1-bfe5-2380fd0224f5"]
}], "Subsubsection",
 CellChangeTimes->{{3.6693537119100227`*^9, 3.669353729409212*^9}, {
  3.670211748437111*^9, 
  3.670211756438262*^9}},ExpressionUUID->"13729ae8-8d49-4e22-ad95-\
50db6564e50c"],

Cell[TextData[{
 "Given a density matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "ABC"], TraditionalForm]],ExpressionUUID->
  "d3aa1f58-4408-4325-8804-43f67ed2afd2"],
 " of size ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d", "A"], 
    SubscriptBox["d", "B"], 
    SubscriptBox["d", "C"], "\[Times]", 
    SubscriptBox["d", "A"], 
    SubscriptBox["d", "B"], 
    SubscriptBox["d", "C"]}], TraditionalForm]],ExpressionUUID->
  "8fe8fb90-a2ed-4892-a6f8-474737d2d30f"],
 ", calculate the reduced density matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "AC"], TraditionalForm]],ExpressionUUID->
  "a22f6dd7-21f5-419b-9428-bdef28cde33d"],
 " of size ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d", "A"], 
    SubscriptBox["d", "C"], "\[Times]", 
    SubscriptBox["d", "A"], 
    SubscriptBox["d", "C"]}], TraditionalForm]],ExpressionUUID->
  "8a664947-5980-44b8-bba2-862462a4cf00"],
 " after tracing out subsystem B:"
}], "Text",
 CellChangeTimes->{{3.670211774333543*^9, 
  3.670211848707547*^9}},ExpressionUUID->"5e3d7dc1-08b4-4c42-a244-\
37d530bd53e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rdm", "[", 
    RowBox[{
     RowBox[{"\[Rho]ABC_", "?", "MatrixQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dA_Integer", "/;", 
        RowBox[{"dA", "\[GreaterEqual]", "1"}]}], ",", 
       RowBox[{"dB_Integer", "/;", 
        RowBox[{"dB", "\[GreaterEqual]", "1"}]}], ",", 
       RowBox[{"dC_Integer", "/;", 
        RowBox[{"dC", "\[GreaterEqual]", "1"}]}]}], "}"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Dimensions", "[", "\[Rho]ABC", "]"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dA", " ", "dB", " ", "dC"}], ",", 
      RowBox[{"dA", " ", "dB", " ", "dC"}]}], "}"}]}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"TensorContract", "[", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"\[Rho]ABC", ",", 
        RowBox[{"{", 
         RowBox[{
         "dA", ",", "dB", ",", "dC", ",", "dA", ",", "dB", ",", "dC"}], 
         "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "5"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6701570444688797`*^9, 3.670157120931857*^9}, {
   3.6845564082585087`*^9, 3.684556426359207*^9}, {3.68455646673715*^9, 
   3.6845564853994102`*^9}, 3.6845568001260843`*^9, {3.684556875273527*^9, 
   3.684556897343663*^9}, 3.68455709400632*^9, {3.684557563143552*^9, 
   3.684557572989278*^9}, {3.684557656162505*^9, 3.6845576678394823`*^9}, {
   3.6845577969904623`*^9, 3.684557802749567*^9}, {3.684564631260564*^9, 
   3.6845646358264847`*^9}, {3.684568281499481*^9, 3.684568285572178*^9}, 
   3.68457069918618*^9, {3.689491380969852*^9, 
   3.6894913811918497`*^9}},ExpressionUUID->"26038adc-28fc-4d2d-a40d-\
a37ce29e2ada"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "starting from a pure state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "ABC"], TraditionalForm]],ExpressionUUID->
  "3ce84e14-0c14-480b-a4fd-76741a8ebfbf"]
}], "Subsubsection",
 CellChangeTimes->{{3.6693537119100227`*^9, 3.669353729409212*^9}, {
  3.670211748437111*^9, 3.670211756438262*^9}, {3.670211858562504*^9, 
  3.6702118615493183`*^9}},ExpressionUUID->"8e49c19d-e525-4e08-99c3-\
07f173b9baa9"],

Cell[TextData[{
 "Given a pure state ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "ABC"], TraditionalForm]],ExpressionUUID->
  "ff56c304-e24a-40b8-9c6b-e8324bf45695"],
 " of length ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d", "A"], 
    SubscriptBox["d", "B"], 
    SubscriptBox["d", "C"]}], TraditionalForm]],ExpressionUUID->
  "29492e51-6c2b-4cfb-9178-27da4d24a159"],
 ", calculate the reduced density matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "AC"], TraditionalForm]],ExpressionUUID->
  "bfabcf55-f220-4b01-95fe-ed09d316495d"],
 " of size ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d", "A"], 
    SubscriptBox["d", "C"], "\[Times]", 
    SubscriptBox["d", "A"], 
    SubscriptBox["d", "C"]}], TraditionalForm]],ExpressionUUID->
  "532027dd-d286-4178-ba35-f319b651983b"],
 " after tracing out subsystem B:"
}], "Text",
 CellChangeTimes->{{3.670211774333543*^9, 
  3.670211876083687*^9}},ExpressionUUID->"16674c23-ed3d-4d86-bd8d-\
0bd69d8a7cc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rdm", "[", 
    RowBox[{
     RowBox[{"\[Psi]ABC_", "?", "VectorQ"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dA_Integer", "/;", 
        RowBox[{"dA", "\[GreaterEqual]", "1"}]}], ",", 
       RowBox[{"dB_Integer", "/;", 
        RowBox[{"dB", "\[GreaterEqual]", "1"}]}], ",", 
       RowBox[{"dC_Integer", "/;", 
        RowBox[{"dC", "\[GreaterEqual]", "1"}]}]}], "}"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "\[Psi]ABC", "]"}], "\[Equal]", 
    RowBox[{"dA", " ", "dB", " ", "dC"}]}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"P", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"\[Psi]ABC", ",", 
        RowBox[{"{", 
         RowBox[{"dA", ",", "dB", ",", "dC"}], "}"}]}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"P", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}], ".", 
       RowBox[{"ConjugateTranspose", "[", "P", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.6701570444688797`*^9, 3.670157120931857*^9}, {
   3.670158487288124*^9, 3.67015856795714*^9}, {3.670211902045909*^9, 
   3.670211902325843*^9}, 3.68455694332288*^9, {3.6845570577146873`*^9, 
   3.68455706539156*^9}, 3.684557098640808*^9, {3.684571420749518*^9, 
   3.68457145253354*^9}, {3.684571509839488*^9, 3.6845715129499893`*^9}, {
   3.684571549026635*^9, 3.684571601572398*^9}, {3.684571640242334*^9, 
   3.684571669827222*^9}, 
   3.6845720701375523`*^9},ExpressionUUID->"c25ee245-148d-4da9-b7a2-\
b36773109365"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["bipartite cases", "Subsection",
 CellChangeTimes->{{3.695953160405645*^9, 
  3.695953162720813*^9}},ExpressionUUID->"61c2de4c-d1b7-4eeb-88c8-\
ff56e5ec6756"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"d", ">", "0"}], TraditionalForm]],ExpressionUUID->
  "91c5a149-aab3-41ee-9fcc-da7a9031fcf7"],
 ": trace out the first ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "bb1aac1d-7acf-4ff0-92f0-c44ee2dd1508"],
 " dimensions\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", "<", "0"}], TraditionalForm]],ExpressionUUID->
  "bce50506-3c28-4640-8710-bfae338b09bd"],
 ": trace out the last ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "57e29b28-c0cb-4369-8faa-9af1b8a93bd7"],
 " dimensions"
}], "Text",
 CellChangeTimes->{{3.695953174537794*^9, 
  3.695953192717464*^9}},ExpressionUUID->"2da44e72-1527-474c-a49e-\
59c061b9000e"],

Cell[CellGroupData[{

Cell[TextData[{
 "starting from a density matrix ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "4537ae91-29a2-47a1-8579-58fb566bb041"]
}], "Subsubsection",
 CellChangeTimes->{{3.6693537119100227`*^9, 3.669353729409212*^9}, {
  3.670211748437111*^9, 3.670211756438262*^9}, {3.695953361427548*^9, 
  3.695953362042582*^9}},ExpressionUUID->"936df8ed-60f3-43a5-937d-\
c7010932ca04"],

Cell[TextData[{
 "Given a density matrix ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "35e3c5fb-ade7-4db0-9947-c72d8b3163c2"],
 " of size ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", " ", 
    RowBox[{"d", "'"}], "\[Times]", "d", " ", 
    RowBox[{"d", "'"}]}], TraditionalForm]],ExpressionUUID->
  "78f5e61a-2bc9-4602-a31c-7ec17c5c21dc"],
 ", calculate the reduced density matrix ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Rho]", "~"], TraditionalForm]],ExpressionUUID->
  "e0f7137c-b50d-4ba5-b3cc-687760127b81"],
 " of size ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"d", "'"}], "\[Times]", 
    RowBox[{"d", "'"}]}], TraditionalForm]],ExpressionUUID->
  "70ef3255-91ed-4fdf-9833-db158c0c2686"],
 " after tracing out the subsystem of dimension ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "b369f305-2141-4afa-9b87-aa4de59779be"],
 ":"
}], "Text",
 CellChangeTimes->{{3.670211774333543*^9, 3.670211848707547*^9}, {
  3.695953365213685*^9, 3.695953412714415*^9}, {3.695953444859578*^9, 
  3.6959534488831177`*^9}},ExpressionUUID->"da8329cb-af19-43f5-aa52-\
9d59cb176c3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceout", "[", 
    RowBox[{
     RowBox[{"\[Rho]_", "?", "MatrixQ"}], ",", 
     RowBox[{"d_Integer", "/;", 
      RowBox[{"d", "\[GreaterEqual]", "1"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "\[Rho]", "]"}], "\[Equal]", 
     RowBox[{"Length", "[", 
      RowBox[{"\[Rho]", "\[Transpose]"}], "]"}]}], "\[And]", 
    RowBox[{"Divisible", "[", 
     RowBox[{
      RowBox[{"Length", "[", "\[Rho]", "]"}], ",", "d"}], "]"}]}]}], ":=", 
  RowBox[{"rdm", "[", 
   RowBox[{"\[Rho]", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "d", ",", 
      FractionBox[
       RowBox[{"Length", "[", "\[Rho]", "]"}], "d"]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695953196030212*^9, 
  3.695953306427854*^9}},ExpressionUUID->"3efd4d54-f9f6-45d8-8bbe-\
9146c5d1845b"],

Cell[TextData[{
 "Given a density matrix ",
 Cell[BoxData[
  FormBox["\[Rho]", TraditionalForm]],ExpressionUUID->
  "b6c3b7b0-d865-4dbf-b09d-7b3b8eb1d851"],
 " of size ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"d", "'"}], 
    RowBox[{"\[LeftBracketingBar]", "d", "\[RightBracketingBar]"}], 
    "\[Times]", 
    RowBox[{"d", "'"}], 
    RowBox[{"\[LeftBracketingBar]", "d", "\[RightBracketingBar]"}]}], 
   TraditionalForm]],ExpressionUUID->"4d1f1c45-320c-4343-88e3-3fda8c6b3df1"],
 ", calculate the reduced density matrix ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Rho]", "~"], TraditionalForm]],ExpressionUUID->
  "8b3e0267-53ba-4b5d-b57f-74e42f79db05"],
 " of size ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"d", "'"}], "\[Times]", 
    RowBox[{"d", "'"}]}], TraditionalForm]],ExpressionUUID->
  "6ababfb5-e534-429c-82a4-52e40e4eae4c"],
 " after tracing out the subsystem of dimension ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[LeftBracketingBar]", "d", "\[RightBracketingBar]"}], 
   TraditionalForm]],ExpressionUUID->"0ffc7f4b-29db-4ace-85e6-4a6c56745316"],
 ":"
}], "Text",
 CellChangeTimes->{{3.670211774333543*^9, 3.670211848707547*^9}, {
  3.695953365213685*^9, 
  3.695953489638777*^9}},ExpressionUUID->"3fceae2d-9313-48ff-8a33-\
995da4ad04e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceout", "[", 
    RowBox[{
     RowBox[{"\[Rho]_", "?", "MatrixQ"}], ",", 
     RowBox[{"d_Integer", "/;", 
      RowBox[{"d", "\[LessEqual]", 
       RowBox[{"-", "1"}]}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "\[Rho]", "]"}], "\[Equal]", 
     RowBox[{"Length", "[", 
      RowBox[{"\[Rho]", "\[Transpose]"}], "]"}]}], "\[And]", 
    RowBox[{"Divisible", "[", 
     RowBox[{
      RowBox[{"Length", "[", "\[Rho]", "]"}], ",", 
      RowBox[{"-", "d"}]}], "]"}]}]}], ":=", 
  RowBox[{"rdm", "[", 
   RowBox[{"\[Rho]", ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"Length", "[", "\[Rho]", "]"}], 
       RowBox[{"-", "d"}]], ",", 
      RowBox[{"-", "d"}], ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.695953196030212*^9, 
  3.695953347690523*^9}},ExpressionUUID->"83f8ae97-0cb7-4e60-b7f6-\
a12fb7cad4bc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "starting from a pure state ",
 Cell[BoxData[
  FormBox["\[Psi]", TraditionalForm]],ExpressionUUID->
  "fdfdb5f5-52b2-4fc5-8b4b-b999c428c7b7"]
}], "Subsubsection",
 CellChangeTimes->{{3.6693537119100227`*^9, 3.669353729409212*^9}, {
  3.670211748437111*^9, 3.670211756438262*^9}, {3.670211858562504*^9, 
  3.6702118615493183`*^9}, {3.695953506348675*^9, 
  3.695953507659122*^9}},ExpressionUUID->"6bea536a-027d-494e-bdaf-\
b0b001615c0b"],

Cell[TextData[{
 "Given a pure state ",
 Cell[BoxData[
  FormBox["\[Psi]", TraditionalForm]],ExpressionUUID->
  "7441f68b-559e-4747-994c-1f00a15da52c"],
 " of length ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", " ", 
    RowBox[{"d", "'"}]}], TraditionalForm]],ExpressionUUID->
  "50d466bb-b7fd-4c78-80d5-76a5cf9ddb8d"],
 ", calculate the reduced density matrix ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Rho]", "~"], TraditionalForm]],ExpressionUUID->
  "2011af00-5041-4ca1-ad5f-e1d1816bef59"],
 " of size ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"d", "'"}], "\[Times]", 
    RowBox[{"d", "'"}]}], TraditionalForm]],ExpressionUUID->
  "5e8aea13-e2a6-4dbf-802a-ed7f9be7d0db"],
 " after tracing out the subsystem of dimension ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "8f9d4c58-f450-4cdb-9d9e-23cb6d1e714e"],
 ":"
}], "Text",
 CellChangeTimes->{{3.670211774333543*^9, 3.670211876083687*^9}, {
  3.695953518748302*^9, 
  3.695953561043968*^9}},ExpressionUUID->"92d4843b-7ff4-4a3f-bdbf-\
b91db3f9dd11"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceout", "[", 
    RowBox[{
     RowBox[{"\[Psi]_", "?", "VectorQ"}], ",", 
     RowBox[{"d_Integer", "/;", 
      RowBox[{"d", "\[GreaterEqual]", "1"}]}]}], "]"}], "/;", 
   RowBox[{"Divisible", "[", 
    RowBox[{
     RowBox[{"Length", "[", "\[Psi]", "]"}], ",", "d"}], "]"}]}], ":=", 
  RowBox[{"rdm", "[", 
   RowBox[{"\[Psi]", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "d", ",", 
      FractionBox[
       RowBox[{"Length", "[", "\[Psi]", "]"}], "d"]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695953196030212*^9, 3.695953306427854*^9}, {
  3.6959535748968287`*^9, 
  3.695953601540604*^9}},ExpressionUUID->"4459c10c-7d25-4b77-86e6-\
404c6277bd83"],

Cell[TextData[{
 "Given a pure state ",
 Cell[BoxData[
  FormBox["\[Psi]", TraditionalForm]]],
 " of length ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"d", "'"}], "d"}], TraditionalForm]]],
 ", calculate the reduced density matrix ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[Rho]", "~"], TraditionalForm]]],
 " of size ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"d", "'"}], "\[Times]", 
    RowBox[{"d", "'"}]}], TraditionalForm]]],
 " after tracing out the subsystem of dimension ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],
  FormatType->"TraditionalForm"],
 ":"
}], "Text",
 CellChangeTimes->{{3.670211774333543*^9, 3.670211876083687*^9}, {
  3.695953518748302*^9, 3.695953561043968*^9}, {3.695953613321438*^9, 
  3.695953615827764*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceout", "[", 
    RowBox[{
     RowBox[{"\[Psi]_", "?", "VectorQ"}], ",", 
     RowBox[{"d_Integer", "/;", 
      RowBox[{"d", "\[LessEqual]", 
       RowBox[{"-", "1"}]}]}]}], "]"}], "/;", 
   RowBox[{"Divisible", "[", 
    RowBox[{
     RowBox[{"Length", "[", "\[Psi]", "]"}], ",", 
     RowBox[{"-", "d"}]}], "]"}]}], ":=", 
  RowBox[{"rdm", "[", 
   RowBox[{"\[Psi]", ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"Length", "[", "\[Psi]", "]"}], 
       RowBox[{"-", "d"}]], ",", 
      RowBox[{"-", "d"}], ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.695953196030212*^9, 3.695953306427854*^9}, {
  3.6959535748968287`*^9, 3.695953634506852*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 778},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 695, 15, 58, "Text",ExpressionUUID->"3c1158a8-b075-4ed7-8d32-6dfdd45784c5"],
Cell[1256, 37, 2693, 50, 46, "Text",ExpressionUUID->"0df2e90a-9e30-4c31-81c7-410041b545d4"],
Cell[3952, 89, 539, 12, 35, "Text",ExpressionUUID->"52ef9869-cb6c-4eb3-9cfd-1672ae8b4ff9"],
Cell[CellGroupData[{
Cell[4516, 105, 315, 5, 98, "Title",ExpressionUUID->"f9eb999e-a051-41ac-a82f-66d4825d4fc9"],
Cell[4834, 112, 979, 24, 58, "Text",ExpressionUUID->"351e6ff2-11a7-4883-83b4-43e20cf48cdb"],
Cell[CellGroupData[{
Cell[5838, 140, 164, 3, 54, "Subsection",ExpressionUUID->"ee1a10b7-9f00-4d3b-833c-80f9f09bf120"],
Cell[CellGroupData[{
Cell[6027, 147, 386, 10, 45, "Subsubsection",ExpressionUUID->"13729ae8-8d49-4e22-ad95-50db6564e50c"],
Cell[6416, 159, 1111, 35, 35, "Text",ExpressionUUID->"5e3d7dc1-08b4-4c42-a244-37d530bd53e1"],
Cell[7530, 196, 1910, 48, 52, "Input",ExpressionUUID->"26038adc-28fc-4d2d-a40d-a37ce29e2ada"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9477, 249, 430, 10, 45, "Subsubsection",ExpressionUUID->"8e49c19d-e525-4e08-99c3-07f173b9baa9"],
Cell[9910, 261, 1010, 32, 35, "Text",ExpressionUUID->"16674c23-ed3d-4d86-bd8d-0bd69d8a7cc9"],
Cell[10923, 295, 1898, 49, 73, "Input",ExpressionUUID->"c25ee245-148d-4da9-b7a2-b36773109365"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12870, 350, 163, 3, 54, "Subsection",ExpressionUUID->"61c2de4c-d1b7-4eeb-88c8-ff56e5ec6756"],
Cell[13036, 355, 719, 22, 58, "Text",ExpressionUUID->"2da44e72-1527-474c-a49e-59c061b9000e"],
Cell[CellGroupData[{
Cell[13780, 381, 407, 9, 45, "Subsubsection",ExpressionUUID->"936df8ed-60f3-43a5-937d-c7010932ca04"],
Cell[14190, 392, 1142, 33, 35, "Text",ExpressionUUID->"da8329cb-af19-43f5-aa52-9d59cb176c3c"],
Cell[15335, 427, 849, 25, 49, "Input",ExpressionUUID->"3efd4d54-f9f6-45d8-8bbe-9146c5d1845b"],
Cell[16187, 454, 1282, 37, 35, "Text",ExpressionUUID->"3fceae2d-9313-48ff-8a33-995da4ad04e5"],
Cell[17472, 493, 932, 28, 49, "Input",ExpressionUUID->"83f8ae97-0cb7-4e60-b7f6-a12fb7cad4bc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18441, 526, 454, 10, 45, "Subsubsection",ExpressionUUID->"6bea536a-027d-494e-bdaf-b0b001615c0b"],
Cell[18898, 538, 1045, 32, 35, "Text",ExpressionUUID->"92d4843b-7ff4-4a3f-bdbf-b91db3f9dd11"],
Cell[19946, 572, 721, 21, 49, "Input",ExpressionUUID->"4459c10c-7d25-4b77-86e6-404c6277bd83"],
Cell[20670, 595, 772, 27, 52, "Text",ExpressionUUID->"3a581238-909e-49ec-b9ef-8c58750b1d5d"],
Cell[21445, 624, 743, 22, 72, "Input",ExpressionUUID->"c9284aa0-1b83-43f5-877c-f52cb064ea23"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

