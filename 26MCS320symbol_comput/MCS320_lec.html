
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MCS320 Intro Symbolic Computation &#8212; Jonny Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=550f00eb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '26MCS320symbol_comput/MCS320_lec';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Jonny Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Math &amp; FP/Language</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../past/Alevel_math.html">A-level-math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Alevel_math_further.html">A-level-further</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MCM.html">Math Computational Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_Lean.html">Lean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_Puzzle.html">Permutation Puzzles</a></li>


<li class="toctree-l1"><a class="reference internal" href="../Course_Ext_III.html">Ext III</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0mmgroup.html">mmgroup Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CS &amp; Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MIT6001Python.html">MIT_CS6001-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MIT6002thinking.html">MIT_CS6002-CS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PE100.html">Project Euler Q1-50</a></li>


<li class="toctree-l1"><a class="reference internal" href="../PE_Informatics/PE_tags.html">Project Euler Tag-Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MCM_QM.html">Quantum Mechanics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook &amp; Tom</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../past/nb_past_courses.html">Past courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/nb_Geo.html">Geography and Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/nb_lottery_simulator.html">Lottery Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/How_Dad_organise_QM.html">How Dad learn QM</a></li>


<li class="toctree-l1"><a class="reference internal" href="../Course_MCM_QFT.html">QFT</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/10pe" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/26MCS320symbol_comput/MCS320_lec.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MCS320 Intro Symbolic Computation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec1">Lec1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec2">Lec2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec3">Lec3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec4">Lec4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec5">Lec5</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec6">Lec6</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec7">Lec7</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec8">Lec8</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec9">Lec9</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec10">Lec10</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec11">Lec11</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec12">Lec12</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec13">Lec13</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec14">Lec14</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec15">Lec15</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec19">Lec19</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec20">Lec20</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec21">Lec21</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec22">Lec22</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec23">Lec23</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec24">Lec24</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec25">Lec25</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec26">Lec26</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec27">Lec27</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec28">Lec28</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec29">Lec29</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec30">Lec30</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec31">Lec31</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec32">Lec32</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec33">Lec33</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec34">Lec34</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec39">Lec39</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec40">Lec40</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec41">Lec41</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec42">Lec42</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mcs320-intro-symbolic-computation">
<h1>MCS320 Intro Symbolic Computation<a class="headerlink" href="#mcs320-intro-symbolic-computation" title="Link to this heading">#</a></h1>
<p>Summer 2023</p>
<section id="lec1">
<h2>Lec1<a class="headerlink" href="#lec1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pi
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">sin</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/aa851e5f3b2aa50ec4e0397e66c7562e057fe30b96e4764522a6b7df094f785f.png" src="../_images/aa851e5f3b2aa50ec4e0397e66c7562e057fe30b96e4764522a6b7df094f785f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pi20</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pi20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">pi20</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1415926535897932385
&lt;class &#39;sage.rings.real_mpfr.RealNumber&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sin</span><span class="p">(</span><span class="n">pi20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.5640070857470010853e-22
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sage.misc.citation</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_systems</span>
<span class="n">get_systems</span><span class="p">(</span><span class="s1">&#39;pi.n(digits=20)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;MPFR&#39;, &#39;ginac&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Problem: compute the first ten rational approximations for pi,</span>
<span class="c1"># starting at 1 decimal place accurate to 10 decimal places.</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">QQ</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span>
<span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[19/6,
 113/36,
 333/106,
 355/113,
 355/113,
 93343/29712,
 98313/31294,
 104348/33215,
 312689/99532,
 833719/265381]
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec2">
<h2>Lec2<a class="headerlink" href="#lec2" title="Link to this heading">#</a></h2>
<p>SageMath is a computer algebra system, capable of working with symbols.
For example, the transcendental constant <span class="math notranslate nohighlight">\(\pi\)</span> is known to SageMath as <code class="docutils literal notranslate"><span class="pre">pi</span></code>.
Applying the <code class="docutils literal notranslate"><span class="pre">sin()</span></code> function to <span class="math notranslate nohighlight">\(\pi\)</span> shows the true value of <span class="math notranslate nohighlight">\(\sin(\pi)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>The language of SageMath is based on Python.  Python is a dynamically typed language.  The type of each object determines the opererations that can be performed on the object.
We query the type of an object with <code class="docutils literal notranslate"><span class="pre">type()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Note that SageMath is case sensitive <code class="docutils literal notranslate"><span class="pre">pi</span></code> <span class="math notranslate nohighlight">\(\not=\)</span> <code class="docutils literal notranslate"><span class="pre">Pi</span></code>.</p>
<p><strong>Numerical Approximations</strong></p>
<p>We can compute a numerical approximation for <span class="math notranslate nohighlight">\(\pi\)</span>, with the application of the method <code class="docutils literal notranslate"><span class="pre">n()</span></code> on the object <code class="docutils literal notranslate"><span class="pre">pi</span></code>, which is of type symbolic expression.
In the argument of <code class="docutils literal notranslate"><span class="pre">n()</span></code> we can specify the number of decimal places with <code class="docutils literal notranslate"><span class="pre">digits=</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Pi10</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Pi10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Pi10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592654
&lt;class &#39;sage.rings.real_mpfr.RealNumber&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>The number we obtained is not a Python float, but of type <code class="docutils literal notranslate"><span class="pre">RealNumber</span></code> of the multiprecision  software GNU MPFR library.  Let us see by how much <code class="docutils literal notranslate"><span class="pre">Pi10</span></code> differs from <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">-</span> <span class="n">Pi10</span>
<span class="nb">print</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pi - 3.141592654
&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>The answer above is exact and correct, but it is not so helpful,
we were hoping to see a number to verify that our <code class="docutils literal notranslate"><span class="pre">Pi10</span></code> approximates <span class="math notranslate nohighlight">\(\pi\)</span> really with 10 decimal places accuracy.  Let us compute a numerical approximation of <code class="docutils literal notranslate"><span class="pre">delta</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">11</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0000000000
3.6379788071e-12
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Pi18q</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">(</span><span class="n">Pi10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the 10-digit accurate rational approximation for pi:&#39;</span><span class="p">,</span> <span class="n">Pi18q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">Pi18q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the 10-digit accurate rational approximation for pi: 833719/265381
&lt;class &#39;sage.rings.rational.Rational&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec3">
<h2>Lec3<a class="headerlink" href="#lec3" title="Link to this heading">#</a></h2>
<p><strong>1. Getting Started</strong></p>
<p>What is the accuracy of 22/7 as an approximation for <span class="math notranslate nohighlight">\(\pi\)</span>?</p>
<p>Well, we setup the formula for the relative error:</p>
<div class="math notranslate nohighlight">
\[
    \left| \frac{22/7 - \pi}{\pi} \right|.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="mi">22</span><span class="o">/</span><span class="mi">7</span> <span class="o">-</span> <span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{{\left| 7 \, \pi - 22 \right|}}{7 \, \pi}</script></html></div></div>
</div>
<p>Now we evaluate this error numerically, in a number system of sufficiently high precision.  For this problem, 5 decimal places will surely be sufficient.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.00040244
</pre></div>
</div>
</div>
</div>
<p>We see that the error is <code class="docutils literal notranslate"><span class="pre">0.0004</span></code> or <span class="math notranslate nohighlight">\(4 \times 10^{-4}\)</span> which is <code class="docutils literal notranslate"><span class="pre">4.0e-4</span></code> in scientific notation, as verified below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;</span><span class="si">%.1e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="mf">0.0004</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;4.0e-04&#39;
</pre></div>
</div>
</div>
</div>
<p><strong>2. Getting Help</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function numerical_approx in module sage.misc.functional:

numerical_approx(x, prec=None, digits=None, algorithm=None)
    Return a numerical approximation of ``self`` with ``prec`` bits
    (or decimal ``digits``) of precision.
    
    No guarantee is made about the accuracy of the result.
    
    .. NOTE::
    
        Lower case :func:`n` is an alias for :func:`numerical_approx`
        and may be used as a method.
    
    INPUT:
    
    - ``prec`` -- precision in bits
    
    - ``digits`` -- precision in decimal digits (only used if
      ``prec`` is not given)
    
    - ``algorithm`` -- which algorithm to use to compute this
      approximation (the accepted algorithms depend on the object)
    
    If neither ``prec`` nor ``digits`` is given, the default
    precision is 53 bits (roughly 16 digits).
    
    EXAMPLES::
    
        sage: numerical_approx(pi, 10)
        3.1
        sage: numerical_approx(pi, digits=10)
        3.141592654
        sage: numerical_approx(pi^2 + e, digits=20)
        12.587886229548403854
        sage: n(pi^2 + e)
        12.5878862295484
        sage: N(pi^2 + e)
        12.5878862295484
        sage: n(pi^2 + e, digits=50)
        12.587886229548403854194778471228813633070946500941
        sage: a = CC(-5).n(prec=40)
        sage: b = ComplexField(40)(-5)
        sage: a == b
        True
        sage: parent(a) is parent(b)
        True
        sage: numerical_approx(9)
        9.00000000000000
    
    You can also usually use method notation::
    
        sage: (pi^2 + e).n()
        12.5878862295484
        sage: (pi^2 + e).numerical_approx()
        12.5878862295484
    
    Vectors and matrices may also have their entries approximated::
    
        sage: v = vector(RDF, [1,2,3])
        sage: v.n()
        (1.00000000000000, 2.00000000000000, 3.00000000000000)
    
        sage: v = vector(CDF, [1,2,3])
        sage: v.n()
        (1.00000000000000, 2.00000000000000, 3.00000000000000)
        sage: _.parent()
        Vector space of dimension 3 over Complex Field with 53 bits of precision
        sage: v.n(prec=20)
        (1.0000, 2.0000, 3.0000)
    
        sage: u = vector(QQ, [1/2, 1/3, 1/4])
        sage: n(u, prec=15)
        (0.5000, 0.3333, 0.2500)
        sage: n(u, digits=5)
        (0.50000, 0.33333, 0.25000)
    
        sage: v = vector(QQ, [1/2, 0, 0, 1/3, 0, 0, 0, 1/4], sparse=True)
        sage: u = v.numerical_approx(digits=4)
        sage: u.is_sparse()
        True
        sage: u
        (0.5000, 0.0000, 0.0000, 0.3333, 0.0000, 0.0000, 0.0000, 0.2500)
    
        sage: A = matrix(QQ, 2, 3, range(6))
        sage: A.n()
        [0.000000000000000  1.00000000000000  2.00000000000000]
        [ 3.00000000000000  4.00000000000000  5.00000000000000]
    
        sage: B = matrix(Integers(12), 3, 8, srange(24))
        sage: N(B, digits=2)
        [0.00  1.0  2.0  3.0  4.0  5.0  6.0  7.0]
        [ 8.0  9.0  10.  11. 0.00  1.0  2.0  3.0]
        [ 4.0  5.0  6.0  7.0  8.0  9.0  10.  11.]
    
    Internally, numerical approximations of real numbers are stored in base-2.
    Therefore, numbers which look the same in their decimal expansion might be
    different::
    
        sage: x=N(pi, digits=3); x
        3.14
        sage: y=N(3.14, digits=3); y
        3.14
        sage: x==y
        False
        sage: x.str(base=2)
        &#39;11.001001000100&#39;
        sage: y.str(base=2)
        &#39;11.001000111101&#39;
    
    Increasing the precision of a floating point number is not allowed::
    
        sage: CC(-5).n(prec=100)
        Traceback (most recent call last):
        ...
        TypeError: cannot approximate to a precision of 100 bits, use at most 53 bits
        sage: n(1.3r, digits=20)
        Traceback (most recent call last):
        ...
        TypeError: cannot approximate to a precision of 70 bits, use at most 53 bits
        sage: RealField(24).pi().n()
        Traceback (most recent call last):
        ...
        TypeError: cannot approximate to a precision of 53 bits, use at most 24 bits
    
    As an exceptional case, ``digits=1`` usually leads to 2 digits (one
    significant) in the decimal output (see :trac:`11647`)::
    
        sage: N(pi, digits=1)
        3.2
        sage: N(pi, digits=2)
        3.1
        sage: N(100*pi, digits=1)
        320.
        sage: N(100*pi, digits=2)
        310.
    
    In the following example, ``pi`` and ``3`` are both approximated to two
    bits of precision and then subtracted, which kills two bits of precision::
    
        sage: N(pi, prec=2)
        3.0
        sage: N(3, prec=2)
        3.0
        sage: N(pi - 3, prec=2)
        0.00
    
    TESTS::
    
        sage: numerical_approx(I)
        1.00000000000000*I
        sage: x = QQ[&#39;x&#39;].gen()
        sage: F.&lt;k&gt; = NumberField(x^2+2, embedding=sqrt(CC(2))*CC.0)
        sage: numerical_approx(k)
        1.41421356237309*I
    
        sage: type(numerical_approx(CC(1/2)))
        &lt;type &#39;sage.rings.complex_mpfr.ComplexNumber&#39;&gt;
    
    The following tests :trac:`10761`, in which ``n()`` would break when
    called on complex-valued algebraic numbers.  ::
    
        sage: E = matrix(3, [3,1,6,5,2,9,7,3,13]).eigenvalues(); E
        [18.16815365088822?, -0.08407682544410650? - 0.2190261484802906?*I, -0.08407682544410650? + 0.2190261484802906?*I]
        sage: E[1].parent()
        Algebraic Field
        sage: [a.n() for a in E]
        [18.1681536508882, -0.0840768254441065 - 0.219026148480291*I, -0.0840768254441065 + 0.219026148480291*I]
    
    Make sure we&#39;ve rounded up log(10,2) enough to guarantee
    sufficient precision (:trac:`10164`)::
    
        sage: ks = 4*10**5, 10**6
        sage: check_str_length = lambda k: len(str(numerical_approx(1+10**-k,digits=k+1)))-1 &gt;= k+1
        sage: check_precision = lambda k: numerical_approx(1+10**-k,digits=k+1)-1 &gt; 0
        sage: all(check_str_length(k) and check_precision(k) for k in ks)
        True
    
    Testing we have sufficient precision for the golden ratio (:trac:`12163`), note
    that the decimal point adds 1 to the string length::
    
        sage: len(str(n(golden_ratio, digits=5000)))
        5001
        sage: len(str(n(golden_ratio, digits=5000000)))  # long time (4s on sage.math, 2012)
        5000001
    
    Check that :trac:`14778` is fixed::
    
        sage: n(0, algorithm=&#39;foo&#39;)
        0.000000000000000
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">n()</span></code> is an alias for the method <code class="docutils literal notranslate"><span class="pre">numerical_approx</span></code>.  Observe the statement
<code class="docutils literal notranslate"><span class="pre">No</span> <span class="pre">guarantee</span> <span class="pre">is</span> <span class="pre">made</span> <span class="pre">about</span> <span class="pre">the</span> <span class="pre">accuracy</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">result.</span></code></p>
<p>If we would not know either <code class="docutils literal notranslate"><span class="pre">n()</span></code> nor <code class="docutils literal notranslate"><span class="pre">numerical_approx</span></code> and wanted to compute a numerical approximation, then we could search the entire SageMath documentation for the words <code class="docutils literal notranslate"><span class="pre">numerical</span> <span class="pre">approximation</span></code>, as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search_doc</span><span class="p">(</span><span class="s2">&quot;numerical_approximation&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The output is moved to the Jupyter Pager window.</p>
<p>The result is rather extensive.  The documentation of SageMath is organized into constructions, tutorials, preps (for undergraduates), and the reference manual.</p>
<p><strong>3. Arbitrary Precision Floating-Point Numbers</strong></p>
<p>One strength of computer algebra systems is that we are not limited to the machine precision and that we can work with arbitrary precision.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">RealField</span></code> defines arithmetic with arbitrary precision, defined in bits.</p>
<p>To calculate how many bits are needed to have a desired precision in decimal places, we use the 2-logarithm of 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="mf">8.0</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;number of bits for 8 decimal places :&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">R8</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of bits for 8 decimal places : 27
</pre></div>
</div>
</div>
</div>
<p>Then we can use <code class="docutils literal notranslate"><span class="pre">R8</span></code> to get an 8-digit decimal approximation for <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R8</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141593
</pre></div>
</div>
</div>
</div>
<p>Let us verify with what we have seen before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1415927
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec4">
<h2>Lec4<a class="headerlink" href="#lec4" title="Link to this heading">#</a></h2>
<p><strong>1. Rational Approximations with Prescribed Accuracy</strong></p>
<p>To make a rational approximation with a prescribed accuracy we do</p>
<ol class="arabic simple">
<li><p>evaluate the number as a floating-point number in the desired precision</p></li>
<li><p>converted the evaluated number into a rational number.</p></li>
</ol>
<p>For example, compute a rational approximation of <span class="math notranslate nohighlight">\(\pi\)</span> accurate to three decimal places.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">QQ</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>333/106
</pre></div>
</div>
</div>
</div>
<p><strong>2. Continued Fractions</strong></p>
<p>A continued fraction is defined by a list of natural numbers.   Let look first at an example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">continued_fraction</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}1
+ \frac{\displaystyle 1}{\displaystyle 2
+ \frac{\displaystyle 1}{\displaystyle 2
+ \frac{\displaystyle 1}{\displaystyle 2
+ \frac{\displaystyle 1}{\displaystyle 2
+ \frac{\displaystyle 1}{\displaystyle 2
+ \frac{\displaystyle 1}{\displaystyle 2
+ \frac{\displaystyle 1}{\displaystyle 2
+ \frac{\displaystyle 1}{\displaystyle 2
+ \frac{\displaystyle 1}{\displaystyle 2
+ \frac{\displaystyle 1}{\displaystyle \dots}}}}}}}}}}</script></html></div></div>
</div>
<p>We see that the continued fraction of <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> is very regular.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">convergents</span></code> of the continued fraction define a sequence of rational approximations of increasing accuracy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">convergents</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lazy list [1, 3/2, 7/5, ...]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">lazy</span></code> aspect of the outcome refers to the delayed evaluation.</p>
<p>Let us force the computation of the convergents and ask for the first 8 convergents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cvg</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">convergents</span><span class="p">()</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">cvg</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 3/2, 7/5, 17/12, 41/29, 99/70, 239/169, 577/408]
</pre></div>
</div>
</div>
</div>
<p>To compute the relative errors of the approximations, we run a list comprehension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;</span><span class="si">%.1e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;2.9e-01&#39;,
 &#39;6.1e-02&#39;,
 &#39;1.0e-02&#39;,
 &#39;1.7e-03&#39;,
 &#39;3.0e-04&#39;,
 &#39;5.1e-05&#39;,
 &#39;8.8e-06&#39;,
 &#39;1.5e-06&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec5">
<h2>Lec5<a class="headerlink" href="#lec5" title="Link to this heading">#</a></h2>
<p><strong>1. Complex Numbers</strong></p>
<p>The set of all complex numbers is predefined as <code class="docutils literal notranslate"><span class="pre">CC</span></code> (or <code class="docutils literal notranslate"><span class="pre">CDF</span></code> for the complex double field).  Let us look at a random complex number.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">CC</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.850863261870165 - 0.914313861818274*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the real part :&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">real</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the imaginary part :&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">imag</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the real part : 0.850863261870165
the imaginary part : -0.914313861818274
</pre></div>
</div>
</div>
</div>
<p>The polar representation of a complex number is defined by the argument and the radius.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the radius of&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the radius of 0.850863261870165 - 0.914313861818274*I is 1.24897483093671
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">argument</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the argument of&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the argument of 0.850863261870165 - 0.914313861818274*I is -0.821328434738775
</pre></div>
</div>
</div>
</div>
<p>Given the argument and radius, we can compute the rectangular representation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rz</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the rectangular format :&#39;</span><span class="p">,</span> <span class="n">rz</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;        the original z :&#39;</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the rectangular format : 0.850863261870165 - 0.914313861818275*I
        the original z : 0.850863261870165 - 0.914313861818274*I
</pre></div>
</div>
</div>
</div>
<p>To verify the formal definition of <code class="docutils literal notranslate"><span class="pre">I</span></code> we factor <span class="math notranslate nohighlight">\(x^2 + 1\)</span> over the polynomial ring with complex coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CC</span><span class="p">[]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Univariate Polynomial Ring in x over Complex Field with 53 bits of precision
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x - I) * (x + I)
</pre></div>
</div>
</div>
</div>
<p>We see that there are two square roots of <span class="math notranslate nohighlight">\(-1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I, -I]
</pre></div>
</div>
</div>
</div>
<p>Therefore, is not strictly correct to refer to <code class="docutils literal notranslate"><span class="pre">I</span></code> as <em>the</em> square root of <span class="math notranslate nohighlight">\(-1\)</span>, because there are two square roots.  It is better to call <code class="docutils literal notranslate"><span class="pre">I</span></code> the positive square root of <span class="math notranslate nohighlight">\(-1\)</span>.</p>
<p><strong>2. Algebraic Numbers</strong></p>
<p>With a <code class="docutils literal notranslate"><span class="pre">reset()</span></code> we reset all names of variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We extend the rational numbers with <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> in three steps:</p>
<ol class="arabic simple">
<li><p>We define the polynomial ring <code class="docutils literal notranslate"><span class="pre">P</span></code> for the polynomials in <code class="docutils literal notranslate"><span class="pre">x</span></code> with rational coefficients in <code class="docutils literal notranslate"><span class="pre">QQ</span></code>.</p></li>
<li><p>The polynomial <code class="docutils literal notranslate"><span class="pre">p</span></code> is <span class="math notranslate nohighlight">\(x^2 - 2\)</span> is the polynomial we want to factor over the field extension.</p></li>
<li><p>The extended number field is called <code class="docutils literal notranslate"><span class="pre">Q1</span></code> using <code class="docutils literal notranslate"><span class="pre">sqrt2</span></code> as the symbol for <span class="math notranslate nohighlight">\(\sqrt{-2}\)</span>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">Q1</span><span class="o">.&lt;</span><span class="n">sqrt2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number Field in sqrt2 with defining polynomial x^2 - 2
</pre></div>
</div>
</div>
</div>
<p>Any polynomial in <code class="docutils literal notranslate"><span class="pre">x</span></code> will be seen as a polynomial with rational coefficients.  To define a polynomial over the extended field <code class="docutils literal notranslate"><span class="pre">Q1</span></code>, we must use a new independent variable.  Therefore, we define <code class="docutils literal notranslate"><span class="pre">P1</span></code> as the ring of polynomials in <code class="docutils literal notranslate"><span class="pre">y</span></code> with coefficients in <code class="docutils literal notranslate"><span class="pre">Q1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Q1</span><span class="p">[]</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">factor</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(y - sqrt2) * (y + sqrt2)
</pre></div>
</div>
</div>
</div>
<p>Now we see that over this new field, that <span class="math notranslate nohighlight">\(y^2 - 2\)</span> factors.</p>
<p>To factor also <span class="math notranslate nohighlight">\(y^2 + 1\)</span>, we add the imaginary unit to <code class="docutils literal notranslate"><span class="pre">Q1</span></code> to obtain the extension <code class="docutils literal notranslate"><span class="pre">Q2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">Q2</span><span class="o">.&lt;</span><span class="n">imagunit</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Q1</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number Field in imagunit with defining polynomial y^2 + 1 over its base field
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P2</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Q2</span><span class="p">[]</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
<span class="n">factor</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(z + sqrt2*imagunit) * (z - sqrt2*imagunit)
</pre></div>
</div>
</div>
</div>
<p><strong>3. Finite Field Extensions</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Over the binary number field, the polynomial <span class="math notranslate nohighlight">\(x^2 + 1\)</span> factors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z2</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Z2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ring of integers modulo 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Z2</span><span class="p">[]</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x + 1)^2
</pre></div>
</div>
</div>
</div>
<p>If a polynomial factors, then we say it is <em>reducible</em>, otherwise it is <em>irreducible</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">factor</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^3 + x + 1
</pre></div>
</div>
</div>
</div>
<p>We see that <span class="math notranslate nohighlight">\(x^3 + x + 1\)</span> does not factor over the binary numbers.  So we can extend <code class="docutils literal notranslate"><span class="pre">Z2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Z2</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Univariate Quotient Polynomial Ring in c over Ring of integers modulo 2 with modulus c^3 + c + 1
</pre></div>
</div>
</div>
</div>
<p>In a finite field we can list all elements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">K</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, c, c + 1, c^2, c^2 + 1, c^2 + c, c^2 + c + 1]
</pre></div>
</div>
</div>
</div>
<p>The multiplication table is printed below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">K</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">K</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 0, 0, 0, 0, 0, 0, 0]
[0, 1, c, c + 1, c^2, c^2 + 1, c^2 + c, c^2 + c + 1]
[0, c, c^2, c^2 + c, c + 1, 1, c^2 + c + 1, c^2 + 1]
[0, c + 1, c^2 + c, c^2 + 1, c^2 + c + 1, c^2, 1, c]
[0, c^2, c + 1, c^2 + c + 1, c^2 + c, c, c^2 + 1, 1]
[0, c^2 + 1, 1, c^2, c, c^2 + c + 1, c + 1, c^2 + c]
[0, c^2 + c, c^2 + c + 1, 1, c^2 + 1, c + 1, c, c^2]
[0, c^2 + c + 1, c^2 + 1, c, 1, c^2 + c, c^2, c + 1]
</pre></div>
</div>
</div>
</div>
<p>Except for the first row and first column, there is exactly one <code class="docutils literal notranslate"><span class="pre">1</span></code> in every row and column, which shows that every element (except zero) has an inverse.</p>
</section>
<section id="lec6">
<h2>Lec6<a class="headerlink" href="#lec6" title="Link to this heading">#</a></h2>
<p><strong>1. An Example of a Symbolic Computation</strong></p>
<p>Let us declare four variables, using the letters a, b, c, and d.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a,b,c,d&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We define <span class="math notranslate nohighlight">\(a + b \sqrt{2}\)</span> and assign this expression to <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\sqrt{2} b + a</script></html></div></div>
</div>
<p>To <code class="docutils literal notranslate"><span class="pre">y</span></code> we assign the expression <span class="math notranslate nohighlight">\(c + d \sqrt{2}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\sqrt{2} d + c</script></html></div></div>
</div>
<p>Then we assign the product of <code class="docutils literal notranslate"><span class="pre">x</span></code> with <code class="docutils literal notranslate"><span class="pre">y</span></code> to <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span>
<span class="n">z</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}{\left(\sqrt{2} b + a\right)} {\left(\sqrt{2} d + c\right)}</script></html></div></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">=</span> <span class="pre">x*y</span></code> is not expanded, we have to force the expansion by the application of the <code class="docutils literal notranslate"><span class="pre">expand()</span></code> method on <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ez</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">ez</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\sqrt{2} b c + \sqrt{2} a d + a c + 2 \, b d</script></html></div></div>
</div>
<p>We see that the <code class="docutils literal notranslate"><span class="pre">ez</span></code> is not a simpler expression than the <code class="docutils literal notranslate"><span class="pre">z</span></code>.  To collect the terms in <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>, we select the coefficient of <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> in the expression <code class="docutils literal notranslate"><span class="pre">ez</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">ez</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}b c + a d</script></html></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">f</span></code> gives us the factor in the term with <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> in the expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\sqrt{2} {\left(b c + a d\right)}</script></html></div></div>
</div>
<p>In order to get the other term in the expression, we subtract the <em>expanded</em> <code class="docutils literal notranslate"><span class="pre">g</span></code> from <code class="docutils literal notranslate"><span class="pre">ez</span></code> to get the rest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">rest</span> <span class="o">=</span> <span class="n">ez</span> <span class="o">-</span> <span class="n">h</span>
<span class="n">rest</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}a c + 2 \, b d</script></html></div></div>
</div>
<p>And now we can assemble the final result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span> <span class="o">=</span> <span class="n">rest</span> <span class="o">+</span> <span class="n">g</span>
<span class="n">show</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}a c + 2 \, b d + \sqrt{2} {\left(b c + a d\right)}</script></html></div></div>
</div>
<p><strong>2. the Symbolic Ring</strong></p>
<p>Consider the expression <span class="math notranslate nohighlight">\(\sqrt{x^2}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\sqrt{x^{2}}</script></html></div></div>
</div>
<p>Why does <code class="docutils literal notranslate"><span class="pre">sqrt(x^2)</span></code> not simplify to <code class="docutils literal notranslate"><span class="pre">x</span></code>?  Well, recall that over the complex numbers, <code class="docutils literal notranslate"><span class="pre">sqrt()</span></code> is a double valued function.</p>
<p>We can force the choice of one of the answers, typically the positive one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">canonicalize_radical</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x
</pre></div>
</div>
</div>
</div>
<p>We can declare letters as symbols.  Also numbers can be considered as symbols.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sqrt4</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">sqrt4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\sqrt{4}</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sqrt4</span><span class="o">.</span><span class="n">unhold</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sinpi</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">sinpi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\sin\left(\pi\right)</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sinpi</span><span class="o">.</span><span class="n">unhold</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p><strong>3. Names and References</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y
</pre></div>
</div>
</div>
</div>
<p>We see that <code class="docutils literal notranslate"><span class="pre">x</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">y</span></code>, because after <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code> refers to <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;y equals&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x equals&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y equals 3
x equals y
</pre></div>
</div>
</div>
</div>
<p>We see that <code class="docutils literal notranslate"><span class="pre">x</span></code> still refers to <code class="docutils literal notranslate"><span class="pre">y</span></code>, after the assignment of <code class="docutils literal notranslate"><span class="pre">3</span></code> to <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>We can force the full evaluation with <code class="docutils literal notranslate"><span class="pre">eval()</span></code> which takes a string on argument.  The <code class="docutils literal notranslate"><span class="pre">str(x)</span></code> returns the string representation of the variable <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<p>What if we had started with <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">3</span></code>?  How do we prevent the evaluation of <code class="docutils literal notranslate"><span class="pre">y</span></code> when we assign <code class="docutils literal notranslate"><span class="pre">y</span></code> to <code class="docutils literal notranslate"><span class="pre">x</span></code>?</p>
<p>To be clear, we still want the same dependencies between the variables as before:</p>
<div class="math notranslate nohighlight">
\[
    x \longrightarrow y \longrightarrow 3
\]</div>
<p>Let us rebegin by resetting all variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;y equals&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y equals 3
</pre></div>
</div>
</div>
</div>
<p>The key is to assign to <code class="docutils literal notranslate"><span class="pre">x</span></code> the <em>name</em> of <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x equals&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x equals y
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<p>By placing quotes around <code class="docutils literal notranslate"><span class="pre">y</span></code> in the assignment to <code class="docutils literal notranslate"><span class="pre">x</span></code> we prevent <code class="docutils literal notranslate"><span class="pre">y</span></code> from evaluating to 3.</p>
</section>
<section id="lec7">
<h2>Lec7<a class="headerlink" href="#lec7" title="Link to this heading">#</a></h2>
<p>In this lecture 7 of MCS 320, we look at binary and hexadecimal formats of numbers, introduce the nearby rational approximations in the first section.  In the second section we illustrate how functions can be used to store data.</p>
<p><strong>1. Number Types</strong></p>
<p>The number types <code class="docutils literal notranslate"><span class="pre">ZZ</span></code>, <code class="docutils literal notranslate"><span class="pre">QQ</span></code>, <code class="docutils literal notranslate"><span class="pre">RR</span></code>, and <code class="docutils literal notranslate"><span class="pre">CC</span></code> abbreviate respectively the integer, rational, real, and complex numbers.</p>
<p>We can use <code class="docutils literal notranslate"><span class="pre">ZZ</span></code> to compute the digits of the binary expansion of a number.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ZZ</span><span class="p">(</span><span class="mi">2022</span><span class="p">)</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1]
</pre></div>
</div>
</div>
</div>
<p>Given the list of the bits in a number, we can convert back to its decimal representation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="mi">2022</span><span class="p">)</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ZZ</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022
</pre></div>
</div>
</div>
</div>
<p>For the real field <code class="docutils literal notranslate"><span class="pre">RR</span></code>, we can ask the precision.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RR</span><span class="o">.</span><span class="n">precision</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53
</pre></div>
</div>
</div>
</div>
<p>For a real number, we can ask the hexadecimal representation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.414516219983697
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;-0x6.a1dbc287dd46p-4&#39;
</pre></div>
</div>
</div>
</div>
<p>Let us consider the strange case of <code class="docutils literal notranslate"><span class="pre">0.1</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbr</span> <span class="o">=</span> <span class="n">RR</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">nbr</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0x1.999999999999ap-4&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R100</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">nbr</span> <span class="o">=</span> <span class="n">R100</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">nbr</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;0x1.999999999999999999999999ap-4&#39;
</pre></div>
</div>
</div>
</div>
<p>When going from 53 bits to 100 bits of precision, we see that the hexadecimal expansion of <code class="docutils literal notranslate"><span class="pre">0.1</span></code> does not stop.  This implies that <code class="docutils literal notranslate"><span class="pre">0.1</span></code> has no exact <em>binary</em> representation, unlike in decimal notation, where the expansion <code class="docutils literal notranslate"><span class="pre">0.1</span></code> matches <span class="math notranslate nohighlight">\(1/10\)</span>.</p>
<p>For any real number, we can ask for its nearest rational number, with an upper bound on the size of the denominator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_denominator</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x =  -0.657062363581058
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-23/35
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_denominator</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2/3,
 -23/35,
 -228/347,
 -5131/7809,
 -5131/7809,
 -471117/717005,
 -1175227/1788608,
 -64166368/97656435,
 -255490245/388837132,
 -6515588861/9916241170]
</pre></div>
</div>
</div>
</div>
<p>This is the third type of rational approximations we encounter.  The previous two types were</p>
<ol class="arabic simple">
<li><p>Rational approximations with prescribed precision.</p></li>
<li><p>The convergents of the continued fraction representation of the number.</p></li>
</ol>
<p>In this third type we control the size of the rational number.</p>
<p><strong>2. Functions to Store Data</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The list is a composite data structure.  The assignment <code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">=</span> <span class="pre">[3,</span> <span class="pre">2,</span> <span class="pre">0]</span></code> makes not only the list <code class="docutils literal notranslate"><span class="pre">L</span></code> but also the names <code class="docutils literal notranslate"><span class="pre">L[0]</span></code>, <code class="docutils literal notranslate"><span class="pre">L[1]</span></code>, and <code class="docutils literal notranslate"><span class="pre">L[2]</span></code>.</p>
<p>We can use functions to store data as illustrated in the example below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fun</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Appends the item to data and prints data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">id</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>123135382038160
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3, 2]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>123135382038160
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3, 2, 0]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>123135382038160
</pre></div>
</div>
</div>
</div>
<p>We see that the value of <code class="docutils literal notranslate"><span class="pre">id(data)</span></code> remains the same.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idofdata</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3, 2, 0, 4]
</pre></div>
</div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">ctypes</span></code> we can retrieve the value of an object, given its address.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">ctypes</span>
<span class="n">dataList</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">idofdata</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">py_object</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataList</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3, 2, 0, 4]
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec8">
<h2>Lec8<a class="headerlink" href="#lec8" title="Link to this heading">#</a></h2>
<p>In lecture 8 of mcs 320, we consider evaluation and execution.</p>
<p><strong>1. Addition and Multiplication Tables</strong></p>
<p>For finite fields, we can tabulate the outcomes of the addition and multiplications of all elements in the field.  Let us make a field with four elements.  Because four is not a prime number, we cannot use the modulo four integers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z2</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Z2</span><span class="p">[]</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">factor</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 + x + 1
</pre></div>
</div>
</div>
</div>
<p>We have a polynomial <code class="docutils literal notranslate"><span class="pre">q</span></code> in <code class="docutils literal notranslate"><span class="pre">x</span></code> of degree 2 with modulo two coefficients which is irreducible.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Z2</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, a, a + 1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the addition table:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">([</span><span class="n">x</span><span class="o">+</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the addition table:
[0, 1, a, a + 1]
[1, 0, a + 1, a]
[a, a + 1, 0, 1]
[a + 1, a, 1, 0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the multiplication table:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the multiplication table:
[0, 0, 0, 0]
[0, 1, a, a + 1]
[0, a, a + 1, 1]
[0, a + 1, 1, a]
</pre></div>
</div>
</div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">Q</span></code> we have the following properties:</p>
<ol class="arabic simple">
<li><p>every number has an inverse with respect to the addition,</p></li>
<li><p>every nonzero number has a multiplicative inverse.</p></li>
</ol>
<p>These properties make that <code class="docutils literal notranslate"><span class="pre">Q</span></code> is a field.</p>
<p>Observe the addition and multiplication tables of the <code class="docutils literal notranslate"><span class="pre">GF(4)</span></code> the Galois field of size 4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GF</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">addition_table</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+  a b c d
 +--------
a| a b c d
b| b a d c
c| c d a b
d| d c b a
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GF</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">multiplication_table</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*  a b c d
 +--------
a| a a a a
b| a b c d
c| a c d b
d| a d b c
</pre></div>
</div>
</div>
</div>
<p><strong>2. Binary Expression Trees</strong></p>
<p>A binary expression tree is a binary tree with leaves and nodes:</p>
<ol class="arabic simple">
<li><p>The leaves are either constants or operands.</p></li>
<li><p>The notes are the arithmetical operations.</p></li>
</ol>
<p>Let us make an example: <span class="math notranslate nohighlight">\(x^3 + 4 x y^3\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sage.ext.fast_callable</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpressionTreeBuilder</span>
<span class="n">etb</span> <span class="o">=</span> <span class="n">ExpressionTreeBuilder</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">etb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">etb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>add(ipow(v_0, 3), mul(mul(4, v_0), ipow(v_1, 3)))
</pre></div>
</div>
</div>
</div>
<p>To draw the tree, we start with the six leaves.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L1</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v_0&#39;</span><span class="p">)</span>
<span class="n">L2</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="n">L3</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>
<span class="n">L4</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;v_1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Two of the leaves appear twice, we do not make duplicate leaves.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N12</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">N12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  _*_
 /   \
v_0   3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N31</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="n">L3</span><span class="p">,</span> <span class="n">L1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">N31</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  *
 / \
4   v_0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N42</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="n">L4</span><span class="p">,</span> <span class="n">L2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">N42</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  _^_
 /   \
v_1   3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N3142</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="n">N31</span><span class="p">,</span> <span class="n">N42</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">N3142</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ___*____
   /        \
  *         _^_
 / \       /   \
4   v_0   v_1   3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span><span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="n">N12</span><span class="p">,</span> <span class="n">N3142</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     _____+_____
    /           \
  _*_         ___*____
 /   \       /        \
v_0   3     *         _^_
           / \       /   \
          4   v_0   v_1   3
</pre></div>
</div>
</div>
</div>
<p>To see a representation of the program listing to evaluate <code class="docutils literal notranslate"><span class="pre">p</span></code>, we work as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">fast_callable</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">op_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 3),
 (&#39;load_const&#39;, 4),
 (&#39;load_arg&#39;, 0),
 &#39;mul&#39;,
 (&#39;load_arg&#39;, 1),
 (&#39;ipow&#39;, 3),
 &#39;mul&#39;,
 &#39;add&#39;,
 &#39;return&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec9">
<h2>Lec9<a class="headerlink" href="#lec9" title="Link to this heading">#</a></h2>
<p>In lecture 9 of mcs 320, we save data and load data from file.</p>
<p><strong>1. Saving Data as Plain Text</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1415926535897932385 has type &lt;class &#39;sage.rings.real_mpfr.RealNumber&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>We will write the string representation of x to file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sx</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">sx</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1415926535897932385 has type &lt;class &#39;str&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mydata.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sx</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can check what is in the listing of the current directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;.ipynb_checkpoints&#39;,
 &#39;.READ_ME.un~&#39;,
 &#39;mcs320lec09.ipynb&#39;,
 &#39;mcs320lec09s19.ipynb&#39;,
 &#39;mydata.txt&#39;,
 &#39;pickledresult.txt&#39;,
 &#39;READ_ME&#39;,
 &#39;READ_ME~&#39;,
 &#39;sageobject.sobj&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span> <span class="c1"># clear everything</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mydata.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1415926535897932385 has type &lt;class &#39;str&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Now that we have the string, we have to convert this back into a proper SageMath object.
Python question: what is the opposite of <code class="docutils literal notranslate"><span class="pre">str()</span></code>?</p>
<p>We could cast our number to a float.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RR</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.14159265358979
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793 has type &lt;class &#39;float&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>In SageMath, we have to call the preparser on the string, before evaluation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span> <span class="o">=</span> <span class="n">preparse</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">px</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RealNumber(&#39;3.1415926535897932385&#39;) has type &lt;class &#39;str&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">px</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793239 has type &lt;class &#39;sage.rings.real_mpfr.RealLiteral&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>2. Saving Objects with save() and Retrieving with load()</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793239 has type &lt;class &#39;sage.rings.real_mpfr.RealLiteral&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;sageobject&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;.ipynb_checkpoints&#39;,
 &#39;.READ_ME.un~&#39;,
 &#39;mcs320lec09.ipynb&#39;,
 &#39;mcs320lec09s19.ipynb&#39;,
 &#39;mydata.txt&#39;,
 &#39;pickledresult.txt&#39;,
 &#39;READ_ME&#39;,
 &#39;READ_ME~&#39;,
 &#39;sageobject.sobj&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reset(&#39;result&#39;)</span>
<span class="c1"># result</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>result
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;sageobject&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793239 has type &lt;class &#39;sage.rings.real_mpfr.RealNumber&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>3. Pickling Python Objects</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">pr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b&#39;\x80\x03csage.rings.real_mpfr\n__create__RealNumber_version0\nq\x00csage.rings.real_mpfr\n__create__RealField_version0\nq\x01KC\x89X\x04\x00\x00\x00RNDNq\x02\x87q\x03Rq\x04X\x12\x00\x00\x003.4gvml245kc4d80@0q\x05K \x87q\x06Rq\x07.&#39;
</pre></div>
</div>
</div>
</div>
<p>The pickled object contains the type information.
We can write this to a file, as a string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;pickledresult.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pr</span><span class="p">))</span>
<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;.ipynb_checkpoints&#39;,
 &#39;.READ_ME.un~&#39;,
 &#39;mcs320lec09.ipynb&#39;,
 &#39;mcs320lec09s19.ipynb&#39;,
 &#39;mydata.txt&#39;,
 &#39;pickledresult.txt&#39;,
 &#39;READ_ME&#39;,
 &#39;READ_ME~&#39;,
 &#39;sageobject.sobj&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>result
</pre></div>
</div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">del</span></code> (a pure Python command), we deleted the object result.
Unlike the <code class="docutils literal notranslate"><span class="pre">result</span> <span class="pre">=</span> <span class="pre">var('result')</span></code> the name result does not exist.
Now we will retrieve the pickled data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;pickledresult.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&quot;b&#39;\\x80\\x03csage.rings.real_mpfr\\n__create__RealNumber_version0\\nq\\x00csage.rings.real_mpfr\\n__create__RealField_version0\\nq\\x01KC\\x89X\\x04\\x00\\x00\\x00RNDNq\\x02\\x87q\\x03Rq\\x04X\\x12\\x00\\x00\\x003.4gvml245kc4d80@0q\\x05K \\x87q\\x06Rq\\x07.&#39;&quot;] has type &lt;class &#39;list&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Question: how do we turn a list of strings into one big string?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joinedpr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
<span class="n">joinedpr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;b&#39;\\x80\\x03csage.rings.real_mpfr\\n__create__RealNumber_version0\\nq\\x00csage.rings.real_mpfr\\n__create__RealField_version0\\nq\\x01KC\\x89X\\x04\\x00\\x00\\x00RNDNq\\x02\\x87q\\x03Rq\\x04X\\x12\\x00\\x00\\x003.4gvml245kc4d80@0q\\x05K \\x87q\\x06Rq\\x07.&#39;&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bytejoinedpr</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">joinedpr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bytejoinedpr</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">bytejoinedpr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b&#39;\x80\x03csage.rings.real_mpfr\n__create__RealNumber_version0\nq\x00csage.rings.real_mpfr\n__create__RealField_version0\nq\x01KC\x89X\x04\x00\x00\x00RNDNq\x02\x87q\x03Rq\x04X\x12\x00\x00\x003.4gvml245kc4d80@0q\x05K \x87q\x06Rq\x07.&#39; has type &lt;class &#39;bytes&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bytejoinedpr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793239 has type &lt;class &#39;sage.rings.real_mpfr.RealNumber&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec10">
<h2>Lec10<a class="headerlink" href="#lec10" title="Link to this heading">#</a></h2>
<p>In lecture 10 of mcs 320, we time Python functions and make them more efficient by vectorization and by Cython.</p>
<p><strong>1. Timing Python functions</strong></p>
<p>This lecture follows Chapter 3 of Sage for Power Users by William Stein.
We consider the computation of a floating-point approximation
of a sum of square roots.  Such sums occur in numerical integration.
One way to approximate <span class="math notranslate nohighlight">\(\pi/4\)</span> is as below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">python_sum_symbolic</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="mi">4</span><span class="o">*</span><span class="n">python_sum_symbolic</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1395554669110264
</pre></div>
</div>
</div>
</div>
<p>To benchmark the function, we can use timeit.
The command <code class="docutils literal notranslate"><span class="pre">timeit</span></code> in Python is good to measure
the execution time of small code snippets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;python_sum_symbolic(1000)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5 loops, best of 3: 58.8 ms per loop
</pre></div>
</div>
</div>
</div>
<p>For longer execution times, we better use <code class="docutils literal notranslate"><span class="pre">cputime()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span> <span class="c1"># cpu time since Sage started</span>
<span class="n">python_sum_symbolic</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ct1</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span> <span class="c1"># cpu time since t1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time for python_sum_symbolic :&#39;</span><span class="p">,</span> <span class="n">ct1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time for python_sum_symbolic : 1.859
</pre></div>
</div>
</div>
</div>
<p><strong>2. Use numerical functions</strong></p>
<p>The first reason that the function is so slow is because we use
the symbolic sqrt function.
We will use the sqrt function of the math module in Python.
The explicit conversion to float is no longer needed because
the this sqrt returns a floating-point number.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">python_sum</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="n">n</span>
<span class="mi">4</span><span class="o">*</span><span class="n">python_sum</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.139555466911023
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t2</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span>
<span class="n">python_sum</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ct2</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time for python_sum :&#39;</span><span class="p">,</span> <span class="n">ct2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time for python_sum : 0.016000000000000014
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;python_sum(10^4)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25 loops, best of 3: 21.3 ms per loop
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;speedup :&#39;</span><span class="p">,</span> <span class="n">ct1</span><span class="o">/</span><span class="n">ct2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>speedup : 116.1874999999999
</pre></div>
</div>
</div>
</div>
<p><strong>3. Vectorize</strong></p>
<p>Instead of the sum we could apply vectorization with numpy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">numpy_sum</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> 
    <span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="nb">sum</span><span class="p">,</span> <span class="n">arange</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">n</span>
<span class="mi">4</span><span class="o">*</span><span class="n">numpy_sum</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.1435554669110277
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;numpy_sum(10^4)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>625 loops, best of 3: 101 s per loop
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To compare against pure Python, we sum a million times.</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span>
<span class="n">python_sum</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ct3</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time for python_sum :&#39;</span><span class="p">,</span> <span class="n">ct3</span><span class="p">)</span>
<span class="n">t4</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span>
<span class="n">numpy_sum</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ct4</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">(</span><span class="n">t4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time for numpy_sum :&#39;</span><span class="p">,</span> <span class="n">ct4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time for python_sum : 2.1249999999999982
time for numpy_sum : 0.031000000000000583
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;speedup :&#39;</span><span class="p">,</span> <span class="n">ct3</span><span class="o">/</span><span class="n">ct4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>speedup : 68.54838709677284
</pre></div>
</div>
</div>
</div>
<p><strong>4. Cythonize</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">cython</span>
def cython_sum(n):
    from math import sqrt
    return sum( sqrt(1-(k/n)**2) for k in range(1, n+1) )/n
</pre></div>
</div>
</div>
</div>
<p>The advantage of Cython is that the code is almost identical to Python.
The two links returned when evaluating a cell with Cython code are the generated C code
and an html file with the annotated version of the Cython program.
In this particular example we had to replace the ^ of the python_sum with **.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">cython_sum</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.139555466911023
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;cython_sum(10^4)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5 loops, best of 3: 32.8 ms per loop
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t5</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span>
<span class="n">cython_sum</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ct5</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">(</span><span class="n">t5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time for the cython_sum :&#39;</span><span class="p">,</span> <span class="n">ct5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time for the cython_sum : 3.2029999999999976
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">cython</span>
cdef extern from &quot;math.h&quot;:
    double sqrt(double)

def cython_sum_typed(long n):
    cdef long k
    return sum( sqrt(1-(k/float(n))**2) for k in range(1, n+1) )/n
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">cython_sum_typed</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.139555466911023
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;cython_sum_typed(10^4)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>625 loops, best of 3: 1.11 ms per loop
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t6</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span>
<span class="n">cython_sum_typed</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ct6</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">(</span><span class="n">t6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time for cython_sum_typed :&#39;</span><span class="p">,</span> <span class="n">ct6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>time for cython_sum_typed : 0.10999999999999943
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;speedup :&#39;</span><span class="p">,</span> <span class="n">ct5</span><span class="o">/</span><span class="n">ct6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>speedup : 29.11818181818195
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec11">
<h2>Lec11<a class="headerlink" href="#lec11" title="Link to this heading">#</a></h2>
<p>In lecture 11 of mcs 320, we consider univariate and multivariate polynomials.</p>
<p><strong>1. Polynomials and Expressions</strong></p>
<p>Consider <span class="math notranslate nohighlight">\(p = x^3 - x^2 + 2 x - 2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^3 - x^2 + 2*x - 2 has type &lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>We see that <code class="docutils literal notranslate"><span class="pre">p</span></code> is a symbolic expression.  If we want to define <span class="math notranslate nohighlight">\(x^3 - x^2 + 2 x - 2\)</span> as a polynomial with rational coefficients, then we can cast <code class="docutils literal notranslate"><span class="pre">p</span></code> as a polynomial in <code class="docutils literal notranslate"><span class="pre">QQ[x]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="n">x</span><span class="p">](</span><span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^3 - x^2 + 2*x - 2 has type &lt;class &#39;sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">QQ[x](p)</span></code> is a <em>type cast</em>, it returns <code class="docutils literal notranslate"><span class="pre">p</span></code> as a polynomial in <code class="docutils literal notranslate"><span class="pre">QQ[x]</span></code>, as a polynomial in <code class="docutils literal notranslate"><span class="pre">x</span></code> with rational coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2, 2, -1, 1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">coefficients</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2, 2, -1, 1]
</pre></div>
</div>
</div>
</div>
<p>Observe that the coefficients are starting with the constant, not the coefficient of the highest degree term.</p>
<p><strong>2. Numeric, Exact, and Symbolic Factorizations</strong></p>
<p>The numeric factorization of a polynomial corresponds to computing the complex roots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(1.00000000000000, 1), (-1.41421356237310*I, 1), (1.41421356237310*I, 1)]
</pre></div>
</div>
</div>
</div>
<p>To see the numeric factorization, we must cast <code class="docutils literal notranslate"><span class="pre">q</span></code> into <code class="docutils literal notranslate"><span class="pre">CC[x]</span></code>, the ring of polynomials in <code class="docutils literal notranslate"><span class="pre">x</span></code> with coefficients in <code class="docutils literal notranslate"><span class="pre">CC</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factor</span><span class="p">(</span><span class="n">CC</span><span class="p">[</span><span class="n">x</span><span class="p">](</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x - 1.00000000000000) * (x - 1.41421356237310*I) * (x + 1.41421356237310*I)
</pre></div>
</div>
</div>
</div>
<p>For the exact factorization, we started with a polynomial with rational coefficients, so we just do <code class="docutils literal notranslate"><span class="pre">factor</span></code> on <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factor</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x - 1) * (x^2 + 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Let us make field extensions so the polynomial factors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Lfq</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
<span class="n">Lfq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(x - 1, 1), (x^2 + 2, 1)]
</pre></div>
</div>
</div>
</div>
<p>We see that the second factor is a quadratic polynomial, with multiplicity one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qf2</span> <span class="o">=</span> <span class="n">Lfq</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">qf2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 + 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q1</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">qf2</span><span class="p">)</span>
<span class="n">P1</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Q1</span><span class="p">[]</span>
<span class="n">q1</span> <span class="o">=</span> <span class="n">P1</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">q1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y^3 - y^2 + 2*y - 2 has type &lt;class &#39;sage.rings.polynomial.polynomial_ring.PolynomialRing_field_with_category.element_class&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factor</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(y - 1) * (y - b) * (y + b)
</pre></div>
</div>
</div>
</div>
<p>We see the symbolic factorization of the polynomial <code class="docutils literal notranslate"><span class="pre">q</span></code>, with roots <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">b</span></code>.</p>
<p><strong>3. Polynomials in Several Variables</strong></p>
<p>Let us look at polynomials in <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, and <code class="docutils literal notranslate"><span class="pre">z</span></code> with integer coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multivariate Polynomial Ring in x, y, z over Integer Ring
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-x^3*y - 29*x^2*y^2 - 2*x^3*z + 5*x*y^2*z + x*y*z^2 - 4*y*z^3 - z^4 - x^3 - y^2*z - x*z^2 + z^3 + 2*x^2 + 5*z has type &lt;class &#39;sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>We can view <code class="docutils literal notranslate"><span class="pre">p</span></code> as a polynomial in <code class="docutils literal notranslate"><span class="pre">x</span></code> with coefficients as polynomials in <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ZZ</span><span class="p">[</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">][</span><span class="n">x</span><span class="p">](</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-y - 2*z - 1)*x^3 + (-29*y^2 + 2)*x^2 + (5*y^2*z + y*z^2 - z^2)*x - 4*y*z^3 - z^4 - y^2*z + z^3 + 5*z
</pre></div>
</div>
</div>
</div>
<p>We could take the recursion farther.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ZZ</span><span class="p">[</span><span class="n">z</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">](</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-y - 2*z - 1)*x^3 + (-29*y^2 + 2)*x^2 + (5*z*y^2 + z^2*y - z^2)*x - z*y^2 - 4*z^3*y - z^4 + z^3 + 5*z
</pre></div>
</div>
</div>
</div>
<p>To order the terms in the polynomial in pure lexicographical order, we define another ring <code class="docutils literal notranslate"><span class="pre">Plex</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Plex</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="n">Plex</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-x^3*y - 2*x^3*z - x^3 - 29*x^2*y^2 + 2*x^2 + 5*x*y^2*z + x*y*z^2 - x*z^2 - y^2*z - 4*y*z^3 - z^4 + z^3 + 5*z
</pre></div>
</div>
</div>
</div>
<p>The default order is degree lexicographic, which is defined explicitly below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Pdeglex</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;deglex&#39;</span><span class="p">)</span>
<span class="n">Pdeglex</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-x^3*y - 2*x^3*z - 29*x^2*y^2 + 5*x*y^2*z + x*y*z^2 - 4*y*z^3 - z^4 - x^3 - x*z^2 - y^2*z + z^3 + 2*x^2 + 5*z
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec12">
<h2>Lec12<a class="headerlink" href="#lec12" title="Link to this heading">#</a></h2>
<p>In lecture 12 of mcs 320 we look at rational expressions and expression swell.</p>
<p><strong>1. Rational Expressions and Rational Polynomials</strong></p>
<p>We start by explaining the difference between arithmetical expressions and rational polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x^3 - 1)/(x - 1) has type &lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 + x + 1 has type &lt;class &#39;sage.rings.fraction_field_element.FractionFieldElement_1poly_field&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Observe first the difference between the types of <code class="docutils literal notranslate"><span class="pre">e</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code>, caused by the type declarations of <code class="docutils literal notranslate"><span class="pre">x</span></code>.  When we declare <code class="docutils literal notranslate"><span class="pre">x</span></code> a variable, then we obtain an expression.  The statement <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">polygen(QQ)</span></code> has the same effect as <code class="docutils literal notranslate"><span class="pre">P.&lt;x&gt;</span> <span class="pre">=</span> <span class="pre">QQ[]</span></code> in that every polynomial in <code class="docutils literal notranslate"><span class="pre">x</span></code> will be viewed as a polynomial in <code class="docutils literal notranslate"><span class="pre">x</span></code> with rational coefficients.</p>
<p>Observe next the consequences of the declarations.  The symbolic expression remains as we typed it in.  With the polynomials, the common factor <code class="docutils literal notranslate"><span class="pre">x-1</span></code> is removed from numerator and denominator.</p>
<p>Such simplification is not always desirable as it leads to expression swell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">1000</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^999 + x^998 + x^997 + x^996 + x^995 + x^994 + x^993 + x^992 + x^991 + x^990 + x^989 + x^988 + x^987 + x^986 + x^985 + x^984 + x^983 + x^982 + x^981 + x^980 + x^979 + x^978 + x^977 + x^976 + x^975 + x^974 + x^973 + x^972 + x^971 + x^970 + x^969 + x^968 + x^967 + x^966 + x^965 + x^964 + x^963 + x^962 + x^961 + x^960 + x^959 + x^958 + x^957 + x^956 + x^955 + x^954 + x^953 + x^952 + x^951 + x^950 + x^949 + x^948 + x^947 + x^946 + x^945 + x^944 + x^943 + x^942 + x^941 + x^940 + x^939 + x^938 + x^937 + x^936 + x^935 + x^934 + x^933 + x^932 + x^931 + x^930 + x^929 + x^928 + x^927 + x^926 + x^925 + x^924 + x^923 + x^922 + x^921 + x^920 + x^919 + x^918 + x^917 + x^916 + x^915 + x^914 + x^913 + x^912 + x^911 + x^910 + x^909 + x^908 + x^907 + x^906 + x^905 + x^904 + x^903 + x^902 + x^901 + x^900 + x^899 + x^898 + x^897 + x^896 + x^895 + x^894 + x^893 + x^892 + x^891 + x^890 + x^889 + x^888 + x^887 + x^886 + x^885 + x^884 + x^883 + x^882 + x^881 + x^880 + x^879 + x^878 + x^877 + x^876 + x^875 + x^874 + x^873 + x^872 + x^871 + x^870 + x^869 + x^868 + x^867 + x^866 + x^865 + x^864 + x^863 + x^862 + x^861 + x^860 + x^859 + x^858 + x^857 + x^856 + x^855 + x^854 + x^853 + x^852 + x^851 + x^850 + x^849 + x^848 + x^847 + x^846 + x^845 + x^844 + x^843 + x^842 + x^841 + x^840 + x^839 + x^838 + x^837 + x^836 + x^835 + x^834 + x^833 + x^832 + x^831 + x^830 + x^829 + x^828 + x^827 + x^826 + x^825 + x^824 + x^823 + x^822 + x^821 + x^820 + x^819 + x^818 + x^817 + x^816 + x^815 + x^814 + x^813 + x^812 + x^811 + x^810 + x^809 + x^808 + x^807 + x^806 + x^805 + x^804 + x^803 + x^802 + x^801 + x^800 + x^799 + x^798 + x^797 + x^796 + x^795 + x^794 + x^793 + x^792 + x^791 + x^790 + x^789 + x^788 + x^787 + x^786 + x^785 + x^784 + x^783 + x^782 + x^781 + x^780 + x^779 + x^778 + x^777 + x^776 + x^775 + x^774 + x^773 + x^772 + x^771 + x^770 + x^769 + x^768 + x^767 + x^766 + x^765 + x^764 + x^763 + x^762 + x^761 + x^760 + x^759 + x^758 + x^757 + x^756 + x^755 + x^754 + x^753 + x^752 + x^751 + x^750 + x^749 + x^748 + x^747 + x^746 + x^745 + x^744 + x^743 + x^742 + x^741 + x^740 + x^739 + x^738 + x^737 + x^736 + x^735 + x^734 + x^733 + x^732 + x^731 + x^730 + x^729 + x^728 + x^727 + x^726 + x^725 + x^724 + x^723 + x^722 + x^721 + x^720 + x^719 + x^718 + x^717 + x^716 + x^715 + x^714 + x^713 + x^712 + x^711 + x^710 + x^709 + x^708 + x^707 + x^706 + x^705 + x^704 + x^703 + x^702 + x^701 + x^700 + x^699 + x^698 + x^697 + x^696 + x^695 + x^694 + x^693 + x^692 + x^691 + x^690 + x^689 + x^688 + x^687 + x^686 + x^685 + x^684 + x^683 + x^682 + x^681 + x^680 + x^679 + x^678 + x^677 + x^676 + x^675 + x^674 + x^673 + x^672 + x^671 + x^670 + x^669 + x^668 + x^667 + x^666 + x^665 + x^664 + x^663 + x^662 + x^661 + x^660 + x^659 + x^658 + x^657 + x^656 + x^655 + x^654 + x^653 + x^652 + x^651 + x^650 + x^649 + x^648 + x^647 + x^646 + x^645 + x^644 + x^643 + x^642 + x^641 + x^640 + x^639 + x^638 + x^637 + x^636 + x^635 + x^634 + x^633 + x^632 + x^631 + x^630 + x^629 + x^628 + x^627 + x^626 + x^625 + x^624 + x^623 + x^622 + x^621 + x^620 + x^619 + x^618 + x^617 + x^616 + x^615 + x^614 + x^613 + x^612 + x^611 + x^610 + x^609 + x^608 + x^607 + x^606 + x^605 + x^604 + x^603 + x^602 + x^601 + x^600 + x^599 + x^598 + x^597 + x^596 + x^595 + x^594 + x^593 + x^592 + x^591 + x^590 + x^589 + x^588 + x^587 + x^586 + x^585 + x^584 + x^583 + x^582 + x^581 + x^580 + x^579 + x^578 + x^577 + x^576 + x^575 + x^574 + x^573 + x^572 + x^571 + x^570 + x^569 + x^568 + x^567 + x^566 + x^565 + x^564 + x^563 + x^562 + x^561 + x^560 + x^559 + x^558 + x^557 + x^556 + x^555 + x^554 + x^553 + x^552 + x^551 + x^550 + x^549 + x^548 + x^547 + x^546 + x^545 + x^544 + x^543 + x^542 + x^541 + x^540 + x^539 + x^538 + x^537 + x^536 + x^535 + x^534 + x^533 + x^532 + x^531 + x^530 + x^529 + x^528 + x^527 + x^526 + x^525 + x^524 + x^523 + x^522 + x^521 + x^520 + x^519 + x^518 + x^517 + x^516 + x^515 + x^514 + x^513 + x^512 + x^511 + x^510 + x^509 + x^508 + x^507 + x^506 + x^505 + x^504 + x^503 + x^502 + x^501 + x^500 + x^499 + x^498 + x^497 + x^496 + x^495 + x^494 + x^493 + x^492 + x^491 + x^490 + x^489 + x^488 + x^487 + x^486 + x^485 + x^484 + x^483 + x^482 + x^481 + x^480 + x^479 + x^478 + x^477 + x^476 + x^475 + x^474 + x^473 + x^472 + x^471 + x^470 + x^469 + x^468 + x^467 + x^466 + x^465 + x^464 + x^463 + x^462 + x^461 + x^460 + x^459 + x^458 + x^457 + x^456 + x^455 + x^454 + x^453 + x^452 + x^451 + x^450 + x^449 + x^448 + x^447 + x^446 + x^445 + x^444 + x^443 + x^442 + x^441 + x^440 + x^439 + x^438 + x^437 + x^436 + x^435 + x^434 + x^433 + x^432 + x^431 + x^430 + x^429 + x^428 + x^427 + x^426 + x^425 + x^424 + x^423 + x^422 + x^421 + x^420 + x^419 + x^418 + x^417 + x^416 + x^415 + x^414 + x^413 + x^412 + x^411 + x^410 + x^409 + x^408 + x^407 + x^406 + x^405 + x^404 + x^403 + x^402 + x^401 + x^400 + x^399 + x^398 + x^397 + x^396 + x^395 + x^394 + x^393 + x^392 + x^391 + x^390 + x^389 + x^388 + x^387 + x^386 + x^385 + x^384 + x^383 + x^382 + x^381 + x^380 + x^379 + x^378 + x^377 + x^376 + x^375 + x^374 + x^373 + x^372 + x^371 + x^370 + x^369 + x^368 + x^367 + x^366 + x^365 + x^364 + x^363 + x^362 + x^361 + x^360 + x^359 + x^358 + x^357 + x^356 + x^355 + x^354 + x^353 + x^352 + x^351 + x^350 + x^349 + x^348 + x^347 + x^346 + x^345 + x^344 + x^343 + x^342 + x^341 + x^340 + x^339 + x^338 + x^337 + x^336 + x^335 + x^334 + x^333 + x^332 + x^331 + x^330 + x^329 + x^328 + x^327 + x^326 + x^325 + x^324 + x^323 + x^322 + x^321 + x^320 + x^319 + x^318 + x^317 + x^316 + x^315 + x^314 + x^313 + x^312 + x^311 + x^310 + x^309 + x^308 + x^307 + x^306 + x^305 + x^304 + x^303 + x^302 + x^301 + x^300 + x^299 + x^298 + x^297 + x^296 + x^295 + x^294 + x^293 + x^292 + x^291 + x^290 + x^289 + x^288 + x^287 + x^286 + x^285 + x^284 + x^283 + x^282 + x^281 + x^280 + x^279 + x^278 + x^277 + x^276 + x^275 + x^274 + x^273 + x^272 + x^271 + x^270 + x^269 + x^268 + x^267 + x^266 + x^265 + x^264 + x^263 + x^262 + x^261 + x^260 + x^259 + x^258 + x^257 + x^256 + x^255 + x^254 + x^253 + x^252 + x^251 + x^250 + x^249 + x^248 + x^247 + x^246 + x^245 + x^244 + x^243 + x^242 + x^241 + x^240 + x^239 + x^238 + x^237 + x^236 + x^235 + x^234 + x^233 + x^232 + x^231 + x^230 + x^229 + x^228 + x^227 + x^226 + x^225 + x^224 + x^223 + x^222 + x^221 + x^220 + x^219 + x^218 + x^217 + x^216 + x^215 + x^214 + x^213 + x^212 + x^211 + x^210 + x^209 + x^208 + x^207 + x^206 + x^205 + x^204 + x^203 + x^202 + x^201 + x^200 + x^199 + x^198 + x^197 + x^196 + x^195 + x^194 + x^193 + x^192 + x^191 + x^190 + x^189 + x^188 + x^187 + x^186 + x^185 + x^184 + x^183 + x^182 + x^181 + x^180 + x^179 + x^178 + x^177 + x^176 + x^175 + x^174 + x^173 + x^172 + x^171 + x^170 + x^169 + x^168 + x^167 + x^166 + x^165 + x^164 + x^163 + x^162 + x^161 + x^160 + x^159 + x^158 + x^157 + x^156 + x^155 + x^154 + x^153 + x^152 + x^151 + x^150 + x^149 + x^148 + x^147 + x^146 + x^145 + x^144 + x^143 + x^142 + x^141 + x^140 + x^139 + x^138 + x^137 + x^136 + x^135 + x^134 + x^133 + x^132 + x^131 + x^130 + x^129 + x^128 + x^127 + x^126 + x^125 + x^124 + x^123 + x^122 + x^121 + x^120 + x^119 + x^118 + x^117 + x^116 + x^115 + x^114 + x^113 + x^112 + x^111 + x^110 + x^109 + x^108 + x^107 + x^106 + x^105 + x^104 + x^103 + x^102 + x^101 + x^100 + x^99 + x^98 + x^97 + x^96 + x^95 + x^94 + x^93 + x^92 + x^91 + x^90 + x^89 + x^88 + x^87 + x^86 + x^85 + x^84 + x^83 + x^82 + x^81 + x^80 + x^79 + x^78 + x^77 + x^76 + x^75 + x^74 + x^73 + x^72 + x^71 + x^70 + x^69 + x^68 + x^67 + x^66 + x^65 + x^64 + x^63 + x^62 + x^61 + x^60 + x^59 + x^58 + x^57 + x^56 + x^55 + x^54 + x^53 + x^52 + x^51 + x^50 + x^49 + x^48 + x^47 + x^46 + x^45 + x^44 + x^43 + x^42 + x^41 + x^40 + x^39 + x^38 + x^37 + x^36 + x^35 + x^34 + x^33 + x^32 + x^31 + x^30 + x^29 + x^28 + x^27 + x^26 + x^25 + x^24 + x^23 + x^22 + x^21 + x^20 + x^19 + x^18 + x^17 + x^16 + x^15 + x^14 + x^13 + x^12 + x^11 + x^10 + x^9 + x^8 + x^7 + x^6 + x^5 + x^4 + x^3 + x^2 + x + 1
</pre></div>
</div>
</div>
</div>
<p>The original expression was much simpler to write.  In order to count the number of coefficients.  We must convert the type of <code class="docutils literal notranslate"><span class="pre">p</span></code> into a polynomial, so we can ask for its coefficient list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.rings.fraction_field_element.FractionFieldElement_1poly_field&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="n">x</span><span class="p">](</span><span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.rings.polynomial.polynomial_rational_flint.Polynomial_rational_flint&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">coefficients</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000
</pre></div>
</div>
</div>
</div>
<p><strong>2. Normal Forms of Rational Polynomials</strong></p>
<p>For a quotient of two polynomials in one variable, we have four normal forms:</p>
<ol class="arabic simple">
<li><p>Both numerator and denominator are expanded.</p></li>
<li><p>Numerator is factored, denominator is expanded.</p></li>
<li><p>Numerator is expanded, denominator is factored.</p></li>
<li><p>Both numerator and denominator are factored.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x^2 - 1)/((x + 2)*(x + 1))
</pre></div>
</div>
</div>
</div>
<p>Let us examine the four different normalizations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">numerator</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x^2 - 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">numerator</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">denominator</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x + 2)*(x + 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">denominator</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x + 2
</pre></div>
</div>
</div>
</div>
<p><strong>3. Horner Form and Partial Fraction Decomposition</strong></p>
<p>The Horner form for a polynomial in one variable provides an algorithm to evaluate the polynomial efficiently.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^8 - 6*x^7 - 2/3*x^6 - x^5 + 4*x^4 - 1/4*x^3 - 3/2*x^2 - 11/2*x + 2
</pre></div>
</div>
</div>
</div>
<p>To compute the Horner form of a polynomial, we must convert to the Symbolic Ring <code class="docutils literal notranslate"><span class="pre">SR</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SR</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">horner</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/12*(((4*(((3*(x - 6)*x - 2)*x - 3)*x + 12)*x - 3)*x - 18)*x - 66)*x + 2
</pre></div>
</div>
</div>
</div>
<p>The partial fraction decomposition is defined for rational polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerator</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">denominator</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">numerator</span><span class="o">/</span><span class="n">denominator</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/14*(7*x^4 - 4*x^3 - 7*x - 14)/(x^4 - 5*x^2 + 4)
</pre></div>
</div>
</div>
</div>
<p>If we use the <code class="docutils literal notranslate"><span class="pre">partial_fraction()</span></code> method, then we must also convert to the Symbolic Ring <code class="docutils literal notranslate"><span class="pre">SR</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rpd</span> <span class="o">=</span> <span class="n">SR</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">partial_fraction</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">rpd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-\frac{6}{7 \, {\left(x + 2\right)}} + \frac{1}{21 \, {\left(x + 1\right)}} + \frac{3}{14 \, {\left(x - 1\right)}} + \frac{13}{42 \, {\left(x - 2\right)}} + \frac{1}{2}</script></html></div></div>
</div>
<p>A random denominator will most likely not factor over the rational numbers,
let us compute the numerical partial fraction decomposition, that is: over the complex numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cr</span> <span class="o">=</span> <span class="n">CC</span><span class="p">[</span><span class="n">x</span><span class="p">](</span><span class="n">r</span><span class="o">.</span><span class="n">numerator</span><span class="p">())</span><span class="o">/</span><span class="p">(</span><span class="n">CC</span><span class="p">[</span><span class="n">x</span><span class="p">](</span><span class="n">r</span><span class="o">.</span><span class="n">denominator</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cr</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">cr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7.00000000000000*x^4 - 4.00000000000000*x^3 - 7.00000000000000*x - 14.0000000000000)/(14.0000000000000*x^4 - 70.0000000000000*x^2 + 56.0000000000000) has type &lt;class &#39;sage.rings.fraction_field_element.FractionFieldElement_1poly_field&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crd</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">partial_fraction_decomposition</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">crd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(0.500000000000000, \left[\frac{0.309523809523810}{x - 2.00000000000000}, \frac{0.214285714285714}{x - 1.00000000000000}, \frac{0.0476190476190476}{x + 1.00000000000000}, \frac{-0.857142857142857}{x + 2.00000000000000}\right]\right)</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">crd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.285714285714286*x^3 + 2.50000000000000*x^2 - 0.500000000000000*x - 3.00000000000000)/(x^4 - 5.00000000000000*x^2 + 4.00000000000000)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reconstructed</span> <span class="o">=</span> <span class="n">crd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">reconstructed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{-0.142857142857143 x^{3} + 1.25000000000000 x^{2} - 0.250000000000000 x - 1.50000000000000}{x^{4} + 0.000000000000000 x^{3} - 5.00000000000000 x^{2} + 0.000000000000000 x + 4.00000000000000}</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">cr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{7.00000000000000 x^{4} - 4.00000000000000 x^{3} + 0.000000000000000 x^{2} - 7.00000000000000 x - 14.0000000000000}{14.0000000000000 x^{4} + 0.000000000000000 x^{3} - 70.0000000000000 x^{2} + 0.000000000000000 x + 56.0000000000000}</script></html></div></div>
</div>
<p>We see that both <code class="docutils literal notranslate"><span class="pre">reconstructed</span></code> and <code class="docutils literal notranslate"><span class="pre">cr</span></code> are the same mathematically.</p>
</section>
<section id="lec13">
<h2>Lec13<a class="headerlink" href="#lec13" title="Link to this heading">#</a></h2>
<p>In lecture 13 of MCS 320, we look at expression trees, symbolic and numeric evaluation.</p>
<p><strong>1. Expression Trees</strong></p>
<p>We will make a random polynomial with 3 terms, of degree 13, with rational coefficients, in the variables x, y, and z.  To see always the same polynomial, we fix the seed of the random number generator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="n">set_random_seed</span><span class="p">(</span><span class="mi">2022</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">terms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{2}{9} x^{5} y^{6} z^{2} - \frac{1}{2} x^{3} y^{6} z - \frac{35}{2} x^{5} z^{4}</script></html></div></div>
</div>
<p>To get the operator/operands view to work on <code class="docutils literal notranslate"><span class="pre">p</span></code>, we must convert to a symbolic expression.  While the shortest way is to cast <code class="docutils literal notranslate"><span class="pre">p</span></code> into the Symbolic Ring <code class="docutils literal notranslate"><span class="pre">SR</span></code>, the alternative is to apply <em>symbolic evaluation</em>.  We redeclare x, y, and z as variables and evaluate <code class="docutils literal notranslate"><span class="pre">p</span></code> symbolically in those new variables to obtain the expression <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y, z&#39;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/9*x^5*y^6*z^2 - 1/2*x^3*y^6*z - 35/2*x^5*z^4 has type &lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>In the symbolic evaluation <code class="docutils literal notranslate"><span class="pre">p(x=x,</span> <span class="pre">y=y,</span> <span class="pre">z=z)</span></code> at the left of each <code class="docutils literal notranslate"><span class="pre">=</span></code> are the symbols used to define <code class="docutils literal notranslate"><span class="pre">p</span></code>.  At the right of each <code class="docutils literal notranslate"><span class="pre">=</span></code> are the newly declared symbols.  Observe that <code class="docutils literal notranslate"><span class="pre">q</span></code> is now a symbolic expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">operator</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function add_vararg at 0x7fdf6f6c6170&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">operands</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2/9*x^5*y^6*z^2, -1/2*x^3*y^6*z, -35/2*x^5*z^4]
</pre></div>
</div>
</div>
</div>
<p>The operator of <code class="docutils literal notranslate"><span class="pre">q</span></code> is an addition which takes as operands a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q0</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">operands</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">q0</span><span class="o">.</span><span class="n">operator</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function mul_vararg at 0x7fdf6f6c6200&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q0</span><span class="o">.</span><span class="n">operands</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x^5, y^6, z^2, 2/9]
</pre></div>
</div>
</div>
</div>
<p>The first term of <code class="docutils literal notranslate"><span class="pre">q</span></code> has the multiplication operator with a list of four operands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q00</span> <span class="o">=</span> <span class="n">q0</span><span class="o">.</span><span class="n">operands</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">q00</span><span class="o">.</span><span class="n">operator</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;built-in function pow&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q00</span><span class="o">.</span><span class="n">operands</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x, 5]
</pre></div>
</div>
</div>
</div>
<p>The power of the first operand in the the first term of <code class="docutils literal notranslate"><span class="pre">q</span></code> is a binary operator, with two operands.</p>
<p>To draw the expression tree, we use a <code class="docutils literal notranslate"><span class="pre">LabelledOrderedTree</span></code>.  The labels for the children are the operands in the expression.</p>
<p>On the WSL (Window Subsystem for Linux) running Ubuntu 22.04.2 LTS, the following statement is needed for the <code class="docutils literal notranslate"><span class="pre">ascii_art</span></code> to display properly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="o">.</span><span class="n">typeset</span><span class="o">.</span><span class="n">ascii_art</span><span class="o">.</span><span class="n">AsciiArt</span><span class="o">.</span><span class="n">_terminal_width</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">80</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oplabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">operands</span><span class="p">()]</span>
<span class="n">operands</span> <span class="o">=</span> <span class="p">[</span><span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">oplabels</span><span class="p">]</span>
<span class="n">exptree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">(</span><span class="n">operands</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">exptree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ______________+________________
 /               /              /            
2/9*x^5*y^6*z^2 -1/2*x^3*y^6*z -35/2*x^5*z^4
</pre></div>
</div>
</div>
</div>
<p>We now do the same to the leaves.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oplabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="n">operands</span><span class="p">()</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">q</span><span class="o">.</span><span class="n">operands</span><span class="p">()]</span>
<span class="n">oplabels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[x^5, y^6, z^2, 2/9], [x^3, y^6, z, -1/2], [x^5, z^4, -35/2]]
</pre></div>
</div>
</div>
</div>
<p>in the definition of <code class="docutils literal notranslate"><span class="pre">oplabels</span></code> we applied the <code class="docutils literal notranslate"><span class="pre">operands()</span></code> to every operand of <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">term0leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">oplabels</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">term0tree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">(</span><span class="n">term0leaves</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">term0tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  _____*______
 /   /   /   /  
x^5 y^6 z^2 2/9
</pre></div>
</div>
</div>
</div>
<p>We do the same operation for the other two terms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">term1leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">oplabels</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">term1tree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">(</span><span class="n">term1leaves</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">term1tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ____*_____
 /   /   / /   
x^3 y^6 z -1/2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">term2leaves</span> <span class="o">=</span> <span class="p">[</span><span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">oplabels</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">term2tree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">(</span><span class="n">term2leaves</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">term2tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ___*____
 /   /   /    
x^5 z^4 -35/2
</pre></div>
</div>
</div>
</div>
<p>We still have to replace the powers of the variables by trees.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leafx</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">leaf5</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;5&#39;</span><span class="p">)</span>
<span class="n">nodex5</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">leafx</span><span class="p">,</span> <span class="n">leaf5</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">nodex5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ^_
 / /
x 5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leafz</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">leaf4</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>
<span class="n">nodez4</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">leafz</span><span class="p">,</span> <span class="n">leaf4</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">nodez4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ^_
 / /
z 4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newterm2tree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">nodex5</span><span class="p">,</span> <span class="n">nodez4</span><span class="p">,</span> <span class="n">term2leaves</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">newterm2tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ___*____
   /    /  /    
  ^_   ^_ -35/2
 / /  / /
x 5  z 4 
</pre></div>
</div>
</div>
</div>
<p>We can defined the other powers similarly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leafy</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">leaf2</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
<span class="n">leaf3</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="n">leaf4</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>
<span class="n">leaf6</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;6&#39;</span><span class="p">)</span>
<span class="n">nodex3</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">leafx</span><span class="p">,</span> <span class="n">leaf3</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">nodex3</span><span class="p">)</span>
<span class="n">nodey6</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">leafy</span><span class="p">,</span> <span class="n">leaf6</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">nodey6</span><span class="p">)</span>
<span class="n">nodez2</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">leafz</span><span class="p">,</span> <span class="n">leaf2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">nodez2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ^_
 / /
z 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ascii_art</span><span class="p">(</span><span class="n">term0tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  _____*______
 /   /   /   /  
x^5 y^6 z^2 2/9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newterm0tree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">nodex5</span><span class="p">,</span> <span class="n">nodey6</span><span class="p">,</span> <span class="n">nodez2</span><span class="p">,</span> <span class="n">term0leaves</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">newterm0tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    _____*_______
   /    /    /  /  
  ^_   ^_   ^_ 2/9
 / /  / /  / /
x 5  y 6  z 2 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ascii_art</span><span class="p">(</span><span class="n">term1tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ____*_____
 /   /   / /   
x^3 y^6 z -1/2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newterm1tree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">nodex3</span><span class="p">,</span> <span class="n">nodey6</span><span class="p">,</span> <span class="n">leafz</span><span class="p">,</span> <span class="n">term1leaves</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">newterm1tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ____*_____
   /    /  / /   
  ^_   ^_ z -1/2
 / /  / /  
x 3  y 6   
</pre></div>
</div>
</div>
</div>
<p>Now we can assemble the entire tree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">newterm0tree</span><span class="p">,</span> <span class="n">newterm1tree</span><span class="p">,</span> <span class="n">newterm2tree</span><span class="p">]</span>
<span class="n">exptree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">exptree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           _________________+__________________
          /                  /                /        
    _____*_______       ____*_____        ___*____
   /    /    /  /      /    /  / /       /    /  /    
  ^_   ^_   ^_ 2/9    ^_   ^_ z -1/2    ^_   ^_ -35/2
 / /  / /  / /       / /  / /          / /  / /
x 5  y 6  z 2       x 3  y 6          x 5  z 4 
</pre></div>
</div>
</div>
</div>
<p><strong>2. Fast Callable Objects</strong></p>
<p>We encountered fast callable objects before, with the binary expression trees.  In this section we demonstrate why they are <em>fast</em> compared to general expressions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2/9*x^5*y^6*z^2 - 1/2*x^3*y^6*z - 35/2*x^5*z^4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1385.50000000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">fast_callable</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1385.50000000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;q(x=1.0, y=2.0, z=3.0)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>625 loops, best of 3: 48.7 s per loop
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;f(1.0, 2.0, 3.0)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>625 loops, best of 3: 5.86 s per loop
</pre></div>
</div>
</div>
</div>
<p>Compare the difference in times.  Even for such a small expression as <code class="docutils literal notranslate"><span class="pre">q</span></code>, the fast callable is much faster.  Observe however, that fast callables are defined for numerical, not for symbolic evaluation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">op_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 5),
 (&#39;load_arg&#39;, 1),
 (&#39;ipow&#39;, 6),
 &#39;mul&#39;,
 (&#39;load_arg&#39;, 2),
 (&#39;ipow&#39;, 2),
 &#39;mul&#39;,
 (&#39;load_const&#39;, 2/9),
 &#39;mul&#39;,
 (&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 3),
 (&#39;load_arg&#39;, 1),
 (&#39;ipow&#39;, 6),
 &#39;mul&#39;,
 (&#39;load_arg&#39;, 2),
 &#39;mul&#39;,
 (&#39;load_const&#39;, -1/2),
 &#39;mul&#39;,
 &#39;add&#39;,
 (&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 5),
 (&#39;load_arg&#39;, 2),
 (&#39;ipow&#39;, 4),
 &#39;mul&#39;,
 (&#39;load_const&#39;, -35/2),
 &#39;mul&#39;,
 &#39;add&#39;,
 &#39;return&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sage.ext.fast_callable</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpressionTreeBuilder</span>
<span class="n">etb</span> <span class="o">=</span> <span class="n">ExpressionTreeBuilder</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">etb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">etb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">etb</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>add(add(add(0, mul(2/9, mul(mul(ipow(v_0, 5), ipow(v_1, 6)), ipow(v_2, 2)))), mul(-1/2, mul(mul(ipow(v_0, 3), ipow(v_1, 6)), ipow(v_2, 1)))), mul(-35/2, mul(ipow(v_0, 5), ipow(v_2, 4))))
</pre></div>
</div>
</div>
</div>
<p>Observe the binary structure.</p>
</section>
<section id="lec14">
<h2>Lec14<a class="headerlink" href="#lec14" title="Link to this heading">#</a></h2>
<p>In lecture 14 of mcs 320, we cover substitution, expansion, and factorization.</p>
<p><strong>1. Substitution</strong></p>
<p>Suppose we want to rewrite</p>
<div class="math notranslate nohighlight">
\[
    (x+y)^2 + \frac{1}{(x+y)^2}
\]</div>
<p>into</p>
<div class="math notranslate nohighlight">
\[
    \frac{(x+y)^4 + 1}{(x+y)^2}.
\]</div>
<p>The problem is that we do not want to expand the numerator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}{\left(x + y\right)}^{2} + \frac{1}{{\left(x + y\right)}^{2}}</script></html></div></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">factor()</span></code> puts the expression <code class="docutils literal notranslate"><span class="pre">p</span></code> on the common denominator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x^4 + 4*x^3*y + 6*x^2*y^2 + 4*x*y^3 + y^4 + 1)/(x + y)^2
</pre></div>
</div>
</div>
</div>
<p>But we see that the numerator is expanded.</p>
<p>To prevent <code class="docutils literal notranslate"><span class="pre">(x+y)^4</span></code> from expanding in the numerator, we substitute <code class="docutils literal notranslate"><span class="pre">x+y</span></code> by <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">:</span> <span class="n">z</span><span class="p">})</span>
<span class="n">q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>z^2 + 1/z^2
</pre></div>
</div>
</div>
</div>
<p>Observe the syntax of the <code class="docutils literal notranslate"><span class="pre">subs()</span></code> method.  The argument is the dictionary <code class="docutils literal notranslate"><span class="pre">{x+y:</span> <span class="pre">z}</span></code> has as key the expression we want to replace by <code class="docutils literal notranslate"><span class="pre">z</span></code>, the corresponding value of the key.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(z^4 + 1)/z^2
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">z</span></code> shielded the expansion of <code class="docutils literal notranslate"><span class="pre">(x+y)^4</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((x + y)^4 + 1)/(x + y)^2
</pre></div>
</div>
</div>
</div>
<p>The substition of a variable in an expression can be executed faster by <em>symbolic evaluation</em>.</p>
<p><strong>2. Sequential and Simultaneous Substitution</strong></p>
<p>In sequential substitution, we replace variables one after the other.  In a simultaneous substitution, all variables are replaced all at once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a, b, c&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">c</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a + 2*b + 3*c
</pre></div>
</div>
</div>
</div>
<p>Suppose we want to replace <code class="docutils literal notranslate"><span class="pre">a</span></code> by <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> by <code class="docutils literal notranslate"><span class="pre">c</span></code>, and <code class="docutils literal notranslate"><span class="pre">c</span></code> by <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3*a + b + 2*c
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3*a + b + 2*c
</pre></div>
</div>
</div>
</div>
<p>The above substitutions are simultaneous.</p>
<p>The substitutions below are sequential.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="n">b</span><span class="p">})</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">b</span><span class="p">:</span> <span class="n">c</span><span class="p">})</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">c</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6*a
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">)(</span><span class="n">b</span><span class="o">=</span><span class="n">c</span><span class="p">)(</span><span class="n">c</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6*a
</pre></div>
</div>
</div>
</div>
<p><strong>3. Collecting Terms</strong></p>
<p>Consider writing</p>
<div class="math notranslate nohighlight">
\[
   (a + b + c) \star (x^2 + x + 1)
\]</div>
<p>into</p>
<div class="math notranslate nohighlight">
\[
   (a + b + c) x^2 + (a + b + c) x + (a + b + c).
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x^2 + x + 1)*(a + b + c)
</pre></div>
</div>
</div>
</div>
<p>Applying <code class="docutils literal notranslate"><span class="pre">expand()</span></code> on <code class="docutils literal notranslate"><span class="pre">p</span></code> leads to expression swell.  To avoid the expression swell we can substitution <code class="docutils literal notranslate"><span class="pre">(a+b+c)</span></code> by <code class="docutils literal notranslate"><span class="pre">z</span></code> as we did before.  This is a good exercise.</p>
<p>An alternative is to work with a polynomial in <code class="docutils literal notranslate"><span class="pre">x</span></code> and coefficients in <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, and <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ZZ</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">][</span><span class="n">x</span><span class="p">](</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(a + b + c)*x^2 + (a + b + c)*x + a + b + c
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec15">
<h2>Lec15<a class="headerlink" href="#lec15" title="Link to this heading">#</a></h2>
<p>Lecture 15 of mcs 320 is on normalization.</p>
<p><strong>1. Normalization of Expressions</strong></p>
<p>When are two expressions the same?  Consider the following example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">e1</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="n">e2</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x + y)*x
x^2 + x*y
</pre></div>
</div>
</div>
</div>
<p>Although <code class="docutils literal notranslate"><span class="pre">e1</span></code> and <code class="docutils literal notranslate"><span class="pre">e2</span></code> look different, we know that they are mathematically equivalent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e1.operands() :&#39;</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">operands</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e2.operands() :&#39;</span><span class="p">,</span> <span class="n">e2</span><span class="o">.</span><span class="n">operands</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e1.operator() :&#39;</span><span class="p">,</span> <span class="n">e1</span><span class="o">.</span><span class="n">operator</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;e2.operator() :&#39;</span><span class="p">,</span> <span class="n">e2</span><span class="o">.</span><span class="n">operator</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e1.operands() : [x + y, x]
e2.operands() : [x^2, x*y]
e1.operator() : &lt;function mul_vararg at 0x6ffdb32a3d40&gt;
e2.operator() : &lt;function add_vararg at 0x6ffdb32a3170&gt;
</pre></div>
</div>
</div>
</div>
<p>Viewed as expressions, <code class="docutils literal notranslate"><span class="pre">e1</span></code> and <code class="docutils literal notranslate"><span class="pre">e2</span></code> are entirely different, and yet mathematically equivalent.  Let us look at their difference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">e1</span> <span class="o">-</span> <span class="n">e2</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x + y)*x - x^2 - x*y
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>In fully expanded form, the difference collapses to zero and therefore we computed that <code class="docutils literal notranslate"><span class="pre">e1</span></code> and <code class="docutils literal notranslate"><span class="pre">e2</span></code> are the same.</p>
<p><strong>2. Rewriting Multivariate Polynomials</strong></p>
<p>We can cast the expressions <code class="docutils literal notranslate"><span class="pre">e1</span></code> and <code class="docutils literal notranslate"><span class="pre">e2</span></code> into the polynomial ring in the variables <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and with integer coefficients.  The monomial order imposed by the cast will normalize the expressions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">](</span><span class="n">e1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 + x*y has type &lt;class &#39;sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p2</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">](</span><span class="n">e2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">p2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 + x*y has type &lt;class &#39;sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">p1</span></code> and <code class="docutils literal notranslate"><span class="pre">p2</span></code> obtained by respectively casting <code class="docutils literal notranslate"><span class="pre">e1</span></code> and <code class="docutils literal notranslate"><span class="pre">e2</span></code> into <code class="docutils literal notranslate"><span class="pre">ZZ[x,y]</span></code> are identical.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span> <span class="o">-</span> <span class="n">p2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>There are many monomial orders.  We distinguish between the pure lexicographic and the degree lexicographic as the two main ones.  The first choice we make is the order of the variables, which by default is alphabetically.</p>
<p>Let us look at a random polynomial with integer coefficients, in <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code>, with the monomials ordered lexicographically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Plex</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Plex</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-x^{5} z - 3 x^{4} y z^{2} + x^{4} z + x^{3} z^{4} - x^{2} y z^{3} - 3 x y z^{5} + 2 x y z^{3} - y^{5} z - y^{5} - y^{4} z^{4} - y^{3} z^{4} + 2 y^{3} z + y^{2} - 2 y z^{7} - 3 y z^{4}</script></html></div></div>
</div>
<p>Let us now reorder the monomials, using as variable order z &gt; y &gt; x (reverse lexicographic) and order by degrees (which is the default).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Pdeg</span><span class="o">.&lt;</span><span class="n">z</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">Pdeg</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-2 z^{7} y - z^{4} y^{4} - z^{4} y^{3} - 3 z^{5} y x + z^{4} x^{3} - 3 z^{2} y x^{4} - z y^{5} - z^{3} y x^{2} - z x^{5} - 3 z^{4} y - y^{5} + 2 z^{3} y x + z x^{4} + 2 z y^{3} + y^{2}</script></html></div></div>
</div>
<p>Observe the different positions of the monomials.</p>
<p><strong>3. A Numerical Test on Equality</strong></p>
<p>Because the number of monomials may grow exponentially with increasing number of variables, rewriting a polynomial is often two expensive.  Consider again our two expressions from the beginning.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Is&#39;</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="s1">&#39;the same as&#39;</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Is (x + y)*x the same as x^2 + x*y ?
</pre></div>
</div>
</div>
</div>
<p>Expressions are callable, let use pick a random point and compare the values of <code class="docutils literal notranslate"><span class="pre">e1</span></code> and <code class="docutils literal notranslate"><span class="pre">e2</span></code> at that random point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">CC</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">CC</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.884182251438780 + 0.625612760600956*I,
 -0.451739336032167 + 0.842882600846518*I)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span> <span class="o">=</span> <span class="n">e1</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
<span class="n">v1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.536351086441882 + 1.56895934102189*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v2</span> <span class="o">=</span> <span class="n">e2</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
<span class="n">v2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.536351086441882 + 1.56895934102189*I
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span> <span class="o">-</span> <span class="n">v2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.11022302462516e-16 - 2.22044604925031e-16*I
</pre></div>
</div>
</div>
</div>
<p>Up to machine precision, the values are the same.  To gain more confidence, take more samples and increase the precision.</p>
</section>
<section id="lec19">
<h2>Lec19<a class="headerlink" href="#lec19" title="Link to this heading">#</a></h2>
<p>In lecture 19 of mcs 320, we define mathematical functions.</p>
<p><strong>1. Symbolic Functions are Expressions</strong></p>
<p>We recall that expressions are callable.  This means that we can evaluate them, numerically or symbolically.</p>
<p>Let us consider a function of two variables, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>:</p>
<div class="math notranslate nohighlight">
\[
   f(x,y) = \exp(-x^2 - y^2) (\sin(x) + \cos(y)).
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; (cos(y) + sin(x))*e^(-x^2 - y^2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Although <code class="docutils literal notranslate"><span class="pre">f</span></code> looks differently when we ask for its value, it is a symbolic expression.</p>
<p>With <em>symbolic evaluation</em> we can go back and forth between an expression and a function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;u, v&#39;</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
<span class="n">e</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(cos(v) + sin(u))*e^(-u^2 - v^2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">e</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; (cos(y) + sin(x))*e^(-x^2 - y^2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">variables</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">variables</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(u, v)
</pre></div>
</div>
</div>
</div>
<p>There is not much difference then between functions and expressions, for both derivatives and antiderivatives are defined.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; -2*x*(cos(y) + sin(x))*e^(-x^2 - y^2) + cos(x)*e^(-x^2 - y^2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; 1/2*sqrt(pi)*cos(y)*erf(x)*e^(-y^2) + 1/4*sqrt(pi)*(I*erf(x + 1/2*I) - I*erf(x - 1/2*I))*e^(-y^2 - 1/4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2*u*(cos(v) + sin(u))*e^(-u^2 - v^2) + cos(u)*e^(-u^2 - v^2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/2*sqrt(pi)*cos(v)*erf(u)*e^(-v^2) + 1/4*sqrt(pi)*(I*erf(u + 1/2*I) - I*erf(u - 1/2*I))*e^(-v^2 - 1/4)
</pre></div>
</div>
</div>
</div>
<p><strong>2. Python Functions and Expressions</strong></p>
<p>Observe the difference with Python functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;function&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>The methods <code class="docutils literal notranslate"><span class="pre">derivative()</span></code> and <code class="docutils literal notranslate"><span class="pre">integral()</span></code> are not defined on Python functions, but </p>
<p>We can evaluate Python functions in symbols to obtain expressions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ep</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
<span class="n">ep</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(cos(v) + sin(u))*e^(-u^2 - v^2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>3. Step and Piecewise Functions</strong></p>
<p>The unit step function is defined as</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(f(x) = 0\)</span>, if <span class="math notranslate nohighlight">\(x &lt; 0\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(f(x) = 1\)</span>, if <span class="math notranslate nohighlight">\(x \geq 0\)</span>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unit_step</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unit_step</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unit_step</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">unit_step</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c912599476029bbe1544402c2cf38eadf8904234c113ee205d93fd7e8836ad7c.png" src="../_images/c912599476029bbe1544402c2cf38eadf8904234c113ee205d93fd7e8836ad7c.png" />
</div>
</div>
<p>The unit step function can be defined as the limit of <span class="math notranslate nohighlight">\(1/(1 + exp(-2 k x)\)</span>, for increasing values of <span class="math notranslate nohighlight">\(k\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">h</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/22ccccd3e91c42552c84a326cd8ab52eda3c909359c6d6d5e1a95dafcc801108.png" src="../_images/22ccccd3e91c42552c84a326cd8ab52eda3c909359c6d6d5e1a95dafcc801108.png" />
</div>
</div>
<p>The Heaviside function is similar to the unit step function, but with the value of <span class="math notranslate nohighlight">\(1/2\)</span> at <span class="math notranslate nohighlight">\(x=0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">unit_step</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dirac_delta(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dirac_delta</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dirac_delta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dirac_delta(0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dirac_delta</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>The Dirac delta function is everywhere zero, except for a spike at the origin.</p>
<p>The Kronecker delta is another delta function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kronecker_delta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kronecker_delta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>With unit step functions, we can define a staircase function.</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(f(x) = 0\)</span> if <span class="math notranslate nohighlight">\(x &lt; 0\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(f(x) = 1/3\)</span> if <span class="math notranslate nohighlight">\(x \in [0, 1)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(f(x) = 2/3\)</span> if <span class="math notranslate nohighlight">\(x \in [1, 2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f(x) = 1\)</span> if <span class="math notranslate nohighlight">\(x \geq 2\)</span>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">unit_step</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="n">unit_step</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="n">unit_step</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x |--&gt; 1/3*unit_step(x - 1) + 1/3*unit_step(x - 2) + 1/3*unit_step(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f1fd60a5e90f79a126ded5dbd433b7ad09727f82a1eb56b91286d07fd6741638.png" src="../_images/f1fd60a5e90f79a126ded5dbd433b7ad09727f82a1eb56b91286d07fd6741638.png" />
</div>
</div>
<p>Alternatively, we can use <code class="docutils literal notranslate"><span class="pre">piecewise</span></code>.</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">piecewise</span></code> takes on input a list of tuples.</p></li>
<li><p>The first element of each tuple is an interval and the second element is the value of the function on that interval.</p></li>
<li><p>Closed intervals are defined with [].</p></li>
<li><p>Open intervals are defined with ().</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">piecewise</span><span class="p">([((</span><span class="o">-</span><span class="n">infinity</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">infinity</span><span class="p">),</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>piecewise(x|--&gt;0 on (-oo, 0), x|--&gt;1/3 on (0, 1), x|--&gt;1/3 on {1}, x|--&gt;2/3 on (1, 2), x|--&gt;1 on {2}, x|--&gt;1 on (2, +oo); x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bc910730dcfd342defbb0dc90a5f004286fc27d7d561463c14b73aead80bb8d3.png" src="../_images/bc910730dcfd342defbb0dc90a5f004286fc27d7d561463c14b73aead80bb8d3.png" />
</div>
</div>
</section>
<section id="lec20">
<h2>Lec20<a class="headerlink" href="#lec20" title="Link to this heading">#</a></h2>
<p>In Lecture 20 of mcs 320, we apply memoization to make recursive functions more efficient.</p>
<p><strong>1. Recursive Functions</strong></p>
<p>The Fibonacci numbers are defined as <span class="math notranslate nohighlight">\(F(0) = 0\)</span>, <span class="math notranslate nohighlight">\(F(1) = 1\)</span>,
and for <span class="math notranslate nohighlight">\(n &gt; 1\)</span>: <span class="math notranslate nohighlight">\(F(n) = F(n-1) + F(n-2)\)</span>.</p>
<p>Below is a basic Python function, that follows the recursive definition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">F</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the n-th Fibonacci number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">F</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us look at the first ten Fibonacci numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
</pre></div>
</div>
</div>
</div>
<p>The main problem with the definition is that it is too inefficient.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;F(20)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25 loops, best of 3: 7.92 ms per loop
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;F(21)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25 loops, best of 3: 13 ms per loop
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;F(22)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25 loops, best of 3: 21.6 ms per loop
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;F(23)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25 loops, best of 3: 34.5 ms per loop
</pre></div>
</div>
</div>
</div>
<p>Just to compute the next number in the sequence takes significantly more time.</p>
<p>The reason for this high cost is the repeated function calls.
Consider the computation of <span class="math notranslate nohighlight">\(F(2) = F(0) + F(1) = 0 + 1\)</span>.
As both <span class="math notranslate nohighlight">\(F(0)\)</span> and <span class="math notranslate nohighlight">\(F(1)\)</span> are base cases in the recursion,
the calls <span class="math notranslate nohighlight">\(F(0)\)</span> and <span class="math notranslate nohighlight">\(F(1)\)</span> are leaves of the binary tree of calls.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L0</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;F(0)&#39;</span><span class="p">)</span>
<span class="n">L1</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;F(1)&#39;</span><span class="p">)</span>
<span class="n">L2</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="n">L0</span><span class="p">,</span> <span class="n">L1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;F(2)&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  _F(2)__
 /       \
F(0)      F(1)
</pre></div>
</div>
</div>
</div>
<p>Consider <span class="math notranslate nohighlight">\(F(3)\)</span>, <span class="math notranslate nohighlight">\(F(4)\)</span>, and <span class="math notranslate nohighlight">\(F(5)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L3</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;F(3)&#39;</span><span class="p">)</span>
<span class="n">L4</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="n">L2</span><span class="p">,</span> <span class="n">L3</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;F(4)&#39;</span><span class="p">)</span>
<span class="n">L5</span> <span class="o">=</span> <span class="n">LabelledBinaryTree</span><span class="p">([</span><span class="n">L3</span><span class="p">,</span> <span class="n">L4</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;F(5)&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">L5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       _______________F(5)_______________
      /                                  \
  ___F(3)___                       _______F(4)________
 /          \                     /                   \
F(1)        _F(2)__             _F(2)__             ___F(3)___
           /       \           /       \           /          \
          F(0)      F(1)      F(0)      F(1)      F(1)        _F(2)__
                                                             /       \
                                                            F(0)      F(1)
</pre></div>
</div>
</div>
</div>
<p>From the tree of function calls, we see many repeated instances
of <span class="math notranslate nohighlight">\(F(0)\)</span> and <span class="math notranslate nohighlight">\(F(1)\)</span>.  Observe too that <span class="math notranslate nohighlight">\(F(3)\)</span> is computed twice,
and <span class="math notranslate nohighlight">\(F(2)\)</span> is computed three times.</p>
<p><strong>2. Memoization in Python</strong></p>
<p>Memoization is a technique to speed up programs by storing the results of function calls.</p>
<p>We will memoize the Fibonacci function <span class="math notranslate nohighlight">\(F\)</span>,
using a dictionary as an extra argument of the function
to store the results of the function calls.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">memoizedF</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    All calls made to memoizedF() are stored in D.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">D</span><span class="p">:</span>       <span class="c1"># dictionary lookup</span>
        <span class="k">return</span> <span class="n">D</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">memoizedF</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">memoizedF</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">D</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span> <span class="c1"># store the result in the dictionary</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p>Let us check the computation of the first 10 Fibonacci numbers again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">memoizedF</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;memoizedF(100)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>625 loops, best of 3: 217 ns per loop
</pre></div>
</div>
</div>
</div>
<p><strong>3. Memoization in SageMath</strong></p>
<p>Consider the Chebyshev polynomials, defined as
<span class="math notranslate nohighlight">\(T(0,x)=1\)</span>, <span class="math notranslate nohighlight">\(T(1,x) = x\)</span> and for degree <span class="math notranslate nohighlight">\(n &gt; 1\)</span>:
<span class="math notranslate nohighlight">\(T(n,x) = 2 x T(n1,x)  T(n2,x)\)</span>.</p>
<p>The Chebyshev polynomials are already available.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">chebyshev_T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 x,
 2*x^2 - 1,
 4*x^3 - 3*x,
 8*x^4 - 8*x^2 + 1,
 16*x^5 - 20*x^3 + 5*x,
 32*x^6 - 48*x^4 + 18*x^2 - 1,
 64*x^7 - 112*x^5 + 56*x^3 - 7*x,
 128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1,
 256*x^9 - 576*x^7 + 432*x^5 - 120*x^3 + 9*x]
</pre></div>
</div>
</div>
</div>
<p>Let us define our own, efficient definition of the
Chebyshev polynomials, with the definition of a function <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p>
<p>Because Chebyshev polynomials are defined by two parameters:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> is the degree of the polynomial,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is the symbol of the variable in the polynomial,</p></li>
</ol>
<p>the keys of the dictionary are tuples <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">x)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">T</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Memoized Chebyshev function of degree n in x.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">D</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">D</span><span class="p">[(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">T</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">T</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">))</span> <span class="c1"># normalize</span>
        <span class="n">D</span><span class="p">[(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">result</span> <span class="c1"># store the normalized result</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p>Observe the normalization of the Chebyshev polynomial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 x,
 2*x^2 - 1,
 4*x^3 - 3*x,
 8*x^4 - 8*x^2 + 1,
 16*x^5 - 20*x^3 + 5*x,
 32*x^6 - 48*x^4 + 18*x^2 - 1,
 64*x^7 - 112*x^5 + 56*x^3 - 7*x,
 128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1,
 256*x^9 - 576*x^7 + 432*x^5 - 120*x^3 + 9*x]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;T(100, x)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>625 loops, best of 3: 474 ns per loop
</pre></div>
</div>
</div>
</div>
<p>As before, we see that this memoized version is very efficient.</p>
</section>
<section id="lec21">
<h2>Lec21<a class="headerlink" href="#lec21" title="Link to this heading">#</a></h2>
<p>In lecture 21 of mcs 320, we work with functions.</p>
<p><strong>1. Expressions in Many Variables</strong></p>
<p>Consider the definition of the following sequence of polynomials.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   f_i = x_i^3 + \left(
     \sum_{ \scriptsize \begin{array}{c}
                j=1 \\
                j \not=i
            \end{array} }^n (i + j + 1) x_j \right) - 1,
   \quad i=1,2,\ldots, n.
\end{split}\]</div>
<p>Let us look at a specific value for <span class="math notranslate nohighlight">\(n\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<p>As it should work for any number of variables, we define a list of variables <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x1, x2, x3, x4]
</pre></div>
</div>
</div>
</div>
<p>Keep in mind that lists start with index 0, so <code class="docutils literal notranslate"><span class="pre">X[0]</span></code> is <code class="docutils literal notranslate"><span class="pre">x1</span></code>.</p>
<p>Let us define a function for the first expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>The function depends on <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code>.  Instead of defining the function with <code class="docutils literal notranslate"><span class="pre">f(i,</span> <span class="pre">n)</span> <span class="pre">=</span> </code>, we must us <code class="docutils literal notranslate"><span class="pre">lambda</span></code> to prevent evaluation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x1^3 + 4*x2 + 5*x3 + 6*x4 - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="n">F</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x1^3 + 4*x2 + 5*x3 + 6*x4 - 1,
 x2^3 + 4*x1 + 6*x3 + 7*x4 - 1,
 x3^3 + 5*x1 + 6*x2 + 8*x4 - 1,
 x4^3 + 6*x1 + 7*x2 + 8*x3 - 1]
</pre></div>
</div>
</div>
</div>
<p><strong>2. Polynomials in Several Variables</strong></p>
<p>A polynomial in <span class="math notranslate nohighlight">\(n\)</span> variables <span class="math notranslate nohighlight">\(x_1, x_2, \ldots, x_n\)</span> with <span class="math notranslate nohighlight">\(m\)</span> terms is defined by</p>
<ol class="arabic simple">
<li><p>a list of <span class="math notranslate nohighlight">\(m\)</span> coefficients, let us take rational numbers,</p></li>
<li><p>a list of <span class="math notranslate nohighlight">\(m\)</span> exponent tuples, each tuple is defined by <span class="math notranslate nohighlight">\(n\)</span> natural numbers.</p></li>
</ol>
<p>In the example below, we take <span class="math notranslate nohighlight">\(n = 5\)</span> and <span class="math notranslate nohighlight">\(m = 8\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x1, x2, x3, x4, x5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">20230707</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The coefficients are stored in the list <code class="docutils literal notranslate"><span class="pre">C</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="n">QQ</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
<span class="n">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, -2, 1/2, -1/2, -6, 0, -3, -7/3]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">())</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
<span class="n">E</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(1, 0, 1, 1, 2),
 (1, 0, 4, 1, 1),
 (4, 0, 2, 1, 1),
 (3, 7, 0, 1, 2),
 (0, 1, 0, 36, 1),
 (4, 1, 0, 1, 36),
 (0, 1, 0, 0, 1),
 (1, 8, 1, 2, 13)]
</pre></div>
</div>
</div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">prod</span></code> to make the first monomial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prod</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">^</span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x1*x3*x4*x5^2
</pre></div>
</div>
</div>
</div>
<p>It is good to have a helper function to define a monomial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monomial</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="n">prod</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">^</span><span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="n">monomial</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x1*x3*x4*x5^2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">monomial</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-6*x2*x4^36*x5 - 7/3*x1*x2^8*x3*x4^2*x5^13 - 1/2*x1^3*x2^7*x4*x5^2 + 1/2*x1^4*x3^2*x4*x5 - 2*x1*x3^4*x4*x5 - 3*x2*x5
</pre></div>
</div>
</div>
</div>
<p>To verify, let us look at the coefficients and the exponents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, -2, 1/2, -1/2, -6, 0, -3, -7/3]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(1, 0, 1, 1, 2),
 (1, 0, 4, 1, 1),
 (4, 0, 2, 1, 1),
 (3, 7, 0, 1, 2),
 (0, 1, 0, 36, 1),
 (4, 1, 0, 1, 36),
 (0, 1, 0, 0, 1),
 (1, 8, 1, 2, 13)]
</pre></div>
</div>
</div>
</div>
<p><strong>3. Function Composition</strong></p>
<p>Consider the trajectory of a projectile in space modeled by a parabola,
subject to the following constraints.  At time <span class="math notranslate nohighlight">\(t = 0\)</span> it is launched from
the ground and at time <span class="math notranslate nohighlight">\(t = 45\)</span> it hits the ground 120 miles further.
Assuming constant horizontal speed we create a function <span class="math notranslate nohighlight">\(f(t)\)</span> to give
the altitude of the projectile in function of time.
First we model the shape of the trajectory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">120</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">120</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/367d64927bbef98d6e030a50a0ca2806c7c741be79e6d714ad7e00e21388de6f.png" src="../_images/367d64927bbef98d6e030a50a0ca2806c7c741be79e6d714ad7e00e21388de6f.png" />
</div>
</div>
<p>Now we want a function in time <span class="math notranslate nohighlight">\(t\)</span>.
The assumption of constant horizontal speed implies that <span class="math notranslate nohighlight">\(x\)</span> is just a rescaling of <span class="math notranslate nohighlight">\(t\)</span>.
This means that when <span class="math notranslate nohighlight">\(t = 45\)</span>, x must be 120.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="mi">120</span><span class="o">/</span><span class="mi">45</span><span class="o">*</span><span class="n">t</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x at 0 :&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x at 45 :&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x at 0 : 0
x at 45 : 120
</pre></div>
</div>
</div>
</div>
<p>Then the altitude is given as the composition of <span class="math notranslate nohighlight">\(y\)</span> after <span class="math notranslate nohighlight">\(x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;altitude at 0 :&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;altitude at 22.5 :&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="mf">22.5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;altitude at 45 :&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>altitude at 0 : 0
altitude at 22.5 : 3600.00000000000
altitude at 45 : 0
</pre></div>
</div>
</div>
</div>
<p>Finally, we plot the altitude as a function of time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">200</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6e1fff64b1d4e72f4f46be908ddaaf8841a976c9e8c7c60af8f227adc37f98be.png" src="../_images/6e1fff64b1d4e72f4f46be908ddaaf8841a976c9e8c7c60af8f227adc37f98be.png" />
</div>
</div>
<p><strong>4. The Newton Operator</strong></p>
<p>The Newton operator defined below takes on input a function and returns a function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">newton_step</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the function that will perform one Newton step</span>
<span class="sd">    to solve the equation f(x) = 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span>
</pre></div>
</div>
</div>
</div>
<p>As an example, consider the computation of the square root of 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">our_sqrt</span> <span class="o">=</span> <span class="n">newton_step</span><span class="p">(</span><span class="n">sqr</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">our_sqrt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x |--&gt; x - 1/2*(x^2 - 2)/x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1</span> <span class="o">=</span> <span class="n">our_sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">our_sqrt</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
<span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>17/12
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s3</span> <span class="o">=</span> <span class="n">our_sqrt</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="n">s3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>577/408
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d3</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">s3</span>
<span class="n">d3</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.1234155e-6
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s4</span> <span class="o">=</span> <span class="n">our_sqrt</span><span class="p">(</span><span class="n">s3</span><span class="p">)</span>
<span class="n">d4</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">s4</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s4</span><span class="p">,</span> <span class="s1">&#39;has error&#39;</span><span class="p">,</span> <span class="n">d4</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>665857/470832 has error -1.59161572810e-12
</pre></div>
</div>
</div>
</div>
<p>Starting from an integer approximation, we obtain a sequence of quadratically converging rational approximations.  The quadratic convergence means that the accuracy doubles in each step.</p>
</section>
<section id="lec22">
<h2>Lec22<a class="headerlink" href="#lec22" title="Link to this heading">#</a></h2>
<p>In lecture 22 of mcs 320, we consider symbolic, numeric, and implicit differentiation.</p>
<p><strong>1. Symbolic Differentiation</strong></p>
<p>Consider an expression <code class="docutils literal notranslate"><span class="pre">f</span></code> which depends on <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sin(2*pi*x)
</pre></div>
</div>
</div>
</div>
<p>Let us compute the value of the derivative of <code class="docutils literal notranslate"><span class="pre">f</span></code> at <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">f1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2*pi*cos(2*pi*x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2*pi
</pre></div>
</div>
</div>
</div>
<p>We can compute the 5-th derivative as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>32*pi^5*cos(2*pi*x)
</pre></div>
</div>
</div>
</div>
<p>or via the method <code class="docutils literal notranslate"><span class="pre">diff</span></code> applied to the expression <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>32*pi^5*cos(2*pi*x)
</pre></div>
</div>
</div>
</div>
<p>With functions in several variables, we can compute the derivatives all at once.  Consider a random polynomial with rational coefficients in the variables <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^4*y - 2*y^5 + 4*x^4 - 1/3*x^3*y - 1/7*x^2*y + 3/16*x - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">SR</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; x^4*y - 2*y^5 + 4*x^4 - 1/3*x^3*y - 1/7*x^2*y + 3/16*x - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; (4*x^3*y + 16*x^3 - x^2*y - 2/7*x*y + 3/16, x^4 - 10*y^4 - 1/3*x^3 - 1/7*x^2)
</pre></div>
</div>
</div>
</div>
<p>Observe that <code class="docutils literal notranslate"><span class="pre">g</span></code> is a function which returns a tuple.  The <code class="docutils literal notranslate"><span class="pre">g</span></code> is the <em>gradient</em> of <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">h</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(x, y) |--&gt; 12*x^2*y + 48*x^2 - 2*x*y - 2/7*y               (x, y) |--&gt; 4*x^3 - x^2 - 2/7*x]
[              (x, y) |--&gt; 4*x^3 - x^2 - 2/7*x                           (x, y) |--&gt; -40*y^3]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.matrix.matrix_generic_dense.Matrix_generic_dense&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Observe that <code class="docutils literal notranslate"><span class="pre">h</span></code> is a matrix.  The matrix of all partial derivatives of a function in several variables is called the <em>Hessian</em> of the function.</p>
<p><strong>2. Numeric Differentiation</strong></p>
<p>Numeric differentiation is available as <code class="docutils literal notranslate"><span class="pre">derivative</span></code> of <code class="docutils literal notranslate"><span class="pre">scipy.misc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">derivative</span> <span class="k">as</span> <span class="n">numdiff</span>
</pre></div>
</div>
</div>
</div>
<p>Let us apply this to the problem of computing the derivative of <code class="docutils literal notranslate"><span class="pre">sin(2*pi*x)</span></code> at <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<p>For this to work properly, we have to use the <code class="docutils literal notranslate"><span class="pre">sin</span></code> and <code class="docutils literal notranslate"><span class="pre">pi</span></code> of <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numdiff</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0e-2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.279051952931303
</pre></div>
</div>
</div>
</div>
<p>The value for <code class="docutils literal notranslate"><span class="pre">dx</span></code> defines the step size <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>We can improve on the numerical value by decreasing the step size and taking more points, specifying the value for <code class="docutils literal notranslate"><span class="pre">order</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numdiff</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1.0e-4</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.283185307180939
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.283185307179586
</pre></div>
</div>
</div>
</div>
<p><strong>3. Implicit Differentiation</strong></p>
<p>Take a random point on the unit circle and compute the slope of the tangent line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">circle</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">circle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 + y^2 - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotcircle</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">plotcircle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/52c62b0a0061139f62403f4700ece12d57d00063b3b0a16ca16b31f184f43f25.png" src="../_images/52c62b0a0061139f62403f4700ece12d57d00063b3b0a16ca16b31f184f43f25.png" />
</div>
</div>
<p>A random point on the unit circle is defined by <span class="math notranslate nohighlight">\((\cos(t), \sin(t))\)</span> for <span class="math notranslate nohighlight">\(t\)</span> a random angle in <span class="math notranslate nohighlight">\([-\pi, \pi[\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angle</span> <span class="o">=</span> <span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="n">angle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.85589892691278
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
<span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.281255911213967, -0.959632800818730)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotpoint</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">plotcircle</span> <span class="o">+</span> <span class="n">plotpoint</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/57cb1e7824d4d5e97ddba39fae864d26b023a48425669ddf86f600dc7098e940.png" src="../_images/57cb1e7824d4d5e97ddba39fae864d26b023a48425669ddf86f600dc7098e940.png" />
</div>
</div>
<p>Now we want to compute the tangent line through the point on the circle.</p>
<p>To apply implicit differentiation, we must declare <code class="docutils literal notranslate"><span class="pre">y(x)</span></code>, that is <code class="docutils literal notranslate"><span class="pre">y</span></code> as a function of <code class="docutils literal notranslate"><span class="pre">x</span></code>.  For this function, we introduce a new variable <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Y(x) has type &lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dy</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">dy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>diff(Y(x), x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ycircle</span> <span class="o">=</span> <span class="n">circle</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="n">Ycircle</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 + Y(x)^2 - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">Ycircle</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">dc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2*Y(x)*diff(Y(x), x) + 2*x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[diff(Y(x), x) == -x/Y(x)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solrhs</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">solrhs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-x/Y(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="n">solrhs</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">a</span><span class="p">})</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">Y</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">):</span> <span class="n">b</span><span class="p">})</span>
<span class="n">slope</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.293087013047082
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tangent</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">b</span> <span class="o">-</span> <span class="n">slope</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
<span class="n">tangent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.293087013047082*x + y + 1.04206525573827
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotline</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="n">tangent</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">plotcircle</span><span class="o">+</span><span class="n">plotpoint</span><span class="o">+</span><span class="n">plotline</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8ead27a5969fd4541ff40806a28b8294b0a074103a2d0e1a2f3fbb02954ebf99.png" src="../_images/8ead27a5969fd4541ff40806a28b8294b0a074103a2d0e1a2f3fbb02954ebf99.png" />
</div>
</div>
</section>
<section id="lec23">
<h2>Lec23<a class="headerlink" href="#lec23" title="Link to this heading">#</a></h2>
<p>In Lecture 23 of MCS 320, we consider integration and summation.</p>
<p><strong>1. Symbolic and Numeric Integration</strong></p>
<p>If a symbolic antiderivative exists, then we can interchange <code class="docutils literal notranslate"><span class="pre">diff</span></code> with <code class="docutils literal notranslate"><span class="pre">integral</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-sin(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sin(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cos(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integral</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cos(x)
</pre></div>
</div>
</div>
</div>
<p>In many cases, a symbolic antiderivative does not exist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
<span class="n">integral</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>integrate(cos(e^(x^2)), x)
</pre></div>
</div>
</div>
</div>
<p>We can ask to compute a numerical approximation for the definite integral.  First we can define the symbolic expression of the integral and specify the <code class="docutils literal notranslate"><span class="pre">hold</span> <span class="pre">=</span> <span class="pre">True</span></code> which does not evaluate the function call.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ie</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\int_{0}^{1} \cos\left(e^{\left(x^{2}\right)}\right)\,{d x}</script></html></div></div>
</div>
<p>A numerical approximation with 16 decimal places is computed below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ie</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1128234569369889
</pre></div>
</div>
</div>
</div>
<p><strong>2. Symbolic Bounds</strong></p>
<p>If a symbolic antiderivate exists, then we can apply the fundamental theorem of calculus.</p>
<p>Let <span class="math notranslate nohighlight">\(F(x) = \int f(x) dx\)</span>, then</p>
<div class="math notranslate nohighlight">
\[
    \int_a^b f(x) dx = F(b) - F(a).
\]</div>
<p>Let us try to apply this with <span class="math notranslate nohighlight">\(f = 1/x^2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">F</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x |--&gt; -1/x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a, b&#39;</span><span class="p">)</span>
<span class="n">ie</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\int_{a}^{b} \frac{1}{x^{2}}\,{d x}</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/a - 1/b
</pre></div>
</div>
</div>
</div>
<p>Removing the hold on the integral does not work!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ie.unhold() # remove comment to see the error message </span>
</pre></div>
</div>
</div>
</div>
<p>The reason for this error can be explained by a plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/653eea2d76a0c6266ac926eaf5dffdfc5685711d2818a6b0787dcbbe7c939102.png" src="../_images/653eea2d76a0c6266ac926eaf5dffdfc5685711d2818a6b0787dcbbe7c939102.png" />
</div>
</div>
<p>The integral can be computed formally by adding assumptions on the bounds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">assume</span><span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ie</span><span class="o">.</span><span class="n">unhold</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/a - 1/b
</pre></div>
</div>
</div>
</div>
<p><strong>3. Summation and Limits</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;k, n&#39;</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}{\sum_{k=1}^{n} k}</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">unhold</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{2} \, n^{2} + \frac{1}{2} \, n</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{1}{2} \, {\left(n + 1\right)} n</script></html></div></div>
</div>
<p>Let us look at the geometric sum, for some ratio <code class="docutils literal notranslate"><span class="pre">r</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">unhold</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="s1">&#39;=&#39;</span> <span class="p">,</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}{\sum_{k=0}^{n} r^{k}} \verb|=| \frac{r^{n + 1} - 1}{r - 1}</script></html></div></div>
</div>
<p>What happens if <code class="docutils literal notranslate"><span class="pre">r</span></code> becomes one?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n + 1
</pre></div>
</div>
</div>
</div>
<p>Another type of limit considers sums with an infinite number of terms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/6*pi^2
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">oo</span></code> stands for <span class="math notranslate nohighlight">\(\infty\)</span>.  The above sum is equivalent to a limit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">oo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>limit(harmonic_number(n, 2), n, +Infinity)
</pre></div>
</div>
</div>
</div>
<p>The Harmonic numbers are sums of reciprocals of the first positive integers.</p>
</section>
<section id="lec24">
<h2>Lec24<a class="headerlink" href="#lec24" title="Link to this heading">#</a></h2>
<p>In Lecture 24 of MCS 320, we consider Taylor series to approximate functions.</p>
<p><strong>1. Taylor Series</strong></p>
<p>We can define Taylor series formally on any function <code class="docutils literal notranslate"><span class="pre">f</span></code> in <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># function with name f in x</span>
</pre></div>
</div>
</div>
</div>
<p>Let us develop about <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">a</span></code>, for some symbol <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tf</span> <span class="o">=</span> <span class="n">taylor</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">tf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/24*(a - x)^4*diff(f(a), a, a, a, a) - 1/6*(a - x)^3*diff(f(a), a, a, a) + 1/2*(a - x)^2*diff(f(a), a, a) - (a - x)*diff(f(a), a) + f(a)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">tf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tcos</span> <span class="o">=</span> <span class="n">taylor</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">tcos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/24*x^4 - 1/2*x^2 + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcos</span> <span class="o">=</span> <span class="n">tcos</span><span class="o">.</span><span class="n">power_series</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="n">pcos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 - 1/2*x^2 + 1/24*x^4 + O(x^5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">pcos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.rings.power_series_poly.PowerSeries_poly&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Because <code class="docutils literal notranslate"><span class="pre">pcos</span></code> is a power series, we can ask for its multiplicative inverse.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">icos</span> <span class="o">=</span> <span class="n">pcos</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="n">icos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 + 1/2*x^2 + 5/24*x^4 + O(x^5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcos</span><span class="o">*</span><span class="n">icos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 + O(x^5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">icos</span><span class="o">*</span><span class="n">pcos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 + O(x^5)
</pre></div>
</div>
</div>
</div>
<p><strong>2. Taylor Series in Several Variables</strong></p>
<p>As an application, consider the computation of the tangent line at any point at the unit circle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circle</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>The coordinates of the point can be left as variables <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a, b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">taylor</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2*(a - x)*a + a^2 - 2*(b - y)*b + b^2 - 1
</pre></div>
</div>
</div>
</div>
<p>Let us make a plot to geometrically verify the formula.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angle</span> <span class="o">=</span> <span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
<span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.588438359127057, 0.808542081470010)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tline</span> <span class="o">=</span> <span class="n">ts</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">)</span>
<span class="n">tline</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.17687671825411*x + 1.61708416294002*y - 2.00000000000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pc</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="n">circle</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">pL</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="n">tline</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">pc</span><span class="o">+</span><span class="n">pp</span><span class="o">+</span><span class="n">pL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c7789c22bd89a40f5b0b229405b0834e32ca5dbd56c83bb44cff26017b9a5632.png" src="../_images/c7789c22bd89a40f5b0b229405b0834e32ca5dbd56c83bb44cff26017b9a5632.png" />
</div>
</div>
<p><strong>3. Approximations</strong></p>
<p>Consider a truncated Taylor series to approximate <code class="docutils literal notranslate"><span class="pre">sin(x)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tsin</span> <span class="o">=</span> <span class="n">taylor</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">tsin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/362880*x^9 - 1/5040*x^7 + 1/120*x^5 - 1/6*x^3 + x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotsin</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
<span class="n">plotser</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">tsin</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">plotsin</span><span class="o">+</span><span class="n">plotser</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f4ec8d3e9f131fb1520c80b056ae972e1beb30692a6d99aeb79638e45e4fb14b.png" src="../_images/f4ec8d3e9f131fb1520c80b056ae972e1beb30692a6d99aeb79638e45e4fb14b.png" />
</div>
</div>
<p>The Taylor series is sufficiently good locally, but not over the entire interval.</p>
<p>A rational approximation give getter results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="n">P</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power Series Ring in z over Rational Field
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">pade</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">pd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(551/75*z^5 - 1484/5*z^3 + 11088/5*z)/(z^4 + 364/5*z^2 + 11088/5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotpade</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">pd</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">plotsin</span><span class="o">+</span><span class="n">plotser</span><span class="o">+</span><span class="n">plotpade</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9a2a12ea25763f1415df2e8ad8818c7d697089d64744ef47129209320678dedf.png" src="../_images/9a2a12ea25763f1415df2e8ad8818c7d697089d64744ef47129209320678dedf.png" />
</div>
</div>
<p>The rational approximation agrees with the series locally, but gives better global results.</p>
<p><strong>4. Series in SymPy</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">series</span></code> in SymPy can be computed with a generator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sersin</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">sersin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;generator object Expr.series.&lt;locals&gt;.&lt;genexpr&gt; at 0x7f4ea523b450&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">sersin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle x\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">sersin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{x^{3}}{6}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">sersin</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{x^{5}}{120}\]</div>
</div>
</div>
<p>Applying <code class="docutils literal notranslate"><span class="pre">next()</span></code> to the generator we get the next term in the series.</p>
</section>
<section id="lec25">
<h2>Lec25<a class="headerlink" href="#lec25" title="Link to this heading">#</a></h2>
<p>In lecture 25 of MCS 320, we consider symbolic-numeric computing</p>
<p><strong>1. Interval Arithmetic</strong></p>
<p>What is the right precision to obtain accurate results?</p>
<p>To motivate the use of interval arithmetic, we take an example
from the paper of Stefano Taschini in the proceedings of SciPy 2008.
We convert the floating-point coefficients to rational numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">QQ</span><span class="p">(</span><span class="mf">333.75</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">6</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">121</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">QQ</span><span class="p">(</span><span class="mf">5.5</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">8</span> <span class="o">+</span> <span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="n">F</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">77617</span><span class="p">,</span> <span class="mi">33096</span><span class="p">)</span>
<span class="n">exact</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="n">exact</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exact</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="n">d</span><span class="p">),</span> <span class="n">B</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="n">d</span><span class="p">))</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>We see that we eventually get to an accurate result.  However, observe the plateaus which could give the impression that, as the result no longer changes, we have reached an accurate result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RIF</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">RIF</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">RIF</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>To see better the range of numbers, we ask to see the number in the <code class="docutils literal notranslate"><span class="pre">brackets</span></code> style.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RIF</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;brackets&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Observe the magnitude of the numbers.  The range of the interval is huge!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R100</span> <span class="o">=</span> <span class="n">RealIntervalField</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">R100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y100</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">R100</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">R100</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">R100</span><span class="p">(</span><span class="n">y100</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;brackets&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>After doubling the precision to 100 bits, observe that the magnitude dropped from <span class="math notranslate nohighlight">\(10^{21}\)</span> down to <span class="math notranslate nohighlight">\(10^7\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R200</span> <span class="o">=</span> <span class="n">RealIntervalField</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">y200</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">R200</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">R200</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="n">R200</span><span class="p">(</span><span class="n">y200</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;brackets&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Working with 200 bits gives an accurate result.  The side of the interval gives a bound on the error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y200</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ry200</span> <span class="o">=</span> <span class="n">R200</span><span class="p">(</span><span class="n">y200</span><span class="p">)</span>
<span class="n">ry200</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">-</span> <span class="n">ry200</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The error is defined as the difference between the upper and lower limit of the interval and we see that we have about 24 correct decimal places.</p>
<p><strong>2. Symbolic-Numeric Factorization</strong></p>
<p>In a numeric factorization of a polynomial in one variable, we compute the complex roots of the polynomial.  In a symbolic factorization, we extend the field of rational numbers with algebraic number till the polynomial factors as a product of linear forms.</p>
<p>A symbolic-numeric factorization works over the <code class="docutils literal notranslate"><span class="pre">QQbar</span></code> number field, which uses the complex interval field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)</span>
<span class="n">P</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we want a more accurate symbolic-numeric factorization, then we can compute the roots at a higher precision, for example with 200 bits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">ComplexIntervalField</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">C</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>3. Constrained Optimization</strong></p>
<p>To end the <code class="docutils literal notranslate"><span class="pre">calculus</span></code> chapter and to transition into the solving chapter, consider a problem of constrained optimization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y, z&#39;</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span>
<span class="n">constraint</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;optimize&#39;</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="s1">&#39;subject to&#39;</span><span class="p">,</span> <span class="n">constraint</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us make plot, for the value of the target equal to two.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tplot</span> <span class="o">=</span> <span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">target</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">cplot</span> <span class="o">=</span> <span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">(),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">tplot</span><span class="o">+</span><span class="n">cplot</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If the value of the target equals one, then we see that the red sheets touch the blue ball.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tplot</span> <span class="o">=</span> <span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">target</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">cplot</span> <span class="o">=</span> <span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">(),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">tplot</span><span class="o">+</span><span class="n">cplot</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To apply the method of Lagrange multipliers we need the gradients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">target</span>
<span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">lhs</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;target as function :&#39;</span><span class="p">,</span> <span class="n">ft</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;constraint as function :&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gt</span> <span class="o">=</span> <span class="n">ft</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">gt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gc</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">gc</span>
</pre></div>
</div>
</div>
</div>
<p>Now we set up the system.  Because <code class="docutils literal notranslate"><span class="pre">lambda</span></code> is reserved in Python, using <code class="docutils literal notranslate"><span class="pre">lambda</span></code> as the name of a variable is wrong.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">gt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="o">*</span><span class="n">gc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">eqs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
<span class="n">eqs</span>
</pre></div>
</div>
</div>
</div>
<p>Observe that the constraint was appended to the list of equations.  We then just solve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sols</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="p">])</span>
<span class="n">sols</span>
</pre></div>
</div>
</div>
</div>
<p>To evaluate the solutions at the target, we must convert the coordinates of the solutions into tuples and drop the value for w.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">sol</span> <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">sols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="p">[[</span><span class="n">e</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">]</span> <span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">sols</span><span class="p">]</span>
<span class="n">L</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">ft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>This problem has two maxima, valued at 1, and two minima, with value -1.</p>
</section>
<section id="lec26">
<h2>Lec26<a class="headerlink" href="#lec26" title="Link to this heading">#</a></h2>
<p>In Lecture 26 of MCS 320, we consider two dimensional plots.</p>
<p><strong>1. The Graph of a Function</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">plot</span></code> function takes functions <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e^(-x^2)*sin(pi*x^3)
</pre></div>
</div>
</div>
</div>
<p>By assigning the output of <code class="docutils literal notranslate"><span class="pre">plot</span></code> to a variable, we separate the computation of the plot from the display.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pf</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/106afc888f163dd8ee748d6e3e42cfcda5aa200c5134d0e5a5f628b160c61ee3.png" src="../_images/106afc888f163dd8ee748d6e3e42cfcda5aa200c5134d0e5a5f628b160c61ee3.png" />
</div>
</div>
<p>The amplitude is defined by <span class="math notranslate nohighlight">\(\pm \exp(-x^2)\)</span>, let us add these two functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fplus</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">pf</span><span class="o">+</span><span class="n">fplus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/230693401267dba86ebb3d76aac35d90d98208b07249dd57ae19c80f5b6ed849.png" src="../_images/230693401267dba86ebb3d76aac35d90d98208b07249dd57ae19c80f5b6ed849.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fminus</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">pf</span><span class="o">+</span><span class="n">fplus</span><span class="o">+</span><span class="n">fminus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/77ecb6876d0b41ebc3332b01d1573d7553073acbb7eb7cfe959daa3d8679c0b9.png" src="../_images/77ecb6876d0b41ebc3332b01d1573d7553073acbb7eb7cfe959daa3d8679c0b9.png" />
</div>
</div>
<p>Consider another example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/748a289921de9cc15373f82ac833e763cb2a6ff6b072ba141b039db38024b1c0.png" src="../_images/748a289921de9cc15373f82ac833e763cb2a6ff6b072ba141b039db38024b1c0.png" />
</div>
</div>
<p>This is not an enteresting plot.  One improvement is to provide bounds on the <span class="math notranslate nohighlight">\(y\)</span>-values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/78c966741ae48296584e420b2a4d966df313f0ff74094f61ec62f0f4204501ec.png" src="../_images/78c966741ae48296584e420b2a4d966df313f0ff74094f61ec62f0f4204501ec.png" />
</div>
</div>
<p>The best plot for this example is when we ask to show the poles, which then displays the asymptotes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">detect_poles</span><span class="o">=</span><span class="s1">&#39;show&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e2bb55bc015f130ebfb104473643fb8469af57d94af8cc6b6ab91acc00ede7ae.png" src="../_images/e2bb55bc015f130ebfb104473643fb8469af57d94af8cc6b6ab91acc00ede7ae.png" />
</div>
</div>
<p><strong>2. Implicit Plots</strong></p>
<p>Many intesting curves are defined by equations <span class="math notranslate nohighlight">\(f(x,y) = 0\)</span>.  Consider a curve invented by James Watt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">watt</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mf">5.12</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">5.15</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mf">14.7456</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="n">watt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-5.15000000000000*x^4 + 5.15000000000000*y^4 + (x^2 + y^2)^3 + 5.12000000000000*(x^2 + y^2)^2 - 14.7456000000000*y^2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">implicit_plot</span><span class="p">(</span><span class="n">watt</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d1765323ae1f0cc378b9183541d74d43c14822ed647c6644d701f4b1aae390c9.png" src="../_images/d1765323ae1f0cc378b9183541d74d43c14822ed647c6644d701f4b1aae390c9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">implicit_plot</span><span class="p">(</span><span class="n">watt</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">plot_points</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c9e2e825ac6aa8d611c9619dc3a3fb225c7f1de03829d709df680d6d256ab220.png" src="../_images/c9e2e825ac6aa8d611c9619dc3a3fb225c7f1de03829d709df680d6d256ab220.png" />
</div>
</div>
<p>Observe the difference between the two plots.  When we use more points in the plot, the plot approaches the origin more.  But does the origin belong to the curve?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">watt</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Yes it does!</p>
<p><strong>3. Parametric Plots</strong></p>
<p>If the curve is defined by two functions <span class="math notranslate nohighlight">\(x(t)\)</span> and <span class="math notranslate nohighlight">\(y(t)\)</span> for the two coordinates <span class="math notranslate nohighlight">\((x = x(t), y = y(t))\)</span>, then the plotting can be done efficiently and accurately.  Consider a Lissajous curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">parametric_plot</span><span class="p">((</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0ab4d9ec5ace1fe695898726ace036a7e6086500ef8db7f947a6d8ca0ce97cff.png" src="../_images/0ab4d9ec5ace1fe695898726ace036a7e6086500ef8db7f947a6d8ca0ce97cff.png" />
</div>
</div>
<p><strong>4. Polar Plots</strong></p>
<p>In polar coordinates, a curve is represented by <span class="math notranslate nohighlight">\(r = f(t)\)</span>, with</p>
<div class="math notranslate nohighlight">
\[
    x = r \cos(t) \quad \mbox{and} \quad y = r \sin(t),
\]</div>
<p>where</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(r\)</span> is the radius of the point <span class="math notranslate nohighlight">\((x, y)\)</span>, its distance from the origin; and</p></li>
<li><p><span class="math notranslate nohighlight">\(t\)</span> is its argument, the angle of the vector ending in <span class="math notranslate nohighlight">\((x,y)\)</span> with the <span class="math notranslate nohighlight">\(x\)</span>-axis.</p></li>
</ol>
<p>Let us compute the polar representation of the curve defined in <code class="docutils literal notranslate"><span class="pre">watt</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">watt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-5.15000000000000*x^4 + 5.15000000000000*y^4 + (x^2 + y^2)^3 + 5.12000000000000*(x^2 + y^2)^2 - 14.7456000000000*y^2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r, t&#39;</span><span class="p">)</span>
<span class="n">pwatt</span> <span class="o">=</span> <span class="n">watt</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">pwatt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-5.15000000000000*r^4*cos(t)^4 + 5.15000000000000*r^4*sin(t)^4 - 14.7456000000000*r^2*sin(t)^2 + (r^2*cos(t)^2 + r^2*sin(t)^2)^3 + 5.12000000000000*(r^2*cos(t)^2 + r^2*sin(t)^2)^2
</pre></div>
</div>
</div>
</div>
<p>Observe the <span class="math notranslate nohighlight">\(\cos(t)^2 + \sin(t)^2\)</span> which can be simplified to one.  Let us simplify before solving.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spwatt</span> <span class="o">=</span> <span class="n">pwatt</span><span class="o">.</span><span class="n">trig_simplify</span><span class="p">()</span>
<span class="n">spwatt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1/4044180699863300*r^4*sin(t)^4 + r^6 - 1213254209959/40441806998633*r^4 + 2/25276129374145625*(130172066276849975*r^4 - 186355846649700864*r^2)*sin(t)^2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">spwatt</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[r == -1/10*sqrt(1/80883613997266*sin(t)^4 - 20827530604295996/40441806998633*sin(t)^2 + 1/80883613997266*sqrt(sin(t)^8 - 83310122417183984*sin(t)^6 + 1735144124291545345496293968519864*sin(t)^4 + 954572963783593651936794875955136*sin(t)^2 + 14719857779832372547816810000) + 60662710497950/40441806998633), r == 1/10*sqrt(1/80883613997266*sin(t)^4 - 20827530604295996/40441806998633*sin(t)^2 + 1/80883613997266*sqrt(sin(t)^8 - 83310122417183984*sin(t)^6 + 1735144124291545345496293968519864*sin(t)^4 + 954572963783593651936794875955136*sin(t)^2 + 14719857779832372547816810000) + 60662710497950/40441806998633), r == -1/10*sqrt(1/80883613997266*sin(t)^4 - 20827530604295996/40441806998633*sin(t)^2 - 1/80883613997266*sqrt(sin(t)^8 - 83310122417183984*sin(t)^6 + 1735144124291545345496293968519864*sin(t)^4 + 954572963783593651936794875955136*sin(t)^2 + 14719857779832372547816810000) + 60662710497950/40441806998633), r == 1/10*sqrt(1/80883613997266*sin(t)^4 - 20827530604295996/40441806998633*sin(t)^2 - 1/80883613997266*sqrt(sin(t)^8 - 83310122417183984*sin(t)^6 + 1735144124291545345496293968519864*sin(t)^4 + 954572963783593651936794875955136*sin(t)^2 + 14719857779832372547816810000) + 60662710497950/40441806998633), r == 0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>Observe that <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">==</span> <span class="pre">0</span></code> is one of the factors.  So we see that the curve passes through the origin.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">f1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1/10*sqrt(1/80883613997266*sin(t)^4 - 20827530604295996/40441806998633*sin(t)^2 + 1/80883613997266*sqrt(sin(t)^8 - 83310122417183984*sin(t)^6 + 1735144124291545345496293968519864*sin(t)^4 + 954572963783593651936794875955136*sin(t)^2 + 14719857779832372547816810000) + 60662710497950/40441806998633)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/583b988774b0b0a1af9d8d0164533a0008ccc43f90159d055b5e0a36f6dfaa97.png" src="../_images/583b988774b0b0a1af9d8d0164533a0008ccc43f90159d055b5e0a36f6dfaa97.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f2</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">(</span><span class="n">f2</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
<span class="n">p2</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/81dd27c5d25141ef9ec513bf65177d9ca2912c0fef86b34c480d606533489467.png" src="../_images/81dd27c5d25141ef9ec513bf65177d9ca2912c0fef86b34c480d606533489467.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f3</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">f3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1/10*sqrt(1/80883613997266*sin(t)^4 - 20827530604295996/40441806998633*sin(t)^2 - 1/80883613997266*sqrt(sin(t)^8 - 83310122417183984*sin(t)^6 + 1735144124291545345496293968519864*sin(t)^4 + 954572963783593651936794875955136*sin(t)^2 + 14719857779832372547816810000) + 60662710497950/40441806998633)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p3</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
<span class="n">p3</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>verbose 0 (3839: plot.py, generate_plot_points) WARNING: When plotting, failed to evaluate function at 198 points.
verbose 0 (3839: plot.py, generate_plot_points) Last error message: &#39;math domain error&#39;
</pre></div>
</div>
<img alt="../_images/599d7b838611fc2887cd7aef6cd703830506c9b59658614a36c92460b7e8d25e.png" src="../_images/599d7b838611fc2887cd7aef6cd703830506c9b59658614a36c92460b7e8d25e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">f3</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="o">/</span><span class="mf">10.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0,
 -1.31743435377368e-16 - 2.15153357636002*I,
 -1.98892849598223e-16 - 3.24816673242766*I,
 -1.98892849598223e-16 - 3.24816673242766*I,
 -1.31743435377368e-16 - 2.15153357636002*I,
 0,
 -1.31743435377368e-16 - 2.15153357636002*I,
 -1.98892849598223e-16 - 3.24816673242766*I,
 -1.98892849598223e-16 - 3.24816673242766*I,
 -1.31743435377368e-16 - 2.15153357636002*I]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f4</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">f4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/10*sqrt(1/80883613997266*sin(t)^4 - 20827530604295996/40441806998633*sin(t)^2 - 1/80883613997266*sqrt(sin(t)^8 - 83310122417183984*sin(t)^6 + 1735144124291545345496293968519864*sin(t)^4 + 954572963783593651936794875955136*sin(t)^2 + 14719857779832372547816810000) + 60662710497950/40441806998633)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">f4</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">k</span><span class="o">/</span><span class="mf">10.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0,
 1.31743435377368e-16 + 2.15153357636002*I,
 1.98892849598223e-16 + 3.24816673242766*I,
 1.98892849598223e-16 + 3.24816673242766*I,
 1.31743435377368e-16 + 2.15153357636002*I,
 0,
 1.31743435377368e-16 + 2.15153357636002*I,
 1.98892849598223e-16 + 3.24816673242766*I,
 1.98892849598223e-16 + 3.24816673242766*I,
 1.31743435377368e-16 + 2.15153357636002*I]
</pre></div>
</div>
</div>
</div>
<p>The third and fourth component cannot be plotted because of the complex values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="p">(</span><span class="n">p2</span><span class="o">+</span><span class="n">pt</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dc6ec66758b4d9000a40b4808a6b50139130a21e3a8db918539992bd3dff0290.png" src="../_images/dc6ec66758b4d9000a40b4808a6b50139130a21e3a8db918539992bd3dff0290.png" />
</div>
</div>
<p>As a <em>real</em> curve, the origin is an isolated point!</p>
</section>
<section id="lec27">
<h2>Lec27<a class="headerlink" href="#lec27" title="Link to this heading">#</a></h2>
<p>In Lecture 27 of MCS 320, we make three dimensional plots.</p>
<p><strong>1. Surfaces</strong></p>
<p>Surfaces can be defined explicitly, by a function <span class="math notranslate nohighlight">\(z = f(x,y)\)</span>, or implicitly by an equation.</p>
<p>Consider the surface <span class="math notranslate nohighlight">\(z = \cos(x y)\)</span>, for <span class="math notranslate nohighlight">\(x \in [-\pi, \pi]\)</span> and <span class="math notranslate nohighlight">\(y \in [-\pi, \pi]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">plot3d</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can change the aspect ratio, so the plot does not look that flat.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot3d</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">[-0.2194,-0.5297,-0.8193],142.51</span></code> is the viewpoint copied to the clipboard</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot3d</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">rotateX</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot3d</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="n">adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> \
    <span class="n">aspect_ratio</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;automatic&#39;</span><span class="p">,</span> <span class="n">num_colors</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Plot the surface defined by <span class="math notranslate nohighlight">\(z^3 - x^2 - y^2 = 0\)</span> for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> in <span class="math notranslate nohighlight">\([-1,1]\)</span> and for <span class="math notranslate nohighlight">\(z \in [0,1]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y, z&#39;</span><span class="p">)</span>
<span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>A surface can be defined in parameter form.  As a surface is two dimensional, there are two free parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;u, v&#39;</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">^</span><span class="nb">abs</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
<span class="n">fy</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">v</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">^</span><span class="nb">abs</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
<span class="n">fz</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">heart</span> <span class="o">=</span> <span class="n">parametric_plot3d</span><span class="p">([</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">fz</span><span class="p">],</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> \
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rotateX</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">heart</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>2. Space Curves</strong></p>
<p>The twisted cubic is an example of a space curve.  We can define it in parameter form, or as the intersection of two cylinders.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">twisted</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">parametric_plot3d</span><span class="p">(</span><span class="n">twisted</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The twisted cubic lies on a parabolic cylinder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="n">pt</span><span class="o">+</span><span class="n">c2</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The twisted cubic lies in the intersection of <span class="math notranslate nohighlight">\(x^2 - y = 0\)</span> and <span class="math notranslate nohighlight">\(x^3 - z = 0\)</span>, respectively a parabolic and a cubic cylinder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c3</span> <span class="o">=</span> <span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">z</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="n">pt</span><span class="o">+</span><span class="n">c2</span><span class="o">+</span><span class="n">c3</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>3. Four dimensional Plots</strong></p>
<p>The color coding of the surface can be used to make a complex plot, in four dimensions.  As example we consider the complex cube root, defined by the equation <span class="math notranslate nohighlight">\(z = w^3\)</span>.</p>
<p>The input is <span class="math notranslate nohighlight">\(w\)</span> and we have two parameters in the input, the real part of <span class="math notranslate nohighlight">\(w\)</span> and the imaginary part of <span class="math notranslate nohighlight">\(w\)</span>, which will be called <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;u, v&#39;</span><span class="p">,</span> <span class="n">domain</span> <span class="o">=</span> <span class="n">RR</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">u</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">v</span>
</pre></div>
</div>
</div>
</div>
<p>Observe that both <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code> are declared as real variables.</p>
<p>The output is <code class="docutils literal notranslate"><span class="pre">z</span></code> and we take its real and imaginary part, expressed in the real variables <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">w</span><span class="o">^</span><span class="mi">3</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">real_part</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">imag_part</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the real part of the output :&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the imaginary part of the output :&#39;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Instead of using the input <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code> as rectangular coordinates, we transition to polar coordinates for the input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r, t&#39;</span><span class="p">)</span>
<span class="n">rt</span> <span class="o">=</span> <span class="p">{</span><span class="n">u</span><span class="p">:</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">v</span><span class="p">:</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)}</span>
<span class="n">px</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">rt</span><span class="p">)</span>
<span class="n">py</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">rt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the polar form of the real part of the output :&#39;</span><span class="p">,</span> <span class="n">px</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the polar form of the imaginary part of the output :&#39;</span><span class="p">,</span> <span class="n">py</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The height of the three dimensional part corresponds to the real part of the input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametric_plot3d</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="n">adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The imaginary part of the input is represented via a colormap.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span> <span class="o">=</span> <span class="n">colormaps</span><span class="o">.</span><span class="n">autumn</span>
<span class="k">def</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">):</span> <span class="k">return</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cr</span> <span class="o">=</span> <span class="n">parametric_plot3d</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> \
    <span class="n">adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">cm</span><span class="p">))</span>
<span class="n">cr</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The colors show that, although the real parts are the same, the imaginary parts differ, so there is no intersection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cr</span> <span class="o">=</span> <span class="n">parametric_plot3d</span><span class="p">((</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> \
    <span class="n">adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">cm</span><span class="p">))</span><span class="o">.</span><span class="n">rotateX</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cr</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec28">
<h2>Lec28<a class="headerlink" href="#lec28" title="Link to this heading">#</a></h2>
<p>In Lecture 28 of MCS 320, we animate two and three dimensional plots.</p>
<p><strong>1. Increasing the Frequency</strong></p>
<p>Consider a periodic function, where the frequence is a parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">f</span></code> is a function in one variable <code class="docutils literal notranslate"><span class="pre">k</span></code> which controls the frequency of the expression for the periodic function with decaying amplitude.</p>
<p>An animation is a list of frames.  Let us plot the first two frames, for <code class="docutils literal notranslate"><span class="pre">k</span></code> equal to 1 and 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">one</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">two</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">two</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">onetwo</span> <span class="o">=</span> <span class="n">animate</span><span class="p">([</span><span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">])</span>
<span class="n">onetwo</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Even already in this very simple animation with two frames, we have already made the mistake of not fixing the range of <code class="docutils literal notranslate"><span class="pre">y</span></code> with <code class="docutils literal notranslate"><span class="pre">ymin</span></code> and <code class="docutils literal notranslate"><span class="pre">ymax</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">animate</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">iterations</span></code> we set the number of iterations (by default, the animation runs in a loop) and with <code class="docutils literal notranslate"><span class="pre">delay</span></code> we control the speed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">graphics_array</span></code> is convenient to display the frames in the animation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">graphics_array</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can save the animation as a <code class="docutils literal notranslate"><span class="pre">.gif</span></code> file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;ourfirstanimation.gif&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>2. A Moving Tangent Line</strong></p>
<p>Consider the tangent line to a moving point on the unit circle.</p>
<p>Consider an animation of the tangent line moving to any point on the unit circle.
First we make an animation of the moving point, using 10 frames.
The first frame draws the unit circle and the first point at angle <span class="math notranslate nohighlight">\(2 \pi/10\)</span>.</p>
<p>Instead of <code class="docutils literal notranslate"><span class="pre">implicit_plot</span></code>, we use the primitives <code class="docutils literal notranslate"><span class="pre">circle</span></code> and <code class="docutils literal notranslate"><span class="pre">line</span></code> for the circle and the tangent line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unitcircle</span> <span class="o">=</span> <span class="n">circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">firstpoint</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="p">(</span><span class="n">unitcircle</span><span class="o">+</span><span class="n">firstpoint</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we make a list of points.
The angle will be <span class="math notranslate nohighlight">\(2 k \pi/10\)</span>, for <span class="math notranslate nohighlight">\(k\)</span> ranging from 1 to 10.
In the animate we must give the xmin, xmax, ymin, ymax, because otherwise the point remains fixed
and the coordinate axes are moving.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movingpoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">animate</span><span class="p">(</span><span class="n">movingpoints</span><span class="p">,</span><span class="n">xmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">xmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For the tangent line, we know that vectors perpendicular to <span class="math notranslate nohighlight">\((\cos(t), \sin(t))\)</span>
are <span class="math notranslate nohighlight">\((-\sin(t),\cos(t))\)</span> and <span class="math notranslate nohighlight">\((\sin(t), -\cos(t))\)</span> which we use as the end points of the tangent line.  We define functions to make the points because we will generate lists of plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span>
<span class="n">v1</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span>
<span class="n">v2</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">v1</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">v1</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">pt</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">v1</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span><span class="n">pt</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">v1</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">B</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">((</span><span class="n">pt</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">v2</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span><span class="n">pt</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">v2</span><span class="p">(</span><span class="n">k</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tangentline1</span> <span class="o">=</span> <span class="n">line</span><span class="p">([</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">unitcircle</span><span class="o">+</span><span class="n">firstpoint</span><span class="o">+</span><span class="n">tangentline1</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we make the animation of 10 tangent lines.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movinglines</span> <span class="o">=</span> <span class="p">[</span><span class="n">unitcircle</span><span class="o">+</span><span class="n">line</span><span class="p">([</span><span class="n">A</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">B</span><span class="p">(</span><span class="n">k</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">animate</span><span class="p">(</span><span class="n">movinglines</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">xmin</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span><span class="n">xmax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">graphics_array</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">movinglines</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">movingpoints</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">animate</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span><span class="n">xmax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Let us look at all frames all at once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">graphics_array</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p><strong>3. Spin Plot of a Surface</strong></p>
<p>One useful animation of a surface is to make a spin plot.  We can spin a surface by rotating the x-, y-, or z-axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y, z&#39;</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Xframes</span> <span class="o">=</span> <span class="p">[</span><span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">rotateX</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Xa</span> <span class="o">=</span> <span class="n">animate</span><span class="p">(</span><span class="n">Xframes</span><span class="p">)</span>
<span class="n">Xa</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Yframes</span> <span class="o">=</span> <span class="p">[</span><span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ya</span> <span class="o">=</span> <span class="n">animate</span><span class="p">(</span><span class="n">Yframes</span><span class="p">)</span>
<span class="n">Ya</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Zframes</span> <span class="o">=</span> <span class="p">[</span><span class="n">implicit_plot3d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Za</span> <span class="o">=</span> <span class="n">animate</span><span class="p">(</span><span class="n">Zframes</span><span class="p">)</span>
<span class="n">Za</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>4. A Space Curve Knot</strong></p>
<p>A space curve is defined by functions in one parameter.  One natural animation is to extend the range of the parameter in each frame of the animation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">curve</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">z</span><span class="p">]</span>
<span class="n">parametric_plot3d</span><span class="p">(</span><span class="n">curve</span><span class="p">,(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">parametric_plot3d</span><span class="p">(</span><span class="n">curve</span><span class="p">,(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">20</span><span class="p">),</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">animate</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">zmin</span><span class="o">=-</span><span class="mi">3</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="lec29">
<h2>Lec29<a class="headerlink" href="#lec29" title="Link to this heading">#</a></h2>
<p>In this lecture 29 of MCS 320, we solve the equations for the Apollonius problem.</p>
<p><strong>1. Two Touching Circles</strong></p>
<p>In an earlier lectures, we considered the tangent line to a circle.  In this lecture we compute circles touching a number of given circles.  We start with one given circle and take one random point inside that circle as the center of the circle touching the given circle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unitcircle</span> <span class="o">=</span> <span class="n">circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">unitcircle</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/93af616229d2ffb3ab414220fa7cf3137cfbae81af64b2a4c05e7b2ef316aa83.png" src="../_images/93af616229d2ffb3ab414220fa7cf3137cfbae81af64b2a4c05e7b2ef316aa83.png" />
</div>
</div>
<p>Let us pick the random point at distance 1/2 of the center, defined by some random angle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angle</span> <span class="o">=</span> <span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="n">rpt</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
<span class="n">rpt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.482192224737109, -0.132252252922502)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ppt</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="n">rpt</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="p">(</span><span class="n">unitcircle</span><span class="o">+</span><span class="n">ppt</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/12d0e43bb5afc2f45521180bca587bea8eb4b05ccb390f36dd822aa1df7794ec.png" src="../_images/12d0e43bb5afc2f45521180bca587bea8eb4b05ccb390f36dd822aa1df7794ec.png" />
</div>
</div>
<p>What is now the radius of the circle which has the random point as center and that touches the unit circle?</p>
<p>Let us try 1/2, as 1/2 is 1 - 1/2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tc1</span> <span class="o">=</span> <span class="n">circle</span><span class="p">(</span><span class="n">rpt</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">unitcircle</span><span class="o">+</span><span class="n">ppt</span> <span class="o">+</span> <span class="n">tc1</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/134122148550b5ca4d5be6eee4e169a1699a965a6ad86fec23c058f832243b51.png" src="../_images/134122148550b5ca4d5be6eee4e169a1699a965a6ad86fec23c058f832243b51.png" />
</div>
</div>
<p>There is another, larger touching circle with radius 3/2 = 1 + 1/2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tc2</span> <span class="o">=</span> <span class="n">circle</span><span class="p">(</span><span class="n">rpt</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">unitcircle</span><span class="o">+</span><span class="n">ppt</span> <span class="o">+</span> <span class="n">tc1</span> <span class="o">+</span> <span class="n">tc2</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b64b77a17576797be6e2eeda83f52c2fbf08872eef59504e7dd383b8f43b568b.png" src="../_images/b64b77a17576797be6e2eeda83f52c2fbf08872eef59504e7dd383b8f43b568b.png" />
</div>
</div>
<p>The first touching circle <code class="docutils literal notranslate"><span class="pre">tc1</span></code> has radius 1/2 and
the 3/2 is the radius of the second touching circle <code class="docutils literal notranslate"><span class="pre">tc2</span></code>.
Their equations can be summarized by</p>
<div class="math notranslate nohighlight">
\[
    (x - c_x)^2 + (y - c_y)^2 - (1 \pm 1/2)^2 = 0,
\]</div>
<p>where <span class="math notranslate nohighlight">\((c_x, c_y)\)</span> is the center of the circle.</p>
<p><strong>2. The Problem of Apollonius</strong></p>
<p>With one given circle, we can fix one parameter of the touching circle, as we did in the example, we picked the two coordinates of the center and then determined the radius of the touching circle.  With one given circle, this problem has two degrees of freedom.  To fix two two degrees, we can give two more circles on input.</p>
<p>Here is then the Problem of Apollonius: <em>Given three circles, compute all circles that touch all three circles.</em></p>
<p>The input is determined by 9 numbers, two coordinates for each center and one radius for each circle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">c1x</span><span class="p">,</span> <span class="n">c1y</span><span class="p">,</span> <span class="n">r1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="n">c2x</span><span class="p">,</span> <span class="n">c2y</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="n">c3x</span><span class="p">,</span> <span class="n">c3y</span><span class="p">,</span> <span class="n">r3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In plotting the input, we transition to the <code class="docutils literal notranslate"><span class="pre">implicit_plot</span></code> because we will need the equations for solving.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">c1x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">c1y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">r1</span><span class="o">^</span><span class="mi">2</span>
<span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">c2x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">c2y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">r2</span><span class="o">^</span><span class="mi">2</span>
<span class="n">c3</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">c3x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">c3y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">r3</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xr</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="n">yr</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">xr</span><span class="p">,</span> <span class="n">yr</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="n">c2</span><span class="p">,</span> <span class="n">xr</span><span class="p">,</span> <span class="n">yr</span><span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="n">c3</span><span class="p">,</span> <span class="n">xr</span><span class="p">,</span> <span class="n">yr</span><span class="p">)</span>
<span class="p">(</span><span class="n">p1</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">+</span> <span class="n">p3</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/53d12f381dd69ec2fa0348c26b2f9331db3a712bab7c191008090e0827a09c6b.png" src="../_images/53d12f381dd69ec2fa0348c26b2f9331db3a712bab7c191008090e0827a09c6b.png" />
</div>
</div>
<p>The circle tangent to all three circles satisfies the following equations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">e1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">c1x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">c1y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">e2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">c2x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">c2y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">e3</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">c3x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">c3y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="n">r3</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">eqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">e3</span><span class="p">]</span>
<span class="n">eqs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-(r - 1)^2 + x^2 + y^2,
 -1/9*(3*r - 2)^2 + (x - 2)^2 + y^2,
 -1/9*(3*r - 1)^2 + (x - 1)^2 + (y - 1)^2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sols</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">eqs</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">solution_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{x: 7/468*sqrt(170) + 77/78,
  y: 7/156*sqrt(85)*sqrt(2) - 35/234,
  r: -1/936*sqrt(-90720*sqrt(170) + 1491120) + 1/3},
 {x: -7/468*sqrt(170) + 77/78,
  y: -7/156*sqrt(85)*sqrt(2) - 35/234,
  r: 1/78*sqrt(5)*sqrt(126*sqrt(170) + 2071) + 1/3}]
</pre></div>
</div>
</div>
</div>
<p>There are two solutions, let us plot them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s0x</span> <span class="o">=</span> <span class="n">sols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
<span class="n">s0y</span> <span class="o">=</span> <span class="n">sols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
<span class="n">s0r</span> <span class="o">=</span> <span class="n">sols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">r</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s0x</span><span class="p">,</span> <span class="n">s0y</span><span class="p">,</span> <span class="n">s0r</span><span class="p">)</span>
<span class="n">sc0</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">s0x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">s0y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s0r</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">s1x</span> <span class="o">=</span> <span class="n">sols</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">x</span><span class="p">]</span>
<span class="n">s1y</span> <span class="o">=</span> <span class="n">sols</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
<span class="n">s1r</span> <span class="o">=</span> <span class="n">sols</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">r</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s1x</span><span class="p">,</span> <span class="n">s1y</span><span class="p">,</span> <span class="n">s1r</span><span class="p">)</span>
<span class="n">sc1</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">s1x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">s1y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">s1r</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">p1</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">+</span> <span class="n">p3</span> <span class="o">+</span> <span class="n">sc0</span> <span class="o">+</span> <span class="n">sc1</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7/468*sqrt(170) + 77/78 7/156*sqrt(85)*sqrt(2) - 35/234 -1/936*sqrt(-90720*sqrt(170) + 1491120) + 1/3
-7/468*sqrt(170) + 77/78 -7/156*sqrt(85)*sqrt(2) - 35/234 1/78*sqrt(5)*sqrt(126*sqrt(170) + 2071) + 1/3
</pre></div>
</div>
<img alt="../_images/96c884fc7380092d552c4cc75036bebd850559c5c9d8f240d3314615473e5b5a.png" src="../_images/96c884fc7380092d552c4cc75036bebd850559c5c9d8f240d3314615473e5b5a.png" />
</div>
</div>
<p>There are three more pairs of solutions, obtained by changing <code class="docutils literal notranslate"><span class="pre">r-r1</span></code> into <code class="docutils literal notranslate"><span class="pre">r+r1</span></code> for the first pair, <code class="docutils literal notranslate"><span class="pre">r-r2</span></code> into <code class="docutils literal notranslate"><span class="pre">r+r2</span></code> for the second pair, and <code class="docutils literal notranslate"><span class="pre">r-r3</span></code> into <code class="docutils literal notranslate"><span class="pre">r+r3</span></code> for the third pair.  Computing and visualizing the solutions is left as an exercise.</p>
<p><strong>3. Groebner Bases</strong></p>
<p>A Groebner basis for a system of polynomials in lexicographic term order can be viewed as a generalization of the row reduced echelon form for linear systems.  Let us cast the equations from above into a polynomial ring with rational coefficients and a lexicographic term order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eqs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-(r - 1)^2 + x^2 + y^2,
 -1/9*(3*r - 2)^2 + (x - 2)^2 + y^2,
 -1/9*(3*r - 1)^2 + (x - 1)^2 + (y - 1)^2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="n">P</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multivariate Polynomial Ring in x, y, r over Rational Field
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">eqs</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>In order to define a Groebner basis, we have to declare an ideal, generated by the polynomials in Q.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="n">J</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ideal (x^2 + y^2 - r^2 + 2*r - 1, x^2 - 4*x + y^2 - r^2 + 4/3*r + 32/9, x^2 - 2*x + y^2 - 2*y - r^2 + 2/3*r + 17/9) of Multivariate Polynomial Ring in x, y, r over Rational Field
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left[x + \frac{1}{6} r - \frac{41}{36}, y + \frac{1}{2} r - \frac{11}{36}, r^{2} - \frac{71}{39} r - \frac{253}{468}\right]</script></html></div></div>
</div>
<p>Observe the nice structure of <code class="docutils literal notranslate"><span class="pre">G</span></code>.  The last equation is quadratic in one variable <code class="docutils literal notranslate"><span class="pre">r</span></code>.  Once we have the two values for <code class="docutils literal notranslate"><span class="pre">r</span></code>, we can write the coordinates for <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>The symbolic-numeric manner to solve the system is over <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J</span><span class="o">.</span><span class="n">variety</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{r: -0.2598568419594498?, y: 0.4354839765352805?, x: 1.182198362548798?},
 {r: 2.080369662472271?, y: -0.7346292756805796?, x: 0.7921606118101772?}]
</pre></div>
</div>
</div>
</div>
<p>The coordinate values of the solutions are intervals.</p>
</section>
<section id="lec30">
<h2>Lec30<a class="headerlink" href="#lec30" title="Link to this heading">#</a></h2>
<p>In Lecture 30 of MCS 320, we do linear algebra.</p>
<p><strong>1. Systems of Linear Equations</strong></p>
<p>Let us define a random 3-by-3 system over the rational numbers, with numerators and denominators bounded by 100.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">num_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">den_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  -5/4 -57/79  13/25]
[-11/84 -37/31 -34/93]
[ -11/9     46  -1/18]
</pre></div>
</div>
</div>
</div>
<p>The matrix A is the coefficient matrix of our random linear system.  The right hand side vector is random vector with the same bounds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">random_vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">num_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">den_bound</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-22/43, -87/41, -62/27)
</pre></div>
</div>
</div>
</div>
<p>The backslash operator (not to confuse with the division operator) is a convenient operator to solve the linear system defined by the coefficient matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> and the right hand side vector <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">A</span>\<span class="n">b</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5005572229574/2065559623287, 252208486789/12393357739722, 3352882185150/688519874429)
</pre></div>
</div>
</div>
</div>
<p>The residual vector is the difference between <code class="docutils literal notranslate"><span class="pre">b</span></code> and the product of <code class="docutils literal notranslate"><span class="pre">A</span></code> with the solution <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 0, 0)
</pre></div>
</div>
</div>
</div>
<p>We solved a random system over the rational numbers.  Observe the expression swell in the numbers of the solution <code class="docutils literal notranslate"><span class="pre">x</span></code>.  We started out with numbers not longer than two decimal places and ended with numbers of more than six decimal places.  And that only for 3-dimensional problems.</p>
<p>We can define matrices via a formula.  For example, the <span class="math notranslate nohighlight">\((i,j)\)</span>-th element of the Hilbert matrix is <span class="math notranslate nohighlight">\(1/(i+j)\)</span> for <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> starting at 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1/2 1/3 1/4 1/5]
[1/3 1/4 1/5 1/6]
[1/4 1/5 1/6 1/7]
[1/5 1/6 1/7 1/8]
</pre></div>
</div>
</div>
</div>
<p><strong>2. Matrix Factorizations</strong></p>
<p>The four important matrix factorizations are</p>
<ol class="arabic simple">
<li><p>The LU factorization.</p></li>
<li><p>The QR factorization.</p></li>
<li><p>The Eigenvalue Decomposition.</p></li>
<li><p>The Singular Value Decomposition.</p></li>
</ol>
<p>We work on the random 3-dimensional matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> from above to illustrate those four factorizations.</p>
<blockquote>
<div><p>2.1 the LU factorization</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LU</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 0 0]
[0 0 1]
[0 1 0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[              1               0               0]
[          44/45               1               0]
[         11/105 -143739/6005041               1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[                -5/4               -57/79                13/25]
[                   0           55346/1185             -141/250]
[                   0                    0 -390538783/900756150]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">*</span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  -5/4 -57/79  13/25]
[ -11/9     46  -1/18]
[-11/84 -37/31 -34/93]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">*</span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  -5/4 -57/79  13/25]
[ -11/9     46  -1/18]
[-11/84 -37/31 -34/93]
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>2.2 the QR decomposition</p>
</div></blockquote>
<p>For the QR decomposition, we must convert the matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">rows</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(-5/4, -57/79, 13/25), (-11/84, -37/31, -34/93), (-11/9, 46, -1/18)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CDF</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">A</span><span class="o">.</span><span class="n">rows</span><span class="p">()]</span>
<span class="n">nbrs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-1.25, -0.7215189873417721, 0.52],
 [-0.13095238095238096, -1.1935483870967742, -0.3655913978494624],
 [-1.2222222222222223, 46.0, -0.05555555555555555]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">CDF</span><span class="p">,</span> <span class="n">nbrs</span><span class="p">)</span>
<span class="n">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[               -1.25  -0.7215189873417721                 0.52]
[-0.13095238095238096  -1.1935483870967742  -0.3655913978494624]
[ -1.2222222222222223                 46.0 -0.05555555555555555]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">QR</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">*</span><span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[    1.0000000000000004  5.551115123125783e-17 1.8648277366750676e-16]
[ 5.551115123125783e-17     1.0000000000000002 -7.632783294297951e-17]
[1.8648277366750676e-16 -7.632783294297951e-17                    1.0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[    1.75313310577689   -31.46596530702512  -0.3047251230768725]
[                 0.0    33.58330202196513  -0.3597878656704642]
[                 0.0                  0.0 -0.42992880924251553]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="o">*</span><span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ -1.2500000000000002    -0.72151898734176   0.5200000000000001]
[-0.13095238095238096    -1.19354838709677  -0.3655913978494625]
[ -1.2222222222222223                 46.0 -0.05555555555555543]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[               -1.25  -0.7215189873417721                 0.52]
[-0.13095238095238096  -1.1935483870967742  -0.3655913978494624]
[ -1.2222222222222223                 46.0 -0.05555555555555555]
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>2.3 the Eigenvalue Decomposition</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.449367248669314?, -0.524868346991509? - 4.145964620413456?*I, -0.524868346991509? + 4.145964620413456?*I]
</pre></div>
</div>
</div>
</div>
<p>The eigenvalue problem is equivalent to finding the roots of the characteristic polynomial and for this, the transition to algebraic numbers happens automatically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_eigenmatrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rrr}
-1.449367248669314? & 0 & 0 \\
0 & -0.524868346991509? - 4.145964620413456? \sqrt{-1} & 0 \\
0 & 0 & -0.524868346991509? + 4.145964620413456? \sqrt{-1}
\end{array}\right)</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rrr}
1 & 1 & 1 \\
0.03664640772965092? & -0.691282990049901? + 0.04152266990464062? \sqrt{-1} & -0.691282990049901? - 0.04152266990464062? \sqrt{-1} \\
-0.3325503262971190? & 0.4353035578097981? - 7.915394664754103? \sqrt{-1} & 0.4353035578097981? + 7.915394664754103? \sqrt{-1}
\end{array}\right)</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rrr}
-1.449367248669314? & -0.524868346991509? - 4.145964620413456? \sqrt{-1} & -0.524868346991509? + 4.145964620413456? \sqrt{-1} \\
-0.05311410314473801? & 0.5349840806605853? + 2.844240884324994? \sqrt{-1} & 0.5349840806605853? - 2.844240884324994? \sqrt{-1} \\
0.4819875514693377? & -33.04542329550710? + 2.349786963655363? \sqrt{-1} & -33.04542329550710? - 2.349786963655363? \sqrt{-1}
\end{array}\right)</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\left(\begin{array}{rrr}
-1.449367248669314? & -0.524868346991509? - 4.145964620413456? \sqrt{-1} & -0.524868346991509? + 4.145964620413456? \sqrt{-1} \\
-0.05311410314473801? & 0.5349840806605853? + 2.844240884324994? \sqrt{-1} & 0.5349840806605853? - 2.844240884324994? \sqrt{-1} \\
0.4819875514693377? & -33.04542329550710? + 2.349786963655363? \sqrt{-1} & -33.04542329550710? - 2.349786963655363? \sqrt{-1}
\end{array}\right)</script></html></div></div>
</div>
<p>We see that <span class="math notranslate nohighlight">\(V D = A V\)</span> or equivalently: <span class="math notranslate nohighlight">\(D = V^{-1} A V\)</span>, or <span class="math notranslate nohighlight">\(A = V D V^{-1}\)</span>.</p>
<blockquote>
<div><p>2.4 Singular Value Decomposition</p>
</div></blockquote>
<p>To compute the Singular Value Decompsition, we must again use the matrix of <code class="docutils literal notranslate"><span class="pre">CDF</span></code> type, and work over the complex double field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">SVD</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Both <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code> are orthogonal matrices, that is: their transpose is the inverse matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="o">*</span><span class="n">U</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[     1.0000000000000002   1.700029006457271e-16  1.7580338226852454e-16]
[  1.700029006457271e-16      1.0000000000000002 -2.0469737016526324e-16]
[ 1.7580338226852454e-16 -2.0469737016526324e-16                     1.0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span><span class="o">*</span><span class="n">V</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[     0.9999999999999991 -2.2551405187698492e-17   5.551115123125783e-17]
[-2.2551405187698492e-17                     1.0                     0.0]
[  5.551115123125783e-17                     0.0      0.9999999999999996]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[46.036789227343746                0.0                0.0]
[               0.0 1.3707314283740828                0.0]
[               0.0                0.0 0.4011228818407111]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[      46.03678922734373   4.163336342344337e-17 -2.0816681711721685e-16]
[   8.35909032964599e-15       1.370731428374083 -3.3306690738754696e-16]
[  1.710491557421756e-15  2.7755575615628914e-17     0.40112288184071115]
</pre></div>
</div>
</div>
</div>
<p><strong>3. Matrices over Rings</strong></p>
<p>The Hermite normal form is computed with a unimodular matrix.  We make a random integer matrix with numbers that are 3 decimal places long, that is: in the range 100 and 999.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">999</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[503 842 787]
[599 828 414]
[857 948 500]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">H</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[       1        0  5995442]
[       0        2 12585079]
[       0        0 27081514]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  15690  -27092    9727]
[  32935  -56869   20418]
[  70872 -122375   43937]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="o">*</span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[       1        0  5995442]
[       0        2 12585079]
[       0        0 27081514]
</pre></div>
</div>
</div>
</div>
<p>Not all integer matrices are invertible, but unimodular matrices are those with inverses with integer coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[       1        0        0]
[       0        1        0]
[       0        0 54163028]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[       1        0        0]
[       0        1        0]
[       0        0 54163028]
</pre></div>
</div>
</div>
</div>
<p><strong>4. Resultants</strong></p>
<p>The resultant is the determinant of the Sylvester matrix, used to eliminate variables in polynomial systems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-1/2*x^2 + 2*x*y + 1/2*y^2 + 1/3*x, 5*y^2 - 3*x + y - 3)
</pre></div>
</div>
</div>
</div>
<p>The resultant of the system defined by <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> with respect to <code class="docutils literal notranslate"><span class="pre">x</span></code> is the condition on <code class="docutils literal notranslate"><span class="pre">y</span></code> for the system to have solutions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-25/2*y^4 + 25*y^3 + 30*y^2 - 14*y - 15/2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-25/2*y^4 + 25*y^3 + 30*y^2 - 14*y - 15/2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">sylvester_matrix</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">S</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[           -3 5*y^2 + y - 3             0]
[            0            -3 5*y^2 + y - 3]
[         -1/2     2*y + 1/3       1/2*y^2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">det</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-25/2*y^4 + 25*y^3 + 30*y^2 - 14*y - 15/2
</pre></div>
</div>
</div>
</div>
<p>Computing the roots of this polynomial will give all y-coordinates of the solutions.</p>
</section>
<section id="lec31">
<h2>Lec31<a class="headerlink" href="#lec31" title="Link to this heading">#</a></h2>
<p>In Lecture 31 of MCS 320, we study differential equations, using the pendulum problem as the running example.</p>
<p><strong>1. The Pendulum</strong></p>
<p>A first model of the pendulum is a second order equation</p>
<div class="math notranslate nohighlight">
\[
    L \frac{d^2}{d~\!t} \theta(t) = -g \theta(t),
\]</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is the length of the string and <span class="math notranslate nohighlight">\(g\)</span> the gravitational constant,</p>
<p>subject to initial conditions</p>
<div class="math notranslate nohighlight">
\[
    \theta(0) = \pi/10, \theta'(0) = 0.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;g, L&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We have to assume that both <code class="docutils literal notranslate"><span class="pre">g</span></code> and <code class="docutils literal notranslate"><span class="pre">L</span></code> are positive, otherwise the symbolic solver will not work.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ode</span> <span class="o">=</span> <span class="n">L</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span> <span class="n">g</span><span class="o">*</span><span class="n">theta</span>
<span class="n">show</span><span class="p">(</span><span class="n">ode</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle L \frac{\partial^{2}}{(\partial t)^{2}}\theta\left(t\right) = -g \theta\left(t\right)\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_K2*cos(sqrt(g)*t/sqrt(L)) + _K1*sin(sqrt(g)*t/sqrt(L))
</pre></div>
</div>
</div>
</div>
<p>As this is a second order equation, we have two families of solutions, with parameters <code class="docutils literal notranslate"><span class="pre">_K1</span></code> and <code class="docutils literal notranslate"><span class="pre">_K2</span></code>.  When we specify the two initial conditions, we obtain a unique solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/10*pi*cos(sqrt(g)*t/sqrt(L))
</pre></div>
</div>
</div>
</div>
<p>Let us look at a particular instance for the symbolic parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ft</span> <span class="o">=</span> <span class="n">sol</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/10*pi*cos(1/3*sqrt(10)*sqrt(3)*t)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">ft</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b604a5b2a086cb78762357e2c2437771ddeee10d7cd71377fe3c974c9524fa29.png" src="../_images/b604a5b2a086cb78762357e2c2437771ddeee10d7cd71377fe3c974c9524fa29.png" />
</div>
</div>
<p>Observe that the 0.3 corresponds to the <span class="math notranslate nohighlight">\(\pi/10\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sin</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.309016994374947
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.314159265358979
</pre></div>
</div>
</div>
</div>
<p><strong>2. Solving with Laplace transforms</strong></p>
<p>The short, direct way to solve this problem with Laplace transforms is as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_laplace</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">ivar</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(L^2*sin(sqrt(L*g)*t/L)*D[0](theta)(0)/sqrt(L*g) + L*cos(sqrt(L*g)*t/L)*theta(0))/L
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init</span> <span class="o">=</span> <span class="p">{</span><span class="n">theta</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> <span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">diff</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">t</span><span class="p">:</span><span class="mi">0</span><span class="p">}):</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">init</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{theta(0): 1/10*pi, D[0](theta)(0): 0}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/10*pi*cos(sqrt(L*g)*t/L)
</pre></div>
</div>
</div>
</div>
<p>It is instructive to look at the long way to use Laplace transforms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">Lode</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">Lode</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(s^2*laplace(theta(t), t, s) - s*theta(0) - D[0](theta)(0))*L == -g*laplace(theta(t), t, s)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="n">Teq</span> <span class="o">=</span> <span class="n">Lode</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">laplace</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">):</span> <span class="n">T</span><span class="p">})</span>
<span class="n">Teq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(T*s^2 - s*theta(0) - D[0](theta)(0))*L == -T*g
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Teq</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[T == (L*s*theta(0) + L*D[0](theta)(0))/(L*s^2 + g)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ts</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>
<span class="n">Ts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/10*pi*L*s/(L*s^2 + g)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ft</span> <span class="o">=</span> <span class="n">inverse_laplace</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">ft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/10*pi*cos(sqrt(L*g)*t/L)
</pre></div>
</div>
</div>
</div>
<p><strong>3. Plotting the Slope Field</strong></p>
<p>The slope field shows the velocities.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one</span> <span class="o">=</span> <span class="n">ft</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">one</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/10*pi*cos(sqrt(10)*t)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">oneplot</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">oneplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c0d9e51dd9885385389ea497c67b0c1463ea31cae73fe9abfa64da43f3888e83.png" src="../_images/c0d9e51dd9885385389ea497c67b0c1463ea31cae73fe9abfa64da43f3888e83.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slopes</span> <span class="o">=</span> <span class="n">plot_slope_field</span><span class="p">(</span><span class="n">v</span><span class="o">-</span><span class="n">one</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                          <span class="n">headlength</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">headaxislength</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">oneplot</span><span class="o">+</span><span class="n">slopes</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/07a322bced79dffa856de382d388216ea1a79951f897626c36a8b67bd3a1c0ee.png" src="../_images/07a322bced79dffa856de382d388216ea1a79951f897626c36a8b67bd3a1c0ee.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dtone</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">dtone</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1/10*sqrt(10)*pi*sin(sqrt(10)*t)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dtoneplot</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">dtone</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">dtoneplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/87d5dfce6e5332878c4d59be9450c22eef275a5be5196aa2532886270ea9acd9.png" src="../_images/87d5dfce6e5332878c4d59be9450c22eef275a5be5196aa2532886270ea9acd9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slopefield</span> <span class="o">=</span> <span class="n">oneplot</span><span class="o">+</span><span class="n">dtoneplot</span><span class="o">+</span><span class="n">slopes</span>
<span class="n">slopefield</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/34ed162caa5d038deac1ab6426e67fd832c035d9df914ab66ba19c3c40c6315a.png" src="../_images/34ed162caa5d038deac1ab6426e67fd832c035d9df914ab66ba19c3c40c6315a.png" />
</div>
</div>
<p><strong>4. The Pendulum with Damping</strong></p>
<p>Set <span class="math notranslate nohighlight">\(g/L = 10\)</span> and assume the damping constant to be 1.2.  The damping is proportional to the velocity.</p>
<div class="math notranslate nohighlight">
\[
    \frac{d^2}{d~\!t^2} \theta(t) = - 1.2 \frac{d}{d~\!t} \theta(t) - 10 \sin(\theta(t)).
\]</div>
<p>To turn this is into a system of first order differential equations, we introduce</p>
<div class="math notranslate nohighlight">
\[
    \frac{d}{d~\!t} \theta(t) = v(t)
\]</div>
<p>and obtain</p>
<div class="math notranslate nohighlight">
\[
    \frac{d}{d~\!t} v(t) = - 1.2 v(t) - 10 \sin(\theta(t))
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;theta, v&#39;</span><span class="p">)</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<span class="n">rhs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[v, -1.20000000000000*v - 10*sin(theta)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">initc</span> <span class="o">=</span> <span class="p">[</span><span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">initc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.314159265358979, 0.000000000000000]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endtime</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="n">step</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">trange</span> <span class="o">=</span> <span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_odeint</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="n">initc</span><span class="p">,</span><span class="n">trange</span><span class="p">,[</span><span class="n">theta</span><span class="p">,</span><span class="n">v</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angles</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">trange</span><span class="p">,</span> <span class="n">angles</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8827594cb2168e536ad183c3ae3c79692f1f507667f0e34acf2ce7fb9ba7dab8.png" src="../_images/8827594cb2168e536ad183c3ae3c79692f1f507667f0e34acf2ce7fb9ba7dab8.png" />
</div>
</div>
</section>
<section id="lec32">
<h2>Lec32<a class="headerlink" href="#lec32" title="Link to this heading">#</a></h2>
<p>In Lecture 32 of MCS 320, we consider polyhedral and unconstrained optimization.</p>
<p><strong>1. Polyhedra</strong></p>
<p>Every polyhedron can be defined in two ways:</p>
<ol class="arabic simple">
<li><p>As the convex hull of a list of points.</p></li>
<li><p>As the intersection of half spaces.</p></li>
</ol>
<p>Let us generate 10 random points with integer coordinates between 10 and 99.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">20220722</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">xvals</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">yvals</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pts</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span><span class="n">yvals</span><span class="p">)]</span>
<span class="n">pts</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">pts</span><span class="p">)</span>
<span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.</span><span class="n">Hrepresentation</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>2. Linear Programming</strong></p>
<p>Linear programming deals with optimizing linear functions
subject to linear constraints.  We consider an example of the documentation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">MixedIntegerLinearProgram</span><span class="p">(</span><span class="n">maximization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">new_variable</span><span class="p">(</span><span class="n">nonnegative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>What is returned is the value of the objective function.  To see the values of the coordinates at the optimal solution, we do the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This problem can be solved interactively, in a step by step fashion.</p>
<p>We first convert the problem to its standard form.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">InteractiveLPProblem</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">],</span> <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">constraint_type</span><span class="o">=</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="n">variable_type</span><span class="o">=</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">)</span>
<span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">standard_form</span><span class="p">()</span>
<span class="n">F</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">display</span> typeset
<span class="n">F</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">display</span> typeset
<span class="n">F</span><span class="o">.</span><span class="n">run_simplex_method</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can also run the simplex method step-by-step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">initial_dictionary</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We ask for the solution, whether the solution is optional,
and the value of the objective function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">basic_solution</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">is_optimal</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">objective_value</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The simplex algorithm consists in swapping variables.
Variables in the basis are swapped with variables not in the basis.
We can ask for the possible variables which can enter the basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">basic_variables</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">nonbasic_variables</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">etr</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">possible_entering</span><span class="p">()</span>
<span class="n">etr</span>
</pre></div>
</div>
</div>
</div>
<p>We select the first of the possible entering variables.
After setting the entering variable, we ask for the possible variables
which can leave the basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">enter</span><span class="p">(</span><span class="n">etr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">lev</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">possible_leaving</span><span class="p">()</span>
<span class="n">lev</span>
</pre></div>
</div>
</div>
</div>
<p>We select the leaving variable and update the dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">leave</span><span class="p">(</span><span class="n">lev</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">D</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Should we continue?  Let us check if the dictionary is optimal
and what the objective value is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">is_optimal</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">objective_value</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>To continue, let us ask for the possible variables which may enter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">etr</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">possible_entering</span><span class="p">()</span>
<span class="n">etr</span>
</pre></div>
</div>
</div>
</div>
<p>After selecting the entering variable,
we ask for the possible variables which may leave.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">enter</span><span class="p">(</span><span class="n">etr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">lev</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">possible_leaving</span><span class="p">()</span>
<span class="n">lev</span>
</pre></div>
</div>
</div>
</div>
<p>After selecting the leaving variable, we update the basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">leave</span><span class="p">(</span><span class="n">lev</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">D</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we check again for optimality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">is_optimal</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="o">.</span><span class="n">objective_value</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>3. Unconstrained Minimization</strong></p>
<p>To introduce minimization without constraints, we take a sum of squares function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">plot3d</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;automatic&#39;</span><span class="p">,</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">aspect_ratio</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">pf</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can look for a minimum.  We need to give an initial guess.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;minimum at&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;with value&#39;</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">pt</span><span class="o">+</span><span class="n">pf</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Even though this problem was defined to be straighforward, observe that the optimum lies in a valley.</p>
</section>
<section id="lec33">
<h2>Lec33<a class="headerlink" href="#lec33" title="Link to this heading">#</a></h2>
<p>We introduce interacts to give the user control over plots.</p>
<p><strong>1. Making Plot with a Parameter</strong></p>
<p>Code adapted from Sage for Undergraduates by Gregory Bard,
pages 285 in Figure 1.</p>
<p>Consider the tangent line to <span class="math notranslate nohighlight">\(y = f(x)\)</span> at the point <span class="math notranslate nohighlight">\(x_0\)</span>.  We can make the plot where <span class="math notranslate nohighlight">\(x_0\)</span> is a parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x |--&gt; x^3 - x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x |--&gt; 3*x^2 - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">tangent_at_point</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shows the tangent line at the point x0,</span>
<span class="sd">    using f and its derivative as global variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">df</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="c1"># y - y0 = slope*(x - x0) implies</span>
    <span class="c1"># y = slope*x - slope*x0 + y0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">slope</span><span class="o">*</span><span class="n">x0</span>
    <span class="n">P1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">gridlines</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">)</span>
    <span class="n">P2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">slope</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tan&#39;</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">P3</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">P1</span><span class="o">+</span><span class="n">P2</span><span class="o">+</span><span class="n">P3</span>
    <span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tangent_at_point</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9b3155b5f78ec204ee1c2f32e616c8f80e70d5c6a83d25efd845a3ea9e9a24ae.png" src="../_images/9b3155b5f78ec204ee1c2f32e616c8f80e70d5c6a83d25efd845a3ea9e9a24ae.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tangent_at_point</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/23b1230a0d41012da2d1555e52e5994c1509341938ec77a79348eeeb38ff4385.png" src="../_images/23b1230a0d41012da2d1555e52e5994c1509341938ec77a79348eeeb38ff4385.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tangent_at_point</span><span class="p">(</span><span class="o">-</span><span class="mf">1.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/acdd0800c5a72efa87594b98617b1d39638c904fbdc910259a80c6e359e3a9dd.png" src="../_images/acdd0800c5a72efa87594b98617b1d39638c904fbdc910259a80c6e359e3a9dd.png" />
</div>
</div>
<p><strong>2. Adding a Slider</strong></p>
<p>Code adapted from Sage for Undergraduates by Gregory Bard,
pages 285 in Figure 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@interact</span>
<span class="k">def</span><span class="w"> </span><span class="nf">tangent_at_point</span><span class="p">(</span><span class="n">x0</span> <span class="o">=</span> <span class="n">slider</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x-coordinate&#39;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shows the tangent line at the point x0,</span>
<span class="sd">    using f and its derivative as global variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">df</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="c1"># y - y0 = slope*(x - x0) implies</span>
    <span class="c1"># y = slope*x - slope*x0 + y0</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">slope</span><span class="o">*</span><span class="n">x0</span>
    <span class="n">P1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">gridlines</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">)</span>
    <span class="n">P2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">slope</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tan&#39;</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">6</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">P3</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">P1</span><span class="o">+</span><span class="n">P2</span><span class="o">+</span><span class="n">P3</span>
    <span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Widget Javascript not detected.  It may not be installed or enabled properly. Reconnecting the current kernel may help.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "febf189475744ea788feec945f94d039"}</script></div>
</div>
<p><strong>3. Adding a Selector</strong></p>
<p>We can add a selector, for example in a color plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reset()</span>
<span class="n">fun</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span>
<span class="n">rng</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nd">@interact</span>
<span class="k">def</span><span class="w"> </span><span class="nf">colorplot</span><span class="p">(</span><span class="n">colrgb</span><span class="o">=</span><span class="n">selector</span><span class="p">([</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;color: &#39;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the expression defined by fun over the range in rng.</span>
<span class="sd">    The parameters fun and rng must be defined before calling colorplot.</span>
<span class="sd">    The user can select the color.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colrgb</span><span class="p">)</span>
    <span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Widget Javascript not detected.  It may not be installed or enabled properly. Reconnecting the current kernel may help.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f645ae53c4954fc8992684c125c1d756"}</script></div>
</div>
</section>
<section id="lec34">
<h2>Lec34<a class="headerlink" href="#lec34" title="Link to this heading">#</a></h2>
<p>We demonstrate an application of an interact.</p>
<p><strong>The Chebyshev Four Bar Mechanism</strong></p>
<p>The Chebyshev mechanism translates circular motion into linear motion, and vice versa.</p>
<p><strong>1. The Crank</strong></p>
<p>We will make a interactive web page to model a four bar mechanism.
The mechanism is attributed to Chebyshev and transmits straight to circular motion.
Let us first start with the making of an interact for a crank.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@interact</span>
<span class="k">def</span><span class="w"> </span><span class="nf">show_crank</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="n">slider</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;angle&#39;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shows the drawing of a crank, where the user can slide the angle</span>
<span class="sd">    to turn the crank.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">endpnt</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
    <span class="n">pltcnt</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">pltend</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="n">endpnt</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">crank</span> <span class="o">=</span> <span class="n">line</span><span class="p">([</span><span class="n">center</span><span class="p">,</span> <span class="n">endpnt</span><span class="p">])</span>
    <span class="p">(</span><span class="n">pltcnt</span><span class="o">+</span><span class="n">crank</span><span class="o">+</span><span class="n">pltend</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">xmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Widget Javascript not detected.  It may not be installed or enabled properly. Reconnecting the current kernel may help.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4580711b7bab47808bb1f92d998c3f0f"}</script></div>
</div>
<p>Notice that the <code class="docutils literal notranslate"><span class="pre">aspect_ratio</span> <span class="pre">=</span> <span class="pre">1</span></code> is missing.  But it is good enough as a start.</p>
<p><strong>2. The Connector Coordinates</strong></p>
<p>There is a bar connected to the end point of the crank.
The end point of that bar is connected to another bar, of length 5/2,
that originates at (2,0).
To find the coordinates of the connector point, we intersect two circles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">c</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">s</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x^2 - 2*x*c + y^2 - 2*y*s + c^2 + s^2 - 25/4, x^2 - 4*x + y^2 - 9/4)
</pre></div>
</div>
</div>
</div>
<p>With the resultant we get symbolic values for the coordinates,
in function of the end point coordinates (c, s) of the crank.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ry</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">ry</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4*y^2*c^2 - 16*y^2*c + 4*y^2*s^2 + 16*y^2 - 4*y*c^2*s + 16*y*c*s - 4*y*s^3 - 16*y*s + c^4 - 8*c^3 + 2*c^2*s^2 - c^2 - 8*c*s^2 + 68*c + s^4 + 8*s^2 - 84
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rx</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">resultant</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">rx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4*x^2*c^2 - 16*x^2*c + 4*x^2*s^2 + 16*x^2 - 4*x*c^3 + 8*x*c^2 - 4*x*c*s^2 + 16*x*c - 8*x*s^2 - 32*x + c^4 + 2*c^2*s^2 - 8*c^2 + s^4 - 17*s^2 + 16
</pre></div>
</div>
</div>
</div>
<p>To solve the polynomials for x and y, we must convert back to the Symbolic Ring (SR).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y,c,s&#39;</span><span class="p">)</span>
<span class="n">sx</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">rx</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>
<span class="n">sx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x == 1/2*(c^3 + (c + 2)*s^2 - 2*c^2 - sqrt(-c^4 - s^4 + 8*c^3 - (2*c^2 - 8*c - 17)*s^2 + c^2 - 68*c + 84)*s - 4*c + 8)/(c^2 + s^2 - 4*c + 4), x == 1/2*(c^3 + (c + 2)*s^2 - 2*c^2 + sqrt(-c^4 - s^4 + 8*c^3 - (2*c^2 - 8*c - 17)*s^2 + c^2 - 68*c + 84)*s - 4*c + 8)/(c^2 + s^2 - 4*c + 4)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sy</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">SR</span><span class="p">(</span><span class="n">ry</span><span class="p">),</span><span class="n">y</span><span class="p">)</span>
<span class="n">sy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[y == 1/2*(s^3 + (c^2 - 4*c + 4)*s - sqrt(-c^4 - s^4 + 8*c^3 - (2*c^2 - 8*c - 17)*s^2 + c^2 - 68*c + 84)*(c - 2))/(c^2 + s^2 - 4*c + 4), y == 1/2*(s^3 + (c^2 - 4*c + 4)*s + sqrt(-c^4 - s^4 + 8*c^3 - (2*c^2 - 8*c - 17)*s^2 + c^2 - 68*c + 84)*(c - 2))/(c^2 + s^2 - 4*c + 4)]
</pre></div>
</div>
</div>
</div>
<p>We take the second solution as coordinates for x
and the first solution for the coordinates for y.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xv</span> <span class="o">=</span> <span class="n">sx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">xv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/2*(c^3 + (c + 2)*s^2 - 2*c^2 + sqrt(-c^4 - s^4 + 8*c^3 - (2*c^2 - 8*c - 17)*s^2 + c^2 - 68*c + 84)*s - 4*c + 8)/(c^2 + s^2 - 4*c + 4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yv</span> <span class="o">=</span> <span class="n">sy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">yv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/2*(s^3 + (c^2 - 4*c + 4)*s - sqrt(-c^4 - s^4 + 8*c^3 - (2*c^2 - 8*c - 17)*s^2 + c^2 - 68*c + 84)*(c - 2))/(c^2 + s^2 - 4*c + 4)
</pre></div>
</div>
</div>
</div>
<p><strong>3. Crank and Connector</strong></p>
<p>Now that we have the symbolic coordinates of the connector, we can extend the interact for the crank showing the connector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fx</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">sn</span><span class="p">)</span> <span class="o">=</span> <span class="n">xv</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">sn</span><span class="p">)</span>
<span class="n">fy</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">sn</span><span class="p">)</span> <span class="o">=</span> <span class="n">yv</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">cs</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">sn</span><span class="p">)</span>
<span class="nd">@interact</span>
<span class="k">def</span><span class="w"> </span><span class="nf">connector</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="n">slider</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;angle&#39;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shows the drawing of a crank, where the user can slide the angle</span>
<span class="sd">    to turn the crank.  Also the connector point is drawn.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">endpnt</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">fx</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">),</span> <span class="n">fy</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">pltcnt</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">pltend</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="n">endpnt</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">crank</span> <span class="o">=</span> <span class="n">line</span><span class="p">([</span><span class="n">center</span><span class="p">,</span> <span class="n">endpnt</span><span class="p">])</span>
    <span class="n">bartwobase</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">bartwo</span> <span class="o">=</span> <span class="n">line</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">barthree</span> <span class="o">=</span> <span class="n">line</span><span class="p">([</span><span class="n">endpnt</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">crank</span> <span class="o">+</span> <span class="n">bartwo</span> <span class="o">+</span> <span class="n">barthree</span>
    <span class="n">pnts</span> <span class="o">=</span> <span class="n">pltcnt</span> <span class="o">+</span> <span class="n">connector</span> <span class="o">+</span> <span class="n">pltend</span> <span class="o">+</span> <span class="n">bartwobase</span>
    <span class="n">plt</span> <span class="o">=</span> <span class="n">bars</span> <span class="o">+</span> <span class="n">pnts</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">xmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=+</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Widget Javascript not detected.  It may not be installed or enabled properly. Reconnecting the current kernel may help.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d432ad7ac96b414890263f915a1f617e"}</script></div>
</div>
<p><strong>4. The Coupler</strong></p>
<p>The final addition is the coupler point and the fourth bar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@interact</span>
<span class="k">def</span><span class="w"> </span><span class="nf">coupler</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="n">slider</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;angle&#39;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shows the drawing of a crank, where the user can slide the angle</span>
<span class="sd">    to turn the crank.  Also the connector point is drawn,</span>
<span class="sd">    with the coupler point and fourth bar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">endpnt</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">fx</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">),</span> <span class="n">fy</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">c</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">s</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span>
    <span class="n">yy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span>
    <span class="n">pltcnt</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">pltend</span> <span class="o">=</span> <span class="n">point</span><span class="p">(</span><span class="n">endpnt</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">coupler</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">crank</span> <span class="o">=</span> <span class="n">line</span><span class="p">([</span><span class="n">center</span><span class="p">,</span> <span class="n">endpnt</span><span class="p">])</span>
    <span class="n">bartwobase</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">bartwo</span> <span class="o">=</span> <span class="n">line</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">barthree</span> <span class="o">=</span> <span class="n">line</span><span class="p">([</span><span class="n">endpnt</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">barfour</span> <span class="o">=</span> <span class="n">line</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">crank</span> <span class="o">+</span> <span class="n">bartwo</span> <span class="o">+</span> <span class="n">barthree</span> <span class="o">+</span> <span class="n">barfour</span>
    <span class="n">pnts</span> <span class="o">=</span> <span class="n">pltcnt</span> <span class="o">+</span> <span class="n">connector</span> <span class="o">+</span> <span class="n">pltend</span> <span class="o">+</span> <span class="n">bartwobase</span> <span class="o">+</span> <span class="n">coupler</span>
    <span class="n">plt</span> <span class="o">=</span> <span class="n">bars</span> <span class="o">+</span> <span class="n">pnts</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">xmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=+</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Widget Javascript not detected.  It may not be installed or enabled properly. Reconnecting the current kernel may help.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0c391cef4d2e4be8ae3d1144c7dd22ff"}</script></div>
</div>
<p><strong>5. Extensions</strong></p>
<p>Several extensions will make this interact even more interesting, below are two suggestions:</p>
<ol class="arabic simple">
<li><p>Draw <em>the coupler curve</em>, this is the curve traced by the coupler point.</p></li>
<li><p>Add addition sliders to control the parameters of the mechanism, one slider to control the length of each bar.</p></li>
</ol>
</section>
<section id="lec39">
<h2>Lec39<a class="headerlink" href="#lec39" title="Link to this heading">#</a></h2>
<p>We use of SymPy in SageMath.</p>
<p><strong>1. Series Expansions</strong></p>
<p>If we use sympy in SageMath, then we may have to be explicit about the use of its functions.
For example, the <code class="docutils literal notranslate"><span class="pre">sqrt()</span></code> function in SageMath is different from <code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">sqrt()</span></code> function in sympy.
Consider the generating function for the Catalan numbers <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">-</span> <span class="pre">sqrt(4-x**2))/(2*x)</span></code>.
With sympy we can define a generator for the terms in a Taylor series,
but we must use the <code class="docutils literal notranslate"><span class="pre">sqrt()</span></code> function of sympy.<br />
But it starts sooner, already with the type of variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sympy.core.symbol.Symbol&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Observe the difference with the var() that we are normally using in SageMath.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Even if we use the sqrt() on a variable that is a sympy symbol,
we get a symbolic expression of Sage on return.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>We can make a generator object on the <code class="docutils literal notranslate"><span class="pre">sqrt(1-x)</span></code>.  That works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tsqrtx</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">tsqrtx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;generator object Expr.series.&lt;locals&gt;.&lt;genexpr&gt; at 0x7f587afddaf0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">tsqrtx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 1\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">tsqrtx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{x}{2}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">tsqrtx</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-x**2/8,
 -x**3/16,
 -5*x**4/128,
 -7*x**5/256,
 -21*x**6/1024,
 -33*x**7/2048,
 -429*x**8/32768,
 -715*x**9/65536]
</pre></div>
</div>
</div>
</div>
<p>But it will not work on <code class="docutils literal notranslate"><span class="pre">sqrt(1-y)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tsqrty</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">tsqrty</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;generator&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">tsqrty</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \sqrt{1 - y}\]</div>
</div>
</div>
<p>Doing another <code class="docutils literal notranslate"><span class="pre">next(tsqrty)</span></code> triggers the <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code> exception.</p>
<p>Although we can explitly use the sqrt() of sympy,
it does make no difference, because <code class="docutils literal notranslate"><span class="pre">y</span></code> is a SageMath variable.</p>
<p>So for the generating function for the Catalan numbers,
we must use a sympy symbol x and not a Sage variable y.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">cg</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">cg</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 x,
 2*x**2,
 5*x**3,
 14*x**4,
 42*x**5,
 132*x**6,
 429*x**7,
 1430*x**8,
 4862*x**9,
 16796*x**10]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">catalan_number</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16796
</pre></div>
</div>
</div>
</div>
<p><strong>2. Pattern Matching</strong></p>
<p>Another feature that is a bit better in SymPy than in Sage is pattern matching,
which can be useful when combined with substitution.
To run this code we can also open a Terminal session, select Misc, and select python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Wild</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{y_: 10}
</pre></div>
</div>
</div>
</div>
<p><strong>3. Solving Recurrence Relations</strong></p>
<p>SymPy can solve recurrence relations.
Consider the Fibonacci numbers,
defined as <span class="math notranslate nohighlight">\(f(n) = f(n-1) + f(n-2)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Function</span><span class="p">,</span> <span class="n">rsolve</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">n</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="n">Fib</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">Fib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - f{\left(n \right)} - f{\left(n + 1 \right)} + f{\left(n + 2 \right)}\]</div>
</div>
</div>
<p>To solve a recurrence relation, we call <code class="docutils literal notranslate"><span class="pre">rsolve</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">rsolve</span><span class="p">(</span><span class="n">Fib</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle C_{0} \left(\frac{1}{2} - \frac{\sqrt{5}}{2}\right)^{n} + C_{1} \left(\frac{1}{2} + \frac{\sqrt{5}}{2}\right)^{n}\]</div>
</div>
</div>
<p>Because we have a two terms relation,
for a unique solution, we need to initial conditions,
as an additional dictionary argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">rsolve</span><span class="p">(</span><span class="n">Fib</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="p">{</span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{\sqrt{5} \left(\frac{1}{2} - \frac{\sqrt{5}}{2}\right)^{n}}{5} + \frac{\sqrt{5} \left(\frac{1}{2} + \frac{\sqrt{5}}{2}\right)^{n}}{5}\]</div>
</div>
</div>
<p>Let us now compute the first 10 Fibonacci numbers.  For this, we return to Sage and convert the SymPy object into a symbolic expression with <code class="docutils literal notranslate"><span class="pre">SR()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sympy.core.add.Add&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fs2</span> <span class="o">=</span> <span class="n">SR</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">fs2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Now we can evaluate and expand the <code class="docutils literal notranslate"><span class="pre">sqrt(5)</span></code> expressions,
which are then automatically simplified.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">fs2</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 1, 2, 3, 5, 8, 13, 21, 34]
</pre></div>
</div>
</div>
</div>
<p><strong>4. Finding the Nearest Algebraic Number</strong></p>
<p>With <code class="docutils literal notranslate"><span class="pre">PSLQ</span></code> one can compute the nearest algebraic number to a given floating-point approximation.  This is available in <code class="docutils literal notranslate"><span class="pre">mpmath</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span> <span class="o">=</span> <span class="n">RR</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.41421356237310
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mpmath</span><span class="w"> </span><span class="kn">import</span> <span class="n">pslq</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwrs</span> <span class="o">=</span> <span class="p">[</span><span class="n">s2</span><span class="o">**</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">pwrs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.00000000000000, 1.41421356237310, 2.00000000000000]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cff</span> <span class="o">=</span> <span class="n">pslq</span><span class="p">(</span><span class="n">pwrs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PSLQ using prec 113 and tol 1.81899e-12
0/100:  Error:     0.06   Norm: 0
FOUND relation at iter 1/100, error: 2.0e-16
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2, 0, -1]
</pre></div>
</div>
</div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">cff</span></code> are the coefficients of the polynomial <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">-</span> <span class="pre">x^2</span></code>, which is the smallest polynomial for which <code class="docutils literal notranslate"><span class="pre">s2</span></code> is an approximate root.</p>
</section>
<section id="lec40">
<h2>Lec40<a class="headerlink" href="#lec40" title="Link to this heading">#</a></h2>
<p>We compute numerically with numpy and scipy.</p>
<p><strong>1. Numerical Solving of Systems of Linear Equations</strong></p>
<p>We have been using numpy already in our plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sage.misc.citation</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_systems</span>
<span class="n">get_systems</span><span class="p">(</span><span class="s2">&quot;point([0,0], size=50).show(figsize=1, axes=False)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_168/1288942697.py:2: UserWarning: get_systems() requires Cython profiling to be enabled, otherwise the results will be very unreliable. Rebuild Sage with the environment variable &#39;SAGE_PROFILE=yes&#39; to enable profiling.
  get_systems(&quot;point([0,0], size=50).show(figsize=1, axes=False)&quot;)
</pre></div>
</div>
<img alt="../_images/ec708e69c814794e0dbb48445f6186de2f537ed94e9e5380023a9751bce1898a.png" src="../_images/ec708e69c814794e0dbb48445f6186de2f537ed94e9e5380023a9751bce1898a.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;numpy&#39;]
</pre></div>
</div>
</div>
</div>
<p>To visualize large data sets, we can use matrix_plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">matrix_plot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/439bc4040bef30e814b3bb02f22d4d5d31e517790cf39d2e3e289f96205f85c8.png" src="../_images/439bc4040bef30e814b3bb02f22d4d5d31e517790cf39d2e3e289f96205f85c8.png" />
</div>
</div>
<p>We have already a random coefficient matrix A.
Let us generate a random right hand side vector b and solve a linear system A*x = b.
The random numbers are uniformly distributed in the interval [-1,+1].</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.00512064],
       [-0.70480263],
       [ 1.44623146],
       [-0.99364059],
       [-0.74074156],
       [ 2.72227682],
       [-1.16717296],
       [-0.1015867 ],
       [-1.39478794],
       [ 1.54941789],
       [ 2.09291182],
       [ 1.23166181],
       [-0.31414951],
       [-1.92680986],
       [ 0.72882184],
       [ 0.62296124],
       [-0.80584849],
       [ 0.94202707],
       [ 1.06721674],
       [ 0.39764622]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27.021346300742454
</pre></div>
</div>
</div>
</div>
<p>The residual of a linear system is the norm of b - A*x,
but something went wrong, because the residual is too large!
What is the problem?  Let us look at the type of A, b, and x.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;type(A) :&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;type(b) :&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;type(x) :&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>type(A) : &lt;class &#39;numpy.ndarray&#39;&gt;
type(b) : &lt;class &#39;numpy.ndarray&#39;&gt;
type(x) : &lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>For the operator arithmetic to work properly,
we must convert to the proper matrix types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">mb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">mx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">mA</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">mb</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">mx</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;class &#39;numpy.matrix&#39;&gt;, &lt;class &#39;numpy.matrix&#39;&gt;, &lt;class &#39;numpy.matrix&#39;&gt;)
</pre></div>
</div>
</div>
</div>
<p>Now we can compute the residual correctly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">mb</span> <span class="o">-</span> <span class="n">mA</span><span class="o">*</span><span class="n">mx</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.3440770491716685e-15
</pre></div>
</div>
</div>
</div>
<p><strong>2. Numerical Integration</strong></p>
<p>Most functions do not have symbolic antiderivatives.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\int_{0}^{1} e^{\sin\left(x\right)}\,{d x}</script></html></div></div>
</div>
<p>We compute a numerical approximation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.6318696084180513
</pre></div>
</div>
</div>
</div>
<p>Let us see how we got to this </p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sage.misc.citation</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_systems</span>
<span class="n">get_systems</span><span class="p">(</span><span class="s2">&quot;a.n()&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_168/2732729778.py:2: UserWarning: get_systems() requires Cython profiling to be enabled, otherwise the results will be very unreliable. Rebuild Sage with the environment variable &#39;SAGE_PROFILE=yes&#39; to enable profiling.
  get_systems(&quot;a.n()&quot;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ginac&#39;]
</pre></div>
</div>
</div>
</div>
<p>GiNAC is a C++ library is it is not a CAS.</p>
<p>Sometimes we may want more diagnostic information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">quad</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">f</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.6318696084180513,
 1.8117392124517587e-14,
 {&#39;neval&#39;: 21,
  &#39;last&#39;: 1,
  &#39;iord&#39;: array([          1,       21931,           0,           0,   -17793120,
               32687,   -11053888,       32687,  1848425598,   179447140,
           -17772848,       32687,   -11053760,       32687, -1094302173,
          -925536350,   -17772752,       32687,   -11053696,       32687,
          -656120084, -1109646371,   -17772656,       32687,   -11053632,
               32687, -1863383552,   851750764,   -17772560,       32687,
           -11053568,       32687,  -358732886,  1988466565,   -17772464,
               32687,   -11053504,       32687, -1839087321, -1441984478,
           -17760208,       32687,   -11053440,       32687, -1447038753,
           190633445,   -17772368,       32687,         336,           0],
        dtype=int32),
  &#39;alist&#39;: array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
  &#39;blist&#39;: array([1.00000000e+000, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304, 7.74860419e-304, 7.74860419e-304,
         7.74860419e-304, 7.74860419e-304]),
  &#39;rlist&#39;: array([1.63186961e+000, 0.00000000e+000, 6.93649197e-310, 6.93649197e-310,
         6.93639347e-310, 6.93649200e-310, 6.93649197e-310, 6.93639349e-310,
         6.93645281e-310, 6.93639349e-310, 6.93649191e-310, 6.93639349e-310,
         6.93649086e-310, 6.93649200e-310, 6.93649093e-310, 6.93639349e-310,
         6.93639349e-310, 6.93649197e-310, 6.93639349e-310, 6.93649194e-310,
         6.93649197e-310, 6.93639349e-310, 6.93649197e-310, 6.93649197e-310,
         6.93649197e-310, 6.93639349e-310, 6.93639348e-310, 6.93649197e-310,
         6.93649200e-310, 6.93649197e-310, 6.93649197e-310, 6.93639349e-310,
         6.93639348e-310, 6.93649191e-310, 6.93649201e-310, 6.93639349e-310,
         6.93639349e-310, 6.93645281e-310, 6.93639349e-310, 6.93645281e-310,
         6.93639349e-310, 6.93639349e-310, 6.93645281e-310, 6.93639349e-310,
         6.93649197e-310, 6.93649197e-310, 6.93649197e-310, 6.93639349e-310,
         6.93639349e-310, 6.93649190e-310]),
  &#39;elist&#39;: array([1.81173921e-014, 0.00000000e+000, 6.93646174e-310, 6.93646174e-310,
         6.93646174e-310, 6.93646174e-310, 6.93649197e-310, 6.93649200e-310,
         6.93649187e-310, 6.93649187e-310, 6.93649200e-310, 6.93649197e-310,
         6.93639358e-310, 6.93639349e-310, 6.93649200e-310, 6.93649197e-310,
         6.93649197e-310, 6.93649197e-310, 6.93649197e-310, 6.93649200e-310,
         6.93649197e-310, 6.93649200e-310, 6.93649201e-310, 6.93649201e-310,
         6.93639347e-310, 6.93649191e-310, 6.93649201e-310, 6.93649197e-310,
         6.93649200e-310, 6.93649200e-310, 6.93649200e-310, 6.93649190e-310,
         6.93639349e-310, 6.93649038e-310, 6.93639349e-310, 6.93639349e-310,
         6.93649201e-310, 6.93639347e-310, 6.93645289e-310, 6.93649061e-310,
         6.93639349e-310, 6.93649200e-310, 6.93646173e-310, 6.93649200e-310,
         6.93649093e-310, 6.93649200e-310, 6.93649200e-310, 6.93649200e-310,
         6.93649200e-310, 6.93649096e-310])})
</pre></div>
</div>
</div>
</div>
<p><strong>3. Rational Approximations</strong></p>
<p>Often we use a combination of sympy and scipy.
For example, the computation of a Pade approximation
starts from a Taylor series.  We can compute Taylor series
with sympy and Pade approximations with scipy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">series</span><span class="p">,</span> <span class="n">sin</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">series</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;generator object Expr.series.&lt;locals&gt;.&lt;genexpr&gt; at 0x7faffef93990&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">terms</span> <span class="o">=</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">terms</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x, -x**3/6, x**5/120, -x**7/5040, x**9/362880, -x**11/39916800]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sterms</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span>
<span class="n">sterms</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{x^{11}}{39916800} + \frac{x^{9}}{362880} - \frac{x^{7}}{5040} + \frac{x^{5}}{120} - \frac{x^{3}}{6} + x\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">sterms</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 0, -1/6, 0, 1/120]
</pre></div>
</div>
</div>
</div>
<p>To compute a Pade approximation, we must convert the list to an array of floats.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 0, -1/6, 0, 1/120] has type &lt;class &#39;list&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">nfc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nfc</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">nfc</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.          1.          0.         -0.16666667  0.          0.00833333] has type &lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Now we import the pade command from scipy.interpolate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">pade</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pade</span><span class="p">(</span><span class="n">nfc</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(poly1d([-0.11666667,  0.        ,  1.        ,  0.        ]),
 poly1d([0.05, 0.  , 1.  ]))
</pre></div>
</div>
</div>
</div>
<p>On return we get numpy polynomials, which have a nice string representation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;numerator :</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;denominator :</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.poly1d&#39;&gt;
numerator :
          3
-0.1167 x + 1 x
denominator :
       2
0.05 x + 1
</pre></div>
</div>
</div>
</div>
<p>numpy polynomials are callable, so plotting is no problem
and we compare with the plot of the actual sin(x) function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="p">))</span>
<span class="p">(</span><span class="n">sp</span><span class="o">+</span><span class="n">pp</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7979480c9e81cca14c12b421f16f3e84f64b0ccbcff86aa972fa6ffedd2526b5.png" src="../_images/7979480c9e81cca14c12b421f16f3e84f64b0ccbcff86aa972fa6ffedd2526b5.png" />
</div>
</div>
<p>We can use the function to bring the polynomials from scipy
into SageMath objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp0</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fp0</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">fp0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x*(1.0 - 0.116666666666667*x**2) has type &lt;class &#39;sympy.core.mul.Mul&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sfp0</span> <span class="o">=</span> <span class="n">SR</span><span class="p">(</span><span class="n">fp0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sfp0</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">sfp0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.116666666666667*x^2 + 1.00000000000000)*x has type &lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>4. Numerical Solving of Ordinary Differential Equations</strong></p>
<p>We end with the numerical solving of an ordinary differential equation,
taking the pendulum problem: <code class="docutils literal notranslate"><span class="pre">diff(theta,t,2)</span> <span class="pre">=</span> <span class="pre">-diff(theta,1)</span> <span class="pre">-</span> <span class="pre">9.8*sin(theta).</span></code>
We need to define a system of first-order differential equations,
introducing an extra variable velocity which is the derivative of theta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">velocity</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t, theta, velocity&#39;</span><span class="p">)</span>
<span class="n">oderhs</span> <span class="o">=</span> <span class="p">[</span><span class="n">velocity</span><span class="p">,</span> <span class="o">-</span><span class="n">velocity</span><span class="o">-</span><span class="mf">9.8</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<span class="n">oderhs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[velocity, -velocity - 9.80000000000000*sin(theta)]
</pre></div>
</div>
</div>
</div>
<p>The right hand side of the system has to be defined as a function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">pend</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">9.8</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</pre></div>
</div>
</div>
</div>
<p>We can evaluate the function symbolically, as a verification.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pend</span><span class="p">([</span><span class="n">theta</span><span class="p">,</span> <span class="n">velocity</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[velocity, -velocity - 9.80000000000000*sin(theta)]
</pre></div>
</div>
</div>
</div>
<p>Then we import odeint of the scipy.integrate package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">odeint</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">linspace</span>
<span class="n">npts</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of points</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">pend</span><span class="p">,</span> <span class="p">[</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">tspan</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.31415927,  0.        ],
       [ 0.31400806, -0.03015808],
       [ 0.3135566 , -0.05998775],
       ...,
       [ 0.00157   ,  0.00380359],
       [ 0.00160711,  0.00361063],
       [ 0.00164228,  0.00341607]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="n">tspan</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">sol</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">)]</span>
<span class="n">list_plot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bc9ac20102150b23b1a51671c8a0ccd49719b2a890cd15ce682770d8a95da2f6.png" src="../_images/bc9ac20102150b23b1a51671c8a0ccd49719b2a890cd15ce682770d8a95da2f6.png" />
</div>
</div>
<p>A phase portrait shows the displacements and the velocities.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="n">sol</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">)]</span>
<span class="n">list_plot</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d483ad59bf895fc5ecaa2ac22102f8c54c3a32c81994c2c946a8ee1e9251c82e.png" src="../_images/d483ad59bf895fc5ecaa2ac22102f8c54c3a32c81994c2c946a8ee1e9251c82e.png" />
</div>
</div>
</section>
<section id="lec41">
<h2>Lec41<a class="headerlink" href="#lec41" title="Link to this heading">#</a></h2>
<p>This notebook uses Julia to do symbolic computation: <em>it must run with a Julia kernel!</em></p>
<p>Consider the problem of computing the slope of the tangent line to a point on a circle.</p>
<p><strong>1. Implicit Differentiation with SymPy.jl</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">SymPy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[x\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">SymFunction</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[y\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dy</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\frac{d}{d x} y{\left(x \right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">typeof</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sym{PyCall.PyObject}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[x^{2} + y^{2}{\left(x \right)} - 1\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">typeof</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sym{PyCall.PyObject}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[2 x + 2 y{\left(x \right)} \frac{d}{d x} y{\left(x \right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dydx</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\left[\begin{smallmatrix}- \frac{x}{y{\left(x \right)}}\end{smallmatrix}\right]\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">typeof</span><span class="p">(</span><span class="n">dydx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Vector{Sym{PyObject}} (alias for Array{Sym{PyCall.PyObject}, 1})
</pre></div>
</div>
</div>
</div>
<p>From the output above, we see that <code class="docutils literal notranslate"><span class="pre">dydx</span></code> is an array.  Arrays in Julia start at one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">symbolicslope</span> <span class="o">=</span> <span class="n">dydx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[- \frac{x}{y{\left(x \right)}}\]</div>
</div>
</div>
<p>Let us now take a random point on the circle, which is generated by a random angle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angle</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">rand</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0739308808121364
</pre></div>
</div>
</div>
</div>
<p>Because Julia is oriented towards numerical computing, the <code class="docutils literal notranslate"><span class="pre">pi</span></code> is a 64-bit floating point constant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.9977118154165967, 0.06761015735907423)
</pre></div>
</div>
</div>
</div>
<p>We store the coordinates of the point in a dictionary, which is a convenient data structure for substitution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sd</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">x</span> <span class="o">=&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\begin{equation*}\begin{cases}y{\left(x \right)} &amp; \text{=&gt;} &amp;0.0676102\\x &amp; \text{=&gt;} &amp;-0.997712\\\end{cases}\end{equation*}\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="n">symbolicslope</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[14.7568332095102\]</div>
</div>
</div>
<p>We see that the <code class="docutils literal notranslate"><span class="pre">subs</span></code> executed a simultaneous substitution.</p>
<p>Let us now do the slope computation via a Taylor series.  The <code class="docutils literal notranslate"><span class="pre">series</span></code> of <code class="docutils literal notranslate"><span class="pre">SymPy</span></code> works only for one variable, but it works well on purely symbolic expressions.  We declare new symbols <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> for the variables in the circle equation and <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> for the coordinates of the point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">Sym</span><span class="p">(</span><span class="s2">&quot;X, Y, A, B&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(X, Y, A, B)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nc</span> <span class="o">=</span> <span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">^</span><span class="mi">2</span>  <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[X^{2} + Y^{2} - 1\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cx</span> <span class="o">=</span> <span class="n">SymPy</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[-1 + Y^{2} + 2 A \left(- A + X\right) + A^{2} + O\left(\left(- A + X\right)^{2}; X\rightarrow A\right)\]</div>
</div>
</div>
<p>To convert the <code class="docutils literal notranslate"><span class="pre">cx</span></code> into a symbolic expression on which we can apply the <code class="docutils literal notranslate"><span class="pre">series</span></code> again, we select the coefficients and make the expression <code class="docutils literal notranslate"><span class="pre">px</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cx</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">A</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[2 A\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cx</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[A^{2} + Y^{2} - 1\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">cx</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">A</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[A^{2} + 2 A \left(- A + X\right) + Y^{2} - 1\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cy</span> <span class="o">=</span> <span class="n">series</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[-1 + 2 B \left(- B + Y\right) + B^{2} + 2 A \left(- A + X\right) + A^{2} + O\left(\left(- B + Y\right)^{2}; Y\rightarrow B\right)\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">cy</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">Y</span><span class="o">-</span><span class="n">B</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Y</span><span class="o">-</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[A^{2} + 2 A \left(- A + X\right) + B^{2} + 2 B \left(- B + Y\right) - 1\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cY</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">Dict</span><span class="p">(</span><span class="n">A</span><span class="o">=&gt;</span><span class="n">a</span><span class="p">,</span> <span class="n">B</span><span class="o">=&gt;</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[- 1.99542363083319 X + 0.135220314718148 Y - 2.0\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">cY</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cY</span><span class="o">.</span><span class="n">coeff</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[14.7568332095102\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[14.7568332095102\]</div>
</div>
</div>
<p><strong>2. Implicit Differentiation via Symbolics.jl</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">Symbolics</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@variables</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split} \begin{equation}
\left[
\begin{array}{c}
x \\
y\left( x \right) \\
\end{array}
\right]
\end{equation}
 \end{split}\]</div>
</div>
</div>
<p>Also <code class="docutils literal notranslate"><span class="pre">SymPy</span></code> has a <code class="docutils literal notranslate"><span class="pre">Differential</span></code> and in order not to confuse, because we have done <code class="docutils literal notranslate"><span class="pre">using</span> <span class="pre">SymPy</span></code> earlier in this notebook, we have have to declare that we are using the <code class="docutils literal notranslate"><span class="pre">Differential</span></code> from <code class="docutils literal notranslate"><span class="pre">Symbolics</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">Symbolics</span><span class="o">.</span><span class="n">Differential</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Differential(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dy</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[ \begin{equation}
\frac{\mathrm{d} y\left( x \right)}{\mathrm{d}x}
\end{equation}
 \]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">typeof</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Num
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[ \begin{equation}
-1 + x^{2} + \left( y\left( x \right) \right)^{2}
\end{equation}
 \]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[ \begin{equation}
\frac{\mathrm{d}}{\mathrm{d}x} \left( -1 + x^{2} + \left( y\left( x \right) \right)^{2} \right)
\end{equation}
 \]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq</span> <span class="o">=</span> <span class="n">expand_derivatives</span><span class="p">(</span><span class="n">dc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[ \begin{equation}
2 x + 2 \frac{\mathrm{d} y\left( x \right)}{\mathrm{d}x} y\left( x \right)
\end{equation}
 \]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SBslope</span> <span class="o">=</span> <span class="n">Symbolics</span><span class="o">.</span><span class="n">solve_for</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[ \begin{equation}
\frac{ - x}{y\left( x \right)}
\end{equation}
 \]</div>
</div>
</div>
<p>We have to make a new dictionary with the coordinates for the points, mapping them to the Symbolics variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nsd</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">x</span> <span class="o">=&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span> <span class="o">=&gt;</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dict{Num, Float64} with 2 entries:
  y(x) =&gt; 0.0676102
  x    =&gt; -0.997712
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">substitute</span><span class="p">(</span><span class="n">SBslope</span><span class="p">,</span> <span class="n">nsd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[ \begin{equation}
14.757
\end{equation}
 \]</div>
</div>
</div>
<p>Let us compare with the slope we computed earlier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[14.7568332095102\]</div>
</div>
</div>
</section>
<section id="lec42">
<h2>Lec42<a class="headerlink" href="#lec42" title="Link to this heading">#</a></h2>
<p>We explore parallel computing with Julia.</p>
<p><strong>1. Multithreading</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">Base</span><span class="o">.</span><span class="n">Threads</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nthreads</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16
</pre></div>
</div>
</div>
</div>
<p>The above output verifies that we have 16 threads at our disposal.  How did we get here?</p>
<p>This notebook runs with a new kernel, where the environment variable <code class="docutils literal notranslate"><span class="pre">JULIA_NUM_THREADS</span></code> is set to 16.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">julia&gt;</span> <span class="pre">using</span> <span class="pre">IJulia</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">julia&gt;</span> <span class="pre">installkernel(&quot;Julia</span> <span class="pre">(16</span> <span class="pre">threads)&quot;,</span> <span class="pre">env=Dict(&quot;JULIA_NUM_THREADS&quot;=&gt;&quot;16&quot;))</span></code></p></li>
</ol>
<p>Before launching jupyter lab, it is also good to do <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">JULIA_NUM_THREAD=16</span></code>.</p>
<p><strong>2. Parallel Matrix Matrix Multiplication</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">LinearAlgebra</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">8000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BLAS</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span> <span class="n">mul</span><span class="o">!(</span>C,<span class="w"> </span>A,<span class="w"> </span>B<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18.561983 seconds (2.15 M allocations: 145.880 MiB, 2.29% compilation time)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>80008000 Matrix{Float64}:
 2002.61  2002.15  2035.81  2026.74    2010.5   2042.48  2015.96  2016.68
 1980.5   1987.49  2012.79  1991.08     1978.89  2018.74  1996.94  2003.18
 1957.56  1984.21  1995.79  1987.67     1977.49  2000.38  1968.04  1978.16
 2003.2   1999.25  2027.97  2013.44     2024.4   2034.51  2020.6   2020.59
 1988.05  1972.63  1996.61  1997.61     1996.68  2009.31  1984.49  2007.51
 1991.66  2005.56  2034.45  2016.99    2028.13  2041.0   2015.59  2012.05
 1993.78  1996.21  1998.82  1996.22     1998.42  2014.44  2013.73  2000.38
 1986.32  1998.09  2022.94  2008.16     2009.88  2057.23  2013.93  2028.85
 1980.79  2000.92  2024.78  2006.74     2003.33  2039.24  2001.3   2006.21
 1988.08  1995.01  2014.57  2004.84     2002.83  2009.4   1987.22  1992.63
 1992.78  2007.42  2021.4   2006.39    1995.28  2029.4   2021.63  2028.23
 2005.45  2017.17  2048.03  2004.62     2008.33  2036.29  2002.41  2014.06
 1965.99  1963.5   1980.35  1972.23     1977.56  1997.92  1973.4   1973.89
                                                                 
 2001.01  2010.14  2031.6   2014.75     2002.88  2037.38  2018.3   2014.21
 1980.08  1969.66  2009.39  2002.72     1986.04  2031.24  1981.15  1987.35
 1970.96  1991.12  1997.72  1991.38    2012.73  2021.88  1997.41  2006.51
 1990.57  1977.8   1997.65  1993.38     1999.44  2016.59  1996.9   2017.76
 1976.0   1993.04  2014.41  1988.52     2004.46  2031.88  2005.34  1997.9
 2001.51  1984.63  2028.94  2004.37     2006.17  2026.22  2007.2   2023.25
 1994.56  1978.4   1995.27  1980.38     1996.56  2019.67  1982.65  1982.74
 1982.14  1990.69  2009.08  2002.33    2005.18  2018.52  2003.19  2008.21
 2000.43  1983.67  2017.42  1996.82     1990.21  2023.77  2000.99  2001.49
 1998.52  2008.49  2033.37  2014.0      2013.12  2035.33  2009.6   2024.21
 1985.31  1992.43  2012.85  1990.14     1998.65  2011.43  2000.18  1983.27
 1992.9   1978.14  2017.69  1991.82     1984.42  2022.81  1990.15  1989.05
</pre></div>
</div>
</div>
</div>
<p>Observe that the timer reports the compilation time as well.  Let us redo the computation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span> <span class="n">mul</span><span class="o">!(</span>C,<span class="w"> </span>A,<span class="w"> </span>B<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18.019970 seconds
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>80008000 Matrix{Float64}:
 2002.61  2002.15  2035.81  2026.74    2010.5   2042.48  2015.96  2016.68
 1980.5   1987.49  2012.79  1991.08     1978.89  2018.74  1996.94  2003.18
 1957.56  1984.21  1995.79  1987.67     1977.49  2000.38  1968.04  1978.16
 2003.2   1999.25  2027.97  2013.44     2024.4   2034.51  2020.6   2020.59
 1988.05  1972.63  1996.61  1997.61     1996.68  2009.31  1984.49  2007.51
 1991.66  2005.56  2034.45  2016.99    2028.13  2041.0   2015.59  2012.05
 1993.78  1996.21  1998.82  1996.22     1998.42  2014.44  2013.73  2000.38
 1986.32  1998.09  2022.94  2008.16     2009.88  2057.23  2013.93  2028.85
 1980.79  2000.92  2024.78  2006.74     2003.33  2039.24  2001.3   2006.21
 1988.08  1995.01  2014.57  2004.84     2002.83  2009.4   1987.22  1992.63
 1992.78  2007.42  2021.4   2006.39    1995.28  2029.4   2021.63  2028.23
 2005.45  2017.17  2048.03  2004.62     2008.33  2036.29  2002.41  2014.06
 1965.99  1963.5   1980.35  1972.23     1977.56  1997.92  1973.4   1973.89
                                                                 
 2001.01  2010.14  2031.6   2014.75     2002.88  2037.38  2018.3   2014.21
 1980.08  1969.66  2009.39  2002.72     1986.04  2031.24  1981.15  1987.35
 1970.96  1991.12  1997.72  1991.38    2012.73  2021.88  1997.41  2006.51
 1990.57  1977.8   1997.65  1993.38     1999.44  2016.59  1996.9   2017.76
 1976.0   1993.04  2014.41  1988.52     2004.46  2031.88  2005.34  1997.9
 2001.51  1984.63  2028.94  2004.37     2006.17  2026.22  2007.2   2023.25
 1994.56  1978.4   1995.27  1980.38     1996.56  2019.67  1982.65  1982.74
 1982.14  1990.69  2009.08  2002.33    2005.18  2018.52  2003.19  2008.21
 2000.43  1983.67  2017.42  1996.82     1990.21  2023.77  2000.99  2001.49
 1998.52  2008.49  2033.37  2014.0      2013.12  2035.33  2009.6   2024.21
 1985.31  1992.43  2012.85  1990.14     1998.65  2011.43  2000.18  1983.27
 1992.9   1978.14  2017.69  1991.82     1984.42  2022.81  1990.15  1989.05
</pre></div>
</div>
</div>
</div>
<p>And now we double the number of threads</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BLAS</span><span class="o">.</span><span class="n">set_num_threads</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@time</span> <span class="n">mul</span><span class="o">!(</span>C,<span class="w"> </span>A,<span class="w"> </span>B<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  9.752459 seconds
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>80008000 Matrix{Float64}:
 2002.61  2002.15  2035.81  2026.74    2010.5   2042.48  2015.96  2016.68
 1980.5   1987.49  2012.79  1991.08     1978.89  2018.74  1996.94  2003.18
 1957.56  1984.21  1995.79  1987.67     1977.49  2000.38  1968.04  1978.16
 2003.2   1999.25  2027.97  2013.44     2024.4   2034.51  2020.6   2020.59
 1988.05  1972.63  1996.61  1997.61     1996.68  2009.31  1984.49  2007.51
 1991.66  2005.56  2034.45  2016.99    2028.13  2041.0   2015.59  2012.05
 1993.78  1996.21  1998.82  1996.22     1998.42  2014.44  2013.73  2000.38
 1986.32  1998.09  2022.94  2008.16     2009.88  2057.23  2013.93  2028.85
 1980.79  2000.92  2024.78  2006.74     2003.33  2039.24  2001.3   2006.21
 1988.08  1995.01  2014.57  2004.84     2002.83  2009.4   1987.22  1992.63
 1992.78  2007.42  2021.4   2006.39    1995.28  2029.4   2021.63  2028.23
 2005.45  2017.17  2048.03  2004.62     2008.33  2036.29  2002.41  2014.06
 1965.99  1963.5   1980.35  1972.23     1977.56  1997.92  1973.4   1973.89
                                                                 
 2001.01  2010.14  2031.6   2014.75     2002.88  2037.38  2018.3   2014.21
 1980.08  1969.66  2009.39  2002.72     1986.04  2031.24  1981.15  1987.35
 1970.96  1991.12  1997.72  1991.38    2012.73  2021.88  1997.41  2006.51
 1990.57  1977.8   1997.65  1993.38     1999.44  2016.59  1996.9   2017.76
 1976.0   1993.04  2014.41  1988.52     2004.46  2031.88  2005.34  1997.9
 2001.51  1984.63  2028.94  2004.37     2006.17  2026.22  2007.2   2023.25
 1994.56  1978.4   1995.27  1980.38     1996.56  2019.67  1982.65  1982.74
 1982.14  1990.69  2009.08  2002.33    2005.18  2018.52  2003.19  2008.21
 2000.43  1983.67  2017.42  1996.82     1990.21  2023.77  2000.99  2001.49
 1998.52  2008.49  2033.37  2014.0      2013.12  2035.33  2009.6   2024.21
 1985.31  1992.43  2012.85  1990.14     1998.65  2011.43  2000.18  1983.27
 1992.9   1978.14  2017.69  1991.82     1984.42  2022.81  1990.15  1989.05
</pre></div>
</div>
</div>
</div>
<p>We went from 18 seconds with two threads to 10 seconds on four threads.</p>
<p><strong>2. Peak Performance</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">peakflops</span></code> computes the peak flop rate for the computer using double precision <code class="docutils literal notranslate"><span class="pre">gemm!</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">peakflops</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0489094017708801e11
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">peakflops</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">peakflops</span><span class="p">(</span><span class="mi">16000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Dimension 4000 is better than 8000 and 16000 on this computer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">^</span><span class="mi">11</span>
</pre></div>
</div>
</div>
</div>
<p>To put the output is perspective, <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">10^11</span></code> is the number 200,000,000,000 or 200 billion.</p>
<p><strong>3. Parallel Numerical Integration</strong></p>
<p>Consider the estimation of <span class="math notranslate nohighlight">\(\pi\)</span> via a Monte Carlo method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myrand</span><span class="p">(</span><span class="n">x</span><span class="p">::</span><span class="n">Int64</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1103515245</span><span class="n">x</span> <span class="o">+</span> <span class="mi">12345</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="o">^</span><span class="mi">31</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function estimatepi(n)</span>

<span class="sd">Runs a simple Monte Carlo method</span>
<span class="sd">to estimate pi with n samples.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">function</span> <span class="n">estimatepi</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="n">r</span> <span class="o">=</span> <span class="n">threadid</span><span class="p">()</span>
   <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span>
       <span class="n">r</span> <span class="o">=</span> <span class="n">myrand</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
       <span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="mi">31</span>
       <span class="n">r</span> <span class="o">=</span> <span class="n">myrand</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
       <span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="mi">31</span>
       <span class="n">count</span> <span class="o">+=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
   <span class="n">end</span>
   <span class="k">return</span> <span class="mi">4</span><span class="o">*</span><span class="n">count</span><span class="o">/</span><span class="n">n</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nt</span> <span class="o">=</span> <span class="n">nthreads</span><span class="p">()</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The number of threads : $nt&quot;</span><span class="p">)</span>
<span class="n">estimates</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">Statistics</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timestart</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="nd">@threads</span> <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">nt</span>
    <span class="n">estimates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">estimatepi</span><span class="p">(</span><span class="mi">10_000_000_000</span><span class="o">/</span><span class="n">nt</span><span class="p">)</span> 
<span class="n">end</span>
<span class="n">estpi</span> <span class="o">=</span> <span class="n">Statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">estimates</span><span class="p">)</span>
<span class="n">elapsed16</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">timestart</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="s2">&quot;The estimate for Pi : $estpi&quot;</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The elapsed time for 16 threads : $elapsed16 seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us redo this for 8 threads.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nt8</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timestart</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="nd">@threads</span> <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">nt8</span>
    <span class="n">estimates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">estimatepi</span><span class="p">(</span><span class="mi">10_000_000_000</span><span class="o">/</span><span class="n">nt8</span><span class="p">)</span> 
<span class="n">end</span>
<span class="n">estpi</span> <span class="o">=</span> <span class="n">Statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">estimates</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">nt8</span><span class="p">])</span>
<span class="n">elapsed8</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">timestart</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="s2">&quot;The estimate for Pi : $estpi&quot;</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The elapsed time for 8 threads : $elapsed8 seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">speedup</span> <span class="o">=</span> <span class="n">elapsed8</span><span class="o">/</span><span class="n">elapsed16</span>
</pre></div>
</div>
</div>
</div>
<p>Instead of speedup, we can look for quality up.  Every thread does the same number of samples, but with more threads running, we expect a better accuracy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timestart</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="nd">@threads</span> <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span>
    <span class="n">estimates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">estimatepi</span><span class="p">(</span><span class="mi">10_000_000_000</span><span class="p">)</span> 
<span class="n">end</span>
<span class="n">estpi</span> <span class="o">=</span> <span class="n">Statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">estimates</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">elapsed8</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">timestart</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">err2</span> <span class="o">=</span> <span class="n">estpi</span> <span class="o">-</span> <span class="n">pi</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The estimate for Pi : $estpi&quot;</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The error : $err8&quot;</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The elapsed time for 2 threads : $elapsed8 seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timestart</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="nd">@threads</span> <span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">estimates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">estimatepi</span><span class="p">(</span><span class="mi">10_000_000_000</span><span class="p">)</span> 
<span class="n">end</span>
<span class="n">estpi</span> <span class="o">=</span> <span class="n">Statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">estimates</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">nt</span><span class="p">])</span>
<span class="n">elapsed8</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">timestart</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">err16</span> <span class="o">=</span> <span class="n">estpi</span> <span class="o">-</span> <span class="n">pi</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The estimate for Pi : $estpi&quot;</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The error : $err16&quot;</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s2">&quot;The elapsed time for 8 threads : $elapsed8 seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sagemath-10.0"
        },
        kernelOptions: {
            name: "sagemath-10.0",
            path: "./26MCS320symbol_comput"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sagemath-10.0'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec1">Lec1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec2">Lec2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec3">Lec3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec4">Lec4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec5">Lec5</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec6">Lec6</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec7">Lec7</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec8">Lec8</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec9">Lec9</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec10">Lec10</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec11">Lec11</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec12">Lec12</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec13">Lec13</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec14">Lec14</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec15">Lec15</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec19">Lec19</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec20">Lec20</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec21">Lec21</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec22">Lec22</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec23">Lec23</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec24">Lec24</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec25">Lec25</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec26">Lec26</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec27">Lec27</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec28">Lec28</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec29">Lec29</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec30">Lec30</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec31">Lec31</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec32">Lec32</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec33">Lec33</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec34">Lec34</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec39">Lec39</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec40">Lec40</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec41">Lec41</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lec42">Lec42</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonny, assisted by Tom
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>