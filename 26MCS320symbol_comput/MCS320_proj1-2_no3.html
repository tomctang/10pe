
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Project One &#8212; Jonny Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=550f00eb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '26MCS320symbol_comput/MCS320_proj1-2_no3';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Jonny Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Math &amp; FP/Language</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../past/Alevel_math.html">A-level-math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Alevel_math_further.html">A-level-further</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MCM.html">Math Computational Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_Lean.html">Lean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_Puzzle.html">Permutation Puzzles</a></li>


<li class="toctree-l1"><a class="reference internal" href="../Course_Ext_III.html">Ext III</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0mmgroup.html">mmgroup Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CS &amp; Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MIT6001Python.html">MIT_CS6001-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MIT6002thinking.html">MIT_CS6002-CS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PE100.html">Project Euler Q1-50</a></li>


<li class="toctree-l1"><a class="reference internal" href="../PE_Informatics/PE_tags.html">Project Euler Tag-Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MCM_QM.html">Quantum Mechanics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook &amp; Tom</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../past/nb_past_courses.html">Past courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/nb_Geo.html">Geography and Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/nb_lottery_simulator.html">Lottery Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/How_Dad_organise_QM.html">How Dad learn QM</a></li>


<li class="toctree-l1"><a class="reference internal" href="../Course_MCM_QFT.html">QFT</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/10pe" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/26MCS320symbol_comput/MCS320_proj1-2_no3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Project One</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Project One</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-with-intervals">1. Arithmetic with Intervals</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-one">Assignment One</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#algebraic-numbers">2. Algebraic Numbers</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-two">Assignment Two.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-a-polynomial">3. Evaluating a Polynomial</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-three">Assignment Three</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#project-one-answers">Project One - Answers</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1. Arithmetic with Intervals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Assignment One</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-assignment-one">Solution to Assignment One</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2. Algebraic Numbers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Assignment Two.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-assignment-two">Solution to Assignment Two</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">3. Evaluating a Polynomial</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Assignment Three</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-assignment-three">Solution to Assignment Three</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#project-two">Project Two</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-polynomials">1. Orthogonal Polynomials</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-approximations">2. Least Squares Approximations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Assignment One</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Assignment Two</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#shifted-chebyshev-polynomials">3. Shifted Chebyshev polynomials</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Assignment Three</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-four">Assignment Four</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-five">Assignment Five</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#project-two-answers">Project Two - Answers</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">1. Orthogonal Polynomials</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">2. Least Squares Approximations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Assignment One</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">solution to assignment one</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Assignment Two</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-assignment-two">answer to assignment two</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">3. Shifted Chebyshev polynomials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Assignment Three</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-assignment-three">answer to assignment three</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Assignment Four</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-assignment-four">answer to assignment four</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Assignment Five</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-assignment-five">answer to assignment five</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="project-one">
<h1>Project One<a class="headerlink" href="#project-one" title="Link to this heading">#</a></h1>
<p>MCS 320 Project One is due Wednesday 2 July 2025 at 2pm.</p>
<p>Interval arithmetic provides an automated error analysis and helps to decide on the choice of the working precision.  The goal of the project is to explore interval arithmetic in SageMath and to conduct systematically numerical experiments.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="arithmetic-with-intervals">
<h1>1. Arithmetic with Intervals<a class="headerlink" href="#arithmetic-with-intervals" title="Link to this heading">#</a></h1>
<p>Instances of <code class="docutils literal notranslate"><span class="pre">RIF</span></code> are intervals where the lower and upper bounds are elements of <code class="docutils literal notranslate"><span class="pre">RR</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RIF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Real Interval Field with 53 bits of precision
</pre></div>
</div>
</div>
</div>
<p>Even though we are working with 53 bits of precision, we assume only the first five decimal places of the numbers are accurate.  So we have an error of <span class="math notranslate nohighlight">\(10^{-5}\)</span> on the numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="mf">1.0e-5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.309769031592794
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3098?
</pre></div>
</div>
</div>
</div>
<p>The interval <code class="docutils literal notranslate"><span class="pre">X</span></code> represents <span class="math notranslate nohighlight">\(x \pm 10^{-5}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;brackets&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;[0.30975903159279388 .. 0.30977903159279391]&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.309759031592793
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.309779031592794
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">absolute_diameter</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0000200000000000200
</pre></div>
</div>
</div>
</div>
<p>To illustrate the elementary arithmetical operations, we define another interval <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">Y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7474?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="n">Y</span>
<span class="n">S</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0572?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">Y</span>
<span class="n">P</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2316?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">Y</span>
<span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4145?
</pre></div>
</div>
</div>
</div>
<p>We see that in the output we can trust the first 4 decimal places.</p>
<p>However, there are instances that lead to a catastrophic loss of accuracy, when we subtract numbers that share several leading bits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span><span class="o">*</span><span class="mf">1.e-4</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">e</span><span class="p">,</span><span class="n">z</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">X</span><span class="o">-</span><span class="n">Z</span>
<span class="n">S</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0001?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">absolute_diameter</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0000400000000000400
</pre></div>
</div>
</div>
</div>
<p>Instead of 4 decimal places of accuracy, we have only one left.</p>
<section id="assignment-one">
<h2>Assignment One<a class="headerlink" href="#assignment-one" title="Link to this heading">#</a></h2>
<p>Generate <code class="docutils literal notranslate"><span class="pre">X</span></code> as above and make <code class="docutils literal notranslate"><span class="pre">Y</span></code> as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">f</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
   <span class="n">Y</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">f</span></code> takes the values <code class="docutils literal notranslate"><span class="pre">1.0e-1</span></code>, <code class="docutils literal notranslate"><span class="pre">1.0e-2</span></code>,
<code class="docutils literal notranslate"><span class="pre">1.0e-3</span></code>, <code class="docutils literal notranslate"><span class="pre">1.0e-4</span></code>, <code class="docutils literal notranslate"><span class="pre">1.0e-5</span></code>, and <code class="docutils literal notranslate"><span class="pre">1.0e-6</span></code>.</p>
<ol class="arabic simple">
<li><p>For each value of <code class="docutils literal notranslate"><span class="pre">f</span></code>, compute <code class="docutils literal notranslate"><span class="pre">S</span> <span class="pre">=</span> <span class="pre">X</span> <span class="pre">-</span> <span class="pre">Y</span></code>
and report <code class="docutils literal notranslate"><span class="pre">S.absolute_diameter()</span></code>.</p></li>
<li><p>Write a couple of sentences interpreting the results.</p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="algebraic-numbers">
<h1>2. Algebraic Numbers<a class="headerlink" href="#algebraic-numbers" title="Link to this heading">#</a></h1>
<p>An algebraic number is a root of a polynomial equation with integer coefficients.  A feature of the intervals as instances of <code class="docutils literal notranslate"><span class="pre">RIF</span></code> is the <code class="docutils literal notranslate"><span class="pre">algdep()</span></code> method which computes algebraic dependencies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">RIF</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="n">e</span><span class="p">))</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.41422?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29*x - 41
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 - 2
</pre></div>
</div>
</div>
</div>
<p>Already a low accuracy approximation for <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> suffices to obtain the correct polynomial <span class="math notranslate nohighlight">\(x^2 - 2\)</span> which defines the algebraic number <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>.</p>
<section id="assignment-two">
<h2>Assignment Two.<a class="headerlink" href="#assignment-two" title="Link to this heading">#</a></h2>
<p>Consider <span class="math notranslate nohighlight">\(2^{1/8}\)</span>, the 8-th root of 2.
What is the smallest number of digits in the floating-point approximation
of <span class="math notranslate nohighlight">\(2^{1/8}\)</span> to accurately compute the coefficients of <span class="math notranslate nohighlight">\(2 - x^8\)</span>,
using the default working precision and tolerance?</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="evaluating-a-polynomial">
<h1>3. Evaluating a Polynomial<a class="headerlink" href="#evaluating-a-polynomial" title="Link to this heading">#</a></h1>
<p>The higher the degree of a polynomial, the more errors accumulate in a numerical evaluation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">[]</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Univariate Polynomial Ring in x over Real Interval Field with 53 bits of precision
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">6</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^6 - 6*x^5 + 15*x^4 - 20*x^3 + 15*x^2 - 6*x + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">-</span> <span class="n">e</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span>
<span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5000?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pz</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">pz</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.02?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pz</span><span class="o">.</span><span class="n">absolute_diameter</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.00162749999993883
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pz</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0148112472812801
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pz</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0164387472812190
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.015625000000000000?
</pre></div>
</div>
</div>
</div>
<p>With a power of 6, we obtain only one correct decimal in the value when the error is 1.0e-5.</p>
<section id="assignment-three">
<h2>Assignment Three<a class="headerlink" href="#assignment-three" title="Link to this heading">#</a></h2>
<p>Consider</p>
<div class="math notranslate nohighlight">
\[
   p(x) = (1 - x)^d, \quad \mbox{for } d = 1,2,\ldots,10,
\]</div>
<p>evaluated at</p>
<div class="math notranslate nohighlight">
\[
   Z = [1.5 - 10^{-k}, 1.5 + 10^{+k}], \quad \mbox{for } k = 1,2,\ldots,10.
\]</div>
<p>How does the width of the interval <span class="math notranslate nohighlight">\(p(Z)\)</span> change for increasing
values of <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(k\)</span>?</p>
<ol class="arabic simple">
<li><p>Report the absolute diameter of the interval <span class="math notranslate nohighlight">\(p(Z)\)</span>,
for <span class="math notranslate nohighlight">\(d = 1,2,\ldots,10\)</span> and <span class="math notranslate nohighlight">\(k=1,2,\ldots,10\)</span> in a table,
where the rows are indexed by <span class="math notranslate nohighlight">\(k\)</span> and the columns by <span class="math notranslate nohighlight">\(d\)</span>.</p></li>
<li><p>Compare with the exact value <span class="math notranslate nohighlight">\(p(3/2)\)</span> and the error predicted
by the width of the intervals.</p></li>
<li><p>Write a couple of sentences interpreting the numerical errors.</p></li>
</ol>
<blockquote>
<div><ol class="arabic simple" start="4">
<li><p>The Deadline is Wednesday 2 July, at 2pm.</p></li>
</ol>
</div></blockquote>
<p>Upload your answer to gradescope at the latest on Wednesday 2 July,
before 2pm.</p>
<p>The solution consists of one single notebook,
organized according to the assignments.
Mark the start of each solution to an assignment using a heading in a cell.
Your notebook should run from top to bottom as a program without errors.
Apply proper formatting in your notebook so it reads
like a technical report if you would print it.
Document the execution cells with complete sentences,
properly formatted in markdown cells.</p>
<p>You may (not must) work in pairs for this project.
A pair consists of two, not three or more.
If you decide to work in a pair,
then you must send me an email with the name of your partner and
with the email address of your partner in the copy of the email,
before 2pm on Wednesday 25 June.
If working in a pair, then only one Jupyter notebook should be submitted.</p>
<p>If you have questions, concerns, or difficulties,
feel free to contact me for help.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="project-one-answers">
<h1>Project One - Answers<a class="headerlink" href="#project-one-answers" title="Link to this heading">#</a></h1>
<p>Interval arithmetic provides an automated error analysis and helps to decide on the choice of the working precision.  The goal of the project is to explore interval arithmetic in SageMath and to conduct systematically numerical experiments.</p>
<section id="id1">
<h2>1. Arithmetic with Intervals<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Instances of <code class="docutils literal notranslate"><span class="pre">RIF</span></code> are intervals where the lower and upper bounds are elements of <code class="docutils literal notranslate"><span class="pre">RR</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RIF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Real Interval Field with 53 bits of precision
</pre></div>
</div>
</div>
</div>
<p>Even though we are working with 53 bits of precision, we assume only the first five decimal places of the numbers are accurate.  So we have an error of <span class="math notranslate nohighlight">\(10^{-5}\)</span> on the numbers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="mf">1.0e-5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0162893269919866
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0163?
</pre></div>
</div>
</div>
</div>
<p>The interval <code class="docutils literal notranslate"><span class="pre">X</span></code> represents <span class="math notranslate nohighlight">\(x \pm 10^{-5}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;brackets&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;[0.016279326991986597 .. 0.016299326991986597]&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0162793269919865
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0162993269919866
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">absolute_diameter</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0000199999999999992
</pre></div>
</div>
</div>
</div>
<p>To illustrate the elementary arithmetical operations, we define another interval <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">Y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.9427?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="n">Y</span>
<span class="n">S</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.9264?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="n">Y</span>
<span class="n">P</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.0154?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">Y</span>
<span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.0173?
</pre></div>
</div>
</div>
</div>
<p>We see that in the output we can trust the first 4 decimal places.</p>
<p>However, there are instances that lead to a catastrophic loss of accuracy, when we subtract numbers that share several leading bits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span><span class="o">*</span><span class="mf">1.e-4</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">e</span><span class="p">,</span><span class="n">z</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">X</span><span class="o">-</span><span class="n">Z</span>
<span class="n">S</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.0001?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">absolute_diameter</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0000399999999999984
</pre></div>
</div>
</div>
</div>
<p>Instead of 4 decimal places of accuracy, we have only one left.</p>
<section id="id2">
<h3>Assignment One<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Generate <code class="docutils literal notranslate"><span class="pre">X</span></code> as above and make <code class="docutils literal notranslate"><span class="pre">Y</span></code> as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">f</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
   <span class="n">Y</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="n">y</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">f</span></code> takes the values <code class="docutils literal notranslate"><span class="pre">1.0e-1</span></code>, <code class="docutils literal notranslate"><span class="pre">1.0e-2</span></code>,
<code class="docutils literal notranslate"><span class="pre">1.0e-3</span></code>, <code class="docutils literal notranslate"><span class="pre">1.0e-4</span></code>, <code class="docutils literal notranslate"><span class="pre">1.0e-5</span></code>, and <code class="docutils literal notranslate"><span class="pre">1.0e-6</span></code>.</p>
<ol class="arabic simple">
<li><p>For each value of <code class="docutils literal notranslate"><span class="pre">f</span></code>, compute <code class="docutils literal notranslate"><span class="pre">S</span> <span class="pre">=</span> <span class="pre">X</span> <span class="pre">-</span> <span class="pre">Y</span></code>
and report <code class="docutils literal notranslate"><span class="pre">S.absolute_diameter()</span></code>.</p></li>
<li><p>Write a couple of sentences interpreting the results.</p></li>
</ol>
</section>
<section id="solution-to-assignment-one">
<h3>Solution to Assignment One<a class="headerlink" href="#solution-to-assignment-one" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="mf">1.0e-5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0e-1</span><span class="p">,</span> <span class="mf">1.0e-2</span><span class="p">,</span> <span class="mf">1.0e-3</span><span class="p">,</span> <span class="mf">1.0e-4</span><span class="p">,</span> <span class="mf">1.0e-5</span><span class="p">,</span> <span class="mf">1.0e-6</span><span class="p">]:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">f</span><span class="o">*</span><span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">Y</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">absolute_diameter</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.0443? 0.0000399999999999984
-0.0073? 0.0000399999999999984
-0.0007? 0.0000399999999999984
0.0000? 0.0000399999999999984
0.0000? 0.0000399999999999984
0.0000? 0.0000399999999999984
</pre></div>
</div>
</div>
</div>
<p>As we consider the difference of the intervals, we notice that the difference becomes zero viewed from the error on the accuracy of five decimal places on the numbers.</p>
<p>The absolute diameter represents the absolute error and remains the same.</p>
</section>
</section>
<section id="id3">
<h2>2. Algebraic Numbers<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>An algebraic number is a root of a polynomial equation with integer coefficients.  A feature of the intervals as instances of <code class="docutils literal notranslate"><span class="pre">RIF</span></code> is the <code class="docutils literal notranslate"><span class="pre">algdep()</span></code> method which computes algebraic dependencies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">RIF</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="n">e</span><span class="p">))</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.41422?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>29*x - 41
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 - 2
</pre></div>
</div>
</div>
</div>
<p>Already a low accuracy approximation for <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> suffices to obtain the correct polynomial <span class="math notranslate nohighlight">\(x^2 - 2\)</span> which defines the algebraic number <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>.</p>
<section id="id4">
<h3>Assignment Two.<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Consider <span class="math notranslate nohighlight">\(2^{1/8}\)</span>, the 8-th root of 2.
What is the smallest number of digits in the floating-point approximation
of <span class="math notranslate nohighlight">\(2^{1/8}\)</span> to accurately compute the coefficients of <span class="math notranslate nohighlight">\(2 - x^8\)</span>,
using the default working precision and tolerance?</p>
</section>
<section id="solution-to-assignment-two">
<h3>Solution to Assignment Two<a class="headerlink" href="#solution-to-assignment-two" title="Link to this heading">#</a></h3>
<p>We begin with a large error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="mf">1.0e-2</span>
<span class="n">e</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0100000000000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="o">+</span><span class="n">e</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.09?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^6 + x^5 - x^2 - x - 1
</pre></div>
</div>
</div>
</div>
<p>With only 3 decimal places of accuracy in the approximation for <span class="math notranslate nohighlight">\(2^{1/8}\)</span>, we cannot recover the algebraic dependency correctly.  Let us take then a smaller error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="mf">1.0e-3</span>
<span class="n">e</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.00100000000000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="o">+</span><span class="n">e</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0905?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^8 - 2
</pre></div>
</div>
</div>
</div>
<p>Five decimal places of accuracy in the approximation for <span class="math notranslate nohighlight">\(2^{1/8}\)</span> suffice to recover the correct algebraic dependency.</p>
</section>
</section>
<section id="id5">
<h2>3. Evaluating a Polynomial<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>The higher the degree of a polynomial, the more errors accumulate in a numerical evaluation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">[]</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Univariate Polynomial Ring in x over Real Interval Field with 53 bits of precision
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">6</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^6 - 6*x^5 + 15*x^4 - 20*x^3 + 15*x^2 - 6*x + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">-</span> <span class="n">e</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span>
<span class="n">z</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.500?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pz</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">pz</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0?
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pz</span><span class="o">.</span><span class="n">absolute_diameter</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.162749906000022
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pz</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.0657771404872592
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pz</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0969727655127633
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.015625000000000000?
</pre></div>
</div>
</div>
</div>
<p>With a power of 6, we obtain only one correct decimal in the value when the error is 1.0e-5.</p>
<section id="id6">
<h3>Assignment Three<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>Consider</p>
<div class="math notranslate nohighlight">
\[
   p(x) = (1 - x)^d, \quad \mbox{for } d = 1,2,\ldots,10,
\]</div>
<p>evaluated at</p>
<div class="math notranslate nohighlight">
\[
   Z = [1.5 - 10^{-k}, 1.5 + 10^{+k}], \quad \mbox{for } k = 1,2,\ldots,10.
\]</div>
<p>How does the width of the interval <span class="math notranslate nohighlight">\(p(Z)\)</span> change for increasing
values of <span class="math notranslate nohighlight">\(d\)</span> and <span class="math notranslate nohighlight">\(k\)</span>?</p>
<ol class="arabic simple">
<li><p>Report the absolute diameter of the interval <span class="math notranslate nohighlight">\(p(Z)\)</span>,
for <span class="math notranslate nohighlight">\(d = 1,2,\ldots,10\)</span> and <span class="math notranslate nohighlight">\(k=1,2,\ldots,10\)</span> in a table,
where the rows are indexed by <span class="math notranslate nohighlight">\(k\)</span> and the columns by <span class="math notranslate nohighlight">\(d\)</span>.</p></li>
<li><p>Compare with the exact value <span class="math notranslate nohighlight">\(p(3/2)\)</span> and the error predicted
by the width of the intervals.</p></li>
<li><p>Write a couple of sentences interpreting the numerical errors.</p></li>
</ol>
</section>
<section id="solution-to-assignment-three">
<h3>Solution to Assignment Three<a class="headerlink" href="#solution-to-assignment-three" title="Link to this heading">#</a></h3>
<p>We start by computing the first table of diameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diam</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="n">d</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">-</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">10</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">10</span><span class="o">^</span><span class="n">k</span><span class="p">)</span>
        <span class="n">pZ</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
        <span class="n">diam</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pZ</span><span class="o">.</span><span class="n">absolute_diameter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Printing this table unformatted is a mess.  As we are mainly interested in the magnitudes of the numbers, we use scientific notations, using two digits for the exponent.</p>
<p>While the C formatting conversions could be used, the most convenient format is available in numpy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="n">diam</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">d</span><span class="p">],</span><span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0e-01 4.0e-01 1.0e+00 2.6e+00 6.8e+00 1.7e+01 4.5e+01 1.1e+02 2.9e+02 7.5e+02 
2.0e-02 4.0e-02 1.0e-01 2.6e-01 6.5e-01 1.6e+00 4.1e+00 1.0e+01 2.6e+01 6.4e+01 
2.0e-03 4.0e-03 1.0e-02 2.6e-02 6.5e-02 1.6e-01 4.1e-01 1.0e+00 2.5e+00 6.4e+00 
2.0e-04 4.0e-04 1.0e-03 2.6e-03 6.5e-03 1.6e-02 4.1e-02 1.0e-01 2.5e-01 6.4e-01 
2.0e-05 4.0e-05 1.0e-04 2.6e-04 6.5e-04 1.6e-03 4.1e-03 1.0e-02 2.5e-02 6.4e-02 
2.0e-06 4.0e-06 1.1e-05 2.6e-05 6.5e-05 1.6e-04 4.1e-04 1.0e-03 2.5e-03 6.4e-03 
2.0e-07 4.0e-07 1.1e-06 2.6e-06 6.5e-06 1.6e-05 4.1e-05 1.0e-04 2.5e-04 6.4e-04 
2.0e-08 4.0e-08 1.1e-07 2.6e-07 6.5e-07 1.6e-06 4.1e-06 1.0e-05 2.5e-05 6.4e-05 
2.0e-09 4.0e-09 1.1e-08 2.6e-08 6.5e-08 1.6e-07 4.1e-07 1.0e-06 2.5e-06 6.4e-06 
2.0e-10 4.0e-10 1.1e-09 2.6e-09 6.5e-09 1.6e-08 4.1e-08 1.0e-07 2.5e-07 6.4e-07 
</pre></div>
</div>
</div>
</div>
<p>We observe the following:</p>
<ol class="arabic simple">
<li><p>The smallest diameter occurs at the bottom left of the table, for <span class="math notranslate nohighlight">\(k=10\)</span> and <span class="math notranslate nohighlight">\(d=1\)</span>,
for a linear polynomial and tiny interval of width <span class="math notranslate nohighlight">\(2 \times 10^{-10}\)</span>.</p></li>
<li><p>The largest diameter occurs at the top right of the table, for <span class="math notranslate nohighlight">\(k=1\)</span> and <span class="math notranslate nohighlight">\(d=10\)</span>,
for a polynomial of degree 10 and a large interval of width <span class="math notranslate nohighlight">\(2 \times 10^{-1}\)</span>.</p></li>
<li><p>The diameters grow smaller in each row and larger in each column,
as the intervals get smaller and the degrees get larger.</p></li>
</ol>
<p>The diameter of each evaluated interval serves as a prediction for the error.</p>
<p>Let us compute another table of errors, as the diameters of the exact value subtracted from the evaluated intervals, for increasing degrees and decreasing interval diameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="n">d</span>
        <span class="n">exact</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">RIF</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">-</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">10</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="mi">10</span><span class="o">^</span><span class="n">k</span><span class="p">)</span>
        <span class="n">pZ</span> <span class="o">=</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Z</span><span class="p">)</span>
        <span class="n">eZ</span> <span class="o">=</span> <span class="n">pZ</span> <span class="o">-</span> <span class="n">exact</span>
        <span class="n">errs</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">eZ</span><span class="o">.</span><span class="n">absolute_diameter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">format_float_scientific</span><span class="p">(</span><span class="n">errs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">d</span><span class="p">],</span><span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0e-01 4.0e-01 1.0e+00 2.6e+00 6.8e+00 1.7e+01 4.5e+01 1.1e+02 2.9e+02 7.5e+02 
2.0e-02 4.0e-02 1.0e-01 2.6e-01 6.5e-01 1.6e+00 4.1e+00 1.0e+01 2.6e+01 6.4e+01 
2.0e-03 4.0e-03 1.0e-02 2.6e-02 6.5e-02 1.6e-01 4.1e-01 1.0e+00 2.5e+00 6.4e+00 
2.0e-04 4.0e-04 1.0e-03 2.6e-03 6.5e-03 1.6e-02 4.1e-02 1.0e-01 2.5e-01 6.4e-01 
2.0e-05 4.0e-05 1.0e-04 2.6e-04 6.5e-04 1.6e-03 4.1e-03 1.0e-02 2.5e-02 6.4e-02 
2.0e-06 4.0e-06 1.1e-05 2.6e-05 6.5e-05 1.6e-04 4.1e-04 1.0e-03 2.5e-03 6.4e-03 
2.0e-07 4.0e-07 1.1e-06 2.6e-06 6.5e-06 1.6e-05 4.1e-05 1.0e-04 2.5e-04 6.4e-04 
2.0e-08 4.0e-08 1.1e-07 2.6e-07 6.5e-07 1.6e-06 4.1e-06 1.0e-05 2.5e-05 6.4e-05 
2.0e-09 4.0e-09 1.1e-08 2.6e-08 6.5e-08 1.6e-07 4.1e-07 1.0e-06 2.5e-06 6.4e-06 
2.0e-10 4.0e-10 1.1e-09 2.6e-09 6.5e-09 1.6e-08 4.1e-08 1.0e-07 2.5e-07 6.4e-07 
</pre></div>
</div>
</div>
</div>
<p>We obtain exactly the same table as before.</p>
<p>The working precision of 53 bits of precision to compute the exact value at 3/2 is sufficient for still modest degrees and for the large diameters of the intervals.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="project-two">
<h1>Project Two<a class="headerlink" href="#project-two" title="Link to this heading">#</a></h1>
<p>The goal of the project is to apply numerical integration to compute least squares approximations of functions.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="orthogonal-polynomials">
<h1>1. Orthogonal Polynomials<a class="headerlink" href="#orthogonal-polynomials" title="Link to this heading">#</a></h1>
<p>The Chebyshev polynomials form an orthogonal basis with respect to the inner product</p>
<div class="math notranslate nohighlight">
\[
    \langle p, q \rangle = \frac{2}{\pi} \int_{-1}^1 \frac{p(x) q(x)}{\sqrt{1-x^2}} dx.
\]</div>
<p>To compute the integrals numerically, we apply the numerical software QUADPACK, wrapped below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps quad of scipy.integrate to compute</span>
<span class="sd">    the inner product of functions f with g.</span>
<span class="sd">    Returns a tuple with the value and an</span>
<span class="sd">    estimate of the error.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">pi</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">quad</span>
    <span class="n">integrand</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">pi</span>
    <span class="k">return</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.0e-12</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.0e-12</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;alg&#39;</span><span class="p">,</span> <span class="n">wvar</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>For the Chebyshev polynomials <span class="math notranslate nohighlight">\(T_i\)</span> and <span class="math notranslate nohighlight">\(T_j\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \langle T_i, T_j \rangle = \left\{
    \begin{array}{ccl}
       2 &amp; \mbox{if} &amp; i = 0 = j, \\
       1 &amp; \mbox{if} &amp; i = j, \\
       0 &amp; \mbox{if} &amp; i \not= j.
    \end{array}
    \right.
\end{split}\]</div>
<p>Let us verify this property on the first three Chebyshev polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T0</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">chebyshev_T</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">T0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle x \ {\mapsto}\ 1\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T0</span><span class="p">,</span> <span class="n">T0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.000000000000001, 6.437379080603478e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">chebyshev_T</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle x \ {\mapsto}\ x\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.0000000000000007, 7.206724385358528e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T0</span><span class="p">,</span> <span class="n">T1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 6.782799421513909e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">chebyshev_T</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle x \ {\mapsto}\ 2 \, x^{2} - 1\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.0000000000000004, 1.0880740738678562e-13)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 8.580555286706832e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T0</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-4.18479521910728e-17, 7.936379416209611e-14)
</pre></div>
</div>
</div>
</div>
<p>We will work with the first 10 Chebyshev polynomials, defined in the list below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">chebyshev_T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 x,
 2*x^2 - 1,
 4*x^3 - 3*x,
 8*x^4 - 8*x^2 + 1,
 16*x^5 - 20*x^3 + 5*x,
 32*x^6 - 48*x^4 + 18*x^2 - 1,
 64*x^7 - 112*x^5 + 56*x^3 - 7*x,
 128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1,
 256*x^9 - 576*x^7 + 432*x^5 - 120*x^3 + 9*x]
</pre></div>
</div>
</div>
</div>
<p>For numerical evaluation, we make fast callable objects of the Chebyshev polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f2</span> <span class="o">=</span> <span class="n">fast_callable</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">vars</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2*x^2 - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="p">[</span><span class="n">fast_callable</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">F</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 x,
 2*x^2 - 1,
 4*x^3 - 3*x,
 8*x^4 - 8*x^2 + 1,
 16*x^5 - 20*x^3 + 5*x,
 32*x^6 - 48*x^4 + 18*x^2 - 1,
 64*x^7 - 112*x^5 + 56*x^3 - 7*x,
 128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1,
 256*x^9 - 576*x^7 + 432*x^5 - 120*x^3 + 9*x]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.000000000000001, 6.437379080603478e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IPT</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">F</span><span class="p">:</span>
    <span class="n">IPT</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">F</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>To formate the table of inner products nicely, we use scientific formatting, as conveniently provided by numpy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">format_float_scientific</span> <span class="k">as</span> <span class="n">npfmt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the inner products :&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">IPT</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">npfmt</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the inner products :
+2.0e+00 +0.0e+00 -4.2e-17 +0.0e+00 -1.3e-16 +0.0e+00 -6.7e-16 -1.9e-15 +1.5e-15 +0.0e+00 
+0.0e+00 +1.0e+00 +0.0e+00 +1.4e-17 +0.0e+00 +6.3e-16 +0.0e+00 -1.7e-15 +0.0e+00 +5.7e-15 
-4.2e-17 +0.0e+00 +1.0e+00 +0.0e+00 -2.0e-17 +0.0e+00 -3.5e-16 +0.0e+00 +1.3e-15 +4.5e-17 
+0.0e+00 +1.4e-17 +0.0e+00 +1.0e+00 +0.0e+00 +2.8e-17 +0.0e+00 +1.4e-16 +1.4e-17 +3.4e-15 
-1.3e-16 +0.0e+00 -2.0e-17 +0.0e+00 +1.0e+00 +0.0e+00 +4.7e-16 -3.1e-17 +7.1e-16 +1.5e-16 
+0.0e+00 +6.3e-16 +0.0e+00 +2.8e-17 +0.0e+00 +1.0e+00 +1.4e-17 -5.0e-16 +1.3e-15 +2.1e-15 
-6.7e-16 +0.0e+00 -3.5e-16 +0.0e+00 +4.7e-16 +1.4e-17 +1.0e+00 +0.0e+00 +2.2e-15 -4.0e-16 
-1.9e-15 -1.7e-15 +0.0e+00 +1.4e-16 -3.1e-17 -5.0e-16 +0.0e+00 +1.0e+00 +0.0e+00 +1.7e-15 
+1.5e-15 +0.0e+00 +1.3e-15 +1.4e-17 +7.1e-16 +1.3e-15 +2.2e-15 +0.0e+00 +1.0e+00 +0.0e+00 
+0.0e+00 +5.7e-15 +4.5e-17 +3.4e-15 +1.5e-16 +2.1e-15 -4.0e-16 +1.7e-15 +0.0e+00 +1.0e+00 
</pre></div>
</div>
</div>
</div>
<p>We have computed a numerical approximation of the identity matrix, with the exception of the very first element, which equals 2, in agreement with the definition of the inner product.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the error estimates :&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">IPT</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">npfmt</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the error estimates :
+6.4e-14 +6.8e-14 +7.9e-14 +1.0e-13 +1.5e-13 +2.5e-13 +4.8e-13 +6.0e-13 +2.0e-13 +4.3e-13 
+6.8e-14 +7.2e-14 +8.6e-14 +1.2e-13 +1.8e-13 +3.2e-13 +6.5e-13 +9.5e-13 +4.6e-13 +5.2e-13 
+7.9e-14 +8.6e-14 +1.1e-13 +1.6e-13 +2.8e-13 +5.8e-13 +7.7e-13 +2.8e-13 +4.8e-13 +6.6e-13 
+1.0e-13 +1.2e-13 +1.6e-13 +2.7e-13 +5.6e-13 +7.7e-13 +2.2e-13 +6.2e-13 +6.4e-13 +4.3e-14 
+1.5e-13 +1.8e-13 +2.8e-13 +5.6e-13 +7.6e-13 +2.7e-13 +5.5e-13 +8.4e-13 +4.3e-14 +8.2e-13 
+2.5e-13 +3.2e-13 +5.8e-13 +7.7e-13 +2.7e-13 +5.6e-13 +6.3e-13 +4.1e-14 +8.5e-13 +5.3e-13 
+4.8e-13 +6.5e-13 +7.7e-13 +2.2e-13 +5.5e-13 +6.3e-13 +4.1e-14 +8.5e-13 +5.3e-13 +5.6e-13 
+6.0e-13 +9.5e-13 +2.8e-13 +6.2e-13 +8.4e-13 +4.1e-14 +8.5e-13 +5.3e-13 +9.9e-13 +8.0e-13 
+2.0e-13 +4.6e-13 +4.8e-13 +6.4e-13 +4.3e-14 +8.5e-13 +5.3e-13 +9.9e-13 +8.0e-13 +1.3e-13 
+4.3e-13 +5.2e-13 +6.6e-13 +4.3e-14 +8.2e-13 +5.3e-13 +5.6e-13 +8.0e-13 +1.3e-13 +3.0e-13 
</pre></div>
</div>
</div>
</div>
<p>The error estimates are all close enough to the double precision.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="least-squares-approximations">
<h1>2. Least Squares Approximations<a class="headerlink" href="#least-squares-approximations" title="Link to this heading">#</a></h1>
<p>For any function <span class="math notranslate nohighlight">\(f(x)\)</span>, we compute an approximation in the Chebyshev basis as</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{a_0}{2} + \sum_{k=1}^n a_k T_k(x),
\]</div>
<p>where the coefficients are computed via the inner products:</p>
<div class="math notranslate nohighlight">
\[
    a_i = \langle f, T_i \rangle, \quad i = 0, 1, \ldots, n.
\]</div>
<p>By the orthogonality of the Chebyshev basis, the approximation minimizes the square of the errors.</p>
<p>As our first example, let us take the exponential function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We compute all inner products with the coefficients in the Chebyshev basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipft</span> <span class="o">=</span> <span class="p">[</span><span class="n">inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">F</span><span class="p">]</span>
<span class="n">ipft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(2.532131755504017, 1.040186253878001e-13),
 (1.13031820798497, 1.1006348135373264e-13),
 (0.2714953395340766, 1.3178963575076938e-13),
 (0.04433684984866379, 1.7857839101954588e-13),
 (0.0054742404420936655, 2.786619721827698e-13),
 (0.0005429263119147293, 5.133024770551932e-13),
 (4.49773229534399e-05, 4.0632208051382745e-14),
 (3.198436462445442e-06, 3.457695298999247e-13),
 (1.9921248281540294e-07, 5.077670324275304e-13),
 (1.1036778269080116e-08, 9.24341447624303e-14)]
</pre></div>
</div>
</div>
</div>
<p>All error estimates are again really tiny.  We select the coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">ip</span> <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ipft</span><span class="p">]</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.532131755504017,
 1.13031820798497,
 0.2714953395340766,
 0.04433684984866379,
 0.0054742404420936655,
 0.0005429263119147293,
 4.49773229534399e-05,
 3.198436462445442e-06,
 1.9921248281540294e-07,
 1.1036778269080116e-08]
</pre></div>
</div>
</div>
</div>
<p>Finally, we can assemble the approximation for the function <span class="math notranslate nohighlight">\(f\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="n">t</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:])])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.82541523688451e-06)*x^9 + (2.5499197800371576e-05)*x^8 + 0.00019834274931351814*x^7 + 0.0013882759389093335*x^6 + 0.008333363995054022*x^5 + 0.04166688603223467*x^4 + 0.16666666118486523*x^3 + 0.49999997254511575*x^2 + 1.0000000002743197*x + 1.0000000005495548
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pA</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">pA</span> <span class="o">+</span> <span class="n">pf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b4cdf2f4edb12624d56bf9f7c30004d5a3c68dfc5bd23b41bc9e22d5a337fa2c.png" src="../_images/b4cdf2f4edb12624d56bf9f7c30004d5a3c68dfc5bd23b41bc9e22d5a337fa2c.png" />
</div>
</div>
<p>We see no difference between the approximation and the function itself.</p>
<p>Let us plot the errors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errA</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="p">))</span>
<span class="n">errA</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.495548460743294e-10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">errA</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">6.0e-10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5fb91771e656e40f4d8badb8d05443aec9e6e4713e4fcd1a831ae39da295e45d.png" src="../_images/5fb91771e656e40f4d8badb8d05443aec9e6e4713e4fcd1a831ae39da295e45d.png" />
</div>
</div>
<p>We see that the 9-th degree polynomial approximates <span class="math notranslate nohighlight">\(f = \exp(x)\)</span> with an absolute error less than <span class="math notranslate nohighlight">\(6 \times 10^{-10}\)</span>.</p>
<section id="id7">
<h2>Assignment One<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Consider <span class="math notranslate nohighlight">\(f(x) = \sin(2 \pi x)\)</span> over <span class="math notranslate nohighlight">\([-1, 1]\)</span>.  How many terms in the least squares Chebyshev approximation are needed to obtain an absolute error of <span class="math notranslate nohighlight">\(10^{-2}\)</span> over <span class="math notranslate nohighlight">\([-1, 1]\)</span>.</p></li>
<li><p>Compute the smallest number of Chebyshev polynomials needed to get this error.</p></li>
</ol>
</section>
<section id="id8">
<h2>Assignment Two<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Consider <span class="math notranslate nohighlight">\(f(x) = \sin(2 \pi x)\)</span> over <span class="math notranslate nohighlight">\([-1,+1]\)</span>.  Use the first 16 Chebyshev polynomials to compute a least squares approximation for <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>What is the error?</p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="shifted-chebyshev-polynomials">
<h1>3. Shifted Chebyshev polynomials<a class="headerlink" href="#shifted-chebyshev-polynomials" title="Link to this heading">#</a></h1>
<p>For functions that have a singularity in the middle of <span class="math notranslate nohighlight">\([-1,+1]\)</span>,
such as <span class="math notranslate nohighlight">\(\sqrt{x}\)</span>,
it is better to consider <span class="math notranslate nohighlight">\([0, 1]\)</span> as the interval and work with
shifted Chebyshev polynomials.</p>
<p>The shifted Chebyshev polynomials are <span class="math notranslate nohighlight">\(T_n^*(x) = T_n(2 x - 1)\)</span>,
defined over the interval <span class="math notranslate nohighlight">\([0,1]\)</span>, forming an orthogonal basis
with respect to the weight</p>
<div class="math notranslate nohighlight">
\[
    w(x) = \frac{1}{\sqrt{x-x^2}}.
\]</div>
<section id="id9">
<h2>Assignment Three<a class="headerlink" href="#id9" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Define the sequence of the first 10 shifted Chebyshev polynomials and their corresponding list of fast callables.</p></li>
<li><p>Adjust the function <code class="docutils literal notranslate"><span class="pre">inner_product</span></code> into a new function <code class="docutils literal notranslate"><span class="pre">shifted_inner_product</span></code>, changing the integration interval from <span class="math notranslate nohighlight">\([-1,+1]\)</span> into <span class="math notranslate nohighlight">\([0, 1]\)</span>.</p></li>
<li><p>Verify the orthogonality of the basis by computing the 10-by-10 table of all inner products, along with the estimates for the errors.</p></li>
</ol>
</section>
<section id="assignment-four">
<h2>Assignment Four<a class="headerlink" href="#assignment-four" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Consider <span class="math notranslate nohighlight">\(f(x) = \exp{x}\)</span> and use the first 16 shifted Chebyshev polynomials to compute a least squares approximation for <span class="math notranslate nohighlight">\(f\)</span> over <span class="math notranslate nohighlight">\([0, 1]\)</span>.</p></li>
<li><p>What is the error?  Compare with the error of the least squares approximation in the Chebyshev basis for <span class="math notranslate nohighlight">\(f\)</span> over <span class="math notranslate nohighlight">\([-1, 1]\)</span>.</p></li>
</ol>
</section>
<section id="assignment-five">
<h2>Assignment Five<a class="headerlink" href="#assignment-five" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Consider <span class="math notranslate nohighlight">\(f(x) = \sqrt{x}\)</span> and use the first 16 shifted Chebyshev polynomials to compute a least squares approximation for <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>What is the error?</p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="project-two-answers">
<h1>Project Two - Answers<a class="headerlink" href="#project-two-answers" title="Link to this heading">#</a></h1>
<p>The goal of the project is to apply numerical integration to compute least squares approximations of functions.</p>
<section id="id10">
<h2>1. Orthogonal Polynomials<a class="headerlink" href="#id10" title="Link to this heading">#</a></h2>
<p>The Chebyshev polynomials form an orthogonal basis with respect to the inner product</p>
<div class="math notranslate nohighlight">
\[
    \langle p, q \rangle = \frac{2}{\pi} \int_{-1}^1 \frac{p(x) q(x)}{\sqrt{1-x^2}} dx.
\]</div>
<p>To compute the integrals numerically, we apply the numerical software QUADPACK, wrapped below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps quad of scipy.integrate to compute</span>
<span class="sd">    the inner product of functions f with g.</span>
<span class="sd">    Returns a tuple with the value and an</span>
<span class="sd">    estimate of the error.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">pi</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">quad</span>
    <span class="n">integrand</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">pi</span>
    <span class="k">return</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.0e-12</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.0e-12</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;alg&#39;</span><span class="p">,</span> <span class="n">wvar</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>For the Chebyshev polynomials <span class="math notranslate nohighlight">\(T_i\)</span> and <span class="math notranslate nohighlight">\(T_j\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \langle T_i, T_j \rangle = \left\{
    \begin{array}{ccl}
       2 &amp; \mbox{if} &amp; i = 0 = j, \\
       1 &amp; \mbox{if} &amp; i = j, \\
       0 &amp; \mbox{if} &amp; i \not= j.
    \end{array}
    \right.
\end{split}\]</div>
<p>Let us verify this property on the first three Chebyshev polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T0</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">chebyshev_T</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">T0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle x \ {\mapsto}\ 1\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T0</span><span class="p">,</span> <span class="n">T0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.000000000000001, 6.437379080603478e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">chebyshev_T</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">T1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle x \ {\mapsto}\ x\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.0000000000000007, 7.206724385358528e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T0</span><span class="p">,</span> <span class="n">T1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 6.782799421513909e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">chebyshev_T</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle x \ {\mapsto}\ 2 \, x^{2} - 1\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T2</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.0000000000000004, 1.0880740738678562e-13)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 8.580555286706832e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">T0</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-4.18479521910728e-17, 7.936379416209611e-14)
</pre></div>
</div>
</div>
</div>
<p>We will work with the first 10 Chebyshev polynomials, defined in the list below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">chebyshev_T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 x,
 2*x^2 - 1,
 4*x^3 - 3*x,
 8*x^4 - 8*x^2 + 1,
 16*x^5 - 20*x^3 + 5*x,
 32*x^6 - 48*x^4 + 18*x^2 - 1,
 64*x^7 - 112*x^5 + 56*x^3 - 7*x,
 128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1,
 256*x^9 - 576*x^7 + 432*x^5 - 120*x^3 + 9*x]
</pre></div>
</div>
</div>
</div>
<p>For numerical evaluation, we make fast callable objects of the Chebyshev polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f2</span> <span class="o">=</span> <span class="n">fast_callable</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">vars</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2*x^2 - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="p">[</span><span class="n">fast_callable</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">F</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 x,
 2*x^2 - 1,
 4*x^3 - 3*x,
 8*x^4 - 8*x^2 + 1,
 16*x^5 - 20*x^3 + 5*x,
 32*x^6 - 48*x^4 + 18*x^2 - 1,
 64*x^7 - 112*x^5 + 56*x^3 - 7*x,
 128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1,
 256*x^9 - 576*x^7 + 432*x^5 - 120*x^3 + 9*x]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inner_product</span><span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.000000000000001, 6.437379080603478e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IPT</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">F</span><span class="p">:</span>
    <span class="n">IPT</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">F</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>To formate the table of inner products nicely, we use scientific formatting, as conveniently provided by numpy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">format_float_scientific</span> <span class="k">as</span> <span class="n">npfmt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the inner products :&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">IPT</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">npfmt</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the inner products :
+2.0e+00 +0.0e+00 -4.2e-17 +0.0e+00 -1.3e-16 +0.0e+00 -6.7e-16 -1.9e-15 +1.5e-15 +0.0e+00 
+0.0e+00 +1.0e+00 +0.0e+00 +1.4e-17 +0.0e+00 +6.3e-16 +0.0e+00 -1.7e-15 +0.0e+00 +5.7e-15 
-4.2e-17 +0.0e+00 +1.0e+00 +0.0e+00 -2.0e-17 +0.0e+00 -3.5e-16 +0.0e+00 +1.3e-15 +4.5e-17 
+0.0e+00 +1.4e-17 +0.0e+00 +1.0e+00 +0.0e+00 +2.8e-17 +0.0e+00 +1.4e-16 +1.4e-17 +3.4e-15 
-1.3e-16 +0.0e+00 -2.0e-17 +0.0e+00 +1.0e+00 +0.0e+00 +4.7e-16 -3.1e-17 +7.1e-16 +1.5e-16 
+0.0e+00 +6.3e-16 +0.0e+00 +2.8e-17 +0.0e+00 +1.0e+00 +1.4e-17 -5.0e-16 +1.3e-15 +2.1e-15 
-6.7e-16 +0.0e+00 -3.5e-16 +0.0e+00 +4.7e-16 +1.4e-17 +1.0e+00 +0.0e+00 +2.2e-15 -4.0e-16 
-1.9e-15 -1.7e-15 +0.0e+00 +1.4e-16 -3.1e-17 -5.0e-16 +0.0e+00 +1.0e+00 +0.0e+00 +1.7e-15 
+1.5e-15 +0.0e+00 +1.3e-15 +1.4e-17 +7.1e-16 +1.3e-15 +2.2e-15 +0.0e+00 +1.0e+00 +0.0e+00 
+0.0e+00 +5.7e-15 +4.5e-17 +3.4e-15 +1.5e-16 +2.1e-15 -4.0e-16 +1.7e-15 +0.0e+00 +1.0e+00 
</pre></div>
</div>
</div>
</div>
<p>We have computed a numerical approximation of the identity matrix, with the exception of the very first element, which equals 2, in agreement with the definition of the inner product.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the error estimates :&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">IPT</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">npfmt</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the error estimates :
+6.4e-14 +6.8e-14 +7.9e-14 +1.0e-13 +1.5e-13 +2.5e-13 +4.8e-13 +6.0e-13 +2.0e-13 +4.3e-13 
+6.8e-14 +7.2e-14 +8.6e-14 +1.2e-13 +1.8e-13 +3.2e-13 +6.5e-13 +9.5e-13 +4.6e-13 +5.2e-13 
+7.9e-14 +8.6e-14 +1.1e-13 +1.6e-13 +2.8e-13 +5.8e-13 +7.7e-13 +2.8e-13 +4.8e-13 +6.6e-13 
+1.0e-13 +1.2e-13 +1.6e-13 +2.7e-13 +5.6e-13 +7.7e-13 +2.2e-13 +6.2e-13 +6.4e-13 +4.3e-14 
+1.5e-13 +1.8e-13 +2.8e-13 +5.6e-13 +7.6e-13 +2.7e-13 +5.5e-13 +8.4e-13 +4.3e-14 +8.2e-13 
+2.5e-13 +3.2e-13 +5.8e-13 +7.7e-13 +2.7e-13 +5.6e-13 +6.3e-13 +4.1e-14 +8.5e-13 +5.3e-13 
+4.8e-13 +6.5e-13 +7.7e-13 +2.2e-13 +5.5e-13 +6.3e-13 +4.1e-14 +8.5e-13 +5.3e-13 +5.6e-13 
+6.0e-13 +9.5e-13 +2.8e-13 +6.2e-13 +8.4e-13 +4.1e-14 +8.5e-13 +5.3e-13 +9.9e-13 +8.0e-13 
+2.0e-13 +4.6e-13 +4.8e-13 +6.4e-13 +4.3e-14 +8.5e-13 +5.3e-13 +9.9e-13 +8.0e-13 +1.3e-13 
+4.3e-13 +5.2e-13 +6.6e-13 +4.3e-14 +8.2e-13 +5.3e-13 +5.6e-13 +8.0e-13 +1.3e-13 +3.0e-13 
</pre></div>
</div>
</div>
</div>
<p>The error estimates are all close enough to the double precision.</p>
</section>
<section id="id11">
<h2>2. Least Squares Approximations<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<p>For any function <span class="math notranslate nohighlight">\(f(x)\)</span>, we compute an approximation in the Chebyshev basis as</p>
<div class="math notranslate nohighlight">
\[
    f(x) = \frac{a_0}{2} + \sum_{k=1}^n a_k T_k(x),
\]</div>
<p>where the coefficients are computed via the inner products:</p>
<div class="math notranslate nohighlight">
\[
    a_i = \langle f, T_i \rangle, \quad i = 0, 1, \ldots, n.
\]</div>
<p>By the orthogonality of the Chebyshev basis, the approximation minimizes the square of the errors.</p>
<p>As our first example, let us take the exponential function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We compute all inner products with the coefficients in the Chebyshev basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipft</span> <span class="o">=</span> <span class="p">[</span><span class="n">inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">F</span><span class="p">]</span>
<span class="n">ipft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(2.532131755504017, 1.040186253878001e-13),
 (1.13031820798497, 1.1006348135373264e-13),
 (0.2714953395340766, 1.3178963575076938e-13),
 (0.04433684984866379, 1.7857839101954588e-13),
 (0.0054742404420936655, 2.786619721827698e-13),
 (0.0005429263119147293, 5.133024770551932e-13),
 (4.49773229534399e-05, 4.0632208051382745e-14),
 (3.198436462445442e-06, 3.457695298999247e-13),
 (1.9921248281540294e-07, 5.077670324275304e-13),
 (1.1036778269080116e-08, 9.24341447624303e-14)]
</pre></div>
</div>
</div>
</div>
<p>All error estimates are again really tiny.  We select the coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">ip</span> <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ipft</span><span class="p">]</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.532131755504017,
 1.13031820798497,
 0.2714953395340766,
 0.04433684984866379,
 0.0054742404420936655,
 0.0005429263119147293,
 4.49773229534399e-05,
 3.198436462445442e-06,
 1.9921248281540294e-07,
 1.1036778269080116e-08]
</pre></div>
</div>
</div>
</div>
<p>Finally, we can assemble the approximation for the function <span class="math notranslate nohighlight">\(f\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="n">t</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:])])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2.82541523688451e-06)*x^9 + (2.5499197800371576e-05)*x^8 + 0.00019834274931351814*x^7 + 0.0013882759389093335*x^6 + 0.008333363995054022*x^5 + 0.04166688603223467*x^4 + 0.16666666118486523*x^3 + 0.49999997254511575*x^2 + 1.0000000002743197*x + 1.0000000005495548
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pA</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">pA</span> <span class="o">+</span> <span class="n">pf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b86e0598bc79e0a5af9468e3e320895526a691f4f38585337a3192e4ed58e8a2.png" src="../_images/b86e0598bc79e0a5af9468e3e320895526a691f4f38585337a3192e4ed58e8a2.png" />
</div>
</div>
<p>We see no difference between the approximation and the function itself.</p>
<p>Let us plot the errors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errA</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="p">))</span>
<span class="n">errA</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.495548460743294e-10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">errA</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">6.0e-10</span><span class="p">,</span> <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;e-10&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/80faa4ffcfe8096596bda2c05f53920a167dd3e63d8e4191465fa21ddad44367.png" src="../_images/80faa4ffcfe8096596bda2c05f53920a167dd3e63d8e4191465fa21ddad44367.png" />
</div>
</div>
<p>We see that the 9-th degree polynomial approximates <span class="math notranslate nohighlight">\(f = \exp(x)\)</span> with an absolute error less than <span class="math notranslate nohighlight">\(6 \times 10^{-10}\)</span>.</p>
<section id="id12">
<h3>Assignment One<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Consider <span class="math notranslate nohighlight">\(f(x) = \sin(2 \pi x)\)</span> over <span class="math notranslate nohighlight">\([-1, 1]\)</span>.  How many terms in the least squares Chebyshev approximation are needed to obtain an absolute error of <span class="math notranslate nohighlight">\(10^{-2}\)</span> over <span class="math notranslate nohighlight">\([-1, 1]\)</span>.</p></li>
<li><p>Compute the smallest number of Chebyshev polynomials needed to get this error.</p></li>
</ol>
</section>
<section id="id13">
<h3>solution to assignment one<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us select the first ten Chebyshev polynomials.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipft</span> <span class="o">=</span> <span class="p">[</span><span class="n">inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">F</span><span class="p">]</span>
<span class="n">ipft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0.0, 7.459000730499313e-15),
 (-0.4247650601527382, 1.7577840453197936e-14),
 (0.0, 9.082313396718633e-14),
 (-0.0582243920785146, 1.1347219099760717e-13),
 (0.0, 9.438212791613082e-13),
 (0.7456493159369406, 5.733434279864011e-15),
 (0.0, 6.712466112689804e-15),
 (-0.315042260224786, 9.93701217291686e-15),
 (0.0, 3.3909277583292514e-14),
 (0.05824776827954421, 9.869219843353269e-14)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">ip</span> <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ipft</span><span class="p">]</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0,
 -0.4247650601527382,
 0.0,
 -0.0582243920785146,
 0.0,
 0.7456493159369406,
 0.0,
 -0.315042260224786,
 0.0,
 0.05824776827954421]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="n">t</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:])])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.911428679563318*x^9 - 53.71341918340377*x^7 + 72.37815809693018*x^5 - 39.7779826531862*x^3 + 6.207680431856909*x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errA</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">errA</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/70c89dd92e24287182aebeaf61d0552a6f657b96d2289123b9a31d7dae433a6e.png" src="../_images/70c89dd92e24287182aebeaf61d0552a6f657b96d2289123b9a31d7dae433a6e.png" />
</div>
</div>
<p>Can we get away with less?  Observe that <span class="math notranslate nohighlight">\(\sin\)</span> is an odd function, the even degrees are missing.  So we select the first 8 polynomials in the basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipft</span> <span class="o">=</span> <span class="p">[</span><span class="n">inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">F</span><span class="p">[:</span><span class="mi">8</span><span class="p">]]</span>
<span class="n">ipft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0.0, 7.459000730499313e-15),
 (-0.4247650601527382, 1.7577840453197936e-14),
 (0.0, 9.082313396718633e-14),
 (-0.0582243920785146, 1.1347219099760717e-13),
 (0.0, 9.438212791613082e-13),
 (0.7456493159369406, 5.733434279864011e-15),
 (0.0, 6.712466112689804e-15),
 (-0.315042260224786, 9.93701217291686e-15)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">ip</span> <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ipft</span><span class="p">]</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0,
 -0.4247650601527382,
 0.0,
 -0.0582243920785146,
 0.0,
 0.7456493159369406,
 0.0,
 -0.315042260224786]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="n">t</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">])])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-20.162704654386303*x^7 + 47.21512220016709*x^5 - 32.78825045964089*x^3 + 5.6834505173410115*x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errA</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">errA</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/031b5b4913434f3f50d3e861e6cb61f5c7163b1b8b795aa413119924c511cd58.png" src="../_images/031b5b4913434f3f50d3e861e6cb61f5c7163b1b8b795aa413119924c511cd58.png" />
</div>
</div>
<p>We see that we need a 9-th degree Chebyshev polynomials in the basis.</p>
</section>
<section id="id14">
<h3>Assignment Two<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Consider <span class="math notranslate nohighlight">\(f(x) = \sin(2 \pi x)\)</span> over <span class="math notranslate nohighlight">\([-1,+1]\)</span>.  Use the first 16 Chebyshev polynomials to compute a least squares approximation for <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>What is the error?</p></li>
</ol>
</section>
<section id="answer-to-assignment-two">
<h3>answer to assignment two<a class="headerlink" href="#answer-to-assignment-two" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">chebyshev_T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 x,
 2*x^2 - 1,
 4*x^3 - 3*x,
 8*x^4 - 8*x^2 + 1,
 16*x^5 - 20*x^3 + 5*x,
 32*x^6 - 48*x^4 + 18*x^2 - 1,
 64*x^7 - 112*x^5 + 56*x^3 - 7*x,
 128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1,
 256*x^9 - 576*x^7 + 432*x^5 - 120*x^3 + 9*x,
 512*x^10 - 1280*x^8 + 1120*x^6 - 400*x^4 + 50*x^2 - 1,
 1024*x^11 - 2816*x^9 + 2816*x^7 - 1232*x^5 + 220*x^3 - 11*x,
 2048*x^12 - 6144*x^10 + 6912*x^8 - 3584*x^6 + 840*x^4 - 72*x^2 + 1,
 4096*x^13 - 13312*x^11 + 16640*x^9 - 9984*x^7 + 2912*x^5 - 364*x^3 + 13*x,
 8192*x^14 - 28672*x^12 + 39424*x^10 - 26880*x^8 + 9408*x^6 - 1568*x^4 + 98*x^2 - 1,
 16384*x^15 - 61440*x^13 + 92160*x^11 - 70400*x^9 + 28800*x^7 - 6048*x^5 + 560*x^3 - 15*x]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="p">[</span><span class="n">fast_callable</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipft</span> <span class="o">=</span> <span class="p">[</span><span class="n">inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">F</span><span class="p">]</span>
<span class="n">ipft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0.0, 7.459000730499313e-15),
 (-0.4247650601527382, 1.7577840453197936e-14),
 (0.0, 9.082313396718633e-14),
 (-0.0582243920785146, 1.1347219099760717e-13),
 (0.0, 9.438212791613082e-13),
 (0.7456493159369406, 5.733434279864011e-15),
 (0.0, 6.712466112689804e-15),
 (-0.315042260224786, 9.93701217291686e-15),
 (0.0, 3.3909277583292514e-14),
 (0.05824776827954421, 9.869219843353269e-14),
 (0.0, 1.4090251276300887e-13),
 (-0.006295650484748561, 6.421760048515432e-13),
 (0.0, 5.177645771141176e-13),
 (0.0004527711747479568, 9.859972294603532e-13),
 (8.673617379884035e-18, 8.101537814524105e-13),
 (-2.3376886493793603e-05, 1.7446438961538916e-13)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">ip</span> <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ipft</span><span class="p">]</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="n">t</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">:])])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.3830069083143144*x^15 + (7.105427357601002e-14)*x^14 + 3.29082663794631*x^13 - (2.4868995751603507e-13)*x^12 - 14.628449833895345*x^11 + (3.419486915845482e-13)*x^10 + 41.819825601584334*x^9 - (2.3314683517128287e-13)*x^8 - 76.63569268816057*x^7 + (8.1601392309949e-14)*x^6 + 81.59425256452091*x^5 - (1.3600232051658168e-14)*x^4 - 41.34092552387566*x^3 + (8.500145032286355e-16)*x^2 + 6.283169265758273*x - 8.673617379884035e-18
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errA</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">errA</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">1.0e-6</span><span class="p">,</span> <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;e-6&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9dc17f7e33d83517e259561310118ed4b5ad93b4fdc75ca27eb6fb15c5ee154a.png" src="../_images/9dc17f7e33d83517e259561310118ed4b5ad93b4fdc75ca27eb6fb15c5ee154a.png" />
</div>
</div>
<p>Using the first 16 Chebyshev polynomials, the error of the approximation is <span class="math notranslate nohighlight">\(10^{-6}\)</span>.</p>
</section>
</section>
<section id="id15">
<h2>3. Shifted Chebyshev polynomials<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<p>For functions that have a singularity in the middle of <span class="math notranslate nohighlight">\([-1,+1]\)</span>,
such as <span class="math notranslate nohighlight">\(\sqrt{x}\)</span>,
it is better to consider <span class="math notranslate nohighlight">\([0, 1]\)</span> as the interval and work with
shifted Chebyshev polynomials.</p>
<p>The shifted Chebyshev polynomials are <span class="math notranslate nohighlight">\(T_n^*(x) = T_n(2 x - 1)\)</span>,
defined over the interval <span class="math notranslate nohighlight">\([0,1]\)</span>, forming an orthogonal basis
with respect to the weight</p>
<div class="math notranslate nohighlight">
\[
    w(x) = \frac{1}{\sqrt{x-x^2}}.
\]</div>
<section id="id16">
<h3>Assignment Three<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Define the sequence of the first 10 shifted Chebyshev polynomials and their corresponding list of fast callables.</p></li>
<li><p>Adjust the function <code class="docutils literal notranslate"><span class="pre">inner_product</span></code> into a new function <code class="docutils literal notranslate"><span class="pre">shifted_inner_product</span></code>, changing the integration interval from <span class="math notranslate nohighlight">\([-1,+1]\)</span> into <span class="math notranslate nohighlight">\([0, 1]\)</span>.</p></li>
<li><p>Verify the orthogonality of the basis by computing the 10-by-10 table of all inner products, along with the estimates for the errors.</p></li>
</ol>
</section>
<section id="answer-to-assignment-three">
<h3>answer to assignment three<a class="headerlink" href="#answer-to-assignment-three" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">chebyshev_T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 x,
 2*x^2 - 1,
 4*x^3 - 3*x,
 8*x^4 - 8*x^2 + 1,
 16*x^5 - 20*x^3 + 5*x,
 32*x^6 - 48*x^4 + 18*x^2 - 1,
 64*x^7 - 112*x^5 + 56*x^3 - 7*x,
 128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1,
 256*x^9 - 576*x^7 + 432*x^5 - 120*x^3 + 9*x]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S2</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle 2 \, {\left(2 \, x - 1\right)}^{2} - 1\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
<span class="n">S</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 2*x - 1,
 8*x^2 - 8*x + 1,
 32*x^3 - 48*x^2 + 18*x - 1,
 128*x^4 - 256*x^3 + 160*x^2 - 32*x + 1,
 512*x^5 - 1280*x^4 + 1120*x^3 - 400*x^2 + 50*x - 1,
 2048*x^6 - 6144*x^5 + 6912*x^4 - 3584*x^3 + 840*x^2 - 72*x + 1,
 8192*x^7 - 28672*x^6 + 39424*x^5 - 26880*x^4 + 9408*x^3 - 1568*x^2 + 98*x - 1,
 32768*x^8 - 131072*x^7 + 212992*x^6 - 180224*x^5 + 84480*x^4 - 21504*x^3 + 2688*x^2 - 128*x + 1,
 131072*x^9 - 589824*x^8 + 1105920*x^7 - 1118208*x^6 + 658944*x^5 - 228096*x^4 + 44352*x^3 - 4320*x^2 + 162*x - 1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="p">[</span><span class="n">fast_callable</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">S</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 2*x - 1,
 8*x^2 - 8*x + 1,
 32*x^3 - 48*x^2 + 18*x - 1,
 128*x^4 - 256*x^3 + 160*x^2 - 32*x + 1,
 512*x^5 - 1280*x^4 + 1120*x^3 - 400*x^2 + 50*x - 1,
 2048*x^6 - 6144*x^5 + 6912*x^4 - 3584*x^3 + 840*x^2 - 72*x + 1,
 8192*x^7 - 28672*x^6 + 39424*x^5 - 26880*x^4 + 9408*x^3 - 1568*x^2 + 98*x - 1,
 32768*x^8 - 131072*x^7 + 212992*x^6 - 180224*x^5 + 84480*x^4 - 21504*x^3 + 2688*x^2 - 128*x + 1,
 131072*x^9 - 589824*x^8 + 1105920*x^7 - 1118208*x^6 + 658944*x^5 - 228096*x^4 + 44352*x^3 - 4320*x^2 + 162*x - 1]
</pre></div>
</div>
</div>
</div>
<p>In the computation of the inner product, we change the integration interval from <span class="math notranslate nohighlight">\([-1,+1]\)</span> to <span class="math notranslate nohighlight">\([0, 1]\)</span> and leave everything else the same.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">shifted_inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wraps quad of scipy.integrate to compute</span>
<span class="sd">    the inner product of functions f with g.</span>
<span class="sd">    Returns a tuple with the value and an</span>
<span class="sd">    estimate of the error.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">pi</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">quad</span>
    <span class="c1">#t = lambda x: (x+1)/2</span>
    <span class="n">integrand</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">pi</span>
    <span class="k">return</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epsabs</span><span class="o">=</span><span class="mf">1.0e-12</span><span class="p">,</span> <span class="n">epsrel</span><span class="o">=</span><span class="mf">1.0e-12</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;alg&#39;</span><span class="p">,</span> <span class="n">wvar</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shifted_inner_product</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.0000000000000007, 7.205347429817266e-14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IPT</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">G</span><span class="p">:</span>
    <span class="n">IPT</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">shifted_inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the inner products :&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">IPT</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">npfmt</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the inner products :
+2.0e+00 +0.0e+00 -8.0e-17 -2.8e-16 +4.5e-16 +1.7e-14 +1.3e-13 -1.6e-13 +1.0e-12 +6.9e-13 
+0.0e+00 +1.0e+00 -2.8e-17 -2.7e-16 +3.8e-16 +1.6e-14 +1.2e-13 -1.5e-13 +3.9e-13 +1.8e-12 
-8.0e-17 -2.8e-17 +1.0e+00 -2.2e-16 -2.5e-16 +1.6e-14 +1.0e-13 -1.8e-13 -3.4e-14 +5.0e-12 
-2.8e-16 -2.7e-16 -2.2e-16 +1.0e+00 -1.2e-15 -3.5e-15 -3.3e-15 -3.3e-14 -5.0e-13 -4.2e-12 
+4.5e-16 +3.8e-16 -2.5e-16 -1.2e-15 +1.0e+00 +9.4e-16 -3.2e-14 +4.9e-15 -3.1e-13 -6.7e-13 
+1.7e-14 +1.6e-14 +1.6e-14 -3.5e-15 +9.4e-16 +1.0e+00 -2.5e-14 +1.3e-13 -2.7e-13 -8.8e-13 
+1.3e-13 +1.2e-13 +1.0e-13 -3.3e-15 -3.2e-14 -2.5e-14 +1.0e+00 +3.1e-13 +2.1e-13 +7.8e-12 
-1.6e-13 -1.5e-13 -1.8e-13 -3.3e-14 +4.9e-15 +1.3e-13 +3.1e-13 +1.0e+00 +2.7e-13 +6.4e-12 
+1.0e-12 +3.9e-13 -3.4e-14 -5.0e-13 -3.1e-13 -2.7e-13 +2.1e-13 +2.7e-13 +1.0e+00 +3.0e-12 
+6.9e-13 +1.8e-12 +5.0e-12 -4.2e-12 -6.7e-13 -8.8e-13 +7.8e-12 +6.4e-12 +3.0e-12 +1.0e+00 
</pre></div>
</div>
</div>
</div>
<p>We have computed a numerical approximation of the identity matrix, with the exception of the very first element, which equals 2, in agreement with the definition of the inner product.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the error estimates :&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">IPT</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">npfmt</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sign</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the error estimates :
+6.5e-14 +6.8e-14 +7.9e-14 +1.0e-13 +1.5e-13 +2.4e-13 +3.8e-13 +9.1e-13 +8.3e-13 +8.8e-13 
+6.8e-14 +7.2e-14 +8.6e-14 +1.2e-13 +1.8e-13 +3.3e-13 +7.3e-13 +9.2e-13 +5.8e-13 +9.6e-13 
+7.9e-14 +8.6e-14 +1.1e-13 +1.6e-13 +2.8e-13 +5.7e-13 +7.5e-13 +8.4e-13 +6.0e-13 +4.4e-13 
+1.0e-13 +1.2e-13 +1.6e-13 +2.7e-13 +5.6e-13 +7.8e-13 +2.6e-13 +8.5e-13 +7.3e-13 +5.1e-13 
+1.5e-13 +1.8e-13 +2.8e-13 +5.6e-13 +7.6e-13 +2.9e-13 +5.8e-13 +3.5e-13 +1.3e-13 +8.7e-13 
+2.4e-13 +3.3e-13 +5.7e-13 +7.8e-13 +2.9e-13 +5.8e-13 +6.3e-13 +2.7e-13 +8.1e-13 +8.5e-13 
+3.8e-13 +7.3e-13 +7.5e-13 +2.6e-13 +5.8e-13 +6.3e-13 +1.0e-13 +6.5e-13 +6.7e-13 +7.6e-13 
+9.1e-13 +9.2e-13 +8.4e-13 +8.5e-13 +3.5e-13 +2.7e-13 +6.5e-13 +5.9e-13 +7.1e-13 +8.7e-13 
+8.3e-13 +5.8e-13 +6.0e-13 +7.3e-13 +1.3e-13 +8.1e-13 +6.7e-13 +7.1e-13 +7.8e-13 +8.0e-13 
+8.8e-13 +9.6e-13 +4.4e-13 +5.1e-13 +8.7e-13 +8.5e-13 +7.6e-13 +8.7e-13 +8.0e-13 +9.9e-13 
</pre></div>
</div>
</div>
</div>
<p>As observed with the Chebyshev basis, all error estimates for the integrals are tiny.</p>
</section>
<section id="id17">
<h3>Assignment Four<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Consider <span class="math notranslate nohighlight">\(f(x) = \exp{x}\)</span> and use the first 16 shifted Chebyshev polynomials to compute a least squares approximation for <span class="math notranslate nohighlight">\(f\)</span> over <span class="math notranslate nohighlight">\([0, 1]\)</span>.</p></li>
<li><p>What is the error?  Compare with the error of the least squares approximation in the Chebyshev basis for <span class="math notranslate nohighlight">\(f\)</span> over <span class="math notranslate nohighlight">\([-1, 1]\)</span>.</p></li>
</ol>
</section>
<section id="answer-to-assignment-four">
<h3>answer to assignment four<a class="headerlink" href="#answer-to-assignment-four" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipft</span> <span class="o">=</span> <span class="p">[</span><span class="n">shifted_inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]</span>
<span class="n">ipft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(3.506775308754182, 1.20570220474292e-13),
 (0.8503916537808108, 1.2734258092450546e-13),
 (0.10520869363093718, 1.5104584250025255e-13),
 (0.008722104733314862, 2.0000667788622195e-13),
 (0.0005434368311512672, 2.956732081393909e-13),
 (2.71154349586189e-05, 4.805877917846146e-13),
 (1.1281332190117566e-06, 8.388151284677292e-13),
 (4.024508182265407e-08, 1.5511838619056676e-13),
 (1.2578424690712353e-09, 7.728190428194436e-13),
 (1.4958050423286018e-11, 9.348304201354524e-13)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">ip</span> <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ipft</span><span class="p">]</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="n">s</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">:])])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.960581585080945e-06)*x^9 + (3.2394364893661987e-05)*x^8 + 0.00018136218930919767*x^7 + 0.0014076940180416386*x^6 + 0.008321637423413186*x^5 + 0.041670877311064114*x^4 + 0.1666658208928512*x^3 + 0.5000000849265902*x^2 + 0.9999999967104999*x + 1.0000000000211169
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pA</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">show</span><span class="p">(</span><span class="n">pA</span> <span class="o">+</span> <span class="n">pf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/35cd1eeb7b81595f74a924fed94e483ff690243e4ee134a7dbee1c038edc2214.png" src="../_images/35cd1eeb7b81595f74a924fed94e483ff690243e4ee134a7dbee1c038edc2214.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errA</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">errA</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="mf">0.1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.1116886017580327e-11,
 1.69391167759159e-11,
 7.28683779982475e-12,
 1.22430954263564e-11,
 1.82567294615410e-11,
 1.80033765673215e-12,
 1.93360882860816e-11,
 9.29256671611256e-12,
 1.05671027483822e-11,
 1.80988557474393e-11]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">errA</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">3.0e-11</span><span class="p">,</span> <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;e-11&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8b564de6cc27cd3e41601e9bc2553aee193e4c876011ce7d44427de61b8d737f.png" src="../_images/8b564de6cc27cd3e41601e9bc2553aee193e4c876011ce7d44427de61b8d737f.png" />
</div>
</div>
<p>We see that the error on <span class="math notranslate nohighlight">\([0,1]\)</span> is less than <span class="math notranslate nohighlight">\(3 \times 10^{-11}\)</span>.  This is better than the <span class="math notranslate nohighlight">\(6 \times 10^{-10}\)</span> on <span class="math notranslate nohighlight">\([-1, 1]\)</span>, as we have gained about one extra decimal place of accuracy.</p>
</section>
<section id="id18">
<h3>Assignment Five<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Consider <span class="math notranslate nohighlight">\(f(x) = \sqrt{x}\)</span> and use the first 16 shifted Chebyshev polynomials to compute a least squares approximation for <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>What is the error?</p></li>
</ol>
</section>
<section id="answer-to-assignment-five">
<h3>answer to assignment five<a class="headerlink" href="#answer-to-assignment-five" title="Link to this heading">#</a></h3>
<p>We start by setting up the basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">chebyshev_T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>
<span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
<span class="n">G</span> <span class="o">=</span> <span class="p">[</span><span class="n">fast_callable</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">S</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ipft</span> <span class="o">=</span> <span class="p">[</span><span class="n">shifted_inner_product</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">G</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_15741/1847448294.py:12: IntegrationWarning: The occurrence of roundoff error is detected, which prevents 
  the requested tolerance from being achieved.  The error may be 
  underestimated.
  return quad(integrand,Integer(0),Integer(1), limit=Integer(100), epsabs=RealNumber(&#39;1.0e-12&#39;), epsrel=RealNumber(&#39;1.0e-12&#39;), weight=&#39;alg&#39;, wvar=(-RealNumber(&#39;0.5&#39;), -RealNumber(&#39;0.5&#39;)))
</pre></div>
</div>
</div>
</div>
<p>We will be able to safely ignore this error, as shown in the error plot below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">ip</span> <span class="k">for</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ipft</span><span class="p">]</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a</span><span class="o">*</span><span class="n">s</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">:])])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>760425.895266369*x^15 - 5921447.082152192*x^14 + 20839343.661522992*x^13 - 43819639.35129244*x^12 + 61324082.646249786*x^11 - 60219013.75054225*x^10 + 42625428.87945318*x^9 - 21997660.642704062*x^8 + 8276668.2769985255*x^7 - 2247759.8290439523*x^6 + 431709.82807732077*x^5 - 56766.6324518453*x^4 + 4879.899368442426*x^3 - 260.67601940638303*x^2 + 9.857394737056321*x + 0.020535995734527912
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errA</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">errA</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="mf">0.1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.020535995734527912,
 0.000727279791286284,
 0.00144689172403201,
 0.000991327552336108,
 0.000775497027475813,
 0.000699011117268333,
 0.000643989855640292,
 0.000527160918324832,
 0.000195437601571702,
 0.000586210054666081]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">errA</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a988cf24742d9fb4774ca25d8a204f25dfc4bebffd62a6a7356887df7b73574f.png" src="../_images/a988cf24742d9fb4774ca25d8a204f25dfc4bebffd62a6a7356887df7b73574f.png" />
</div>
</div>
<p>We see that the error on <span class="math notranslate nohighlight">\([0, 1]\)</span> is less than <span class="math notranslate nohighlight">\(3 \times 10^{-3}\)</span> and it drops by one magnitude in <span class="math notranslate nohighlight">\([0.1, 1]\)</span>.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sagemath"
        },
        kernelOptions: {
            name: "sagemath",
            path: "./26MCS320symbol_comput"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sagemath'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Project One</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-with-intervals">1. Arithmetic with Intervals</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-one">Assignment One</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#algebraic-numbers">2. Algebraic Numbers</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-two">Assignment Two.</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-a-polynomial">3. Evaluating a Polynomial</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-three">Assignment Three</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#project-one-answers">Project One - Answers</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1. Arithmetic with Intervals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Assignment One</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-assignment-one">Solution to Assignment One</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">2. Algebraic Numbers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Assignment Two.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-assignment-two">Solution to Assignment Two</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">3. Evaluating a Polynomial</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Assignment Three</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-to-assignment-three">Solution to Assignment Three</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#project-two">Project Two</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#orthogonal-polynomials">1. Orthogonal Polynomials</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#least-squares-approximations">2. Least Squares Approximations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Assignment One</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Assignment Two</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#shifted-chebyshev-polynomials">3. Shifted Chebyshev polynomials</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Assignment Three</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-four">Assignment Four</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-five">Assignment Five</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#project-two-answers">Project Two - Answers</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">1. Orthogonal Polynomials</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">2. Least Squares Approximations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Assignment One</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">solution to assignment one</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Assignment Two</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-assignment-two">answer to assignment two</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">3. Shifted Chebyshev polynomials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Assignment Three</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-assignment-three">answer to assignment three</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Assignment Four</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-assignment-four">answer to assignment four</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Assignment Five</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-assignment-five">answer to assignment five</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonny, assisted by Tom
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>