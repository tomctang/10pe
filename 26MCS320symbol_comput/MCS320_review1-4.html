
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Review 1 &#8212; Jonny Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=550f00eb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '26MCS320symbol_comput/MCS320_review1-4';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Jonny Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Math &amp; FP/Language</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../past/Alevel_math.html">A-level-math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Alevel_math_further.html">A-level-further</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MCM.html">Math Computational Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_Lean.html">Lean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_Puzzle.html">Permutation Puzzles</a></li>


<li class="toctree-l1"><a class="reference internal" href="../Course_Ext_III.html">Ext III</a></li>
<li class="toctree-l1"><a class="reference internal" href="../0mmgroup.html">mmgroup Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CS &amp; Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MIT6001Python.html">MIT_CS6001-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MIT6002thinking.html">MIT_CS6002-CS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PE100.html">Project Euler Q1-50</a></li>


<li class="toctree-l1"><a class="reference internal" href="../PE_Informatics/PE_tags.html">Project Euler Tag-Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/Course_MCM_QM.html">Quantum Mechanics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook &amp; Tom</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../past/nb_past_courses.html">Past courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/nb_Geo.html">Geography and Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/nb_lottery_simulator.html">Lottery Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../past/How_Dad_organise_QM.html">How Dad learn QM</a></li>


<li class="toctree-l1"><a class="reference internal" href="../Course_MCM_QFT.html">QFT</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/10pe" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/26MCS320symbol_comput/MCS320_review1-4.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Review 1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Review 1</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1">question 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2">question 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-3">question 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-4">question 4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-5">question 5</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-6">question 6</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-7">question 7</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-8">question 8</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-1-answers-separated">Review 1 - Answers separated</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nearby-rational-approximations">1. nearby rational approximations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-function-to-store-data">2. a function to store data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algebraic-numbers">3. Algebraic Numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorization">4. Vectorization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fully-factored-form-of-rational-polynomials">5. Fully Factored Form of Rational Polynomials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer">answer:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expression-trees">6. Expression Trees</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulation-of-expressions">7. Manipulation of Expressions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multivariate-polynomials">8. Multivariate Polynomials</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-2">Review 2</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-2-answers-separated">Review 2 - Answers separated</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#list-comprehensions">1. List Comprehensions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memoization">2. Memoization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-defined-by-integrals">3. Functions defined by Integrals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#taylor-series">4. Taylor Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#slope-of-the-tangent-line">5. Slope of the Tangent Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-in-polar-coordinates">6. Plotting in Polar Coordinates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constrained-optimization">7. Constrained Optimization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-a-linear-system">8. Solving a Linear System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-initial-value-problem">9. An Initial Value Problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polyhedral-optimization">10. Polyhedral Optimization</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-3-answers-combined">Review 3 - Answers combined</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#our-first-steps">1. Our First Steps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">question 1.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-1">answer to question 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">question 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-2">answer to question 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">question 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-3">answer to question 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">question 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-4">answer to question 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">question 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-5">answer to question 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">question 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-question-6">answer question 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">question 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-7">answer to question 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">question 8</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-8">answer to question 8</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomials-and-rational-expressions">2. Polynomials and Rational Expressions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-9">question 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-9">answer to question 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-10">question 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-10">answer to question 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-11">question 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-11">answer to question 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-12">question 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-12">answer to question 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-13">question 13</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-13">answer to question 13</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-4">Review 4</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-calculus">Part 3. Calculus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">question 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">answer to question 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">question 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">answer to question 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">question 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">answer to question 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">question 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">answer to question 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">question 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">answer to question 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">question 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-6">answer to question 6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-plotting-and-solving-equations">Part 4: plotting and solving equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">question 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">answer to question 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">question 8</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">answer to question 8</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">question 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">answer to question 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">question 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">answer to question 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">question 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">answer to question 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">question 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">answer to question 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">question 13</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">answer to question 13</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="review-1">
<h1>Review 1<a class="headerlink" href="#review-1" title="Link to this heading">#</a></h1>
<p>This review contains some representative problems to prepare for the first midterm exam.</p>
<section id="question-1">
<h2>question 1<a class="headerlink" href="#question-1" title="Link to this heading">#</a></h2>
<p>Consider <span class="math notranslate nohighlight">\(S = \sqrt{2}\)</span></p>
<ol class="arabic simple">
<li><p>Construct a nearby rational approximation for <span class="math notranslate nohighlight">\(S\)</span> where the size of the denominator is not larger than 1000.</p></li>
<li><p>Construct a sequence of 10 nearby rational approximations, where the denominator of the <span class="math notranslate nohighlight">\(k\)</span>-th approximation is smaller than <span class="math notranslate nohighlight">\(10^k\)</span>.</p></li>
<li><p>Verify the accuracy of the rational approximations.</p></li>
</ol>
</section>
<section id="question-2">
<h2>question 2<a class="headerlink" href="#question-2" title="Link to this heading">#</a></h2>
<p>Define a function <code class="docutils literal notranslate"><span class="pre">whatis</span></code> which stores definitions.</p>
<p>Here is a session with this function:</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">whatis('computer</span> <span class="pre">algebra')</span></code> returns</p>
<p><code class="docutils literal notranslate"><span class="pre">call</span> <span class="pre">again</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">definition</span> <span class="pre">for</span> <span class="pre">computer</span> <span class="pre">algebra</span></code></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">whatis('computer</span> <span class="pre">algebra',</span> <span class="pre">'the</span> <span class="pre">study</span> <span class="pre">of</span> <span class="pre">algorithms</span> <span class="pre">in</span> <span class="pre">symbolic</span> <span class="pre">computation')</span></code></p>
<p>stores the definition for <code class="docutils literal notranslate"><span class="pre">'computer</span> <span class="pre">algebra'</span></code></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">whatis('computer</span> <span class="pre">algebra')</span></code> returns</p>
<p><code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">study</span> <span class="pre">of</span> <span class="pre">algorithms</span> <span class="pre">in</span> <span class="pre">symbolic</span> <span class="pre">computation</span></code></p>
</li>
</ol>
</section>
<section id="question-3">
<h2>question 3<a class="headerlink" href="#question-3" title="Link to this heading">#</a></h2>
<p>Consider the polynomial <span class="math notranslate nohighlight">\(p = x^4 + x^2 + 1\)</span>
over the field <span class="math notranslate nohighlight">\({\mathbb Z}_2\)</span>, the field of bits, 0 and 1.</p>
<ol class="arabic">
<li><p>Is <span class="math notranslate nohighlight">\(p\)</span> irreducible?  If not, then what are its factors?</p></li>
<li><p>Extend the field <span class="math notranslate nohighlight">\({\mathbb Z}_2\)</span> with sufficiently many formal roots
so <span class="math notranslate nohighlight">\(p\)</span> factors as a product of linear factors.</p>
<p>Write the factorization of <span class="math notranslate nohighlight">\(p\)</span>.</p>
</li>
</ol>
</section>
<section id="question-4">
<h2>question 4<a class="headerlink" href="#question-4" title="Link to this heading">#</a></h2>
<p>Write a Python function <code class="docutils literal notranslate"><span class="pre">python_sum</span></code> which takes on input a positive integer <span class="math notranslate nohighlight">\(n\)</span> and which returns
the floating-point value of</p>
<div class="math notranslate nohighlight">
\[
    \frac{\pi}{n} \sum_{i=1}^{n-1} \cos\left( - \frac{\pi}{2} + i \frac{\pi}{n} \right).
\]</div>
<p>Write a more efficient version <code class="docutils literal notranslate"><span class="pre">numpy_sum</span></code> using vectorization.</p>
<p>Time the two versions to illustrate the efficiency.</p>
</section>
<section id="question-5">
<h2>question 5<a class="headerlink" href="#question-5" title="Link to this heading">#</a></h2>
<p>Explain what is the fully factored normal form of rational polynomials.</p>
<p>Why does this automatic simplification not happen automatically?</p>
<p>Illustrate with a good example.</p>
</section>
<section id="question-6">
<h2>question 6<a class="headerlink" href="#question-6" title="Link to this heading">#</a></h2>
<p>Type
<code class="docutils literal notranslate"><span class="pre">reset();</span> <span class="pre">x,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">var('x,y');</span> <span class="pre">q</span> <span class="pre">=</span> <span class="pre">(x^2</span> <span class="pre">-</span> <span class="pre">y)/(y^2</span> <span class="pre">-</span> <span class="pre">x)</span></code>
and draw the expression tree of <code class="docutils literal notranslate"><span class="pre">q.</span></code></p>
</section>
<section id="question-7">
<h2>question 7<a class="headerlink" href="#question-7" title="Link to this heading">#</a></h2>
<p>Rewrite</p>
<div class="math notranslate nohighlight">
\[
   x + \frac{(x - y)^5}{(x + y)^5}
\]</div>
<p>into</p>
<div class="math notranslate nohighlight">
\[
   \frac{(x + y)^5 \cdot x + (x - y)^5}{(x + y)^5}.
\]</div>
</section>
<section id="question-8">
<h2>question 8<a class="headerlink" href="#question-8" title="Link to this heading">#</a></h2>
<p>Consider <span class="math notranslate nohighlight">\(p = -y^2 z^3 - y z^4 + 3 x y^3 + x^3 + z^2\)</span>
as a polynomial with integer coefficients in the variables <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span>.</p>
<p>The monomials of <span class="math notranslate nohighlight">\(p\)</span> are sorted in the degree lexicographical order.</p>
<p>Convert <span class="math notranslate nohighlight">\(p\)</span> (<em>without retyping <span class="math notranslate nohighlight">\(p\)</span>!</em>) into the pure lexicographical term order.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="review-1-answers-separated">
<h1>Review 1 - Answers separated<a class="headerlink" href="#review-1-answers-separated" title="Link to this heading">#</a></h1>
<section id="nearby-rational-approximations">
<h2>1. nearby rational approximations<a class="headerlink" href="#nearby-rational-approximations" title="Link to this heading">#</a></h2>
<p>Consider <span class="math notranslate nohighlight">\(S = \sqrt{2}\)</span></p>
<ol class="arabic simple">
<li><p>Construct a nearby rational approximation for <span class="math notranslate nohighlight">\(S\)</span> where the size of the denominator is not larger than 1000.</p></li>
<li><p>Construct a sequence of 10 nearby rational approximations, where the denominator of the <span class="math notranslate nohighlight">\(k\)</span>-th approximation is smaller than <span class="math notranslate nohighlight">\(10^k\)</span>.</p></li>
<li><p>Verify the accuracy of the rational approximations.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">RR</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_denominator</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1393/985
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R100</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="p">[</span><span class="n">R100</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">nearby_rational</span><span class="p">(</span><span class="n">max_denominator</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)]</span>
<span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[7/5,
 140/99,
 1393/985,
 8119/5741,
 114243/80782,
 941664/665857,
 9369319/6625109,
 131836323/93222358,
 1086679440/768398401,
 10812186007/7645370045]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">floor</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">S</span> <span class="o">-</span> <span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="mf">10.0</span><span class="p">)))</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Q</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 4, 6, 8, 10, 11, 14, 16, 18, 20]
</pre></div>
</div>
</div>
</div>
<p>Observe the increase in precision from <code class="docutils literal notranslate"><span class="pre">RR</span></code> (default 53 bits) to 100 bits in <code class="docutils literal notranslate"><span class="pre">R100</span></code>.</p>
</section>
<section id="a-function-to-store-data">
<h2>2. a function to store data<a class="headerlink" href="#a-function-to-store-data" title="Link to this heading">#</a></h2>
<p>Define a function <code class="docutils literal notranslate"><span class="pre">whatis</span></code> which stores definitions.</p>
<p>Here is a session with this function:</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">whatis('computer</span> <span class="pre">algebra')</span></code> returns</p>
<p><code class="docutils literal notranslate"><span class="pre">call</span> <span class="pre">again</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">definition</span> <span class="pre">for</span> <span class="pre">computer</span> <span class="pre">algebra</span></code></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">whatis('computer</span> <span class="pre">algebra',</span> <span class="pre">'the</span> <span class="pre">study</span> <span class="pre">of</span> <span class="pre">algorithms</span> <span class="pre">in</span> <span class="pre">symbolic</span> <span class="pre">computation')</span></code></p>
<p>stores the definition for <code class="docutils literal notranslate"><span class="pre">'computer</span> <span class="pre">algebra'</span></code></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">whatis('computer</span> <span class="pre">algebra')</span></code> returns</p>
<p><code class="docutils literal notranslate"><span class="pre">the</span> <span class="pre">study</span> <span class="pre">of</span> <span class="pre">algorithms</span> <span class="pre">in</span> <span class="pre">symbolic</span> <span class="pre">computation</span></code></p>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">whatis</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">definition</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="p">{}):</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">D</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">definition</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">D</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">definition</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;call again with the definition for&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">whatis</span><span class="p">(</span><span class="s1">&#39;computer algebra&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>call again with the definition for computer algebra
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">whatis</span><span class="p">(</span><span class="s1">&#39;computer algebra&#39;</span><span class="p">,</span> <span class="s1">&#39;the study of algorithms in symbolic computation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">whatis</span><span class="p">(</span><span class="s1">&#39;computer algebra&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>computer algebra is the study of algorithms in symbolic computation
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">whatis</span><span class="p">(</span><span class="s1">&#39;symbolic computation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>call again with the definition for symbolic computation
</pre></div>
</div>
</div>
</div>
<p>Using this function could be a good preparation to study the definitions we encountered in the course.</p>
</section>
<section id="algebraic-numbers">
<h2>3. Algebraic Numbers<a class="headerlink" href="#algebraic-numbers" title="Link to this heading">#</a></h2>
<p>Consider the polynomial <span class="math notranslate nohighlight">\(p = x^4 + x^2 + 1\)</span>
over the field <span class="math notranslate nohighlight">\({\mathbb Z}_2\)</span>, the field of bits, 0 and 1.</p>
<ol class="arabic">
<li><p>Is <span class="math notranslate nohighlight">\(p\)</span> irreducible?  If not, then what are its factors?</p></li>
<li><p>Extend the field <span class="math notranslate nohighlight">\({\mathbb Z}_2\)</span> with sufficiently many formal roots
so <span class="math notranslate nohighlight">\(p\)</span> factors as a product of linear factors.</p>
<p>Write the factorization of <span class="math notranslate nohighlight">\(p\)</span>.</p>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Is&#39;</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;irreducible?&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Is x^4 + x^2 + 1 irreducible? False
</pre></div>
</div>
</div>
</div>
<p>The polynomial is not irreducible, it factors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x^2 + x + 1)^2
</pre></div>
</div>
</div>
</div>
<p>We see that the polynomial is the square of <span class="math notranslate nohighlight">\(x^2 + x + 1\)</span>.</p>
<p>To define the field extension, we select the irreducible factor from the list of factors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(x^2 + x + 1, 2)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">K</span><span class="o">.&lt;</span><span class="n">r</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">K</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finite Field in r of size 2^2
</pre></div>
</div>
</div>
</div>
<p>To see the factorization, we must cast the polynomial into the polynomial ring over this extended field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factor</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="n">x</span><span class="p">](</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x + r)^2 * (x + r + 1)^2
</pre></div>
</div>
</div>
</div>
</section>
<section id="vectorization">
<h2>4. Vectorization<a class="headerlink" href="#vectorization" title="Link to this heading">#</a></h2>
<p>Write a Python function <code class="docutils literal notranslate"><span class="pre">python_sum</span></code> which takes on input a positive integer <span class="math notranslate nohighlight">\(n\)</span> and which returns
the floating-point value of</p>
<div class="math notranslate nohighlight">
\[
    \frac{\pi}{n} \sum_{i=1}^{n-1} \cos\left( - \frac{\pi}{2} + i \frac{\pi}{n} \right).
\]</div>
<p>Write a more efficient version <code class="docutils literal notranslate"><span class="pre">numpy_sum</span></code> using vectorization.</p>
<p>Time the two versions to illustrate the efficiency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">python_sum</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the sum of cos(-pi/2 + i*(pi/n)) for i from 1 to n-1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">((</span><span class="n">pi</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="nb">sum</span><span class="p">([</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="n">n</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">python_sum</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.9999983550656617
</pre></div>
</div>
</div>
</div>
<p>To prepare the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> version, let us experiment with <code class="docutils literal notranslate"><span class="pre">arange</span></code> for <code class="docutils literal notranslate"><span class="pre">n</span></code> equal to 10.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">arange</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-1/2*pi, -2/5*pi, -3/10*pi, -1/5*pi, -1/10*pi, 0, 1/10*pi, 1/5*pi,
       3/10*pi, 2/5*pi], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">numpy_sum</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies numpy vectors to sum cos(-pi/2 + i*(pi/n)) for i from 1 to n-1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">arange</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numpy_sum</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.9999884854774963
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;python_sum(1000)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25 loops, best of 3: 21.2 ms per loop
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;numpy_sum(1000)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>625 loops, best of 3: 10.4 s per loop
</pre></div>
</div>
</div>
</div>
<p>We see an enormous speed up, from 72 milliseconds to 31 microseconds.</p>
</section>
<section id="fully-factored-form-of-rational-polynomials">
<h2>5. Fully Factored Form of Rational Polynomials<a class="headerlink" href="#fully-factored-form-of-rational-polynomials" title="Link to this heading">#</a></h2>
<p>Explain what is the fully factored normal form of rational polynomials.</p>
<p>Why does this automatic simplification not happen automatically?</p>
<p>Illustrate with a good example.</p>
<section id="answer">
<h3>answer:<a class="headerlink" href="#answer" title="Link to this heading">#</a></h3>
<p>The fully factored normal form of the rational polynomial is where both numerator and denominator are factored and where the common factor is removed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{x^{2} - 1}{x + 1}</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normalized numerator :&#39;</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">numerator</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normalized denominator :&#39;</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">denominator</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>normalized numerator : x - 1
normalized denominator : 1
</pre></div>
</div>
</div>
</div>
<p>Because of expression swell, this normalization does not happen automatically.  An example is</p>
<div class="math notranslate nohighlight">
\[
   \frac{x^{1000} - 1}{x - 1}
\]</div>
<p>which leads to 1000 terms if the <span class="math notranslate nohighlight">\(x-1\)</span> is factored out of the numerator.</p>
</section>
</section>
<section id="expression-trees">
<h2>6. Expression Trees<a class="headerlink" href="#expression-trees" title="Link to this heading">#</a></h2>
<p>Type
<code class="docutils literal notranslate"><span class="pre">reset();</span> <span class="pre">x,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">var('x,y');</span> <span class="pre">q</span> <span class="pre">=</span> <span class="pre">(x^2</span> <span class="pre">-</span> <span class="pre">y)/(y^2</span> <span class="pre">-</span> <span class="pre">x)</span></code>
and draw the expression tree of <code class="docutils literal notranslate"><span class="pre">q.</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let us ask for the operands and the operators.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L0</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">operands</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">operator</span><span class="p">(),</span> <span class="s1">&#39;operates on&#39;</span><span class="p">,</span> <span class="n">L0</span><span class="p">)</span> 
<span class="n">L1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="o">.</span><span class="n">operands</span><span class="p">(),</span> <span class="n">a</span><span class="o">.</span><span class="n">operator</span><span class="p">())</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">L0</span><span class="p">]</span>
<span class="n">L1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function mul_vararg at 0x7f4f37c9aef0&gt; operates on [x^2 - y, 1/(y^2 - x)]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[([x^2, -y], &lt;function add_vararg at 0x7f4f37c9ae60&gt;),
 ([y^2 - x, -1], &lt;built-in function pow&gt;)]
</pre></div>
</div>
</div>
</div>
<p>Observe that the division by <code class="docutils literal notranslate"><span class="pre">(y^2</span> <span class="pre">-</span> <span class="pre">x)</span></code> is represented by <code class="docutils literal notranslate"><span class="pre">(y^2</span> <span class="pre">-</span> <span class="pre">x)^(-1)</span></code>.</p>
<p>We continue computing the operators and the operands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L2</span> <span class="o">=</span> <span class="n">L1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">L3</span> <span class="o">=</span> <span class="n">L1</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">L4</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="o">.</span><span class="n">operands</span><span class="p">(),</span> <span class="n">a</span><span class="o">.</span><span class="n">operator</span><span class="p">())</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">L2</span><span class="p">]</span>
<span class="n">L5</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="o">.</span><span class="n">operands</span><span class="p">(),</span> <span class="n">a</span><span class="o">.</span><span class="n">operator</span><span class="p">())</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">L3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[([x, 2], &lt;built-in function pow&gt;), ([y, -1], &lt;function mul_vararg at 0x7f4f37c9aef0&gt;)]
[([y^2, -x], &lt;function add_vararg at 0x7f4f37c9ae60&gt;), ([], None)]
</pre></div>
</div>
</div>
</div>
<p>There are two expressions, <code class="docutils literal notranslate"><span class="pre">y^2</span></code> and <code class="docutils literal notranslate"><span class="pre">-x</span></code>, which have operands and an operator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L6</span> <span class="o">=</span> <span class="n">L5</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="p">[(</span><span class="n">a</span><span class="o">.</span><span class="n">operands</span><span class="p">(),</span> <span class="n">a</span><span class="o">.</span><span class="n">operator</span><span class="p">())</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">L6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[([y, 2], &lt;built-in function pow&gt;),
 ([x, -1], &lt;function mul_vararg at 0x7f4f37c9aef0&gt;)]
</pre></div>
</div>
</div>
</div>
<p>Now we represent <code class="docutils literal notranslate"><span class="pre">y^2</span></code> and <code class="docutils literal notranslate"><span class="pre">-x</span></code> with <code class="docutils literal notranslate"><span class="pre">LabelledOrderedTree</span></code> objects.</p>
<p>The next line is needed only if you are running WSL.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span><span class="o">.</span><span class="n">typeset</span><span class="o">.</span><span class="n">ascii_art</span><span class="o">.</span><span class="n">AsciiArt</span><span class="o">.</span><span class="n">_terminal_width</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">80</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leafy</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">leaf2</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
<span class="n">nodey2</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">leafy</span><span class="p">,</span> <span class="n">leaf2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">leafx</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">leafm1</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
<span class="n">nodexm1</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">leafx</span><span class="p">,</span> <span class="n">leafm1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ascii_art</span><span class="p">(</span><span class="n">nodey2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ascii_art</span><span class="p">(</span><span class="n">nodexm1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ^_
 / /
y 2
  *_
 / / 
x -1
</pre></div>
</div>
</div>
</div>
<p>In the same fashion, we represent <code class="docutils literal notranslate"><span class="pre">x^2</span></code> and <code class="docutils literal notranslate"><span class="pre">-y</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodex2</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">leafx</span><span class="p">,</span> <span class="n">leaf2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">nodeym1</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">leafy</span><span class="p">,</span> <span class="n">leafm1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ascii_art</span><span class="p">(</span><span class="n">nodex2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ascii_art</span><span class="p">(</span><span class="n">nodeym1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ^_
 / /
x 2
  *_
 / / 
y -1
</pre></div>
</div>
</div>
</div>
<p>The numerator is <code class="docutils literal notranslate"><span class="pre">x^2</span> <span class="pre">-</span> <span class="pre">y</span></code> and the denominator <code class="docutils literal notranslate"><span class="pre">y^2</span> <span class="pre">-</span> <span class="pre">x</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numerator</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">nodex2</span><span class="p">,</span> <span class="n">nodeym1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">denominator</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">nodey2</span><span class="p">,</span> <span class="n">nodexm1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ascii_art</span><span class="p">(</span><span class="n">numerator</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ascii_art</span><span class="p">(</span><span class="n">denominator</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    _+___
   /    /  
  ^_   *_
 / /  / / 
x 2  y -1
    _+___
   /    /  
  ^_   *_
 / /  / / 
y 2  x -1
</pre></div>
</div>
</div>
</div>
<p>Then at last, we take the inverse of the denominator
and multiply with the numerator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">invden</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">denominator</span><span class="p">,</span> <span class="n">leafm1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">)</span>
<span class="n">exptree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">numerator</span><span class="p">,</span> <span class="n">invden</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">exptree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       _______*________
      /               /     
    _+___          __^____
   /    /         /      / 
  ^_   *_       _+___   -1
 / /  / /      /    /  
x 2  y -1     ^_   *_  
             / /  / /  
            y 2  x -1  
</pre></div>
</div>
</div>
</div>
</section>
<section id="manipulation-of-expressions">
<h2>7. Manipulation of Expressions<a class="headerlink" href="#manipulation-of-expressions" title="Link to this heading">#</a></h2>
<p>Rewrite</p>
<div class="math notranslate nohighlight">
\[
   x + \frac{(x - y)^5}{(x + y)^5}
\]</div>
<p>into</p>
<div class="math notranslate nohighlight">
\[
   \frac{(x + y)^5 \cdot x + (x - y)^5}{(x + y)^5}.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}x + \frac{{\left(x - y\right)}^{5}}{{\left(x + y\right)}^{5}}</script></html></div></div>
</div>
<p>We need to prevent <code class="docutils literal notranslate"><span class="pre">x+y</span></code> and <code class="docutils literal notranslate"><span class="pre">x-y</span></code> from expanding.  We will replace <code class="docutils literal notranslate"><span class="pre">x+y</span></code> and <code class="docutils literal notranslate"><span class="pre">x-y</span></code> by two new variables, which we must declare first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;u, v&#39;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">:</span><span class="n">u</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">:</span><span class="n">v</span><span class="p">})</span>
<span class="n">show</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}x + \frac{v^{5}}{u^{5}}</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{u^{5} x + v^{5}}{u^{5}}</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{{\left(x + y\right)}^{5} x + {\left(x - y\right)}^{5}}{{\left(x + y\right)}^{5}}</script></html></div></div>
</div>
</section>
<section id="multivariate-polynomials">
<h2>8. Multivariate Polynomials<a class="headerlink" href="#multivariate-polynomials" title="Link to this heading">#</a></h2>
<p>Consider <span class="math notranslate nohighlight">\(p = -y^2 z^3 - y z^4 + 3 x y^3 + x^3 + z^2\)</span>
as a polynomial with integer coefficients in the variables <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span>.</p>
<p>The monomials of <span class="math notranslate nohighlight">\(p\)</span> are sorted in the degree lexicographical order.</p>
<p>Convert <span class="math notranslate nohighlight">\(p\)</span> (<em>without retyping <span class="math notranslate nohighlight">\(p\)</span>!</em>) into the pure lexicographical term order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}-y^{2} z^{3} - y z^{4} + 3 x y^{3} + x^{3} + z^{2}</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Rlex</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">Rlex</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}x^{3} + 3 x y^{3} - y^{2} z^{3} - y z^{4} + z^{2}</script></html></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="review-2">
<h1>Review 2<a class="headerlink" href="#review-2" title="Link to this heading">#</a></h1>
<p>In this review sheet we consider problems
to prepare for the second midterm exam of mcs 320.</p>
<blockquote>
<div><p>Question 1</p>
</div></blockquote>
<p>Count the number of points with integer coordinates <span class="math notranslate nohighlight">\((x,y)\)</span>
in the region defined by the inequalities <span class="math notranslate nohighlight">\(0 \leq x &lt; 20\)</span>, <span class="math notranslate nohighlight">\(0 \leq y &lt; 20\)</span>,
<span class="math notranslate nohighlight">\(y \geq x/2\)</span>, <span class="math notranslate nohighlight">\(y \leq 3 x\)</span>.</p>
<p>Do the following:</p>
<ol class="arabic simple">
<li><p>Generate a list L of integer points <span class="math notranslate nohighlight">\((i,j)\)</span> for <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> ranging between 0 and 19.</p></li>
<li><p>Select from the list L those points in the cone <span class="math notranslate nohighlight">\(y \geq x/2\)</span> and by <span class="math notranslate nohighlight">\(y \leq 3 x\)</span>.</p></li>
<li><p>Count the number of points in the cone.  Write also the number below.</p></li>
</ol>
<blockquote>
<div><p>Question 2</p>
</div></blockquote>
<p>For some parameter <span class="math notranslate nohighlight">\(t\)</span>, consider the sequence recursively defined as:</p>
<p><span class="math notranslate nohighlight">\(F(n) = (1-t) F(n-1) + t F(n-2)\)</span>, for <span class="math notranslate nohighlight">\(n &gt; 1\)</span>, where <span class="math notranslate nohighlight">\(F(0) = a\)</span> and <span class="math notranslate nohighlight">\(F(1) = b\)</span>.</p>
<p>Using the recursive definition write an efficient SageMath function <span class="math notranslate nohighlight">\(F\)</span>
to compute <span class="math notranslate nohighlight">\(F(n)\)</span> as <span class="math notranslate nohighlight">\(F(a,b,t,n)\)</span>.
What is the result of <span class="math notranslate nohighlight">\(F(a,b,0.3,100)\)</span>?</p>
<blockquote>
<div><p>Question 3</p>
</div></blockquote>
<p>Consider the function <span class="math notranslate nohighlight">\(f(t)\)</span> as the integral of <span class="math notranslate nohighlight">\((1 - e^x)\)</span> for <span class="math notranslate nohighlight">\(x\)</span> from 0 to <span class="math notranslate nohighlight">\(t\)</span>, for <span class="math notranslate nohighlight">\(t \geq 0\)</span>.</p>
<ol class="arabic simple">
<li><p>Define this function in Sage.</p></li>
<li><p>What is <span class="math notranslate nohighlight">\(f'(1)\)</span>?</p></li>
</ol>
<blockquote>
<div><p>Question 4</p>
</div></blockquote>
<p>The function <span class="math notranslate nohighlight">\(g(x,t) = (1-t^2)/(1 - 2xt + t^2)\)</span> is a
generating function for the Chebyshev polynomials.</p>
<ol class="arabic">
<li><p>Compute a Taylor series approximation for <span class="math notranslate nohighlight">\(g(x,t)\)</span>
around <span class="math notranslate nohighlight">\(t = 0\)</span> of order 10.</p></li>
<li><p>Select the coefficient of <span class="math notranslate nohighlight">\(t^8\)</span> and compare
with the output of <code class="docutils literal notranslate"><span class="pre">chebyshev_T(8,x)</span></code>.</p>
<p>Is there a difference between the two?</p>
</li>
</ol>
<blockquote>
<div><p>Question 5</p>
</div></blockquote>
<p>Consider the point <span class="math notranslate nohighlight">\((1,1)\)</span> on the curve <span class="math notranslate nohighlight">\(f(x,y) = x^2 - y^3 - x + y = 0\)</span>.</p>
<ol class="arabic">
<li><p>Give the Sage command(s) to compute a Taylor series about the point <span class="math notranslate nohighlight">\((1,1)\)</span>
where the term of the error is of second order.</p></li>
<li><p>Compute the slope of the tangent line of the curve at the point <span class="math notranslate nohighlight">\((1,1)\)</span>
and use the slope to determine the tangent line.
Write the equation of the tangent line.</p>
<p>Verify that the tangent line equals the first-order Taylor series at <span class="math notranslate nohighlight">\((1,1)\)</span>.</p>
</li>
</ol>
<blockquote>
<div><p>Question 6</p>
</div></blockquote>
<p>Consider the curve <span class="math notranslate nohighlight">\(x^4 - 3 x y + y^4 = 0\)</span>.  Do the following.</p>
<ol class="arabic simple">
<li><p>Make a plot for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> both ranging between <span class="math notranslate nohighlight">\(-2\)</span> and <span class="math notranslate nohighlight">\(+2\)</span>;</p></li>
<li><p>Convert the curve into polar coordinates; and</p></li>
<li><p>Plot the curve in polar coordinates.</p></li>
</ol>
<blockquote>
<div><p>Question 7</p>
</div></blockquote>
<p>Let <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> be positive numbers.
Consider <span class="math notranslate nohighlight">\(f = x^2/a + y/b\)</span> and the unit circle <span class="math notranslate nohighlight">\(x^2 + y^2 = 1\)</span>.</p>
<p>Determine the number of candidate extremal values of <span class="math notranslate nohighlight">\(f\)</span> on the unit circle.</p>
<p>Use a lexicographic Groebner basis to compute a triangular form of the equations for this problem.</p>
<blockquote>
<div><p>Question 8</p>
</div></blockquote>
<p>Do the following.</p>
<ol class="arabic simple">
<li><p>Create a 5-by-5 matrix <span class="math notranslate nohighlight">\(A\)</span> over the rationals where
the <span class="math notranslate nohighlight">\((i,j)\)</span>-the element is <span class="math notranslate nohighlight">\(1/(i+j)\)</span> (for <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> both from 1 to 5).</p></li>
<li><p>Define <span class="math notranslate nohighlight">\(b\)</span> as a vector of length 5 of ones.
Solve the system defined by <span class="math notranslate nohighlight">\(A x = b\)</span>.</p></li>
<li><p>Verify that <span class="math notranslate nohighlight">\(b - A x\)</span> equals zero.</p></li>
</ol>
<blockquote>
<div><p>Question 9</p>
</div></blockquote>
<p>Consider the intial value problem <span class="math notranslate nohighlight">\(dy/dt = 2 - 6y\)</span>, <span class="math notranslate nohighlight">\(y(0) = -1\)</span>.</p>
<ol class="arabic">
<li><p>Solve this problem and plot the solution trajectory for <span class="math notranslate nohighlight">\(t \in [0,2]\)</span>.</p></li>
<li><p>Plot the slope field for <span class="math notranslate nohighlight">\(t \in [0,2]\)</span>, <span class="math notranslate nohighlight">\(y \in [-1,0.5]\)</span>.</p>
<p>Place also the particular solution computed the first part of this question on the plot.</p>
</li>
</ol>
<blockquote>
<div><p>Question 10</p>
</div></blockquote>
<p>Minimize <span class="math notranslate nohighlight">\(x+3y\)</span></p>
<p>subject to <span class="math notranslate nohighlight">\(x \geq 2\)</span>, <span class="math notranslate nohighlight">\(y \geq 1\)</span>, <span class="math notranslate nohighlight">\(x + 2y \leq 8\)</span>, <span class="math notranslate nohighlight">\(x+y \leq 6\)</span>.</p>
<p>Formulate the linear programming problem and solve it.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="review-2-answers-separated">
<h1>Review 2 - Answers separated<a class="headerlink" href="#review-2-answers-separated" title="Link to this heading">#</a></h1>
<section id="list-comprehensions">
<h2>1. List Comprehensions<a class="headerlink" href="#list-comprehensions" title="Link to this heading">#</a></h2>
<p>Count the number of points with integer coordinates <span class="math notranslate nohighlight">\((x,y)\)</span>
in the region defined by the inequalities <span class="math notranslate nohighlight">\(0 \leq x &lt; 20\)</span>, <span class="math notranslate nohighlight">\(0 \leq y &lt; 20\)</span>,
<span class="math notranslate nohighlight">\(y \geq x/2\)</span>, <span class="math notranslate nohighlight">\(y \leq 3 x\)</span>.</p>
<p>Do the following:</p>
<ol class="arabic simple">
<li><p>Generate a list L of integer points <span class="math notranslate nohighlight">\((i,j)\)</span> for <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> ranging between 0 and 19.</p></li>
<li><p>Select from the list L those points in the cone <span class="math notranslate nohighlight">\(y \geq x/2\)</span> and by <span class="math notranslate nohighlight">\(y \leq 3 x\)</span>.</p></li>
<li><p>Count the number of points in the cone.  Write also the number below.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="n">F</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">x</span><span class="o">/</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)]</span>
<span class="n">F</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0, 0),
 (1, 1),
 (1, 2),
 (1, 3),
 (2, 1),
 (2, 2),
 (2, 3),
 (2, 4),
 (2, 5),
 (2, 6),
 (3, 2),
 (3, 3),
 (3, 4),
 (3, 5),
 (3, 6),
 (3, 7),
 (3, 8),
 (3, 9),
 (4, 2),
 (4, 3),
 (4, 4),
 (4, 5),
 (4, 6),
 (4, 7),
 (4, 8),
 (4, 9),
 (4, 10),
 (4, 11),
 (4, 12),
 (5, 3),
 (5, 4),
 (5, 5),
 (5, 6),
 (5, 7),
 (5, 8),
 (5, 9),
 (5, 10),
 (5, 11),
 (5, 12),
 (5, 13),
 (5, 14),
 (5, 15),
 (6, 3),
 (6, 4),
 (6, 5),
 (6, 6),
 (6, 7),
 (6, 8),
 (6, 9),
 (6, 10),
 (6, 11),
 (6, 12),
 (6, 13),
 (6, 14),
 (6, 15),
 (6, 16),
 (6, 17),
 (6, 18),
 (7, 4),
 (7, 5),
 (7, 6),
 (7, 7),
 (7, 8),
 (7, 9),
 (7, 10),
 (7, 11),
 (7, 12),
 (7, 13),
 (7, 14),
 (7, 15),
 (7, 16),
 (7, 17),
 (7, 18),
 (7, 19),
 (8, 4),
 (8, 5),
 (8, 6),
 (8, 7),
 (8, 8),
 (8, 9),
 (8, 10),
 (8, 11),
 (8, 12),
 (8, 13),
 (8, 14),
 (8, 15),
 (8, 16),
 (8, 17),
 (8, 18),
 (8, 19),
 (9, 5),
 (9, 6),
 (9, 7),
 (9, 8),
 (9, 9),
 (9, 10),
 (9, 11),
 (9, 12),
 (9, 13),
 (9, 14),
 (9, 15),
 (9, 16),
 (9, 17),
 (9, 18),
 (9, 19),
 (10, 5),
 (10, 6),
 (10, 7),
 (10, 8),
 (10, 9),
 (10, 10),
 (10, 11),
 (10, 12),
 (10, 13),
 (10, 14),
 (10, 15),
 (10, 16),
 (10, 17),
 (10, 18),
 (10, 19),
 (11, 6),
 (11, 7),
 (11, 8),
 (11, 9),
 (11, 10),
 (11, 11),
 (11, 12),
 (11, 13),
 (11, 14),
 (11, 15),
 (11, 16),
 (11, 17),
 (11, 18),
 (11, 19),
 (12, 6),
 (12, 7),
 (12, 8),
 (12, 9),
 (12, 10),
 (12, 11),
 (12, 12),
 (12, 13),
 (12, 14),
 (12, 15),
 (12, 16),
 (12, 17),
 (12, 18),
 (12, 19),
 (13, 7),
 (13, 8),
 (13, 9),
 (13, 10),
 (13, 11),
 (13, 12),
 (13, 13),
 (13, 14),
 (13, 15),
 (13, 16),
 (13, 17),
 (13, 18),
 (13, 19),
 (14, 7),
 (14, 8),
 (14, 9),
 (14, 10),
 (14, 11),
 (14, 12),
 (14, 13),
 (14, 14),
 (14, 15),
 (14, 16),
 (14, 17),
 (14, 18),
 (14, 19),
 (15, 8),
 (15, 9),
 (15, 10),
 (15, 11),
 (15, 12),
 (15, 13),
 (15, 14),
 (15, 15),
 (15, 16),
 (15, 17),
 (15, 18),
 (15, 19),
 (16, 8),
 (16, 9),
 (16, 10),
 (16, 11),
 (16, 12),
 (16, 13),
 (16, 14),
 (16, 15),
 (16, 16),
 (16, 17),
 (16, 18),
 (16, 19),
 (17, 9),
 (17, 10),
 (17, 11),
 (17, 12),
 (17, 13),
 (17, 14),
 (17, 15),
 (17, 16),
 (17, 17),
 (17, 18),
 (17, 19),
 (18, 9),
 (18, 10),
 (18, 11),
 (18, 12),
 (18, 13),
 (18, 14),
 (18, 15),
 (18, 16),
 (18, 17),
 (18, 18),
 (18, 19),
 (19, 10),
 (19, 11),
 (19, 12),
 (19, 13),
 (19, 14),
 (19, 15),
 (19, 16),
 (19, 17),
 (19, 18),
 (19, 19)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>230
</pre></div>
</div>
</div>
</div>
<p>We count 230 points.</p>
</section>
<section id="memoization">
<h2>2. Memoization<a class="headerlink" href="#memoization" title="Link to this heading">#</a></h2>
<p>For some parameter <span class="math notranslate nohighlight">\(t\)</span>, consider the sequence recursively defined as:</p>
<p><span class="math notranslate nohighlight">\(F(n) = (1-t) F(n-1) + t F(n-2)\)</span>, for <span class="math notranslate nohighlight">\(n &gt; 1\)</span>, where <span class="math notranslate nohighlight">\(F(0) = a\)</span> and <span class="math notranslate nohighlight">\(F(1) = b\)</span>.</p>
<p>Using the recursive definition write an efficient SageMath function <span class="math notranslate nohighlight">\(F\)</span>
to compute <span class="math notranslate nohighlight">\(F(n)\)</span> as <span class="math notranslate nohighlight">\(F(a,b,t,n)\)</span>.
What is the result of <span class="math notranslate nohighlight">\(F(a,b,0.3,100)\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Withouth memoization ...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">a</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">b</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;A, B&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>B
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.300000000000000*A + 0.700000000000000*B
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">F</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Memoized F with D.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="ow">in</span> <span class="n">D</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">D</span><span class="p">[(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">b</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span><span class="o">*</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">D</span><span class="p">[(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">)]</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p>We first test some base cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a, b&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a
b
0.300000000000000*a + 0.700000000000000*b
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.230769230769230*a + 0.769230769230768*b
</pre></div>
</div>
</div>
</div>
</section>
<section id="functions-defined-by-integrals">
<h2>3. Functions defined by Integrals<a class="headerlink" href="#functions-defined-by-integrals" title="Link to this heading">#</a></h2>
<p>Consider the function <span class="math notranslate nohighlight">\(f(t)\)</span> as the integral of <span class="math notranslate nohighlight">\((1 - e^x)\)</span> for <span class="math notranslate nohighlight">\(x\)</span> from 0 to <span class="math notranslate nohighlight">\(t\)</span>, for <span class="math notranslate nohighlight">\(t \geq 0\)</span>.</p>
<ol class="arabic simple">
<li><p>Define this function in Sage.</p></li>
<li><p>What is <span class="math notranslate nohighlight">\(f'(1)\)</span>?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t |--&gt; t - e^t + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t |--&gt; -e^t + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-e + 1
</pre></div>
</div>
</div>
</div>
</section>
<section id="taylor-series">
<h2>4. Taylor Series<a class="headerlink" href="#taylor-series" title="Link to this heading">#</a></h2>
<p>The function <span class="math notranslate nohighlight">\(g(x,t) = (1-t^2)/(1 - 2xt + t^2)\)</span> is a
generating function for the Chebyshev polynomials.</p>
<ol class="arabic">
<li><p>Compute a Taylor series approximation for <span class="math notranslate nohighlight">\(g(x,t)\)</span>
around <span class="math notranslate nohighlight">\(t = 0\)</span> of order 10.</p></li>
<li><p>Select the coefficient of <span class="math notranslate nohighlight">\(t^8\)</span> and compare
with the output of <code class="docutils literal notranslate"><span class="pre">chebyshev_T(8,x)</span></code>.</p>
<p>Is there a difference between the two?</p>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,t&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">tg</span> <span class="o">=</span> <span class="n">taylor</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">tg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2*(512*x^10 - 1280*x^8 + 1120*x^6 - 400*x^4 + 50*x^2 - 1)*t^10 + 2*(256*x^9 - 576*x^7 + 432*x^5 - 120*x^3 + 9*x)*t^9 + 2*(128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1)*t^8 + 2*(64*x^7 - 112*x^5 + 56*x^3 - 7*x)*t^7 + 2*(32*x^6 - 48*x^4 + 18*x^2 - 1)*t^6 + 2*(16*x^5 - 20*x^3 + 5*x)*t^5 + 2*(8*x^4 - 8*x^2 + 1)*t^4 + 2*(4*x^3 - 3*x)*t^3 + 2*(2*x^2 - 1)*t^2 + 2*t*x + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tg</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>256*x^8 - 512*x^6 + 320*x^4 - 64*x^2 + 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chebyshev_T</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>128*x^8 - 256*x^6 + 160*x^4 - 32*x^2 + 1
</pre></div>
</div>
</div>
</div>
<p>We see that the difference is a factor of 2: the <code class="docutils literal notranslate"><span class="pre">tg.coefficient(t,</span> <span class="pre">8)</span></code> is twice of <code class="docutils literal notranslate"><span class="pre">chebyshev_T(8,x)</span></code>.</p>
</section>
<section id="slope-of-the-tangent-line">
<h2>5. Slope of the Tangent Line<a class="headerlink" href="#slope-of-the-tangent-line" title="Link to this heading">#</a></h2>
<p>Consider the point <span class="math notranslate nohighlight">\((1,1)\)</span> on the curve <span class="math notranslate nohighlight">\(f(x,y) = x^2 - y^3 - x + y = 0\)</span>.</p>
<ol class="arabic">
<li><p>Give the Sage command(s) to compute a Taylor series about the point <span class="math notranslate nohighlight">\((1,1)\)</span>
where the term of the error is of second order.</p></li>
<li><p>Compute the slope of the tangent line of the curve at the point <span class="math notranslate nohighlight">\((1,1)\)</span>
and use the slope to determine the tangent line.
Write the equation of the tangent line.</p>
<p>Verify that the tangent line equals the first-order Taylor series at <span class="math notranslate nohighlight">\((1,1)\)</span>.</p>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="n">tf</span> <span class="o">=</span> <span class="n">taylor</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">tf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x - 2*y + 1
</pre></div>
</div>
</div>
</div>
<p>We can compute the slope of the tangent line directly from the Taylor series, as below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">tf</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">tf</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/2
</pre></div>
</div>
</div>
</div>
<p>To compute the slope of the tangent line at <span class="math notranslate nohighlight">\((1,1)\)</span> we apply implicit differentiation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">dy</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">dy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>diff(y(x), x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-y(x)^3 + x^2 - x + y(x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-3*y(x)^2*diff(y(x), x) + 2*x + diff(y(x), x) - 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[diff(y(x), x) == (2*x - 1)/(3*y(x)^2 - 1)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">slope</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">y</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span><span class="mi">1</span><span class="p">})</span>
<span class="n">slope</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tangent</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">slope</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">tangent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1/2*x + y(x) - 1/2 == 0
</pre></div>
</div>
</div>
</div>
<p>Let us compare with the Taylor series approximation in <code class="docutils literal notranslate"><span class="pre">tf</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x - 2*y + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -tf.coefficient(x, 1)/tf.coefficient(y, 1)</span>
<span class="c1"># does not work at this point, because y was defined as a function ...</span>
</pre></div>
</div>
</div>
</div>
<p>As equations <code class="docutils literal notranslate"><span class="pre">tangent</span></code> and <code class="docutils literal notranslate"><span class="pre">tf</span></code> are the same, as can be seen by multiplying the coefficients of <code class="docutils literal notranslate"><span class="pre">tangent</span></code> by two.</p>
</section>
<section id="plotting-in-polar-coordinates">
<h2>6. Plotting in Polar Coordinates<a class="headerlink" href="#plotting-in-polar-coordinates" title="Link to this heading">#</a></h2>
<p>Consider the curve <span class="math notranslate nohighlight">\(x^4 - 3 x y + y^4 = 0\)</span>.  Do the following.</p>
<ol class="arabic simple">
<li><p>Make a plot for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> both ranging between <span class="math notranslate nohighlight">\(-2\)</span> and <span class="math notranslate nohighlight">\(+2\)</span>;</p></li>
<li><p>Convert the curve into polar coordinates; and</p></li>
<li><p>Plot the curve in polar coordinates.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">4</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">pf</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9bd6e7d797c9a53c9e3c8981f3e4f3a6fe23c5de4c1dfd102a8b11f8f2b5f038.png" src="../_images/9bd6e7d797c9a53c9e3c8981f3e4f3a6fe23c5de4c1dfd102a8b11f8f2b5f038.png" />
</div>
</div>
<p>We convert to polar coordinates with a substitution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r,t&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qf</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">qf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r^4*cos(t)^4 + r^4*sin(t)^4 - 3*r^2*cos(t)*sin(t)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rf</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">qf</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">solution_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{r: -sqrt(3)*sqrt(cos(t)*sin(t)/(cos(t)^4 + sin(t)^4))},
 {r: sqrt(3)*sqrt(cos(t)*sin(t)/(cos(t)^4 + sin(t)^4))},
 {r: 0}]
</pre></div>
</div>
</div>
</div>
<p>The problem is to select a good range for <span class="math notranslate nohighlight">\(t\)</span>,
because <code class="docutils literal notranslate"><span class="pre">cos(t)*sin(t)</span></code> appears as argument of <code class="docutils literal notranslate"><span class="pre">sqrt</span></code>.
To see where <code class="docutils literal notranslate"><span class="pre">cos(t)*sin(t)</span></code> becomes negative, we make a plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3f8807cba7c56323dbab972303588990ef023196ace3598b3d482aa3b20f79e9.png" src="../_images/3f8807cba7c56323dbab972303588990ef023196ace3598b3d482aa3b20f79e9.png" />
</div>
</div>
<p>We select the intervals <span class="math notranslate nohighlight">\([0, \pi/2]\)</span> and <span class="math notranslate nohighlight">\([\pi, 3\pi/2]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pp1</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">(</span><span class="n">rf</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">r</span><span class="p">],</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">pp2</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">(</span><span class="n">rf</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">r</span><span class="p">],</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">pt0</span> <span class="o">=</span> <span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">pt0</span><span class="o">+</span><span class="n">pp1</span><span class="o">+</span><span class="n">pp2</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5b44bcbf7a95dddd3058176ac9d21ff369e4b8cde83e82ab4854c24900cfb57a.png" src="../_images/5b44bcbf7a95dddd3058176ac9d21ff369e4b8cde83e82ab4854c24900cfb57a.png" />
</div>
</div>
</section>
<section id="constrained-optimization">
<h2>7. Constrained Optimization<a class="headerlink" href="#constrained-optimization" title="Link to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> be positive numbers.
Consider <span class="math notranslate nohighlight">\(f = x^2/a + y/b\)</span> and the unit circle <span class="math notranslate nohighlight">\(x^2 + y^2 = 1\)</span>.</p>
<p>Determine the number of candidate extremal values of <span class="math notranslate nohighlight">\(f\)</span> on the unit circle.</p>
<p>Use a lexicographic Groebner basis to compute a triangular form of the equations for this problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a,b&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">a</span> <span class="o">+</span> <span class="n">y</span><span class="o">/</span><span class="n">b</span>
<span class="n">c</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">gf</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">gc</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; (2*x/a, 1/b)
(x, y) |--&gt; (2*x, 2*y)
</pre></div>
</div>
</div>
</div>
<p>We introduce a new variable to apply the technique of Lagrange multipliers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;Lambda&#39;</span><span class="p">)</span>
<span class="n">sf</span> <span class="o">=</span> <span class="p">[</span><span class="n">gf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">Lambda</span><span class="o">*</span><span class="n">gc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="n">sf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
<span class="n">sf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2*Lambda*x + 2*x/a, -2*Lambda*y + 1/b, x^2 + y^2 - 1]
</pre></div>
</div>
</div>
</div>
<p>To determine the number, we can bring the system in triangular form.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">Lambda</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="n">PR</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multivariate Polynomial Ring in x, y, a, b, Lambda over Rational Field
</pre></div>
</div>
</div>
</div>
<p>Be aware that the constraints are rational expressions!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ss</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">sf</span><span class="p">]</span>
<span class="n">ss</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2*Lambda*a*x + 2*x, -2*Lambda*b*y + 1, x^2 + y^2 - 1]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sf2</span> <span class="o">=</span> <span class="p">[</span><span class="n">PR</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ss</span><span class="p">]</span>
<span class="n">sf2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2*x*a*Lambda + 2*x, -2*y*b*Lambda + 1, x^2 + y^2 - 1]
</pre></div>
</div>
</div>
</div>
<p>Now we can compute a lexicographic Groebner basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">sf2</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">J</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x^2 + y^2 - 1, x*a*Lambda - x, y*a*Lambda - y - 2*a*b*Lambda^2 + 2*b*Lambda, y*b + 2*a*b^2*Lambda^2 - 1/2*a - 2*b^2*Lambda, a*b^2*Lambda^3 - 1/4*a*Lambda - b^2*Lambda^2 + 1/4]
</pre></div>
</div>
</div>
</div>
<p>Keeping in mind that a and b are parameters,
and that the variables are x, y, and Lambda,
we read off the triangular structure of the basis:</p>
<ol class="arabic simple">
<li><p>There is a polynomial of degree 3 in Lambda.</p></li>
<li><p>x and y appear linearly as equations in Lambda.</p></li>
</ol>
<p>Thus, there are 3 solutions, for generic values of the parameters a and b.</p>
<p><strong>Extra Question:</strong> Solve this problem numerically for a = 2, and b = 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g23</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">g</span><span class="p">]</span>
<span class="n">g23</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x^2 + y^2 - 1,
 2*x*Lambda - x,
 2*y*Lambda - y - 12*Lambda^2 + 6*Lambda,
 3*y + 36*Lambda^2 - 18*Lambda - 1,
 18*Lambda^3 - 9*Lambda^2 - 1/2*Lambda + 1/4]
</pre></div>
</div>
</div>
</div>
<p>In order to solve this problem properly, we must cast the polynomials in a ring with variables, x, y, and Lambda.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">QR</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Lambda</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="n">QR</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multivariate Polynomial Ring in x, y, Lambda over Rational Field
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G23</span> <span class="o">=</span> <span class="p">[</span><span class="n">QR</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">g23</span><span class="p">]</span>
<span class="n">G23</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x^2 + y^2 - 1,
 2*x*Lambda - x,
 2*y*Lambda - y - 12*Lambda^2 + 6*Lambda,
 3*y + 36*Lambda^2 - 18*Lambda - 1,
 18*Lambda^3 - 9*Lambda^2 - 1/2*Lambda + 1/4]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J23</span> <span class="o">=</span> <span class="n">ideal</span><span class="p">(</span><span class="n">G23</span><span class="p">)</span>
<span class="n">J23</span><span class="o">.</span><span class="n">variety</span><span class="p">(</span><span class="n">QQbar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{Lambda: 0.50000000000000000?, y: 0.3333333333333334?, x: -0.9428090415820634?},
 {Lambda: 0.50000000000000000?, y: 0.3333333333333334?, x: 0.9428090415820634?},
 {Lambda: 0.1666666666666667?, y: 1, x: 0},
 {Lambda: -0.1666666666666667?, y: -1, x: 0}]
</pre></div>
</div>
</div>
</div>
<p>We see that for the particular values of 2 and 3 for a and b, we have four solutions.</p>
</section>
<section id="solving-a-linear-system">
<h2>8. Solving a Linear System<a class="headerlink" href="#solving-a-linear-system" title="Link to this heading">#</a></h2>
<p>Do the following.</p>
<ol class="arabic simple">
<li><p>Create a 5-by-5 matrix <span class="math notranslate nohighlight">\(A\)</span> over the rationals where
the <span class="math notranslate nohighlight">\((i,j)\)</span>-the element is <span class="math notranslate nohighlight">\(1/(i+j)\)</span> (for <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> both from 1 to 5).</p></li>
<li><p>Define <span class="math notranslate nohighlight">\(b\)</span> as a vector of length 5 of ones.
Solve the system defined by <span class="math notranslate nohighlight">\(A x = b\)</span>.</p></li>
<li><p>Verify that <span class="math notranslate nohighlight">\(b - A x\)</span> equals zero.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 1/2  1/3  1/4  1/5  1/6]
[ 1/3  1/4  1/5  1/6  1/7]
[ 1/4  1/5  1/6  1/7  1/8]
[ 1/5  1/6  1/7  1/8  1/9]
[ 1/6  1/7  1/8  1/9 1/10]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 1, 1, 1, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">A</span>\<span class="n">b</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(30, -420, 1680, -2520, 1260)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 0, 0, 0, 0)
</pre></div>
</div>
</div>
</div>
</section>
<section id="an-initial-value-problem">
<h2>9. An Initial Value Problem<a class="headerlink" href="#an-initial-value-problem" title="Link to this heading">#</a></h2>
<p>Consider the intial value problem <span class="math notranslate nohighlight">\(dy/dt = 2 - 6y\)</span>, <span class="math notranslate nohighlight">\(y(0) = -1\)</span>.</p>
<ol class="arabic">
<li><p>Solve this problem and plot the solution trajectory for <span class="math notranslate nohighlight">\(t \in [0,2]\)</span>.</p></li>
<li><p>Plot the slope field for <span class="math notranslate nohighlight">\(t \in [0,2]\)</span>, <span class="math notranslate nohighlight">\(y \in [-1,0.5]\)</span>.</p>
<p>Place also the particular solution computed the first part of this question on the plot.</p>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="n">ode</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">y</span>
<span class="n">ode</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>diff(y(t), t) == -6*y(t) + 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3*(e^(6*t) - 4)*e^(-6*t)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotsol</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plotsol</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/71ae39f1b1a4ce607ef95542c0e3ea4d19ac872bc672e5d91bfe74029a52c84d.png" src="../_images/71ae39f1b1a4ce607ef95542c0e3ea4d19ac872bc672e5d91bfe74029a52c84d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">ode</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-6*y(t) + 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/3*(e^(6*t) - 4)*e^(-6*t)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">):</span><span class="n">sol</span><span class="p">})</span>
<span class="n">sr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2*(e^(6*t) - 4)*e^(-6*t) + 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pslopes</span> <span class="o">=</span> <span class="n">plot_slope_field</span><span class="p">(</span><span class="n">sr</span><span class="p">,(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="n">Y</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span><span class="n">headlength</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">headaxislength</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="p">(</span><span class="n">pslopes</span><span class="o">+</span><span class="n">plotsol</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3d51e7bfbab57d303baed82f0298fa7427ab6cd494b2eaf279a80d6d79c1f4e0.png" src="../_images/3d51e7bfbab57d303baed82f0298fa7427ab6cd494b2eaf279a80d6d79c1f4e0.png" />
</div>
</div>
</section>
<section id="polyhedral-optimization">
<h2>10. Polyhedral Optimization<a class="headerlink" href="#polyhedral-optimization" title="Link to this heading">#</a></h2>
<p>Minimize <span class="math notranslate nohighlight">\(x+3y\)</span></p>
<p>subject to <span class="math notranslate nohighlight">\(x \geq 2\)</span>, <span class="math notranslate nohighlight">\(y \geq 1\)</span>, <span class="math notranslate nohighlight">\(x + 2y \leq 8\)</span>, <span class="math notranslate nohighlight">\(x+y \leq 6\)</span>.</p>
<p>Formulate the linear programming problem and solve it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">MixedIntegerLinearProgram</span><span class="p">(</span><span class="n">maximization</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minimization:
  

Constraints:
Variables:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">new_variable</span><span class="p">(</span><span class="n">nonnegative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minimization:
  x_0 + 3.0 x_1 

Constraints:
Variables:
  x_0 is a continuous variable (min=0.0, max=+oo)
  x_1 is a continuous variable (min=0.0, max=+oo)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minimization:
  x_0 + 3.0 x_1 

Constraints:
  2.0 &lt;= x_0 
  1.0 &lt;= x_1 
  x_0 + 2.0 x_1 &lt;= 8.0
  x_0 + x_1 &lt;= 6.0
Variables:
  x_0 is a continuous variable (min=0.0, max=+oo)
  x_1 is a continuous variable (min=0.0, max=+oo)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: 2.0, 2: 1.0}
</pre></div>
</div>
</div>
</div>
<p>The optimal value 5 is obtained at (2, 1).</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="review-3-answers-combined">
<h1>Review 3 - Answers combined<a class="headerlink" href="#review-3-answers-combined" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>We review the first two parts of the course for the final exam.</p></li>
<li><p>Below are <strong>both Q &amp; A</strong> to the review problems for the first part of the course.</p></li>
</ul>
<section id="our-first-steps">
<h2>1. Our First Steps<a class="headerlink" href="#our-first-steps" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>question 1.<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Explain the difference between <code class="docutils literal notranslate"><span class="pre">RDF</span></code> and <code class="docutils literal notranslate"><span class="pre">RR</span></code>.  Illustrate with an example.</p>
</section>
<section id="answer-to-question-1">
<h3>answer to question 1<a class="headerlink" href="#answer-to-question-1" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">RDF</span></code> corresponds to the hardware doubles,
whereas <code class="docutils literal notranslate"><span class="pre">RR</span></code> has a default precision of 53 bits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">RDF</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Real Double Field
Real Field with 53 bits of precision
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">RDF</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">RR</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.141592653589793 has type &lt;class &#39;sage.rings.real_double_element_gsl.RealDoubleElement_gsl&#39;&gt;
3.14159265358979 has type &lt;class &#39;sage.rings.real_mpfr.RealNumber&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>question 2<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Give a list of ten rational approximations for <code class="docutils literal notranslate"><span class="pre">sqrt(3)</span></code>, accurate with 2, 3, up to 11 decimal places.</p>
</section>
<section id="answer-to-question-2">
<h3>answer to question 2<a class="headerlink" href="#answer-to-question-2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">[</span><span class="n">QQ</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">12</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[26/15,
 265/153,
 362/209,
 989/571,
 8733/5042,
 18817/10864,
 70226/40545,
 191861/110771,
 716035/413403,
 1694157/978122]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>question 3<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Consider <span class="math notranslate nohighlight">\(Z_{31}\)</span>.  What is the multiplicative inverse of 7?</p>
<p>Show that <span class="math notranslate nohighlight">\(15 x^5 + 4 x^4 + 23 x^3 + 26 x^2 + 6 x + 1\)</span> is irreducible over <span class="math notranslate nohighlight">\(Z_{31}\)</span>.</p>
</section>
<section id="answer-to-question-3">
<h3>answer to question 3<a class="headerlink" href="#answer-to-question-3" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z31</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<span class="n">Z31</span><span class="o">.</span><span class="n">multiplication_table</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> *  aa ab ac ad ae af ag ah ai aj ak al am an ao ap aq ar as at au av aw ax ay az ba bb bc bd be
  +---------------------------------------------------------------------------------------------
aa| aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa aa
ab| aa ab ac ad ae af ag ah ai aj ak al am an ao ap aq ar as at au av aw ax ay az ba bb bc bd be
ac| aa ac ae ag ai ak am ao aq as au aw ay ba bc be ab ad af ah aj al an ap ar at av ax az bb bd
ad| aa ad ag aj am ap as av ay bb be ac af ai al ao ar au ax ba bd ab ae ah ak an aq at aw az bc
ae| aa ae ai am aq au ay bc ab af aj an ar av az bd ac ag ak ao as aw ba be ad ah al ap at ax bb
af| aa af ak ap au az be ae aj ao at ay bd ad ai an as ax bc ac ah am ar aw bb ab ag al aq av ba
ag| aa ag am as ay be af al ar ax bd ae ak aq aw bc ad aj ap av bb ac ai ao au ba ab ah an at az
ah| aa ah ao av bc ae al as az ab ai ap aw bd af am at ba ac aj aq ax be ag an au bb ad ak ar ay
ai| aa ai aq ay ab aj ar az ac ak as ba ad al at bb ae am au bc af an av bd ag ao aw be ah ap ax
aj| aa aj as bb af ao ax ab ak at bc ag ap ay ac al au bd ah aq az ad am av be ai ar ba ae an aw
ak| aa ak au be aj at bd ai as bc ah ar bb ag aq ba af ap az ae ao ay ad an ax ac am aw ab al av
al| aa al aw ac an ay ae ap ba ag ar bc ai at be ak av ab am ax ad ao az af aq bb ah as bd aj au
am| aa am ay af ar bd ak aw ad ap bb ai au ab an az ag as be al ax ae aq bc aj av ac ao ba ah at
an| aa an ba ai av ad aq bd al ay ag at ab ao bb aj aw ae ar be am az ah au ac ap bc ak ax af as
ao| aa ao bc al az ai aw af at ac aq be an bb ak ay ah av ae as ab ap bd am ba aj ax ag au ad ar
ap| aa ap be ao bd an bc am bb al ba ak az aj ay ai ax ah aw ag av af au ae at ad as ac ar ab aq
aq| aa aq ab ar ac as ad at ae au af av ag aw ah ax ai ay aj az ak ba al bb am bc an bd ao be ap
ar| aa ar ad au ag ax aj ba am bd ap ab as ae av ah ay ak bb an be aq ac at af aw ai az al bc ao
as| aa as af ax ak bc ap ac au ah az am be ar ae aw aj bb ao ab at ag ay al bd aq ad av ai ba an
at| aa at ah ba ao ac av aj bc aq ae ax al be as ag az an ab au ai bb ap ad aw ak bd ar af ay am
au| aa au aj bd as ah bb aq af az ao ad ax am ab av ak be at ai bc ar ag ba ap ae ay an ac aw al
av| aa av al ab aw am ac ax an ad ay ao ae az ap af ba aq ag bb ar ah bc as ai bd at aj be au ak
aw| aa aw an ae ba ar ai be av am ad az aq ah bd au al ac ay ap ag bc at ak ab ax ao af bb as aj
ax| aa ax ap ah be aw ao ag bd av an af bc au am ae bb at al ad ba as ak ac az ar aj ab ay aq ai
ay| aa ay ar ak ad bb au an ag be ax aq aj ac ba at am af bd aw ap ai ab az as al ae bc av ao ah
az| aa az at an ah ab ba au ao ai ac bb av ap aj ad bc aw aq ak ae bd ax ar al af be ay as am ag
ba| aa ba av aq al ag ab bb aw ar am ah ac bc ax as an ai ad bd ay at ao aj ae be az au ap ak af
bb| aa bb ax at ap al ah ad be ba aw as ao ak ag ac bd az av ar an aj af ab bc ay au aq am ai ae
bc| aa bc az aw at aq an ak ah ae ab bd ba ax au ar ao al ai af ac be bb ay av as ap am aj ag ad
bd| aa bd bb az ax av at ar ap an al aj ah af ad ab be bc ba ay aw au as aq ao am ak ai ag ae ac
be| aa be bd bc bb ba az ay ax aw av au at as ar aq ap ao an am al ak aj ai ah ag af ae ad ac ab
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i7</span> <span class="o">=</span> <span class="n">Z31</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="n">i7</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<p>We see that the multiplicative inverse of 7 modulo 31 is 9.  Let us verify this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Z31</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">i7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Indeed, 9 is the inverse of 7 modulo 31.</p>
<p>Let us now solve the second part of the question.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">Z31</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">23</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">26</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15*x^5 + 4*x^4 + 23*x^3 + 26*x^2 + 6*x + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;sage.rings.polynomial.polynomial_zmod_flint.Polynomial_zmod_flint&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type(p)</span></code> verifies that <code class="docutils literal notranslate"><span class="pre">p</span></code> is not a general symbolic expression, but a particular type of polynomial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(15) * (x^5 + 23*x^4 + 16*x^3 + 10*x^2 + 19*x + 29)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Both <code class="docutils literal notranslate"><span class="pre">p.factor()</span></code> and <code class="docutils literal notranslate"><span class="pre">p.is_irreducible()</span></code> show that the polynomial is irreducible.</p>
<p>Instead of <code class="docutils literal notranslate"><span class="pre">polygen(GF(31))</span></code>, we can also use <code class="docutils literal notranslate"><span class="pre">PolynomialRing</span></code>,
which gives the same type of polynomial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">23</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">26</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15*x^5 + 4*x^4 + 23*x^3 + 26*x^2 + 6*x + 1 has type &lt;class &#39;sage.rings.polynomial.polynomial_zmod_flint.Polynomial_zmod_flint&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>question 4<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Expand <code class="docutils literal notranslate"><span class="pre">exp(I*2*Pi/k)</span></code> as <code class="docutils literal notranslate"><span class="pre">cos(2*Pi/k)</span> <span class="pre">+</span> <span class="pre">I*sin(2*Pi/k)</span></code>.</p>
</section>
<section id="answer-to-question-4">
<h3>answer to question 4<a class="headerlink" href="#answer-to-question-4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">SR</span><span class="o">.</span><span class="n">symbol</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">k</span><span class="p">)</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e^(2*I*pi/k)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">real</span><span class="p">()</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">t</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cos(2*pi/k) + I*sin(2*pi/k)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>question 5<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>Consider <code class="docutils literal notranslate"><span class="pre">q</span> <span class="pre">=</span> <span class="pre">cos(x^3</span> <span class="pre">-</span> <span class="pre">1)</span> <span class="pre">+</span> <span class="pre">3*sin(y)</span> <span class="pre">-</span> <span class="pre">z^7</span></code>.  Draw the expression tree of <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
</section>
<section id="answer-to-question-5">
<h3>answer to question 5<a class="headerlink" href="#answer-to-question-5" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span><span class="o">^</span><span class="mi">7</span>
<span class="n">q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-z^7 + cos(x^3 - 1) + 3*sin(y)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">operands</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-z^7, cos(x^3 - 1), 3*sin(y)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">operator</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function add_vararg at 0x7f0fc7082830&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">operands</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;q0 :&#39;</span><span class="p">,</span> <span class="n">q0</span><span class="o">.</span><span class="n">operator</span><span class="p">(),</span> <span class="n">q0</span><span class="o">.</span><span class="n">operands</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;q1 :&#39;</span><span class="p">,</span> <span class="n">q1</span><span class="o">.</span><span class="n">operator</span><span class="p">(),</span> <span class="n">q1</span><span class="o">.</span><span class="n">operands</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;q2 :&#39;</span><span class="p">,</span> <span class="n">q2</span><span class="o">.</span><span class="n">operator</span><span class="p">(),</span> <span class="n">q2</span><span class="o">.</span><span class="n">operands</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>q0 : &lt;function mul_vararg at 0x7f0fc70828c0&gt; [z^7, -1]
q1 : cos [x^3 - 1]
q2 : &lt;function mul_vararg at 0x7f0fc70828c0&gt; [sin(y), 3]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q00</span> <span class="o">=</span> <span class="n">q0</span><span class="o">.</span><span class="n">operands</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;q00 :&#39;</span><span class="p">,</span> <span class="n">q00</span><span class="o">.</span><span class="n">operator</span><span class="p">(),</span> <span class="n">q00</span><span class="o">.</span><span class="n">operands</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>q00 : &lt;built-in function pow&gt; [z, 7]
</pre></div>
</div>
</div>
</div>
<p>Now we have enough information to draw the expression tree.</p>
<p>Let us start representing all leaves.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Lx</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">Ly</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">Lz</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">L7</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;7&#39;</span><span class="p">)</span>
<span class="n">Lm1</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
<span class="n">L3</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We start with the <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">z^7</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Lz7</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Lz</span><span class="p">,</span><span class="n">L7</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pow&#39;</span><span class="p">)</span>
<span class="n">Lop1</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Lz7</span><span class="p">,</span><span class="n">Lm1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">Lop1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;repr(&lt;sage.typeset.ascii_art.AsciiArt at 0x7f0fc36c4700&gt;) failed: OSError: [Errno 25] Inappropriate ioctl for device&gt;
</pre></div>
</div>
</div>
</div>
<p>The second operand is <code class="docutils literal notranslate"><span class="pre">cos(x^3-1)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Lx3</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Lx</span><span class="p">,</span><span class="n">L3</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pow&#39;</span><span class="p">)</span>
<span class="n">Lx3m1</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Lx3</span><span class="p">,</span><span class="n">Lm1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">)</span>
<span class="n">Lop2</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Lx3m1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">Lop2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;repr(&lt;sage.typeset.ascii_art.AsciiArt at 0x7f0fc36c5870&gt;) failed: OSError: [Errno 25] Inappropriate ioctl for device&gt;
</pre></div>
</div>
</div>
</div>
<p>Then the third operand is <code class="docutils literal notranslate"><span class="pre">3*sin(y)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Lsin</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Ly</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin&#39;</span><span class="p">)</span>
<span class="n">Lop3</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">L3</span><span class="p">,</span><span class="n">Lsin</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">Lop3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;repr(&lt;sage.typeset.ascii_art.AsciiArt at 0x7f0fc36c4340&gt;) failed: OSError: [Errno 25] Inappropriate ioctl for device&gt;
</pre></div>
</div>
</div>
</div>
<p>Now we can assemble the tree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Lop1</span><span class="p">,</span><span class="n">Lop2</span><span class="p">,</span><span class="n">Lop3</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;repr(&lt;sage.typeset.ascii_art.AsciiArt at 0x7f0fc36c6500&gt;) failed: OSError: [Errno 25] Inappropriate ioctl for device&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h3>question 6<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>Save a random matrix to file, destroy its reference,
and load then the saved matrix back into SageMath.</p>
</section>
<section id="answer-question-6">
<h3>answer question 6<a class="headerlink" href="#answer-question-6" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">())</span>
<span class="n">M</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  0.621660021942880   0.649467962756092  -0.554103848766790  0.0227078641543150]
[  0.404637308293002  -0.722876671193864  -0.266150461564519 -0.0663804221933906]
[ -0.141812483491682  -0.694540150031590  -0.167627160357438   0.693178157317415]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;ourmatrix&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">M</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;ourmatrix.sobj&#39;</span><span class="p">)</span>
<span class="n">M</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  0.621660021942880   0.649467962756092  -0.554103848766790  0.0227078641543150]
[  0.404637308293002  -0.722876671193864  -0.266150461564519 -0.0663804221933906]
[ -0.141812483491682  -0.694540150031590  -0.167627160357438   0.693178157317415]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h3>question 7<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>Consider <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span> <span class="pre">79*x^298+56*x^205+49*x^164+63*x^121+57*x^11959*x^42</span></code>.</p>
<ol class="arabic simple">
<li><p>Generate optimized code to evaluate <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p></li>
<li><p>How many operations are needed to evaluate <code class="docutils literal notranslate"><span class="pre">p</span></code>?</p></li>
<li><p>Compare with the cost of the direct evaluation of <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p></li>
</ol>
</section>
<section id="answer-to-question-7">
<h3>answer to question 7<a class="headerlink" href="#answer-to-question-7" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">79</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">298</span>  <span class="o">+</span> <span class="mi">56</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">205</span> <span class="o">+</span> <span class="mi">49</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">164</span> <span class="o">+</span> <span class="mi">63</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">121</span> <span class="o">+</span> <span class="mi">57</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">119</span> <span class="o">-</span> <span class="mi">59</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">42</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>79*x^298 + 56*x^205 + 49*x^164 + 63*x^121 + 57*x^119 - 59*x^42
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">fast_callable</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="n">q</span><span class="o">.</span><span class="n">op_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 298),
 (&#39;load_const&#39;, 79),
 &#39;mul&#39;,
 (&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 205),
 (&#39;load_const&#39;, 56),
 &#39;mul&#39;,
 &#39;add&#39;,
 (&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 164),
 (&#39;load_const&#39;, 49),
 &#39;mul&#39;,
 &#39;add&#39;,
 (&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 121),
 (&#39;load_const&#39;, 63),
 &#39;mul&#39;,
 &#39;add&#39;,
 (&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 119),
 (&#39;load_const&#39;, 57),
 &#39;mul&#39;,
 &#39;add&#39;,
 (&#39;load_arg&#39;, 0),
 (&#39;ipow&#39;, 42),
 (&#39;load_const&#39;, -59),
 &#39;mul&#39;,
 &#39;add&#39;,
 &#39;return&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of operations :&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">op_list</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of operations : 30
</pre></div>
</div>
</div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">fast_callable</span></code> evaluation, we have six exponentiations (<code class="docutils literal notranslate"><span class="pre">ipow</span></code>),
six multiplications with a coefficient, and five additions.
In the direct evaluation, without <code class="docutils literal notranslate"><span class="pre">ipow</span></code>, the number of multiplications is
the sum of the degrees of the operands of p.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdegs</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">operands</span><span class="p">()]</span>
<span class="n">pdegs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[298, 205, 164, 121, 119, 42]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;number of multiplications:&#39;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pdegs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of multiplications: 949
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h3>question 8<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>Consider the right hand side of</p>
<div class="math notranslate nohighlight">
\[
   \int_1^2 \frac{1}{x} dx \approx \frac{1}{2n} \left( 1 + \frac{1}{2} \right)
                                  + \frac{1}{n} \sum_{k=1}^n \left( \frac{1}{1 + k/n} \right).
\]</div>
<ol class="arabic">
<li><p>Write a Python function <code class="docutils literal notranslate"><span class="pre">P</span></code> to define the evaluation of the right hand side of the above sum,
for any value for <span class="math notranslate nohighlight">\(n\)</span> which is the input parameter to the function.</p>
<p>Compare the value of <code class="docutils literal notranslate"><span class="pre">P(10000)</span></code> with the exact value of the integral.</p>
<p>Time the execution of the function for <span class="math notranslate nohighlight">\(n = 10,000\)</span>.</p>
</li>
<li><p>Use vectorization to define a more efficient function <code class="docutils literal notranslate"><span class="pre">F</span></code> which computes the same sum as <code class="docutils literal notranslate"><span class="pre">P</span></code>
and which also takes <span class="math notranslate nohighlight">\(n\)</span> as the input parameter.</p>
<p>Compare the value of <code class="docutils literal notranslate"><span class="pre">F(10000)</span></code> with the exact value of the integral.</p>
<p>Time the execution of the function for <span class="math notranslate nohighlight">\(n = 10,000\)</span>.</p>
</li>
</ol>
<p>Compare the result of the timings.</p>
</section>
<section id="answer-to-question-8">
<h3>answer to question 8<a class="headerlink" href="#answer-to-question-8" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="o">/</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="n">n</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10000</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">p10000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.693147181184945
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exact</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="n">exact</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6931471805599452
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10000</span> <span class="o">-</span> <span class="n">exact</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.25000162735034e-10
</pre></div>
</div>
</div>
</div>
<p>We see that the error of the approximate sum is about <span class="math notranslate nohighlight">\(6.25 \times 10^{-10}\)</span> which is accurate enough.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;P(10000)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25 loops, best of 3: 16.9 ms per loop
</pre></div>
</div>
</div>
</div>
<p>Now we import <code class="docutils literal notranslate"><span class="pre">numpy</span></code> to apply the vectorization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">F</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies vectorization to the trapezoidal rule</span>
<span class="sd">    with n function evaluations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">((</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">pts</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f10000</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">f10000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6931471811849453
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f10000</span> <span class="o">-</span> <span class="n">exact</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.250001627350343e-10
</pre></div>
</div>
</div>
</div>
<p>We see the same error as before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;F(10000)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>625 loops, best of 3: 42.8 s per loop
</pre></div>
</div>
</div>
</div>
<p>We observe that by vectorization, the time has dropped from 52 milliseconds to 151 microseconds.</p>
</section>
</section>
<section id="polynomials-and-rational-expressions">
<h2>2. Polynomials and Rational Expressions<a class="headerlink" href="#polynomials-and-rational-expressions" title="Link to this heading">#</a></h2>
<section id="question-9">
<h3>question 9<a class="headerlink" href="#question-9" title="Link to this heading">#</a></h3>
<p>Draw the expression tree of <code class="docutils literal notranslate"><span class="pre">x*y*(x-y)</span></code>.</p>
</section>
<section id="answer-to-question-9">
<h3>answer to question 9<a class="headerlink" href="#answer-to-question-9" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x - y)*x*y
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">operator</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;function mul_vararg at 0x7f0fc70828c0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">operands</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x - y, x, y]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p0</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">operands</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p0 :&#39;</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p0</span><span class="o">.</span><span class="n">operator</span><span class="p">(),</span> <span class="n">p0</span><span class="o">.</span><span class="n">operands</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p0 : x - y &lt;function add_vararg at 0x7f0fc7082830&gt; [x, -y]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span> <span class="o">=</span> <span class="n">p0</span><span class="o">.</span><span class="n">operands</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p1 :&#39;</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">operator</span><span class="p">(),</span> <span class="n">p1</span><span class="o">.</span><span class="n">operands</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p1 : -y &lt;function mul_vararg at 0x7f0fc70828c0&gt; [y, -1]
</pre></div>
</div>
</div>
</div>
<p>We now have enough information to draw the expression tree.</p>
<p>To represent the tree via LabelledOrderedTree,
we can start defining the leaves: <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, and <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Lx</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">Ly</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">Lm1</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
<span class="c1"># The x - y is represented as x + (-1)*y</span>
<span class="n">Lmy</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Ly</span><span class="p">,</span><span class="n">Lm1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">)</span>
<span class="n">Lop1</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Lx</span><span class="p">,</span><span class="n">Lmy</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">Lop1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;repr(&lt;sage.typeset.ascii_art.AsciiArt at 0x7f0fb917d420&gt;) failed: OSError: [Errno 25] Inappropriate ioctl for device&gt;
</pre></div>
</div>
</div>
</div>
<p>Then the expression tree has Lop1 as the first child,
the other two children are <code class="docutils literal notranslate"><span class="pre">Lx</span></code> and <code class="docutils literal notranslate"><span class="pre">Ly</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">LabelledOrderedTree</span><span class="p">([</span><span class="n">Lop1</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">)</span>
<span class="n">ascii_art</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;repr(&lt;sage.typeset.ascii_art.AsciiArt at 0x7f0fb917c2b0&gt;) failed: OSError: [Errno 25] Inappropriate ioctl for device&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-10">
<h3>question 10<a class="headerlink" href="#question-10" title="Link to this heading">#</a></h3>
<p>Consider <span class="math notranslate nohighlight">\(p = x^3 - x - 2\)</span> and give all Sage commands for an exact,
numeric, and symbolic factorization.</p>
<p>In particular, answer the following questions.</p>
<ol class="arabic simple">
<li><p>How can you write <span class="math notranslate nohighlight">\(p\)</span> as an <em>exact</em> product of
linear factors, with <em>exact</em> complex numbers?</p></li>
<li><p>Compute a <em>numerical</em> factorization
of <span class="math notranslate nohighlight">\(p\)</span> over the complex numbers.</p></li>
<li><p>Define a <em>symbolic</em> (i.e.: formal) factorization of <span class="math notranslate nohighlight">\(p\)</span>,
declaring sufficiently many roots.</p></li>
<li><p>Compute a <em>symbolic-numeric</em> factorization of <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ol>
</section>
<section id="answer-to-question-10">
<h3>answer to question 10<a class="headerlink" href="#answer-to-question-10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^3 - x - 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(-1/2*(1/9*sqrt(26)*sqrt(3) + 1)^(1/3)*(I*sqrt(3) + 1) - 1/6*(-I*sqrt(3) + 1)/(1/9*sqrt(26)*sqrt(3) + 1)^(1/3),
  1),
 (-1/2*(1/9*sqrt(26)*sqrt(3) + 1)^(1/3)*(-I*sqrt(3) + 1) - 1/6*(I*sqrt(3) + 1)/(1/9*sqrt(26)*sqrt(3) + 1)^(1/3),
  1),
 ((1/9*sqrt(26)*sqrt(3) + 1)^(1/3) + 1/3/(1/9*sqrt(26)*sqrt(3) + 1)^(1/3), 1)]
</pre></div>
</div>
</div>
</div>
<p>We can assemble the exact factorization from the exact roots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prod</span><span class="p">([</span><span class="n">x</span> <span class="o">-</span> <span class="n">root</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">r</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/108*(3*(1/9*sqrt(26)*sqrt(3) + 1)^(1/3)*(I*sqrt(3) + 1) + 6*x + (-I*sqrt(3) + 1)/(1/9*sqrt(26)*sqrt(3) + 1)^(1/3))*(3*(1/9*sqrt(26)*sqrt(3) + 1)^(1/3)*(-I*sqrt(3) + 1) + 6*x + (I*sqrt(3) + 1)/(1/9*sqrt(26)*sqrt(3) + 1)^(1/3))*(3*x - 3*(1/9*sqrt(26)*sqrt(3) + 1)^(1/3) - 1/(1/9*sqrt(26)*sqrt(3) + 1)^(1/3))
</pre></div>
</div>
</div>
</div>
<p>The numerical factorization is over the complex number field.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">CC</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">](</span><span class="n">p</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x - 1.52137970680457) * (x + 0.760689853402284 - 0.857873626595179*I) * (x + 0.760689853402284 + 0.857873626595179*I)
</pre></div>
</div>
</div>
</div>
<p>Let us now do the symbolic factorization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> 
<span class="n">K</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number Field in a with defining polynomial x^3 - x - 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kp</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">](</span><span class="n">p</span><span class="p">)</span>
<span class="n">kp</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x - a) * (x^2 + a*x + a^2 - 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kpb</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kp</span><span class="o">.</span><span class="n">factor</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">kpb</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number Field in b with defining polynomial x^2 + a*x + a^2 - 1 over its base field
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lkp</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">](</span><span class="n">kp</span><span class="p">)</span>
<span class="n">lkp</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x + b + a) * (x - b) * (x - a)
</pre></div>
</div>
</div>
</div>
<p>The symbolic-numeric factorization works over the field <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>, extending the complex number with complex intervals.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factor</span><span class="p">(</span><span class="n">QQbar</span><span class="p">[</span><span class="n">x</span><span class="p">](</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x - 1.521379706804568?) * (x + 0.7606898534022837? - 0.8578736265951787?*I) * (x + 0.7606898534022837? + 0.8578736265951787?*I)
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-11">
<h3>question 11<a class="headerlink" href="#question-11" title="Link to this heading">#</a></h3>
<p>Give all the sage commands to convert <code class="docutils literal notranslate"><span class="pre">(x-y)*(x+y)</span></code> into <code class="docutils literal notranslate"><span class="pre">(x+y)*x</span> <span class="pre">=</span> <span class="pre">(x+y)*y</span></code>.</p>
</section>
<section id="answer-to-question-11">
<h3>answer to question 11<a class="headerlink" href="#answer-to-question-11" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x + y)*(x - y)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">:</span><span class="n">z</span><span class="p">})</span>
<span class="n">q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x - y)*z
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">r</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x + y)*x - (x + y)*y
</pre></div>
</div>
</div>
</div>
</section>
<section id="question-12">
<h3>question 12<a class="headerlink" href="#question-12" title="Link to this heading">#</a></h3>
<p>Consider <span class="math notranslate nohighlight">\(r = (79*x^5 + 56*x^4 + 49*x^3 + 63*x^2 + 57*x - 59)/(45*x^5 - 8*x^4 - 93*x^2 + 43*x - 62)\)</span>.</p>
<ol class="arabic simple">
<li><p>How many operations does it take to evaluate <span class="math notranslate nohighlight">\(r\)</span> with a partial fraction decomposition?</p></li>
<li><p>Compare this number of operations with the Horner forms of numerator and denominator for r.</p></li>
</ol>
</section>
<section id="answer-to-question-12">
<h3>answer to question 12<a class="headerlink" href="#answer-to-question-12" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">CC</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="mi">79</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">56</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">49</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">63</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">57</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">59</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">45</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">93</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">43</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">62</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html><script type="math/tex; mode=display">\newcommand{\Bold}[1]{\mathbf{#1}}\frac{79.0000000000000 x^{5} + 56.0000000000000 x^{4} + 49.0000000000000 x^{3} + 63.0000000000000 x^{2} + 57.0000000000000 x - 59.0000000000000}{45.0000000000000 x^{5} - 8.00000000000000 x^{4} + 0.000000000000000 x^{3} - 93.0000000000000 x^{2} + 43.0000000000000 x - 62.0000000000000}</script></html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">partial_fraction_decomposition</span><span class="p">()</span>
<span class="n">q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.75555555555556,
 [1.73033923026938/(x - 1.34613302859424),
  (-0.209546357895326 - 0.317866843685468*I)/(x - 0.243395948193229 - 0.710544938063163*I),
  (-0.209546357895326 + 0.317866843685468*I)/(x - 0.243395948193229 + 0.710544938063163*I),
  (0.122648347698910 + 0.522394270600454*I)/(x + 0.827573573601461 - 1.06277001016849*I),
  (0.122648347698910 - 0.522394270600454*I)/(x + 0.827573573601461 + 1.06277001016849*I)])
</pre></div>
</div>
</div>
</div>
<p>If we would use the Horner form to evaluate numerator and denominator,
then we need 5 multiplications and 5 additions, with one division.
The partial fraction decomposition gives 5 divisions and 5 (complex) additions.</p>
</section>
<section id="question-13">
<h3>question 13<a class="headerlink" href="#question-13" title="Link to this heading">#</a></h3>
<p>Explain why normal forms are so important to symbolic computation.</p>
<p>What can we do if a normal form is too expensive to compute? Illustrate with a good example.</p>
</section>
<section id="answer-to-question-13">
<h3>answer to question 13<a class="headerlink" href="#answer-to-question-13" title="Link to this heading">#</a></h3>
<p>With a normal form we can decide whether two expressions are equal to each other.
The normalization for rational expression is the removal of common factors in the numerator
and the denominator.  This may lead to expression swell, as the example below shows.
We can apply a probability one numerical evaluation test.
We generate a random number and evaluate the expression to see if the expression is zero or not.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">100</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x^100 - 1)/(x - 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^99 + x^98 + x^97 + x^96 + x^95 + x^94 + x^93 + x^92 + x^91 + x^90 + x^89 + x^88 + x^87 + x^86 + x^85 + x^84 + x^83 + x^82 + x^81 + x^80 + x^79 + x^78 + x^77 + x^76 + x^75 + x^74 + x^73 + x^72 + x^71 + x^70 + x^69 + x^68 + x^67 + x^66 + x^65 + x^64 + x^63 + x^62 + x^61 + x^60 + x^59 + x^58 + x^57 + x^56 + x^55 + x^54 + x^53 + x^52 + x^51 + x^50 + x^49 + x^48 + x^47 + x^46 + x^45 + x^44 + x^43 + x^42 + x^41 + x^40 + x^39 + x^38 + x^37 + x^36 + x^35 + x^34 + x^33 + x^32 + x^31 + x^30 + x^29 + x^28 + x^27 + x^26 + x^25 + x^24 + x^23 + x^22 + x^21 + x^20 + x^19 + x^18 + x^17 + x^16 + x^15 + x^14 + x^13 + x^12 + x^11 + x^10 + x^9 + x^8 + x^7 + x^6 + x^5 + x^4 + x^3 + x^2 + x + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RR</span><span class="o">.</span><span class="n">random_element</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.685474316298453
</pre></div>
</div>
</div>
</div>
<p>We see that, when evaluated at a random element, the nonzero value shows that the expression is not zero.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="review-4">
<h1>Review 4<a class="headerlink" href="#review-4" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>We review the second half of the course.</p></li>
</ul>
<section id="part-3-calculus">
<h2>Part 3. Calculus<a class="headerlink" href="#part-3-calculus" title="Link to this heading">#</a></h2>
<section id="id9">
<h3>question 1<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p>Write a function to make polynomials in a system.</p>
<p>The <em>k</em>-th polynomial in the system is</p>
<div class="math notranslate nohighlight">
\[
      f_k(x_1,x_2, \ldots, x_n) = x_k + \sum_{i=1}^{n-k} x_i x_{k+i},
      \quad k=1,2,\ldots,n.
\]</div>
<p>Test your function on 8 variables.</p>
</section>
<section id="id10">
<h3>answer to question 1<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">)]</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x1, x2, x3, x4, x5, x6, x7, x8]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">X</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">:</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x1*x2 + x2*x3 + x3*x4 + x4*x5 + x5*x6 + x6*x7 + x7*x8 + x1,
 x1*x3 + x2*x4 + x3*x5 + x4*x6 + x5*x7 + x6*x8 + x2,
 x1*x4 + x2*x5 + x3*x6 + x4*x7 + x5*x8 + x3,
 x1*x5 + x2*x6 + x3*x7 + x4*x8 + x4,
 x1*x6 + x2*x7 + x3*x8 + x5,
 x1*x7 + x2*x8 + x6,
 x1*x8 + x7,
 x8]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h3>question 2<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>Define a piecewise function <code class="docutils literal notranslate"><span class="pre">int_inv_cub</span></code> which
as function of the end point <span class="math notranslate nohighlight">\(b\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[
   \int_{-1}^b \frac{1}{x^3} dx
\]</div>
<p>and which must be correct for <em>any</em> value of the parameter <span class="math notranslate nohighlight">\(b\)</span>.</p>
</section>
<section id="id12">
<h3>answer to question 2<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="p">),</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">i</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle \int_{-1}^{b} \frac{1}{x^{3}}\,{d x}\)</html></div></div>
</div>
<p>Without <code class="docutils literal notranslate"><span class="pre">hold=True</span></code> an error message prompts <code class="docutils literal notranslate"><span class="pre">Is</span> <span class="pre">b+1</span> <span class="pre">positive,</span> <span class="pre">negative</span> <span class="pre">or</span> <span class="pre">zero?</span></code></p>
<p>Let us assume that <span class="math notranslate nohighlight">\(b+1&lt;0\)</span> or <span class="math notranslate nohighlight">\(b&lt;-1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">assume</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span>
<span class="n">negval</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">unhold</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">negval</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle -\frac{1}{2 \, b^{2}} + \frac{1}{2}\)</html></div></div>
</div>
<p>We needed another assumption <span class="math notranslate nohighlight">\(b &gt; 0\)</span>.
We reset to test other cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="n">infval</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="p">),</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">infval</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle \int_{-1}^{b} \frac{1}{x^{3}}\,{d x}\)</html></div></div>
</div>
<p>We get another error message for the above case.
The value is infinity if 0 is in <span class="math notranslate nohighlight">\([-1,b]\)</span>.</p>
<p>We needed another assumption <span class="math notranslate nohighlight">\(b &gt; -1\)</span> and <span class="math notranslate nohighlight">\(b &lt; 0\)</span>.
We reset to test other cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span>
<span class="n">negval</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">negval</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle -\frac{1}{2 \, b^{2}} + \frac{1}{2}\)</html></div></div>
</div>
<p>So far, we have the following cases for <span class="math notranslate nohighlight">\(b\)</span>:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(-\infty &lt; b &lt; -1\)</span> : <span class="math notranslate nohighlight">\(-1/2/b^2 + 1/2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(-1 &lt; b &lt; 0\)</span> : <span class="math notranslate nohighlight">\(-1/2/b^2 + 1/2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b &gt; 0 : \infty\)</span></p></li>
</ol>
<p>Two cases are left to consider: <span class="math notranslate nohighlight">\(b = -1\)</span> and <span class="math notranslate nohighlight">\(b = 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle \int_{-1}^{0} \frac{1}{x^{3}}\,{d x}\)</html></div></div>
</div>
<p>The above integral is divergent and we will assign it the value <span class="math notranslate nohighlight">\(\infty\)</span>.</p>
<p>Finally, this is the complete case analysis:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(-\infty &lt; b &lt; -1\)</span> : <span class="math notranslate nohighlight">\(-1/2/b^2 + 1/2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b = -1\)</span> : 0</p></li>
<li><p><span class="math notranslate nohighlight">\(-1 &lt; b &lt; 0\)</span> : <span class="math notranslate nohighlight">\(-1/2/b^2 + 1/2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b \geq 0\)</span> : <span class="math notranslate nohighlight">\(\infty\)</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">int_inv_cub</span> <span class="o">=</span> <span class="n">piecewise</span><span class="p">([((</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> \
                         <span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">),((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">b</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>\
                         <span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">oo</span><span class="p">),((</span><span class="mi">0</span><span class="p">,</span><span class="n">oo</span><span class="p">),</span><span class="n">oo</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p>Let us check all cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int_inv_cub</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/8
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int_inv_cub</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int_inv_cub</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-3/2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int_inv_cub</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+Infinity
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">int_inv_cub</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+Infinity
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h3>question 3<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>The arc length of continuous function <span class="math notranslate nohighlight">\(f(x)\)</span> over an interval <span class="math notranslate nohighlight">\([a,b]\)</span> is</p>
<div class="math notranslate nohighlight">
\[
    \int_a^t \sqrt{1+[f'(x)]^2}.
\]</div>
<ol class="arabic">
<li><p>Compute the arc length of the positive half
of the unit circle, i.e.: <span class="math notranslate nohighlight">\(f(x) = \sqrt{1-x^2}\)</span></p>
<p>(<em>answer:</em> <span class="math notranslate nohighlight">\(\pi\)</span>).</p>
</li>
<li><p>Create a function (call it <code class="docutils literal notranslate"><span class="pre">arc_length</span></code>) in <span class="math notranslate nohighlight">\(t\)</span>
which returns a 10-digit floating-point approximation
of the arc length of the positive half of the circle,
for <span class="math notranslate nohighlight">\(x \in [0,t]\)</span>.</p></li>
</ol>
</section>
<section id="id14">
<h3>answer to question 3<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>\(\displaystyle -\frac{x}{\sqrt{-x^{2} + 1}}\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integral</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">df</span><span class="o">^</span><span class="mi">2</span><span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pi
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">arc_length</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the arc length of the circle for x in [0, t].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">df</span><span class="o">^</span><span class="mi">2</span><span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">),</span> <span class="n">hold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arc_length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.570796313279659
</pre></div>
</div>
</div>
</div>
</section>
<section id="id15">
<h3>question 4<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<p>Consider the recurrence relation</p>
<div class="math notranslate nohighlight">
\[
      h(n) = 5 h(n-1) - 6 h(n-2), \mbox{ for } n \geq 2,
      \mbox{ with } h(0) = 1 \mbox{ and } h(1) = -2.
\]</div>
<p>Answer the following the questions.</p>
<ol class="arabic">
<li><p>The generating function</p>
<div class="math notranslate nohighlight">
\[
        g(x) = \frac{1-7x}{1-5x + 6x^2}
   \]</div>
<p>defines <span class="math notranslate nohighlight">\(h(n)\)</span> as the coefficient with <span class="math notranslate nohighlight">\(x^n\)</span> in the Taylor
expansion of <span class="math notranslate nohighlight">\(g(x)\)</span>.</p>
<p>Use <span class="math notranslate nohighlight">\(g(x)\)</span> to define <span class="math notranslate nohighlight">\(h\)</span> as a function (call it <code class="docutils literal notranslate"><span class="pre">t</span></code>) of <span class="math notranslate nohighlight">\(n\)</span>
which gives the value of <span class="math notranslate nohighlight">\(h(n)\)</span>.</p>
</li>
<li><p>Write a function to compute <span class="math notranslate nohighlight">\(h(n)\)</span>, directly using the
recurrence relation from above.</p>
<p>Make sure your function can compute <span class="math notranslate nohighlight">\(h(120)\)</span>.</p>
<p>Compare with the result of the first part of the question.</p>
</li>
</ol>
</section>
<section id="id16">
<h3>answer to question 4<a class="headerlink" href="#id16" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="n">taylor</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-76172*x^9 - 24964*x^8 - 8108*x^7 - 2596*x^6 - 812*x^5 - 244*x^4 - 68*x^3 - 16*x^2 - 2*x + 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the value of h(n) using the</span>
<span class="sd">    Taylor series of the generating function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tn</span> <span class="o">=</span> <span class="n">taylor</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tn</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">t</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, -2, -16, -68, -244, -812, -2596, -8108, -24964, -76172]
</pre></div>
</div>
</div>
</div>
<p>Now we solve the second part of the question
and use the recursion relation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">h</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies memoization to compute h(n).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">D</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">D</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">D</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">h</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, -2, -16, -68, -244, -812, -2596, -8108, -24964, -76172]
</pre></div>
</div>
</div>
</div>
<p>We observe that we get the same sequence of numbers as before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-7188041199657724841646073178059495579561383474850002702724
</pre></div>
</div>
</div>
</div>
<p>Thanks to the memoization, the function <code class="docutils literal notranslate"><span class="pre">h</span></code> can efficiently compute `<span class="math notranslate nohighlight">\(h(120)\)</span>.</p>
</section>
<section id="id17">
<h3>question 5<a class="headerlink" href="#id17" title="Link to this heading">#</a></h3>
<p>The Legendre polynomials are defined by</p>
<div class="math notranslate nohighlight">
\[
      P_0(x) = 1, \quad P_1(x) = x,
      \quad P_n(x) = \frac{2n-1}{n} x P_{n-1}(x)
      - \frac{n-1}{n} P_{n-2}(x), \ {\rm for} \ n \geq 2.
\]</div>
<p>Write an <em>efficient, recursive</em> function <code class="docutils literal notranslate"><span class="pre">legendre</span></code> to compute
<span class="math notranslate nohighlight">\(P_n(x)\)</span>.  The function <code class="docutils literal notranslate"><span class="pre">legendre</span></code> takes on input
the degree <span class="math notranslate nohighlight">\(n\)</span> and the variable <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Compare the output of your <code class="docutils literal notranslate"><span class="pre">legendre</span></code> (50, <span class="math notranslate nohighlight">\(x\)</span> )
with the <code class="docutils literal notranslate"><span class="pre">legendre_P</span></code> (50, <span class="math notranslate nohighlight">\(x\)</span> ).</p>
</section>
<section id="id18">
<h3>answer to question 5<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">legendre</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="p">{}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the n-th Legendre polynomial in x,</span>
<span class="sd">    with memoization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">in</span> <span class="n">D</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">D</span><span class="p">[(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">expand</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">legendre</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> 
                            <span class="o">-</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">legendre</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
        <span class="n">D</span><span class="p">[(</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p>We test some simple cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">legendre</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">legendre</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">legendre</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3/2*x^2 - 1/2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">legendre</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5/2*x^3 - 3/2*x
</pre></div>
</div>
</div>
</div>
<p>Now, see if we can compute the Legendre polynomial of degree 50.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">legendre</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12611418068195524166851562157/140737488355328*x^50 - 156050375086257748529223875175/140737488355328*x^48 + 226836112238787036521861509275/35184372088832*x^46 - 823773249709279237895181270525/35184372088832*x^44 + 4189728463575151392735706892025/70368744177664*x^42 - 7928255400303748020099876118755/70368744177664*x^40 + 5790298887862287879848224131675/35184372088832*x^38 - 6684039602901787158511168414725/35184372088832*x^36 + 24770264410753681822717859419275/140737488355328*x^34 - 18602568051449552212241926551825/140737488355328*x^32 + 1423900270604780539702468452115/17592186044416*x^30 - 712769410486857922635873160725/17592186044416*x^28 + 583174972216520118520259858775/35184372088832*x^26 - 194391657405506706173419952925/35184372088832*x^24 + 26248579962778792027330678575/17592186044416*x^22 - 5693353963757653481984400705/17592186044416*x^20 + 7838675747202566388239392275/140737488355328*x^18 - 1052956443654076082002306425/140737488355328*x^16 + 26998883170617335435956575/35184372088832*x^14 - 2052546673789621992207225/35184372088832*x^12 + 222078820442811559812585/70368744177664*x^10 - 8065816723104536070675/70368744177664*x^8 + 90048990529077755175/35184372088832*x^6 - 1067774591253886425/35184372088832*x^4 + 20146690401016725/140737488355328*x^2 - 15801325804719/140737488355328
</pre></div>
</div>
</div>
</div>
<p>Legendre polynomials are already defined in SageMath.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="n">legendre_P</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5/2*x^3 - 3/2*x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">legendre_P</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">legendre</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Observe that the test whether our Legendre agrees with the Legendre of SageMath is straightforward because of the canonical form in which the polynomials are stored.</p>
</section>
<section id="id19">
<h3>question 6<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<p>Consider the point <span class="math notranslate nohighlight">\(P = (1,1)\)</span> on the curve defined by <span class="math notranslate nohighlight">\(xy - 2 x + 1 = 0\)</span>.</p>
<p>Compute the slope of the tangent line to the curve at <span class="math notranslate nohighlight">\(P\)</span> in two ways:</p>
<ol class="arabic simple">
<li><p>with implicit differentiation,</p></li>
<li><p>with a Taylor series.</p></li>
</ol>
</section>
<section id="answer-to-question-6">
<h3>answer to question 6<a class="headerlink" href="#answer-to-question-6" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>With SageMath, the fastest way to solve this problem is via the Taylor series, truncated after the linear term.  Let us do that first.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">taylor</span><span class="p">(</span><span class="n">f</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-x + y
</pre></div>
</div>
</div>
</div>
<p>We see that the tangent line is <span class="math notranslate nohighlight">\(y = x\)</span>, therefore, the slope is 1.</p>
<p>Let us now do implicit differentiation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">F</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x*Y(x) - 2*x + 1 == 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dy</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">dy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>diff(Y(x), x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dF</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">dF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x*diff(Y(x), x) + Y(x) - 2 == 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">dF</span><span class="p">,</span><span class="n">dy</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[diff(Y(x), x) == -(Y(x) - 2)/x]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">slope</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-(Y(x) - 2)/x
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the value of the slope is:&#39;</span><span class="p">,</span> <span class="n">slope</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">Y</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span><span class="mi">1</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the value of the slope is: 1
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="part-4-plotting-and-solving-equations">
<h2>Part 4: plotting and solving equations<a class="headerlink" href="#part-4-plotting-and-solving-equations" title="Link to this heading">#</a></h2>
<section id="id20">
<h3>question 7<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<p>Suppose we want to plot the curve <span class="math notranslate nohighlight">\(x^4 + x^2 y^2 - y^2 = 0\)</span>
for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> both between <span class="math notranslate nohighlight">\(-1\)</span> and <span class="math notranslate nohighlight">\(+1\)</span>.</p>
<ol class="arabic">
<li><p>Sampling this curve as given in rectangular coordinates,
how many samples do we need to take from the curve to
obtain a nice plot?</p></li>
<li><p>Convert the curve into polar coordinates and plot.</p>
<p>How many samples of the curve are needed here?</p>
</li>
</ol>
</section>
<section id="id21">
<h3>answer to question 7<a class="headerlink" href="#id21" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^4 + x^2*y^2 - y^2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pltf</span> <span class="o">=</span> <span class="n">implicit_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">pltf</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f8bb12f4851f1f72fd0e41583f2e85c02f5e022676e73f8b757db07b62de1f2d.png" src="../_images/f8bb12f4851f1f72fd0e41583f2e85c02f5e022676e73f8b757db07b62de1f2d.png" />
</div>
</div>
<p>Even with 5000 points (which already takes some time), we do not get a nice plot around (0,0) which is a singular point on this curve in rectangular coordinates.</p>
<p>Let us now convert to polar coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;r,t&#39;</span><span class="p">)</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">pf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r^4*cos(t)^4 + r^4*cos(t)^2*sin(t)^2 - r^2*sin(t)^2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">solution_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{r: -sin(t)/(sqrt(cos(t)^2 + sin(t)^2)*cos(t))},
 {r: sin(t)/(sqrt(cos(t)^2 + sin(t)^2)*cos(t))},
 {r: 0}]
</pre></div>
</div>
</div>
</div>
<p>Before plotting, let us simplify the expressions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rt0</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">r</span><span class="p">]</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
<span class="n">rt0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-sin(t)/cos(t)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rt1</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">r</span><span class="p">]</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
<span class="n">rt1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sin(t)/cos(t)
</pre></div>
</div>
</div>
</div>
<p>As the <span class="math notranslate nohighlight">\(\cos(t)\)</span> appears in the denominator, we have to avoid plotting around multiples of <span class="math notranslate nohighlight">\(\pi/2\)</span>, otherwise we would divide by zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p0</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">(</span><span class="n">rt0</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">(</span><span class="n">rt1</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="p">(</span><span class="n">p0</span><span class="o">+</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8b335f5380a4d7b6ff11fd9a8e1ad6f4891390b6196c090362cd1756b26545a0.png" src="../_images/8b335f5380a4d7b6ff11fd9a8e1ad6f4891390b6196c090362cd1756b26545a0.png" />
</div>
</div>
<p>We see that the plot looks good with the default number of plotting points.</p>
<p>Let us try 100 points total for the plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p0</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">(</span><span class="n">rt0</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">polar_plot</span><span class="p">(</span><span class="n">rt1</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="p">(</span><span class="n">p0</span><span class="o">+</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cbc02b92cce9eb2d389f2f2d22a8c7954002a8d22a338f666908d38c45f5e333.png" src="../_images/cbc02b92cce9eb2d389f2f2d22a8c7954002a8d22a338f666908d38c45f5e333.png" />
</div>
</div>
<p>Conclusion: in rectangular coordinates, even with 5000 plot points we do not get a nice enough plot around the origin.  In polar coordinates, 100 plots suffice.</p>
</section>
<section id="id22">
<h3>question 8<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<p>Solve $x^2 a^2 - 2x^2 a - 3 x^2 - x a^2 + 4 x a - 3 x + a^2</p>
<ul class="simple">
<li><p>2 a - 15<span class="math notranslate nohighlight">\( for \)</span>x<span class="math notranslate nohighlight">\( for all values of the parameter \)</span>a$.</p></li>
</ul>
<p>Be as complete as possible in your description of the solution.</p>
</section>
<section id="id23">
<h3>answer to question 8<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,a&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">15</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sx</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">sx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x == 1/2*(a - sqrt(-3*a^2 - 26*a - 19) - 1)/(a + 1), x == 1/2*(a + sqrt(-3*a^2 - 26*a - 19) - 1)/(a + 1)]
</pre></div>
</div>
</div>
</div>
<p>We see that this solution will not work for <span class="math notranslate nohighlight">\(a = -1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px2</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">px2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a^2 - 2*a - 3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sa2</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">px2</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="n">sa2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[a == 3, a == -1]
</pre></div>
</div>
</div>
</div>
<p>Another problem is the value 3 for <span class="math notranslate nohighlight">\(a\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p3</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">p3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>For <span class="math notranslate nohighlight">\(a = 3\)</span>, the entire polynomial vanishes and x can be anything.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p4</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-8*x - 16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solve</span><span class="p">(</span><span class="n">p4</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x == -2]
</pre></div>
</div>
</div>
</div>
<p>For <span class="math notranslate nohighlight">\(a = -1\)</span>, there is one solution for <span class="math notranslate nohighlight">\(x\)</span>.</p>
</section>
<section id="id24">
<h3>question 9<a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<p>Find the point with real coordinates on the curve
<span class="math notranslate nohighlight">\(xy - 2 x + 3 = 0\)</span> closest to the origin.</p>
</section>
<section id="id25">
<h3>answer to question 9<a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<ol class="arabic simple" start="3">
<li><p>Find the point with real coordinates on the curve <span class="math notranslate nohighlight">\(x y - 2 x + 3\)</span>
closest to the origin.</p></li>
</ol>
<p>We apply the technique of Lagrange multipliers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Lambda</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y,Lambda&#39;</span><span class="p">)</span>
<span class="n">target</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="n">target</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; x^2 + y^2
</pre></div>
</div>
</div>
</div>
<p>The target expresses the square of the distance of the point <span class="math notranslate nohighlight">\((x, y)\)</span> to the origin <span class="math notranslate nohighlight">\((0,0)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">constraint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="n">constraint</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; x*y - 2*x + 3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
<span class="n">dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; (2*x, 2*y)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
<span class="n">dc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(x, y) |--&gt; (y - 2, x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Lambda</span><span class="o">*</span><span class="n">dc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> \
       <span class="n">dt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Lambda</span><span class="o">*</span><span class="n">dc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">constraint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)]</span>
<span class="n">sys</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-Lambda*(y - 2) + 2*x, -Lambda*x + 2*y, x*y - 2*x + 3]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sols</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">sys</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">Lambda</span><span class="p">],</span><span class="n">solution_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{x: 0.493535367624353 + 1.8118700339534315*I,
  y: 1.5801426285062603 + 1.541382927845156*I,
  Lambda: 2.0261972405615523 - 1.1922959243930134*I},
 {x: 0.493535367624353 - 1.8118700339534315*I,
  y: 1.5801426285062603 - 1.541382927845156*I,
  Lambda: 2.0261972405615523 + 1.1922959243930134*I},
 {x: -2.1655756642279553, y: 3.385312783318223, Lambda: -3.126478616924477},
 {x: 1.1785049215216814, y: -0.5455981941309255, Lambda: -0.9259158751696065}]
</pre></div>
</div>
</div>
</div>
<p>There are two real solutions and we have to evaluate those two solutions in the target
to see which one is closest to the origin.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sol</span> <span class="ow">in</span> <span class="n">sols</span><span class="p">:</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="s1">&#39;has value </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">target</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">sol</span><span class="p">[</span><span class="n">y</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{x: 0.493535367624353 + 1.8118700339534315*I, y: 1.5801426285062603 + 1.541382927845156*I, Lambda: 2.0261972405615523 - 1.1922959243930134*I} has value 
 -2.9183064646721366 + 6.659653628869352*I
{x: 0.493535367624353 - 1.8118700339534315*I, y: 1.5801426285062603 - 1.541382927845156*I, Lambda: 2.0261972405615523 + 1.1922959243930134*I} has value 
 -2.9183064646721366 - 6.659653628869352*I
{x: -2.1655756642279553, y: 3.385312783318223, Lambda: -3.126478616924477} has value 
 16.150060598394123
{x: 1.1785049215216814, y: -0.5455981941309255, Lambda: -0.9259158751696065} has value 
 1.6865512394897515
</pre></div>
</div>
</div>
</div>
<p>We see that the last value is the one closest to the origin.</p>
</section>
<section id="id26">
<h3>question 10<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<p>How many real solutions does the system defined by <span class="math notranslate nohighlight">\(x^2 - 2 y^2 - 1 = 0\)</span>
and <span class="math notranslate nohighlight">\(x y - 2 x - 3 = 0\)</span> have?</p>
<p>Let us first try to see if we can work over <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>.</p>
</section>
<section id="id27">
<h3>answer to question 10<a class="headerlink" href="#id27" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">])</span>
<span class="n">J</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ideal (x^2 + (-2)*y^2 - 1, x*y + (-2)*x - 3) of Multivariate Polynomial Ring in x, y over Algebraic Field
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J</span><span class="o">.</span><span class="n">variety</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{y: -0.4808124295021981?, x: -1.209281267831274?},
 {y: 2.747679206408034?, x: 4.012415985744022?},
 {y: 0.8665666115470820? - 1.068362531678099?*I, x: -1.401567358956374? + 1.321102825438973?*I},
 {y: 0.8665666115470820? + 1.068362531678099?*I, x: -1.401567358956374? - 1.321102825438973?*I}]
</pre></div>
</div>
</div>
</div>
<p>We see there are two real and two complex conjugated solutions.
Let us verify with a lexicographic Groebner basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RQ</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;lex&#39;</span><span class="p">)</span>
<span class="n">JQ</span> <span class="o">=</span> <span class="n">Ideal</span><span class="p">([</span><span class="n">RQ</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="n">RQ</span><span class="p">(</span><span class="n">q</span><span class="p">)])</span>
<span class="n">JQ</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ideal (x^2 - 2*y^2 - 1, x*y - 2*x - 3) of Multivariate Polynomial Ring in x, y over Rational Field
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gb</span> <span class="o">=</span> <span class="n">JQ</span><span class="o">.</span><span class="n">groebner_basis</span><span class="p">()</span>
<span class="n">gb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[x - 2/3*y^3 + 4/3*y^2 - 1/3*y + 2/3, y^4 - 4*y^3 + 9/2*y^2 - 2*y - 5/2]
</pre></div>
</div>
</div>
</div>
<p>The triangular structure of lexicographic Groebner basis shows there are 4 solutions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">py</span> <span class="o">=</span> <span class="n">gb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">py</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">py</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>y^4 - 4*y^3 + 9/2*y^2 - 2*y - 5/2 has type &lt;class &#39;sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>To find the real roots of py, we have to cast the polynomial in a real ring.
We cannot do this directly from Singular, but convert to a Sage expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">pz</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">z</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pz</span><span class="p">,</span> <span class="s1">&#39;has type&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">pz</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>z^4 - 4*z^3 + 9/2*z^2 - 2*z - 5/2 has type &lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rpz</span> <span class="o">=</span> <span class="n">RR</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">](</span><span class="n">pz</span><span class="p">)</span>
<span class="n">rpz</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(-0.480812429502198, 1), (2.74767920640803, 1)]
</pre></div>
</div>
</div>
</div>
<p>We now see there are two real solutions.</p>
</section>
<section id="id28">
<h3>question 11<a class="headerlink" href="#id28" title="Link to this heading">#</a></h3>
<p>Consider <span class="math notranslate nohighlight">\(y'' + 6 y' + 13 y = 0\)</span>, with <span class="math notranslate nohighlight">\(y(\pi/2) = -2\)</span> and <span class="math notranslate nohighlight">\(y'(\pi/2) = 8\)</span>.</p>
<ol class="arabic">
<li><p>Find an exact solution to this initial value problem
and use this to create a function <span class="math notranslate nohighlight">\(f\)</span> which returns
a numerical 10-digit floating-point approximation of the solution.</p></li>
<li><p>Solve this initial value problem numerically.</p>
<p>Compare the solution with the value for <span class="math notranslate nohighlight">\(y(2)\)</span> and
also with <span class="math notranslate nohighlight">\(f(2)\)</span> obtained in the first part.</p>
</li>
</ol>
</section>
<section id="id29">
<h3>answer to question 11<a class="headerlink" href="#id29" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ode</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">13</span><span class="o">*</span><span class="n">y</span>
<span class="n">ode</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13*y(x) + 6*diff(y(x), x) + diff(y(x), x, x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="o">=</span><span class="n">ode</span><span class="p">,</span> <span class="n">dvar</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2*cos(2*x)*e^(3/2*pi) - e^(3/2*pi)*sin(2*x))*e^(-3*x)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">funsol</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sol</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">funsol</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.000000000
</pre></div>
</div>
</div>
</div>
<p>The system from <span class="math notranslate nohighlight">\(y&quot; + 6 y' + 13 y\)</span> is</p>
<p><span class="math notranslate nohighlight">\(y' = z\)</span>,</p>
<p><span class="math notranslate nohighlight">\(z' = -6 z - 13 y\)</span>,</p>
<p>in the <code class="docutils literal notranslate"><span class="pre">rhs()</span></code>, <code class="docutils literal notranslate"><span class="pre">w[0]</span> <span class="pre">=</span> <span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">w[1]</span> <span class="pre">=</span> <span class="pre">y'</span> <span class="pre">=</span> <span class="pre">z</span></code>.</p>
<p>So, for a numerical solver, we define the right hand side</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">odeint</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">linspace</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">rhs</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">13</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rhs</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[8, -22]
</pre></div>
</div>
</div>
</div>
<p>Because we are interested in the value at 2,
the end of the span for x ends at 2 and begins at pi/2.
Because we work numerically with scipy,
we have to use the pi from scipy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">pi</span> <span class="k">as</span> <span class="n">scipypi</span>
<span class="n">xspan</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">scipypi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numsol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">rhs</span><span class="p">,[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">xspan</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the numerical solution at 2:&#39;</span><span class="p">,</span> <span class="n">numsol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>the numerical solution at 2: [-0.15189484  1.65169878]
</pre></div>
</div>
</div>
</div>
<p>Now we compare with f(2):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">funsol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.1518948078
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numsolyat2</span> <span class="o">=</span> <span class="n">numsol</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">numsol</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">numsolyat2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.15189483999619088
</pre></div>
</div>
</div>
</div>
<p>Let us compute the difference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">abs</span><span class="p">(</span><span class="n">funsol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">numsolyat2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.216155164e-8
</pre></div>
</div>
</div>
</div>
</section>
<section id="id30">
<h3>question 12<a class="headerlink" href="#id30" title="Link to this heading">#</a></h3>
<p>A 5-by-5 variable Toeplitz matrix has the following form:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>   [t0 t1 t2 t3 t4]
   [t8 t0 t1 t2 t3]
   [t7 t8 t0 t1 t2]
   [t6 t7 t8 t0 t1]
   [t5 t6 t7 t8 t0]
</pre></div>
</div>
<p>for the symbols in the list <code class="docutils literal notranslate"><span class="pre">[t0,</span> <span class="pre">t1,</span> <span class="pre">t2,</span> <span class="pre">t3,</span> <span class="pre">t4,</span> <span class="pre">t5,</span> <span class="pre">t6,</span> <span class="pre">t7,</span> <span class="pre">t8]</span></code>.</p>
<p>For general dimension <span class="math notranslate nohighlight">\(n\)</span>, the <span class="math notranslate nohighlight">\((i,j)\)</span>-th element
of the Toepliz matrix <span class="math notranslate nohighlight">\(T\)</span> is</p>
<p><span class="math notranslate nohighlight">\(T_{(i,j)} = \left\{
    \begin{array}{lcl}
    j - i &amp; {\rm if} &amp; j \geq i \\
    j - i + 2 n - 1 &amp; {\rm if} &amp; j &lt; i.
    \end{array}
    \right.\)</span></p>
<p>Define a variable Toeplitz matrix, for any dimension <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>Test your construction for <span class="math notranslate nohighlight">\(n = 5\)</span>.</p>
</section>
<section id="id31">
<h3>answer to question 12<a class="headerlink" href="#id31" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[t0, t1, t2, t3, t4, t5, t6, t7, t8]
</pre></div>
</div>
</div>
</div>
<p>The indices in a Toeplitz matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">i</span> <span class="k">else</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 1 2 3 4]
[8 0 1 2 3]
[7 8 0 1 2]
[6 7 8 0 1]
[5 6 7 8 0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toeplitz</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">i</span> <span class="k">else</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">toeplitz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[t0 t1 t2 t3 t4]
[t8 t0 t1 t2 t3]
[t7 t8 t0 t1 t2]
[t6 t7 t8 t0 t1]
[t5 t6 t7 t8 t0]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id32">
<h3>question 13<a class="headerlink" href="#id32" title="Link to this heading">#</a></h3>
<p>Maximize <span class="math notranslate nohighlight">\(x_1 + x_2\)</span></p>
<p>subject to</p>
<p><span class="math notranslate nohighlight">\(-x_1 + 2 x_2 \leq 8\)</span>,
<span class="math notranslate nohighlight">\(4 x_1 - 3 x_2 \leq 8\)</span>, <span class="math notranslate nohighlight">\(2 x_1 + x_2 \leq 14\)</span>,
<span class="math notranslate nohighlight">\(x_1 \geq 0\)</span>, and <span class="math notranslate nohighlight">\(x_2 \geq 0\)</span>.</p>
<p>Define this problem and then solve it.</p>
<p>What are the values of <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> at the optimal solution?</p>
</section>
<section id="id33">
<h3>answer to question 13<a class="headerlink" href="#id33" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">MixedIntegerLinearProgram</span><span class="p">(</span><span class="n">maximization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">new_variable</span><span class="p">(</span><span class="n">nonnegative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Maximization:
  x_0 + x_1 

Constraints:
  - x_0 + 2.0 x_1 &lt;= 8.0
  4.0 x_0 - 3.0 x_1 &lt;= 8.0
  2.0 x_0 + x_1 &lt;= 14.0
Variables:
  x_0 is a continuous variable (min=0.0, max=+oo)
  x_1 is a continuous variable (min=0.0, max=+oo)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: 4.0, 2: 6.0}
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sagemath"
        },
        kernelOptions: {
            name: "sagemath",
            path: "./26MCS320symbol_comput"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sagemath'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Review 1</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1">question 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2">question 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-3">question 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-4">question 4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-5">question 5</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-6">question 6</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-7">question 7</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-8">question 8</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-1-answers-separated">Review 1 - Answers separated</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nearby-rational-approximations">1. nearby rational approximations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-function-to-store-data">2. a function to store data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#algebraic-numbers">3. Algebraic Numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorization">4. Vectorization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fully-factored-form-of-rational-polynomials">5. Fully Factored Form of Rational Polynomials</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer">answer:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expression-trees">6. Expression Trees</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulation-of-expressions">7. Manipulation of Expressions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multivariate-polynomials">8. Multivariate Polynomials</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-2">Review 2</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-2-answers-separated">Review 2 - Answers separated</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#list-comprehensions">1. List Comprehensions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memoization">2. Memoization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions-defined-by-integrals">3. Functions defined by Integrals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#taylor-series">4. Taylor Series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#slope-of-the-tangent-line">5. Slope of the Tangent Line</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-in-polar-coordinates">6. Plotting in Polar Coordinates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constrained-optimization">7. Constrained Optimization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-a-linear-system">8. Solving a Linear System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#an-initial-value-problem">9. An Initial Value Problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polyhedral-optimization">10. Polyhedral Optimization</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-3-answers-combined">Review 3 - Answers combined</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#our-first-steps">1. Our First Steps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">question 1.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-1">answer to question 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">question 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-2">answer to question 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">question 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-3">answer to question 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">question 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-4">answer to question 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">question 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-5">answer to question 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">question 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-question-6">answer question 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">question 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-7">answer to question 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">question 8</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-8">answer to question 8</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polynomials-and-rational-expressions">2. Polynomials and Rational Expressions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-9">question 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-9">answer to question 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-10">question 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-10">answer to question 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-11">question 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-11">answer to question 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-12">question 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-12">answer to question 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question-13">question 13</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-13">answer to question 13</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#review-4">Review 4</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3-calculus">Part 3. Calculus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">question 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">answer to question 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">question 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">answer to question 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">question 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">answer to question 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">question 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">answer to question 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">question 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">answer to question 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">question 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-6">answer to question 6</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4-plotting-and-solving-equations">Part 4: plotting and solving equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">question 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">answer to question 7</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">question 8</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">answer to question 8</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">question 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">answer to question 9</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">question 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">answer to question 10</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">question 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">answer to question 11</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">question 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">answer to question 12</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">question 13</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">answer to question 13</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonny, assisted by Tom
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>