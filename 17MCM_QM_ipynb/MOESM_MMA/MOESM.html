
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>many ways to define the factorial function &#8212; Jonny Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=8dedbda2" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '17MCM_QM_ipynb/MOESM_MMA/MOESM';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Jonny Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Mathe &amp; FP/Language</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Alevel_math.html">1. A-level-math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Alevel_math_further.html">2. A-level-further</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../00intro_math.html">3. Math-FP-Lang Combo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01number_algebra.html">4. Number &amp; Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../02discrete_continuous.html">5. Discrete &amp; Continuous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../03real_world.html">6. Real World Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../05math_as_code.html">7. Math as code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CS &amp; Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Course_MIT6001Python.html">8. MIT_CS6001-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Course_MIT6002thinking.html">9. MIT_CS6002-CS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PE25.html">10. Project Euler Q1-25</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PE50.html">11. PE Q26-50</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PE75.html">12. PE Q51-</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Course_MCM.html">13. Math Computational Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Course_MCM_QM.html">14. Quantum Mechanics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../nb_past_courses.html">15. Past courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nb_Geo.html">16. Geography and Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nb_lottery_simulator.html">17. Lottery Math</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/10pe" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/17MCM_QM_ipynb/MOESM_MMA/MOESM.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>many ways to define the factorial function</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">many ways to define the factorial function</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-function-identity">—UNPARSED—. function identity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-function-forwarding">—UNPARSED—. function forwarding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-mathematical-equivalence-i">—UNPARSED—. mathematical equivalence (I)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-mathematical-equivalence-ii">—UNPARSED—. mathematical equivalence (II)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-recursion-i-pattern-matching">—UNPARSED—. recursion (I): pattern matching</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-recursion-ii-if-clause">—UNPARSED—. recursion (II): If clause</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-recursion-iii-anonymous-function">—UNPARSED—. recursion (III): anonymous function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-procedural-programming-i-do-loop">—UNPARSED—. procedural programming (I): Do loop</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-procedural-programming-ii-for-loop">—UNPARSED—. procedural programming (II): For loop</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-list-processing-i-automatic">—UNPARSED—. list processing (I): automatic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-list-processing-ii-manual">—UNPARSED—. list processing (II): manual</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-functional-programming">—UNPARSED—. functional programming</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-permutation-group-size">—UNPARSED—. permutation group size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-repeated-pattern-matching-and-replacement">—UNPARSED—. repeated pattern matching and replacement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-string-processing">—UNPARSED—. string processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-nested-lists-by-repeated-replacement">—UNPARSED—. nested lists by repeated replacement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-analytic-differentiation">—UNPARSED—. analytic differentiation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-density-matrices">reduced density matrices</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tripartite-cases">tripartite cases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-density-matrix-rho-text-abc">starting from a density matrix  <span class="math notranslate nohighlight">\(\rho _{\text{ABC}}\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-pure-state-psi-text-abc">starting from a pure state  <span class="math notranslate nohighlight">\(\psi _{\text{ABC}}\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bipartite-cases">bipartite cases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-density-matrix-rho">starting from a density matrix  <span class="math notranslate nohighlight">\(\rho\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-pure-state-psi">starting from a pure state  <span class="math notranslate nohighlight">\(\psi\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-mechanical-spin-and-angular-momentum-operators">quantum-mechanical spin and angular momentum operators</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-1-2-electron-in-a-dc-magnetic-field">spin-1/2 electron in a dc magnetic field</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#coupled-spin-systems-87-text-rb">coupled spin systems:  <span class="math notranslate nohighlight">\(\, ^{87}\text{Rb}\)</span></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-spin-operators">general spin operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specific-spin-operators">specific spin operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#units">units</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#physical-constants">physical constants</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperfine-hamiltonian">hyperfine Hamiltonian</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#static-magnetic-field">static magnetic field</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagonalize-the-hamiltonian">diagonalize the Hamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-energy-levels">plot the energy levels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-the-energy-eigenstates">analyze the energy eigenstates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#field-free-limit">field-free limit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#low-field-limit">low-field limit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#high-field-limit">high-field limit</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#magic-magnetic-field">“magic” magnetic field</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#oscillating-magnetic-field">oscillating magnetic field</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian">Hamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transition-matrix-elements">transition matrix elements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-time-dependent-schrodinger-equation-numerically">solve time-dependent Schrödinger equation numerically</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotating-wave-approximation">rotating-wave approximation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#transverse-ising-model">transverse Ising model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">quantum-mechanical spin and angular momentum operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators-acting-on-many-spins">operators acting on many spins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Hamiltonian</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#asymptotic-ground-states">asymptotic ground states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian-diagonalization">Hamiltonian diagonalization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-the-ground-state">analysis of the ground state</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-gap">energy gap</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap-with-asymptotic-wavefunctions">overlap with asymptotic wavefunctions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#magnetization">magnetization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlations">correlations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">reduced density matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#entropy-of-entanglement">entropy of entanglement</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-gates-and-quantum-computing">Quantum Gates and Quantum Computing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions-of-quantum-gates">definitions of quantum gates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-qubit-gates">single-qubit gates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-qubit-gates">two-qubit gates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#three-qubit-gates">three-qubit gates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-circuit">a simple circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-fourier-transform">Quantum Fourier Transform</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-phase-estimation">Quantum phase estimation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#particle-in-a-1d-gravity-well">particle in a 1D gravity well</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analytic-calculation">analytic calculation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-setup">system setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basis-set">basis set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-i-momentum-basis">numerical solution (I): momentum basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-ii-mixed-basis">numerical solution (II): mixed basis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wigner-distribution">Wigner distribution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#wigner-quasi-probability-distribution">Wigner quasi-probability distribution</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">definitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting">plotting</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamics-of-a-particle-moving-in-a-1d-potential-split-step-method">dynamics of a particle moving in a 1D potential: split-step method</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">system setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exact-propagation">exact propagation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-step-propagation">split-step propagation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-wavefunction">initial wavefunction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependent-density">time-dependent density</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-step-propagation-with-a-time-dependent-potential">split-step propagation with a time-dependent potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-step-propagation-with-a-time-dependent-potential-and-with-nonlinear-interaction">split-step propagation with a time-dependent potential and with nonlinear interaction</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>This Mathematica code is <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied.</p>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
<section class="tex2jax_ignore mathjax_ignore" id="many-ways-to-define-the-factorial-function">
<h1>many ways to define the factorial function<a class="headerlink" href="#many-ways-to-define-the-factorial-function" title="Link to this heading">#</a></h1>
<p>The following list of definitions of the factorial function is based on the Wolfram demo  <a class="reference external" href="http://www.wolfram.com/training/videos/EDU002/">http://www.wolfram.com/training/videos/EDU002/</a> . Try to understand as many of these definitions as possible. What this means in practice is that for most problems you can pick the programming paradigm that suits your way of thinking best, instead of being forced into one way or another. The different paradigms have different advantages and disadvantages, which may become clearer to you as you become more familiar with them.</p>
<section id="unparsed-function-identity">
<h2>—UNPARSED—. function identity<a class="headerlink" href="#unparsed-function-identity" title="Link to this heading">#</a></h2>
<p>Define the function  <span class="math notranslate nohighlight">\(f\)</span></p>
<p>to be an alias of the built-in function  <span class="math notranslate nohighlight">\(\text{Factorial}\)</span></p>
<p>:  <span class="math notranslate nohighlight">\(f[5]\)</span></p>
<p>is now strictly the same thing as calling  <span class="math notranslate nohighlight">\(\text{Factorial}[5]\)</span></p>
<p>, which in turn is the same thing as calling  <span class="math notranslate nohighlight">\(5!\)</span></p>
<p>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span> <span class="o">=</span> <span class="n">Factorial</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-function-forwarding">
<h2>—UNPARSED—. function forwarding<a class="headerlink" href="#unparsed-function-forwarding" title="Link to this heading">#</a></h2>
<p>A call to  <span class="math notranslate nohighlight">\(f\)</span></p>
<p>is forwarded to the function “ <code class="docutils literal notranslate"><span class="pre">!</span></code> ”: calling  <span class="math notranslate nohighlight">\(f[5]\)</span></p>
<p>triggers the evaluation of  <span class="math notranslate nohighlight">\(5!\)</span></p>
<p>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">n</span><span class="err">!</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-mathematical-equivalence-i">
<h2>—UNPARSED—. mathematical equivalence (I)<a class="headerlink" href="#unparsed-mathematical-equivalence-i" title="Link to this heading">#</a></h2>
<p>Use the mathematical definition  <span class="math notranslate nohighlight">\(n\text{!=}\Gamma (n+1)\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Gamma</span><span class="p">[</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-mathematical-equivalence-ii">
<h2>—UNPARSED—. mathematical equivalence (II)<a class="headerlink" href="#unparsed-mathematical-equivalence-ii" title="Link to this heading">#</a></h2>
<p>Use the mathematical definition  <span class="math notranslate nohighlight">\(n\text{!=}\prod _{i=1}^n\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Product</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-recursion-i-pattern-matching">
<h2>—UNPARSED—. recursion (I): pattern matching<a class="headerlink" href="#unparsed-recursion-i-pattern-matching" title="Link to this heading">#</a></h2>
<p>Rule-based recursion, using Mathematica’s built-in pattern-matching capabilities: calling  <span class="math notranslate nohighlight">\(f[5]\)</span></p>
<p>leads to a call of  <span class="math notranslate nohighlight">\(f[4]\)</span></p>
<p>, which leads to a call of  <span class="math notranslate nohighlight">\(f[3]\)</span></p>
<p>, and so on until  <span class="math notranslate nohighlight">\(f[1]\)</span></p>
<p>immediately returns the result  <span class="math notranslate nohighlight">\(1\)</span></p>
<p>, after which the program unrolls the recursion stack and does the necessary multiplications:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">n</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-recursion-ii-if-clause">
<h2>—UNPARSED—. recursion (II): If clause<a class="headerlink" href="#unparsed-recursion-ii-if-clause" title="Link to this heading">#</a></h2>
<p>The same recursion but without rules (no pattern-matching):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">If</span><span class="p">[</span><span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="n">f</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-recursion-iii-anonymous-function">
<h2>—UNPARSED—. recursion (III): anonymous function<a class="headerlink" href="#unparsed-recursion-iii-anonymous-function" title="Link to this heading">#</a></h2>
<p>Define the same recursion through functional programming:  <span class="math notranslate nohighlight">\(f\)</span></p>
<p>is a function whose name is  <span class="math notranslate nohighlight">\(\#0\)</span></p>
<p>and whose first (and only) argument is  <span class="math notranslate nohighlight">\(\#1\)</span></p>
<p>. The end of the function definition is marked with  <span class="math notranslate nohighlight">\(\&amp;\)</span></p>
<p>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span> <span class="o">=</span> <span class="n">If</span><span class="p">[</span><span class="c1">#1 == 1, 1, #1*#0[#1 - 1]] &amp; ; </span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-procedural-programming-i-do-loop">
<h2>—UNPARSED—. procedural programming (I): Do loop<a class="headerlink" href="#unparsed-procedural-programming-i-do-loop" title="Link to this heading">#</a></h2>
<p>procedural programming with a  <span class="math notranslate nohighlight">\(\text{Do}\)</span></p>
<p>loop:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Module</span><span class="p">[{</span><span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">},</span> <span class="n">Do</span><span class="p">[</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">}];</span> <span class="n">t</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-procedural-programming-ii-for-loop">
<h2>—UNPARSED—. procedural programming (II): For loop<a class="headerlink" href="#unparsed-procedural-programming-ii-for-loop" title="Link to this heading">#</a></h2>
<p>procedural programming with a  <span class="math notranslate nohighlight">\(\text{For}\)</span></p>
<p>loop: this is how you would compute factorials in procedural programming languages like C. It is a very precise step-by-step prescription of how exactly the computer is supposed to do the calculation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Module</span><span class="p">[{</span><span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">},</span> <span class="n">For</span><span class="p">[</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="o">++</span><span class="p">,</span> <span class="n">t</span> <span class="o">*=</span> <span class="n">i</span><span class="p">];</span> <span class="n">t</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-list-processing-i-automatic">
<h2>—UNPARSED—. list processing (I): automatic<a class="headerlink" href="#unparsed-list-processing-i-automatic" title="Link to this heading">#</a></h2>
<p>Make a list of the numbers  <span class="math notranslate nohighlight">\(1\ldots n\)</span></p>
<p>(with  <span class="math notranslate nohighlight">\(\text{Range}[n]\)</span></p>
<p>) and then multiply them together at once, by applying the function  <span class="math notranslate nohighlight">\(\text{Times}\)</span></p>
<p>to this list. This is the most elegant way of multiplying all these numbers together, because both the generation of the list of integers and their multiplication are done with internally optimized methods. The programmer merely specifies  <em>what</em>  he would like the computer to do, and not  <em>how</em>  it is to be done.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Times</span> <span class="o">@@</span> <span class="n">Range</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-list-processing-ii-manual">
<h2>—UNPARSED—. list processing (II): manual<a class="headerlink" href="#unparsed-list-processing-ii-manual" title="Link to this heading">#</a></h2>
<p>Make a list of the numbers  <span class="math notranslate nohighlight">\(1\ldots n\)</span></p>
<p>and then multiply them together one after the other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Fold</span><span class="p">[</span><span class="n">Times</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Range</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-functional-programming">
<h2>—UNPARSED—. functional programming<a class="headerlink" href="#unparsed-functional-programming" title="Link to this heading">#</a></h2>
<p>Functional programming: make a list of functions  <span class="math notranslate nohighlight">\(\{t\to t,t\to 2t,t\to 3t,\ldots ,t\to n t\}\)</span></p>
<p>, and then, starting with the number  <span class="math notranslate nohighlight">\(1\)</span></p>
<p>, apply each of these functions once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Fold</span><span class="p">[</span><span class="c1">#2[#1] &amp; , 1, Array[Function[t, #1*t] &amp; , n]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-permutation-group-size">
<h2>—UNPARSED—. permutation group size<a class="headerlink" href="#unparsed-permutation-group-size" title="Link to this heading">#</a></h2>
<p>Construct a list whose length we know to be  <span class="math notranslate nohighlight">\(n!\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Length</span><span class="p">[</span><span class="n">Permutations</span><span class="p">[</span><span class="n">Range</span><span class="p">[</span><span class="n">n</span><span class="p">]]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-repeated-pattern-matching-and-replacement">
<h2>—UNPARSED—. repeated pattern matching and replacement<a class="headerlink" href="#unparsed-repeated-pattern-matching-and-replacement" title="Link to this heading">#</a></h2>
<p>Use repeated pattern-based replacement ( <span class="math notranslate nohighlight">\(\text{//.}\)</span></p>
<p>) to find the factorial: start with the object  <span class="math notranslate nohighlight">\(\{1,n\}\)</span></p>
<p>and apply the given rule until the result no longer changes because the pattern no longer matches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">First</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">}</span> <span class="o">//.</span> <span class="p">{</span><span class="n">a_</span><span class="p">,</span> <span class="n">b_</span> <span class="o">/</span><span class="p">;</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">}</span> <span class="p">:</span><span class="o">&gt;</span> <span class="p">{</span><span class="n">b</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-string-processing">
<h2>—UNPARSED—. string processing<a class="headerlink" href="#unparsed-string-processing" title="Link to this heading">#</a></h2>
<p>Build a string whose length is  <span class="math notranslate nohighlight">\(n!\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">StringLength</span><span class="p">[</span><span class="n">Fold</span><span class="p">[</span><span class="n">StringJoin</span><span class="p">[</span><span class="n">Table</span><span class="p">[</span><span class="c1">#1, {#2}]] &amp; , &quot;A&quot;, Range[n]]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-nested-lists-by-repeated-replacement">
<h2>—UNPARSED—. nested lists by repeated replacement<a class="headerlink" href="#unparsed-nested-lists-by-repeated-replacement" title="Link to this heading">#</a></h2>
<p>Starting from the number  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>, repeatedly replace each number  <span class="math notranslate nohighlight">\(m\)</span></p>
<p>by a list containing  <span class="math notranslate nohighlight">\(m\)</span></p>
<p>times the number  <span class="math notranslate nohighlight">\(m-1\)</span></p>
<p>. At the end, we have a list of lists of … of lists that overall contains  <span class="math notranslate nohighlight">\(n!\)</span></p>
<p>times the number 1. Flatten it out and count the number of elements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Length</span><span class="p">[</span><span class="n">Flatten</span><span class="p">[</span><span class="n">n</span> <span class="o">//.</span> <span class="n">m_</span> <span class="o">/</span><span class="p">;</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">:</span><span class="o">&gt;</span> <span class="n">Table</span><span class="p">[</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="n">m</span><span class="p">}]]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unparsed-analytic-differentiation">
<h2>—UNPARSED—. analytic differentiation<a class="headerlink" href="#unparsed-analytic-differentiation" title="Link to this heading">#</a></h2>
<p>Use the relationship  <span class="math notranslate nohighlight">\(\frac{d^n}{dx^n}\left(x^n\right)=n!\)</span></p>
<p>: compute the  <span class="math notranslate nohighlight">\(n^{\text{th}}\)</span></p>
<p>derivative of  <span class="math notranslate nohighlight">\(x^n\)</span></p>
<p>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Clear</span><span class="p">[</span><span class="n">f</span><span class="p">];</span> 
<span class="n">f</span><span class="p">[</span><span class="n">n_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">D</span><span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="n">n</span><span class="p">,</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<p>This Mathematica code is part of the lecture script  <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied. It is licensed under a  <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> .</p>
<img src="data:image/jpg;base64,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" class="img-responsive"/>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="reduced-density-matrices">
<h1>reduced density matrices<a class="headerlink" href="#reduced-density-matrices" title="Link to this heading">#</a></h1>
<p>We operate in a Hilbert space that is the direct product (tensor product) of three Hilbert subspaces associated with three subsystems A, B, C, which have dimensions  <span class="math notranslate nohighlight">\(d_A\)</span></p>
<p>,  <span class="math notranslate nohighlight">\(d_B\)</span></p>
<p>,  <span class="math notranslate nohighlight">\(d_C\)</span></p>
<p>, respectively. The goal is to calculate the reduced density matrix of the system after tracing out (forgetting, cutting out) subsystem B.</p>
<section id="tripartite-cases">
<h2>tripartite cases<a class="headerlink" href="#tripartite-cases" title="Link to this heading">#</a></h2>
<section id="starting-from-a-density-matrix-rho-text-abc">
<h3>starting from a density matrix  <span class="math notranslate nohighlight">\(\rho _{\text{ABC}}\)</span><a class="headerlink" href="#starting-from-a-density-matrix-rho-text-abc" title="Link to this heading">#</a></h3>
<p>Given a density matrix  <span class="math notranslate nohighlight">\(\rho _{\text{ABC}}\)</span></p>
<p>of size  <span class="math notranslate nohighlight">\(d_Ad_Bd_C\times d_Ad_Bd_C\)</span></p>
<p>, calculate the reduced density matrix  <span class="math notranslate nohighlight">\(\rho _{\text{AC}}\)</span></p>
<p>of size  <span class="math notranslate nohighlight">\(d_Ad_C\times d_Ad_C\)</span></p>
<p>after tracing out subsystem B:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rdm</span><span class="p">[(</span><span class="n">ρABC_</span><span class="p">)</span><span class="err">?</span><span class="n">MatrixQ</span><span class="p">,</span> <span class="p">{</span><span class="n">dA_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dA</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dB_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dB</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dC_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dC</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Dimensions</span><span class="p">[</span><span class="n">ρABC</span><span class="p">]</span> <span class="o">==</span> <span class="p">{</span><span class="n">dA</span><span class="o">*</span><span class="n">dB</span><span class="o">*</span><span class="n">dC</span><span class="p">,</span> <span class="n">dA</span><span class="o">*</span><span class="n">dB</span><span class="o">*</span><span class="n">dC</span><span class="p">}</span> <span class="o">:=</span> <span class="n">Flatten</span><span class="p">[</span><span class="n">TensorContract</span><span class="p">[</span><span class="n">ArrayReshape</span><span class="p">[</span><span class="n">ρABC</span><span class="p">,</span> <span class="p">{</span><span class="n">dA</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">dC</span><span class="p">,</span> <span class="n">dA</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">dC</span><span class="p">}],</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">}],</span> <span class="p">{{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="starting-from-a-pure-state-psi-text-abc">
<h3>starting from a pure state  <span class="math notranslate nohighlight">\(\psi _{\text{ABC}}\)</span><a class="headerlink" href="#starting-from-a-pure-state-psi-text-abc" title="Link to this heading">#</a></h3>
<p>Given a pure state  <span class="math notranslate nohighlight">\(\psi _{\text{ABC}}\)</span></p>
<p>of length  <span class="math notranslate nohighlight">\(d_Ad_Bd_C\)</span></p>
<p>, calculate the reduced density matrix  <span class="math notranslate nohighlight">\(\rho _{\text{AC}}\)</span></p>
<p>of size  <span class="math notranslate nohighlight">\(d_Ad_C\times d_Ad_C\)</span></p>
<p>after tracing out subsystem B:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rdm</span><span class="p">[(</span><span class="n">ψABC_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="p">{</span><span class="n">dA_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dA</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dB_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dB</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dC_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dC</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Length</span><span class="p">[</span><span class="n">ψABC</span><span class="p">]</span> <span class="o">==</span> <span class="n">dA</span><span class="o">*</span><span class="n">dB</span><span class="o">*</span><span class="n">dC</span> <span class="o">:=</span> <span class="n">With</span><span class="p">[{</span><span class="n">P</span> <span class="o">=</span> <span class="n">ArrayReshape</span><span class="p">[</span><span class="n">ψABC</span><span class="p">,</span> <span class="p">{</span><span class="n">dA</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">dC</span><span class="p">}]},</span> <span class="n">Flatten</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">}]</span> <span class="o">.</span> <span class="n">ConjugateTranspose</span><span class="p">[</span><span class="n">P</span><span class="p">],</span> <span class="p">{{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}}]]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="bipartite-cases">
<h2>bipartite cases<a class="headerlink" href="#bipartite-cases" title="Link to this heading">#</a></h2>
<p><span class="math notranslate nohighlight">\(d&gt;0\)</span></p>
<p>: trace out the first  <span class="math notranslate nohighlight">\(d\)</span></p>
<p>dimensions</p>
<p><span class="math notranslate nohighlight">\(d&lt;0\)</span></p>
<p>: trace out the last  <span class="math notranslate nohighlight">\(d\)</span></p>
<p>dimensions</p>
<section id="starting-from-a-density-matrix-rho">
<h3>starting from a density matrix  <span class="math notranslate nohighlight">\(\rho\)</span><a class="headerlink" href="#starting-from-a-density-matrix-rho" title="Link to this heading">#</a></h3>
<p>Given a density matrix  <span class="math notranslate nohighlight">\(\rho\)</span></p>
<p>of size  <span class="math notranslate nohighlight">\(d d'\times d d'\)</span></p>
<p>, calculate the reduced density matrix  <span class="math notranslate nohighlight">\(\tilde{\rho }\)</span></p>
<p>of size  <span class="math notranslate nohighlight">\(d'\times d'\)</span></p>
<p>after tracing out the subsystem of dimension  <span class="math notranslate nohighlight">\(d\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">traceout</span><span class="p">[(</span><span class="n">ρ_</span><span class="p">)</span><span class="err">?</span><span class="n">MatrixQ</span><span class="p">,</span> <span class="n">d_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Length</span><span class="p">[</span><span class="n">ρ</span><span class="p">]</span> <span class="o">==</span> <span class="n">Length</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">ρ</span><span class="p">]]</span> <span class="o">&amp;&amp;</span> <span class="n">Divisible</span><span class="p">[</span><span class="n">Length</span><span class="p">[</span><span class="n">ρ</span><span class="p">],</span> <span class="n">d</span><span class="p">]</span> <span class="o">:=</span> <span class="n">rdm</span><span class="p">[</span><span class="n">ρ</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">Length</span><span class="p">[</span><span class="n">ρ</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<p>Given a density matrix  <span class="math notranslate nohighlight">\(\rho\)</span></p>
<p>of size  <span class="math notranslate nohighlight">\(d'| d| \times d'| d|\)</span></p>
<p>, calculate the reduced density matrix  <span class="math notranslate nohighlight">\(\tilde{\rho }\)</span></p>
<p>of size  <span class="math notranslate nohighlight">\(d'\times d'\)</span></p>
<p>after tracing out the subsystem of dimension  <span class="math notranslate nohighlight">\(| d|\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">traceout</span><span class="p">[(</span><span class="n">ρ_</span><span class="p">)</span><span class="err">?</span><span class="n">MatrixQ</span><span class="p">,</span> <span class="n">d_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Length</span><span class="p">[</span><span class="n">ρ</span><span class="p">]</span> <span class="o">==</span> <span class="n">Length</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">ρ</span><span class="p">]]</span> <span class="o">&amp;&amp;</span> <span class="n">Divisible</span><span class="p">[</span><span class="n">Length</span><span class="p">[</span><span class="n">ρ</span><span class="p">],</span> <span class="o">-</span><span class="n">d</span><span class="p">]</span> <span class="o">:=</span> <span class="n">rdm</span><span class="p">[</span><span class="n">ρ</span><span class="p">,</span> <span class="p">{</span><span class="n">Length</span><span class="p">[</span><span class="n">ρ</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">),</span> <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="starting-from-a-pure-state-psi">
<h3>starting from a pure state  <span class="math notranslate nohighlight">\(\psi\)</span><a class="headerlink" href="#starting-from-a-pure-state-psi" title="Link to this heading">#</a></h3>
<p>Given a pure state  <span class="math notranslate nohighlight">\(\psi\)</span></p>
<p>of length  <span class="math notranslate nohighlight">\(d d'\)</span></p>
<p>, calculate the reduced density matrix  <span class="math notranslate nohighlight">\(\tilde{\rho }\)</span></p>
<p>of size  <span class="math notranslate nohighlight">\(d'\times d'\)</span></p>
<p>after tracing out the subsystem of dimension  <span class="math notranslate nohighlight">\(d\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">traceout</span><span class="p">[(</span><span class="n">ψ_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="n">d_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Divisible</span><span class="p">[</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">],</span> <span class="n">d</span><span class="p">]</span> <span class="o">:=</span> <span class="n">rdm</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<p>Given a pure state  <span class="math notranslate nohighlight">\(\psi\)</span></p>
<p>of length  <span class="math notranslate nohighlight">\(d'd\)</span></p>
<p>, calculate the reduced density matrix  <span class="math notranslate nohighlight">\(\tilde{\rho }\)</span></p>
<p>of size  <span class="math notranslate nohighlight">\(d'\times d'\)</span></p>
<p>after tracing out the subsystem of dimension  <span class="math notranslate nohighlight">\(d\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">traceout</span><span class="p">[(</span><span class="n">ψ_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="n">d_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Divisible</span><span class="p">[</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">],</span> <span class="o">-</span><span class="n">d</span><span class="p">]</span> <span class="o">:=</span> <span class="n">rdm</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="p">{</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">),</span> <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<p>This Mathematica code is part of the lecture script  <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied. It is licensed under a  <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> .</p>
<img src="data:image/jpg;base64,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" class="img-responsive"/>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="quantum-mechanical-spin-and-angular-momentum-operators">
<h1>quantum-mechanical spin and angular momentum operators<a class="headerlink" href="#quantum-mechanical-spin-and-angular-momentum-operators" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SpinQ</span><span class="p">[</span><span class="n">S_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">IntegerQ</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">S</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="n">splus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[{{</span><span class="mi">0</span><span class="p">}}];</span> 
<span class="n">splus</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">[</span><span class="n">Sqrt</span><span class="p">[</span><span class="n">S</span><span class="o">*</span><span class="p">(</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">{</span><span class="n">M</span><span class="p">,</span> <span class="n">S</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">}],</span> <span class="p">{</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}]</span>
<span class="n">sminus</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Transpose</span><span class="p">[</span><span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]]</span>
<span class="n">sx</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">sx</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">+</span> <span class="n">sminus</span><span class="p">[</span><span class="n">S</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">sy</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">sy</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">-</span> <span class="n">sminus</span><span class="p">[</span><span class="n">S</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="n">sz</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">sz</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Range</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">{</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}]</span>
<span class="nb">id</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="nb">id</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="n">IdentityMatrix</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SparseArray</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>This Mathematica code is part of the lecture script  <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied. It is licensed under a  <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> .</p>
<img src="data:image/jpg;base64,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" class="img-responsive"/>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="spin-1-2-electron-in-a-dc-magnetic-field">
<h1>spin-1/2 electron in a dc magnetic field<a class="headerlink" href="#spin-1-2-electron-in-a-dc-magnetic-field" title="Link to this heading">#</a></h1>
<p>Pauli operators:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">Sx</span><span class="p">,</span> <span class="n">Sy</span><span class="p">,</span> <span class="n">Sz</span><span class="p">}</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Table</span><span class="p">[</span><span class="n">PauliMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">}];</span> 
</pre></div>
</div>
</div>
</div>
<p>units:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MagneticFieldUnit</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;Gausses&quot;</span><span class="p">];</span> 
<span class="n">EnergyUnit</span> <span class="o">=</span> <span class="n">UnitConvert</span><span class="p">[</span><span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;PlanckConstant&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;MHz&quot;</span><span class="p">]];</span> 
</pre></div>
</div>
</div>
</div>
<p>express the Bohr magneton in these units:  <span class="math notranslate nohighlight">\(\left.\mu _B\right/h\approx 1.4\text{MHz}/G\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">μB</span> <span class="o">=</span> <span class="n">UnitConvert</span><span class="p">[</span><span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;BohrMagneton&quot;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">EnergyUnit</span><span class="o">/</span><span class="n">MagneticFieldUnit</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>electron  <span class="math notranslate nohighlight">\(g\)</span></p>
<p>factor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ge</span> <span class="o">=</span> <span class="n">UnitConvert</span><span class="p">[</span><span class="s2">&quot;ElectronGFactor&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Hamiltonian:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">H</span><span class="p">[</span><span class="n">Bx_</span><span class="p">,</span> <span class="n">By_</span><span class="p">,</span> <span class="n">Bz_</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">μB</span><span class="p">)</span><span class="o">*</span><span class="n">ge</span><span class="o">*</span><span class="p">(</span><span class="n">Sx</span><span class="o">*</span><span class="n">Bx</span> <span class="o">+</span> <span class="n">Sy</span><span class="o">*</span><span class="n">By</span> <span class="o">+</span> <span class="n">Sz</span><span class="o">*</span><span class="n">Bz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>eigenvalues and non-normalized eigenvectors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Eigensystem</span><span class="p">[</span><span class="n">H</span><span class="p">[</span><span class="n">Bx</span><span class="p">,</span> <span class="n">By</span><span class="p">,</span> <span class="n">Bz</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>This Mathematica code is part of the lecture script  <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied. It is licensed under a  <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> .</p>
<img src="data:image/jpg;base64,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" class="img-responsive"/>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="coupled-spin-systems-87-text-rb">
<h1>coupled spin systems:  <span class="math notranslate nohighlight">\(\, ^{87}\text{Rb}\)</span><a class="headerlink" href="#coupled-spin-systems-87-text-rb" title="Link to this heading">#</a></h1>
<p>hyperfine structure</p>
<section id="general-spin-operators">
<h2>general spin operators<a class="headerlink" href="#general-spin-operators" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SpinQ</span><span class="p">[</span><span class="n">S_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">IntegerQ</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">S</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="n">splus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[{{</span><span class="mi">0</span><span class="p">}}];</span> 
<span class="n">splus</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">[</span><span class="n">Sqrt</span><span class="p">[</span><span class="n">S</span><span class="o">*</span><span class="p">(</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">{</span><span class="n">M</span><span class="p">,</span> <span class="n">S</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">}],</span> <span class="p">{</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}]</span>
<span class="n">sminus</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Transpose</span><span class="p">[</span><span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]]</span>
<span class="n">sx</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">sx</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">+</span> <span class="n">sminus</span><span class="p">[</span><span class="n">S</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">sy</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">sy</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">-</span> <span class="n">sminus</span><span class="p">[</span><span class="n">S</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="n">sz</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">sz</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Range</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">{</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}]</span>
<span class="nb">id</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="nb">id</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="n">IdentityMatrix</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SparseArray</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specific-spin-operators">
<h2>specific spin operators<a class="headerlink" href="#specific-spin-operators" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Ix</span> <span class="o">=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">sx</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
<span class="n">Iy</span> <span class="o">=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">sy</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
<span class="n">Iz</span> <span class="o">=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">sz</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
<span class="n">Sx</span> <span class="o">=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="nb">id</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">sx</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
<span class="n">Sy</span> <span class="o">=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="nb">id</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">sy</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
<span class="n">Sz</span> <span class="o">=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="nb">id</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">sz</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
<span class="n">Lx</span> <span class="o">=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="nb">id</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">sx</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
<span class="n">Ly</span> <span class="o">=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="nb">id</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">sy</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
<span class="n">Lz</span> <span class="o">=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="nb">id</span><span class="p">[</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nb">id</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Jx</span> <span class="o">=</span> <span class="n">Sx</span> <span class="o">+</span> <span class="n">Lx</span><span class="p">;</span> <span class="n">Jy</span> <span class="o">=</span> <span class="n">Sy</span> <span class="o">+</span> <span class="n">Ly</span><span class="p">;</span> <span class="n">Jz</span> <span class="o">=</span> <span class="n">Sz</span> <span class="o">+</span> <span class="n">Lz</span><span class="p">;</span> 
<span class="n">Fx</span> <span class="o">=</span> <span class="n">Ix</span> <span class="o">+</span> <span class="n">Jx</span><span class="p">;</span> <span class="n">Fy</span> <span class="o">=</span> <span class="n">Iy</span> <span class="o">+</span> <span class="n">Jy</span><span class="p">;</span> <span class="n">Fz</span> <span class="o">=</span> <span class="n">Iz</span> <span class="o">+</span> <span class="n">Jz</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="units">
<h2>units<a class="headerlink" href="#units" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MagneticFieldUnit</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;Gausses&quot;</span><span class="p">];</span> 
<span class="n">EnergyUnit</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;PlanckConstant&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;Megahertz&quot;</span><span class="p">];</span> 
<span class="n">TimeUnit</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;Microseconds&quot;</span><span class="p">];</span> 
</pre></div>
</div>
</div>
</div>
<section id="physical-constants">
<h3>physical constants<a class="headerlink" href="#physical-constants" title="Link to this heading">#</a></h3>
<p>calculate numerical values for physical constants:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">μBn</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;BohrMagneton&quot;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">EnergyUnit</span><span class="o">/</span><span class="n">MagneticFieldUnit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ℏn</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;ReducedPlanckConstant&quot;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">EnergyUnit</span><span class="o">*</span><span class="n">TimeUnit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="hyperfine-hamiltonian">
<h2>hyperfine Hamiltonian<a class="headerlink" href="#hyperfine-hamiltonian" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Hhf</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">Ix</span> <span class="o">.</span> <span class="n">Jx</span> <span class="o">+</span> <span class="n">Iy</span> <span class="o">.</span> <span class="n">Jy</span> <span class="o">+</span> <span class="n">Iz</span> <span class="o">.</span> <span class="n">Jz</span><span class="p">)</span> <span class="o">-</span> <span class="n">μB</span><span class="o">*</span><span class="n">Bz</span><span class="o">*</span><span class="p">(</span><span class="n">gI</span><span class="o">*</span><span class="n">Iz</span> <span class="o">+</span> <span class="n">gS</span><span class="o">*</span><span class="n">Sz</span> <span class="o">+</span> <span class="n">gL</span><span class="o">*</span><span class="n">Lz</span><span class="p">);</span> 
<span class="n">hfc</span> <span class="o">=</span> <span class="p">{</span><span class="n">A</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">Quantity</span><span class="p">[</span><span class="s2">&quot;PlanckConstant&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">Quantity</span><span class="p">[</span><span class="mf">3.417341305452145</span><span class="p">,</span> <span class="s2">&quot;GHz&quot;</span><span class="p">])</span><span class="o">/</span><span class="n">EnergyUnit</span><span class="p">,</span> <span class="n">gS</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="mf">2.0023193043622</span><span class="p">,</span> <span class="n">gL</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="mf">0.99999369</span><span class="p">,</span> <span class="n">gI</span> <span class="o">-&gt;</span> <span class="n">Plus</span><span class="p">[</span><span class="mf">0.0009951414</span><span class="p">],</span> <span class="n">μB</span> <span class="o">-&gt;</span> <span class="n">μBn</span><span class="p">,</span> <span class="n">ℏ</span> <span class="o">-&gt;</span> <span class="n">ℏn</span><span class="p">};</span> 
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="static-magnetic-field">
<h2>static magnetic field<a class="headerlink" href="#static-magnetic-field" title="Link to this heading">#</a></h2>
<section id="diagonalize-the-hamiltonian">
<h3>diagonalize the Hamiltonian<a class="headerlink" href="#diagonalize-the-hamiltonian" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">eval</span><span class="p">,</span> <span class="n">evec</span><span class="p">}</span> <span class="o">=</span> <span class="n">FullSimplify</span><span class="p">[</span><span class="n">Eigensystem</span><span class="p">[</span><span class="n">Hhf</span><span class="p">]];</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-energy-levels">
<h3>plot the energy levels<a class="headerlink" href="#plot-the-energy-levels" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Plot</span><span class="p">[</span><span class="n">Evaluate</span><span class="p">[</span><span class="nb">eval</span> <span class="o">/.</span> <span class="n">hfc</span><span class="p">],</span> <span class="p">{</span><span class="n">Bz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">},</span> <span class="n">Frame</span> <span class="o">-&gt;</span> <span class="kc">True</span><span class="p">,</span> <span class="n">FrameLabel</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="s2">&quot;Bz / G&quot;</span><span class="p">,</span> <span class="s2">&quot;E / MHz&quot;</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analyze-the-energy-eigenstates">
<h3>analyze the energy eigenstates<a class="headerlink" href="#analyze-the-energy-eigenstates" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nevec</span> <span class="o">=</span> <span class="p">(</span><span class="c1">#1/Sqrt[#1 . #1] &amp; ) /@ evec; </span>
</pre></div>
</div>
</div>
</div>
<section id="field-free-limit">
<h4>field-free limit<a class="headerlink" href="#field-free-limit" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Assuming</span><span class="p">[</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FullSimplify</span><span class="p">[</span><span class="n">Limit</span><span class="p">[</span><span class="nb">eval</span><span class="p">,</span> <span class="n">Bz</span> <span class="o">-&gt;</span> <span class="mi">0</span><span class="p">]]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nevec0</span> <span class="o">=</span> <span class="n">Assuming</span><span class="p">[</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FullSimplify</span><span class="p">[</span><span class="n">Limit</span><span class="p">[</span><span class="n">nevec</span><span class="p">,</span> <span class="n">Bz</span> <span class="o">-&gt;</span> <span class="mi">0</span><span class="p">]]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixForm</span><span class="p">[</span><span class="n">nevec0</span> <span class="o">.</span> <span class="p">(</span><span class="n">Fx</span> <span class="o">.</span> <span class="n">Fx</span> <span class="o">+</span> <span class="n">Fy</span> <span class="o">.</span> <span class="n">Fy</span> <span class="o">+</span> <span class="n">Fz</span> <span class="o">.</span> <span class="n">Fz</span><span class="p">)</span> <span class="o">.</span> <span class="n">Transpose</span><span class="p">[</span><span class="n">nevec0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixForm</span><span class="p">[</span><span class="n">nevec0</span> <span class="o">.</span> <span class="n">Fz</span> <span class="o">.</span> <span class="n">Transpose</span><span class="p">[</span><span class="n">nevec0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="low-field-limit">
<h4>low-field limit<a class="headerlink" href="#low-field-limit" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Assuming</span><span class="p">[</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FullSimplify</span><span class="p">[</span><span class="n">Series</span><span class="p">[</span><span class="nb">eval</span><span class="p">,</span> <span class="p">{</span><span class="n">Bz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="high-field-limit">
<h4>high-field limit<a class="headerlink" href="#high-field-limit" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Assuming</span><span class="p">[</span><span class="n">μB</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">gS</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">gI</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FullSimplify</span><span class="p">[</span><span class="n">Series</span><span class="p">[</span><span class="nb">eval</span><span class="p">,</span> <span class="p">{</span><span class="n">Bz</span><span class="p">,</span> <span class="n">Infinity</span><span class="p">,</span> <span class="mi">0</span><span class="p">}]]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nevecinf</span> <span class="o">=</span> <span class="n">Assuming</span><span class="p">[</span><span class="n">μB</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">gS</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">gI</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FullSimplify</span><span class="p">[</span><span class="n">Limit</span><span class="p">[</span><span class="n">nevec</span><span class="p">,</span> <span class="n">Bz</span> <span class="o">-&gt;</span> <span class="n">Infinity</span><span class="p">],</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixForm</span><span class="p">[</span><span class="n">nevecinf</span> <span class="o">.</span> <span class="n">Iz</span> <span class="o">.</span> <span class="n">Transpose</span><span class="p">[</span><span class="n">nevecinf</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixForm</span><span class="p">[</span><span class="n">nevecinf</span> <span class="o">.</span> <span class="n">Jz</span> <span class="o">.</span> <span class="n">Transpose</span><span class="p">[</span><span class="n">nevecinf</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="magic-magnetic-field">
<h3>“magic” magnetic field<a class="headerlink" href="#magic-magnetic-field" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Plot</span><span class="p">[</span><span class="nb">eval</span><span class="p">[[</span><span class="mi">6</span><span class="p">]]</span> <span class="o">-</span> <span class="nb">eval</span><span class="p">[[</span><span class="mi">7</span><span class="p">]]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">A</span> <span class="o">/.</span> <span class="n">hfc</span><span class="p">,</span> <span class="p">{</span><span class="n">Bz</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">NMinimize</span><span class="p">[</span><span class="nb">eval</span><span class="p">[[</span><span class="mi">6</span><span class="p">]]</span> <span class="o">-</span> <span class="nb">eval</span><span class="p">[[</span><span class="mi">7</span><span class="p">]]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">A</span> <span class="o">/.</span> <span class="n">hfc</span><span class="p">,</span> <span class="n">Bz</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>good approximation to the magic field:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="n">μB</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mi">16</span><span class="o">*</span><span class="n">gI</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">gS</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span> <span class="o">/.</span> <span class="n">hfc</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="oscillating-magnetic-field">
<h2>oscillating magnetic field<a class="headerlink" href="#oscillating-magnetic-field" title="Link to this heading">#</a></h2>
<section id="hamiltonian">
<h3>Hamiltonian<a class="headerlink" href="#hamiltonian" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">H0</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">Ix</span> <span class="o">.</span> <span class="n">Jx</span> <span class="o">+</span> <span class="n">Iy</span> <span class="o">.</span> <span class="n">Jy</span> <span class="o">+</span> <span class="n">Iz</span> <span class="o">.</span> <span class="n">Jz</span><span class="p">)</span> <span class="o">-</span> <span class="n">μB</span><span class="o">*</span><span class="n">Bz</span><span class="o">*</span><span class="p">(</span><span class="n">gS</span><span class="o">*</span><span class="n">Sz</span> <span class="o">+</span> <span class="n">gL</span><span class="o">*</span><span class="n">Lz</span> <span class="o">+</span> <span class="n">gI</span><span class="o">*</span><span class="n">Iz</span><span class="p">);</span> 
<span class="n">H1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">μB</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">gS</span><span class="o">*</span><span class="p">(</span><span class="n">Bacx</span><span class="o">*</span><span class="n">Sx</span> <span class="o">+</span> <span class="n">Bacy</span><span class="o">*</span><span class="n">Sy</span> <span class="o">+</span> <span class="n">Bacz</span><span class="o">*</span><span class="n">Sz</span><span class="p">)</span> <span class="o">+</span> <span class="n">gI</span><span class="o">*</span><span class="p">(</span><span class="n">Bacx</span><span class="o">*</span><span class="n">Ix</span> <span class="o">+</span> <span class="n">Bacy</span><span class="o">*</span><span class="n">Iy</span> <span class="o">+</span> <span class="n">Bacz</span><span class="o">*</span><span class="n">Iz</span><span class="p">)</span> <span class="o">+</span> <span class="n">gL</span><span class="o">*</span><span class="p">(</span><span class="n">Bacx</span><span class="o">*</span><span class="n">Lx</span> <span class="o">+</span> <span class="n">Bacy</span><span class="o">*</span><span class="n">Ly</span> <span class="o">+</span> <span class="n">Bacz</span><span class="o">*</span><span class="n">Lz</span><span class="p">));</span> 
<span class="n">H</span><span class="p">[</span><span class="n">t_</span><span class="p">]</span> <span class="o">=</span> <span class="n">H0</span> <span class="o">+</span> <span class="n">H1</span><span class="o">*</span><span class="n">Cos</span><span class="p">[</span><span class="n">ω</span><span class="o">*</span><span class="n">t</span><span class="p">];</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="transition-matrix-elements">
<h3>transition matrix elements<a class="headerlink" href="#transition-matrix-elements" title="Link to this heading">#</a></h3>
<p>diagonalize the time-independent Hamiltonian  <span class="math notranslate nohighlight">\(H_0\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">eval</span><span class="p">,</span> <span class="n">evec</span><span class="p">}</span> <span class="o">=</span> <span class="n">FullSimplify</span><span class="p">[</span><span class="n">Eigensystem</span><span class="p">[</span><span class="n">H0</span><span class="p">]];</span> 
<span class="n">nevec</span> <span class="o">=</span> <span class="p">(</span><span class="c1">#1/Sqrt[#1 . #1] &amp; ) /@ evec; </span>
</pre></div>
</div>
</div>
</div>
<p>compute the transition matrix elements induced by  <span class="math notranslate nohighlight">\(H_1\)</span></p>
<p>between the eigenstates of  <span class="math notranslate nohighlight">\(H_0\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">Assuming</span><span class="p">[</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FullSimplify</span><span class="p">[</span><span class="n">nevec</span> <span class="o">.</span> <span class="n">H1</span> <span class="o">.</span> <span class="n">Transpose</span><span class="p">[</span><span class="n">nevec</span><span class="p">]]];</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="solve-time-dependent-schrodinger-equation-numerically">
<h3>solve time-dependent Schrödinger equation numerically<a class="headerlink" href="#solve-time-dependent-schrodinger-equation-numerically" title="Link to this heading">#</a></h3>
<p>differential equations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">deqs</span> <span class="o">=</span> <span class="n">Table</span><span class="p">[</span><span class="n">I</span><span class="o">*</span><span class="n">ℏ</span><span class="o">*</span><span class="n">Derivative</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="n">i</span><span class="p">]][</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="n">Sum</span><span class="p">[</span><span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="n">j</span><span class="p">][</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">Exp</span><span class="p">[(</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">eval</span><span class="p">[[</span><span class="n">j</span><span class="p">]]</span> <span class="o">-</span> <span class="nb">eval</span><span class="p">[[</span><span class="n">i</span><span class="p">]])</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">ℏ</span><span class="p">)]</span><span class="o">*</span><span class="n">Cos</span><span class="p">[</span><span class="n">ω</span><span class="o">*</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]],</span> <span class="p">{</span><span class="n">j</span><span class="p">,</span> <span class="mi">8</span><span class="p">}],</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">}];</span> 
</pre></div>
</div>
</div>
</div>
<p>numerical solution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">NDSolve</span><span class="p">[</span><span class="n">Join</span><span class="p">[</span><span class="n">deqs</span> <span class="o">/.</span> <span class="n">hfc</span> <span class="o">/.</span> <span class="p">{</span><span class="n">Bz</span> <span class="o">-&gt;</span> <span class="mf">3.22896</span><span class="p">,</span> <span class="n">Bacx</span> <span class="o">-&gt;</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">Bacy</span> <span class="o">-&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Bacz</span> <span class="o">-&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ω</span> <span class="o">-&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">Pi</span><span class="o">*</span><span class="mf">6827.9</span><span class="p">},</span> <span class="p">{</span><span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">6</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">8</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">}],</span> <span class="n">Table</span><span class="p">[</span><span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="n">i</span><span class="p">][</span><span class="n">t</span><span class="p">],</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="mi">8</span><span class="p">}],</span> <span class="p">{</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">},</span> <span class="n">MaxStepSize</span> <span class="o">-&gt;</span> <span class="mi">10</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">),</span> <span class="n">MaxSteps</span> <span class="o">-&gt;</span> <span class="mi">10</span><span class="o">^</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Plot</span><span class="p">[</span><span class="n">Evaluate</span><span class="p">[</span><span class="n">Abs</span><span class="p">[</span><span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">2</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">/.</span> <span class="n">S</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="p">{</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Plot</span><span class="p">[</span><span class="n">Evaluate</span><span class="p">[</span><span class="n">Abs</span><span class="p">[</span><span class="n">Subscript</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="mi">7</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">/.</span> <span class="n">S</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="p">{</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="rotating-wave-approximation">
<h3>rotating-wave approximation<a class="headerlink" href="#rotating-wave-approximation" title="Link to this heading">#</a></h3>
<p>detuning:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Δ</span> <span class="o">=</span> <span class="n">ω</span> <span class="o">-</span> <span class="p">(</span><span class="n">Ei</span> <span class="o">-</span> <span class="n">Ej</span><span class="p">)</span><span class="o">/</span><span class="n">ℏ</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>generalized Rabi frequency:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Ω</span> <span class="o">=</span> <span class="n">Sqrt</span><span class="p">[(</span><span class="n">Tij</span><span class="o">*</span><span class="n">Tji</span><span class="p">)</span><span class="o">/</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Δ</span><span class="o">^</span><span class="mi">2</span><span class="p">];</span> 
</pre></div>
</div>
</div>
</div>
<p>solutions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ψi</span><span class="p">[</span><span class="n">t_</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ψi0</span><span class="o">*</span><span class="n">Cos</span><span class="p">[</span><span class="n">Ω</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="p">((</span><span class="n">Δ</span><span class="o">/</span><span class="n">Ω</span><span class="p">)</span><span class="o">*</span><span class="n">ψi0</span> <span class="o">-</span> <span class="p">(</span><span class="n">Tij</span><span class="o">/</span><span class="p">(</span><span class="n">ℏ</span><span class="o">*</span><span class="n">Ω</span><span class="p">))</span><span class="o">*</span><span class="n">ψj0</span><span class="p">)</span><span class="o">*</span><span class="n">Sin</span><span class="p">[</span><span class="n">Ω</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span><span class="p">)])</span><span class="o">/</span><span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">Δ</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span> 
<span class="n">ψj</span><span class="p">[</span><span class="n">t_</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">Δ</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">ψj0</span><span class="o">*</span><span class="n">Cos</span><span class="p">[</span><span class="n">Ω</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="o">-</span> <span class="n">I</span><span class="o">*</span><span class="p">((</span><span class="n">Δ</span><span class="o">/</span><span class="n">Ω</span><span class="p">)</span><span class="o">*</span><span class="n">ψj0</span> <span class="o">+</span> <span class="p">(</span><span class="n">Tji</span><span class="o">/</span><span class="p">(</span><span class="n">ℏ</span><span class="o">*</span><span class="n">Ω</span><span class="p">))</span><span class="o">*</span><span class="n">ψi0</span><span class="p">)</span><span class="o">*</span><span class="n">Sin</span><span class="p">[</span><span class="n">Ω</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span><span class="p">)]);</span> 
</pre></div>
</div>
</div>
</div>
<p>check that these satisfy the time-dependent Schrödinger equation in the rotating-wave approximation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">FullSimplify</span><span class="p">[</span><span class="n">I</span><span class="o">*</span><span class="n">ℏ</span><span class="o">*</span><span class="n">Derivative</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ψi</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ψj</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">Tij</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">Δ</span><span class="o">*</span><span class="n">t</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">FullSimplify</span><span class="p">[</span><span class="n">I</span><span class="o">*</span><span class="n">ℏ</span><span class="o">*</span><span class="n">Derivative</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ψj</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ψi</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">Δ</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">Tji</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>check the boundary conditions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ψi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ψj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>This Mathematica code is part of the lecture script  <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied. It is licensed under a  <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> .</p>
<img src="data:image/jpg;base64,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" class="img-responsive"/>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="transverse-ising-model">
<h1>transverse Ising model<a class="headerlink" href="#transverse-ising-model" title="Link to this heading">#</a></h1>
<section id="id1">
<h2>quantum-mechanical spin and angular momentum operators<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SpinQ</span><span class="p">[</span><span class="n">S_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">IntegerQ</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">S</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="n">splus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[{{</span><span class="mi">0</span><span class="p">}}];</span> 
<span class="n">splus</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">[</span><span class="n">Sqrt</span><span class="p">[</span><span class="n">S</span><span class="o">*</span><span class="p">(</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">{</span><span class="n">M</span><span class="p">,</span> <span class="n">S</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">}],</span> <span class="p">{</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}]</span>
<span class="n">sminus</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Transpose</span><span class="p">[</span><span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]]</span>
<span class="n">sx</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">sx</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">+</span> <span class="n">sminus</span><span class="p">[</span><span class="n">S</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">sy</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">sy</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">splus</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">-</span> <span class="n">sminus</span><span class="p">[</span><span class="n">S</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="n">sz</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">sz</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Range</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">{</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}]</span>
<span class="nb">id</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="nb">id</span><span class="p">[</span><span class="n">S</span><span class="p">]</span> <span class="o">=</span> <span class="n">IdentityMatrix</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SparseArray</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="operators-acting-on-many-spins">
<h2>operators acting on many spins<a class="headerlink" href="#operators-acting-on-many-spins" title="Link to this heading">#</a></h2>
<p>an operator  <span class="math notranslate nohighlight">\(a\)</span></p>
<p>acting on spin  <span class="math notranslate nohighlight">\(k\)</span></p>
<p>out of a set of  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>spins- <span class="math notranslate nohighlight">\(S\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">op</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">,</span> <span class="p">(</span><span class="n">a_</span><span class="p">)</span><span class="err">?</span><span class="n">MatrixQ</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">Dimensions</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="p">{</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}</span> <span class="o">:=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">IdentityMatrix</span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">SparseArray</span><span class="p">],</span> <span class="n">a</span><span class="p">,</span> <span class="n">IdentityMatrix</span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">),</span> <span class="n">SparseArray</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>spin operators acting on spin  <span class="math notranslate nohighlight">\(k\)</span></p>
<p>out of a set of  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>spins- <span class="math notranslate nohighlight">\(S\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sx</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">sx</span><span class="p">[</span><span class="n">S</span><span class="p">]]</span>
<span class="n">sy</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">sy</span><span class="p">[</span><span class="n">S</span><span class="p">]]</span>
<span class="n">sz</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">sz</span><span class="p">[</span><span class="n">S</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>Hamiltonian<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>transverse Ising model on a ring of  <span class="math notranslate nohighlight">\(N\)</span></p>
<p>spins:</p>
<div class="math notranslate nohighlight">
\[\hat{H}=-\frac{b}{2}\sum _{k=1}^N \hat{S}_x^{(k)}-\sum _{k=1}^{N-1} \hat{S}_z^{(k)}\hat{S}_z^{(k+1)}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">H</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">n_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">b_</span><span class="p">]</span> <span class="o">:=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">Sum</span><span class="p">[</span><span class="n">sx</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">],</span> <span class="p">{</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">}]</span> <span class="o">-</span> <span class="n">Sum</span><span class="p">[</span><span class="n">sz</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">.</span> <span class="n">sz</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">Mod</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="p">{</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="asymptotic-ground-states">
<h2>asymptotic ground states<a class="headerlink" href="#asymptotic-ground-states" title="Link to this heading">#</a></h2>
<p>product state  <span class="math notranslate nohighlight">\(|\theta \rangle ^{\otimes N}\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">productstate</span><span class="p">[(</span><span class="n">θ_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">θ</span><span class="p">;</span> 
<span class="n">productstate</span><span class="p">[(</span><span class="n">θ_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="n">n_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Flatten</span><span class="p">[</span><span class="n">KroneckerProduct</span> <span class="o">@@</span> <span class="n">Table</span><span class="p">[</span><span class="n">θ</span><span class="p">,</span> <span class="n">n</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>parallel-spin states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xup</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Table</span><span class="p">[</span><span class="n">Sqrt</span><span class="p">[</span><span class="n">Binomial</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="n">S</span><span class="p">]],</span> <span class="p">{</span><span class="n">M</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">}]</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">S</span>
<span class="n">xdn</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Table</span><span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="n">S</span><span class="p">)</span><span class="o">*</span><span class="n">Sqrt</span><span class="p">[</span><span class="n">Binomial</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="n">S</span><span class="p">]],</span> <span class="p">{</span><span class="n">M</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">}]</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">S</span>
<span class="n">zup</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">zdn</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>product states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">allxup</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">n_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">:=</span> <span class="n">productstate</span><span class="p">[</span><span class="n">xup</span><span class="p">[</span><span class="n">S</span><span class="p">],</span> <span class="n">n</span><span class="p">]</span>
<span class="n">allxdn</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">n_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">:=</span> <span class="n">productstate</span><span class="p">[</span><span class="n">xdn</span><span class="p">[</span><span class="n">S</span><span class="p">],</span> <span class="n">n</span><span class="p">]</span>
<span class="n">allzup</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">n_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">:=</span> <span class="n">productstate</span><span class="p">[</span><span class="n">zup</span><span class="p">[</span><span class="n">S</span><span class="p">],</span> <span class="n">n</span><span class="p">]</span>
<span class="n">allzdn</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">n_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">:=</span> <span class="n">productstate</span><span class="p">[</span><span class="n">zdn</span><span class="p">[</span><span class="n">S</span><span class="p">],</span> <span class="n">n</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="hamiltonian-diagonalization">
<h2>Hamiltonian diagonalization<a class="headerlink" href="#hamiltonian-diagonalization" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">S</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">14</span><span class="p">},</span> <span class="n">h</span><span class="p">[</span><span class="n">b_</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">b</span><span class="p">];</span> <span class="n">gs0up</span> <span class="o">=</span> <span class="n">allzup</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">];</span> <span class="n">gs0dn</span> <span class="o">=</span> <span class="n">allzdn</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">];</span> <span class="n">gsplusinf</span> <span class="o">=</span> <span class="n">allxup</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">];</span> <span class="n">gsminusinf</span> <span class="o">=</span> <span class="n">allxdn</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">];</span> <span class="n">Clear</span><span class="p">[</span><span class="n">gs</span><span class="p">];</span> <span class="n">gs</span><span class="p">[(</span><span class="n">b_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="n">m_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">:=</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">Transpose</span><span class="p">[</span><span class="n">Sort</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="o">-</span><span class="n">Eigensystem</span><span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">[</span><span class="n">N</span><span class="p">[</span><span class="n">b</span><span class="p">]],</span> <span class="n">m</span><span class="p">,</span> <span class="n">Method</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="s2">&quot;Arnoldi&quot;</span><span class="p">,</span> <span class="s2">&quot;Criteria&quot;</span> <span class="o">-&gt;</span> <span class="s2">&quot;RealPart&quot;</span><span class="p">,</span> <span class="n">MaxIterations</span> <span class="o">-&gt;</span> <span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">}]]]];</span> <span class="n">Clear</span><span class="p">[</span><span class="n">mx</span><span class="p">,</span> <span class="n">my</span><span class="p">,</span> <span class="n">mz</span><span class="p">];</span> <span class="n">mx</span><span class="p">[(</span><span class="n">b_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="n">m_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">:=</span> <span class="n">mx</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">With</span><span class="p">[{</span><span class="n">g</span> <span class="o">=</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]},</span> <span class="n">Re</span><span class="p">[</span><span class="n">Conjugate</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">.</span> <span class="p">(</span><span class="n">sx</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">Mod</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">.</span> <span class="n">g</span><span class="p">)]];</span> <span class="n">my</span><span class="p">[(</span><span class="n">b_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="n">m_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">:=</span> <span class="n">my</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">With</span><span class="p">[{</span><span class="n">g</span> <span class="o">=</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]},</span> <span class="n">Re</span><span class="p">[</span><span class="n">Conjugate</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">.</span> <span class="p">(</span><span class="n">sy</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">Mod</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">.</span> <span class="n">g</span><span class="p">)]];</span> <span class="n">mz</span><span class="p">[(</span><span class="n">b_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="n">m_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">:=</span> <span class="n">mz</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">With</span><span class="p">[{</span><span class="n">g</span> <span class="o">=</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]},</span> <span class="n">Re</span><span class="p">[</span><span class="n">Conjugate</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">.</span> <span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">Mod</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">.</span> <span class="n">g</span><span class="p">)]];</span> <span class="n">Clear</span><span class="p">[</span><span class="n">Cop</span><span class="p">];</span> <span class="n">Cop</span><span class="p">[</span><span class="n">k1_Integer</span><span class="p">,</span> <span class="n">k2_Integer</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Cop</span><span class="p">[</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">]</span> <span class="o">=</span> <span class="n">With</span><span class="p">[{</span><span class="n">q1</span> <span class="o">=</span> <span class="n">Mod</span><span class="p">[</span><span class="n">k1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">Mod</span><span class="p">[</span><span class="n">k2</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span> <span class="n">sx</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q1</span><span class="p">]</span> <span class="o">.</span> <span class="n">sx</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q2</span><span class="p">]</span> <span class="o">+</span> <span class="n">sy</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q1</span><span class="p">]</span> <span class="o">.</span> <span class="n">sy</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q2</span><span class="p">]</span> <span class="o">+</span> <span class="n">sz</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q1</span><span class="p">]</span> <span class="o">.</span> <span class="n">sz</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">q2</span><span class="p">]];</span> <span class="n">Clear</span><span class="p">[</span><span class="n">c</span><span class="p">];</span> <span class="n">c</span><span class="p">[(</span><span class="n">b_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="n">m_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">m</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="n">k1_Integer</span><span class="p">,</span> <span class="n">k2_Integer</span><span class="p">}]</span> <span class="o">:=</span> <span class="n">c</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="p">{</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">}]</span> <span class="o">=</span> <span class="n">With</span><span class="p">[{</span><span class="n">g</span> <span class="o">=</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]},</span> <span class="n">Re</span><span class="p">[</span><span class="n">Conjugate</span><span class="p">[</span><span class="n">g</span><span class="p">]</span> <span class="o">.</span> <span class="p">(</span><span class="n">Cop</span><span class="p">[</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">]</span> <span class="o">.</span> <span class="n">g</span><span class="p">)]</span> <span class="o">-</span> <span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k1</span><span class="p">]</span><span class="o">*</span><span class="n">mx</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k2</span><span class="p">]</span> <span class="o">+</span> <span class="n">my</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k1</span><span class="p">]</span><span class="o">*</span><span class="n">my</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k2</span><span class="p">]</span> <span class="o">+</span> <span class="n">mz</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k1</span><span class="p">]</span><span class="o">*</span><span class="n">mz</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k2</span><span class="p">])];</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analysis-of-the-ground-state">
<h2>analysis of the ground state<a class="headerlink" href="#analysis-of-the-ground-state" title="Link to this heading">#</a></h2>
<section id="energy-gap">
<h3>energy gap<a class="headerlink" href="#energy-gap" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">bmax</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="p">},</span> <span class="n">ListLinePlot</span><span class="p">[</span><span class="n">Table</span><span class="p">[{</span><span class="n">b</span><span class="p">,</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span> <span class="o">-</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">bmax</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">db</span><span class="p">}]]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="overlap-with-asymptotic-wavefunctions">
<h3>overlap with asymptotic wavefunctions<a class="headerlink" href="#overlap-with-asymptotic-wavefunctions" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">bmax</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="p">},</span> <span class="n">ListLinePlot</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">Table</span><span class="p">[{{</span><span class="n">b</span><span class="p">,</span> <span class="n">Abs</span><span class="p">[</span><span class="n">gsminusinf</span> <span class="o">.</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="n">Abs</span><span class="p">[</span><span class="n">gsplusinf</span> <span class="o">.</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="n">Abs</span><span class="p">[((</span><span class="n">gs0up</span> <span class="o">-</span> <span class="n">gs0dn</span><span class="p">)</span><span class="o">/</span><span class="n">Sqrt</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">.</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="n">Abs</span><span class="p">[((</span><span class="n">gs0up</span> <span class="o">+</span> <span class="n">gs0dn</span><span class="p">)</span><span class="o">/</span><span class="n">Sqrt</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">.</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="n">Abs</span><span class="p">[((</span><span class="n">gs0up</span> <span class="o">-</span> <span class="n">gs0dn</span><span class="p">)</span><span class="o">/</span><span class="n">Sqrt</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">.</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Abs</span><span class="p">[((</span><span class="n">gs0up</span> <span class="o">+</span> <span class="n">gs0dn</span><span class="p">)</span><span class="o">/</span><span class="n">Sqrt</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">.</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span><span class="p">}},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">bmax</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">db</span><span class="p">}]]]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="magnetization">
<h3>magnetization<a class="headerlink" href="#magnetization" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">bmax</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="p">},</span> <span class="n">ListLinePlot</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">Table</span><span class="p">[{{</span><span class="n">b</span><span class="p">,</span> <span class="n">mx</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="n">mz</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">bmax</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">db</span><span class="p">}]]]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="correlations">
<h3>correlations<a class="headerlink" href="#correlations" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">bmax</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="p">},</span> <span class="n">ListLinePlot</span><span class="p">[</span><span class="n">Table</span><span class="p">[{</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">δ</span><span class="p">}]},</span> <span class="p">{</span><span class="n">δ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">bmax</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">db</span><span class="p">}],</span> <span class="n">PlotLegends</span> <span class="o">-&gt;</span> <span class="n">Range</span><span class="p">[</span><span class="mi">7</span><span class="p">]]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>reduced density matrices<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>functions for calculating reduced density matrices: (see ReducedDensityMatrix.nb)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rdm</span><span class="p">[(</span><span class="n">ψABC_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="p">{</span><span class="n">dA_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dA</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dB_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dB</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dC_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dC</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Length</span><span class="p">[</span><span class="n">ψABC</span><span class="p">]</span> <span class="o">==</span> <span class="n">dA</span><span class="o">*</span><span class="n">dB</span><span class="o">*</span><span class="n">dC</span> <span class="o">:=</span> <span class="n">With</span><span class="p">[{</span><span class="n">P</span> <span class="o">=</span> <span class="n">ArrayReshape</span><span class="p">[</span><span class="n">ψABC</span><span class="p">,</span> <span class="p">{</span><span class="n">dA</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">dC</span><span class="p">}]},</span> <span class="n">Flatten</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">}]</span> <span class="o">.</span> <span class="n">ConjugateTranspose</span><span class="p">[</span><span class="n">P</span><span class="p">],</span> <span class="p">{{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}}]]</span>
<span class="n">traceout</span><span class="p">[(</span><span class="n">ψ_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="n">d_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Divisible</span><span class="p">[</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">],</span> <span class="n">d</span><span class="p">]</span> <span class="o">:=</span> <span class="n">rdm</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">}]</span>
<span class="n">traceout</span><span class="p">[(</span><span class="n">ψ_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="n">d_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Divisible</span><span class="p">[</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">],</span> <span class="o">-</span><span class="n">d</span><span class="p">]</span> <span class="o">:=</span> <span class="n">rdm</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="p">{</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">),</span> <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="entropy-of-entanglement">
<h3>entropy of entanglement<a class="headerlink" href="#entropy-of-entanglement" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="p">[</span><span class="mi">0</span> <span class="o">|</span> <span class="mf">0.</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="n">s</span><span class="p">[</span><span class="n">x_</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">Log</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">];</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">EE</span><span class="p">[(</span><span class="n">S_</span><span class="p">)</span><span class="err">?</span><span class="n">SpinQ</span><span class="p">,</span> <span class="n">ψ_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Total</span><span class="p">[</span><span class="n">s</span> <span class="o">/@</span> <span class="n">Re</span><span class="p">[</span><span class="n">Eigenvalues</span><span class="p">[</span><span class="n">traceout</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))]]]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">bmax</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="p">},</span> <span class="n">ListLinePlot</span><span class="p">[</span><span class="n">Table</span><span class="p">[{</span><span class="n">b</span><span class="p">,</span> <span class="n">EE</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">gs</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">][[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]},</span> <span class="p">{</span><span class="n">b</span><span class="p">,</span> <span class="o">-</span><span class="n">bmax</span><span class="p">,</span> <span class="n">bmax</span><span class="p">,</span> <span class="n">db</span><span class="p">}],</span> <span class="n">PlotRange</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]]</span>
</pre></div>
</div>
</div>
</div>
<p>This Mathematica code is part of the lecture script  <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied. It is licensed under a  <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> .</p>
<img src="data:image/jpg;base64,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" class="img-responsive"/>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="quantum-gates-and-quantum-computing">
<h1>Quantum Gates and Quantum Computing<a class="headerlink" href="#quantum-gates-and-quantum-computing" title="Link to this heading">#</a></h1>
<section id="definitions-of-quantum-gates">
<h2>definitions of quantum gates<a class="headerlink" href="#definitions-of-quantum-gates" title="Link to this heading">#</a></h2>
<p>single-qubit pseudospin operators:  <span class="math notranslate nohighlight">\(\mathbf{1}\)</span></p>
<p>,  <span class="math notranslate nohighlight">\(\hat{\sigma }_x\)</span></p>
<p>,  <span class="math notranslate nohighlight">\(\hat{\sigma }_y\)</span></p>
<p>,  <span class="math notranslate nohighlight">\(\hat{\sigma }_z\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nb">id</span><span class="p">,</span> <span class="n">σx</span><span class="p">,</span> <span class="n">σy</span><span class="p">,</span> <span class="n">σz</span><span class="p">}</span> <span class="o">=</span> <span class="n">Table</span><span class="p">[</span><span class="n">SparseArray</span><span class="p">[</span><span class="n">PauliMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">}];</span> 
</pre></div>
</div>
</div>
</div>
<p>projectors onto 0 and 1 states, respectively:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">P0</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[(</span><span class="nb">id</span> <span class="o">+</span> <span class="n">σz</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">];</span> 
<span class="n">P1</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[(</span><span class="nb">id</span> <span class="o">-</span> <span class="n">σz</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">];</span> 
</pre></div>
</div>
</div>
</div>
<p>operator  <span class="math notranslate nohighlight">\(\hat{a}\)</span></p>
<p>acting on the  <span class="math notranslate nohighlight">\(k^{\text{th}}\)</span></p>
<p>qubit of a set of  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>qubits:  <span class="math notranslate nohighlight">\(\mathbf{1}\otimes \mathbf{1}\otimes \cdots \otimes \mathbf{1}\otimes \hat{a}\otimes 1\otimes \cdots \otimes \mathbf{1}\otimes \mathbf{1}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">op</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">,</span> <span class="n">a_</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">Dimensions</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">}</span> <span class="o">:=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">IdentityMatrix</span><span class="p">[</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">SparseArray</span><span class="p">],</span> <span class="n">a</span><span class="p">,</span> <span class="n">IdentityMatrix</span><span class="p">[</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">),</span> <span class="n">SparseArray</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>controlled operator: in a set of  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>qubits, only if all of the qubits in the list  <span class="math notranslate nohighlight">\(\lambda\)</span></p>
<p>are in state 1 then the operator  <span class="math notranslate nohighlight">\(\hat{A}\)</span></p>
<p>is applied to the system; otherwise no operation is applied</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CTRL</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">λ_</span> <span class="o">/</span><span class="p">;</span> <span class="n">VectorQ</span><span class="p">[</span><span class="n">λ</span><span class="p">,</span> <span class="n">IntegerQ</span><span class="p">],</span> <span class="n">A_</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Unequal</span> <span class="o">@@</span> <span class="n">λ</span> <span class="o">&amp;&amp;</span> <span class="n">Min</span><span class="p">[</span><span class="n">λ</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">Max</span><span class="p">[</span><span class="n">λ</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">Dimensions</span><span class="p">[</span><span class="n">A</span><span class="p">]</span> <span class="o">==</span> <span class="p">{</span><span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="p">}</span> <span class="o">:=</span> <span class="n">IdentityMatrix</span><span class="p">[</span><span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="p">,</span> <span class="n">SparseArray</span><span class="p">]</span> <span class="o">+</span> <span class="n">Dot</span> <span class="o">@@</span> <span class="p">(</span><span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="c1">#1, P1] &amp; ) /@ λ . (A - IdentityMatrix[2^n, SparseArray])</span>
</pre></div>
</div>
</div>
</div>
<section id="single-qubit-gates">
<h3>single-qubit gates<a class="headerlink" href="#single-qubit-gates" title="Link to this heading">#</a></h3>
<p>Pauli gates acting on the  <span class="math notranslate nohighlight">\(k^{\text{th}}\)</span></p>
<p>qubit of a set of  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>qubits:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">σx</span><span class="p">]</span>
<span class="n">Y</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">σy</span><span class="p">]</span>
<span class="n">Z</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">σz</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Pauli rotations:  <span class="math notranslate nohighlight">\(\hat{R}_x(\phi )\propto e^{-i \phi  \left.\hat{\sigma }_x\right/2}\)</span></p>
<p>etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">RX</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">,</span> <span class="n">ϕ_</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">ϕ</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">id</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">ϕ</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">σx</span><span class="p">]</span>
<span class="n">RY</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">,</span> <span class="n">ϕ_</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">ϕ</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">id</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">ϕ</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">σy</span><span class="p">]</span>
<span class="n">RZ</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">,</span> <span class="n">ϕ_</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">ϕ</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">id</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">ϕ</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">σz</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Hadamard gate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">H</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">σx</span> <span class="o">+</span> <span class="n">σz</span><span class="p">)</span><span class="o">/</span><span class="n">Sqrt</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="two-qubit-gates">
<h3>two-qubit gates<a class="headerlink" href="#two-qubit-gates" title="Link to this heading">#</a></h3>
<p>SWAP gate: exchanges the state of qubits  <span class="math notranslate nohighlight">\(j\)</span></p>
<p>and  <span class="math notranslate nohighlight">\(k\)</span></p>
<p>in a set of  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>qubits</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SWAP</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="p">{</span><span class="n">j_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">}]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">k</span> <span class="o">:=</span> <span class="p">(</span><span class="n">IdentityMatrix</span><span class="p">[</span><span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="p">,</span> <span class="n">SparseArray</span><span class="p">]</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">.</span> <span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">Y</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">.</span> <span class="n">Y</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">Z</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">.</span> <span class="n">Z</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>square root of the SWAP gate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SQRTSWAP</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="p">{</span><span class="n">j_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">}]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">k</span> <span class="o">:=</span> <span class="p">((</span><span class="mi">3</span> <span class="o">+</span> <span class="n">I</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">IdentityMatrix</span><span class="p">[</span><span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="p">,</span> <span class="n">SparseArray</span><span class="p">]</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">I</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">.</span> <span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">Y</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">.</span> <span class="n">Y</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">Z</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">.</span> <span class="n">Z</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>CNOT gate: in a set of  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>qubits, if qubit  <span class="math notranslate nohighlight">\(j\)</span></p>
<p>is in state 0 then there is no effect on qubit  <span class="math notranslate nohighlight">\(k\)</span></p>
<p>, whereas if qubit  <span class="math notranslate nohighlight">\(j\)</span></p>
<p>is in state 1 then the NOT operator  <span class="math notranslate nohighlight">\(\hat{\sigma }_x\)</span></p>
<p>acts on qubit  <span class="math notranslate nohighlight">\(k\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CNOT</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">j_Integer</span> <span class="o">-&gt;</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">k</span> <span class="o">:=</span> <span class="n">CTRL</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">{</span><span class="n">j</span><span class="p">},</span> <span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">σx</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="three-qubit-gates">
<h3>three-qubit gates<a class="headerlink" href="#three-qubit-gates" title="Link to this heading">#</a></h3>
<p>CCNOT (Toffoli) gate: in a set of  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>qubits, if both qubits  <span class="math notranslate nohighlight">\(i\)</span></p>
<p>and  <span class="math notranslate nohighlight">\(j\)</span></p>
<p>are in state 1, then the NOT operator  <span class="math notranslate nohighlight">\(\hat{\sigma }_x\)</span></p>
<p>acts on qubit  <span class="math notranslate nohighlight">\(k\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CCNOT</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="p">{</span><span class="n">i_Integer</span><span class="p">,</span> <span class="n">j_Integer</span><span class="p">}</span> <span class="o">-&gt;</span> <span class="n">k_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">k</span> <span class="o">:=</span> <span class="n">CTRL</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">},</span> <span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">σx</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>controlled SWAP (Fredkin) gate: in a set of  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>qubits, if qubit  <span class="math notranslate nohighlight">\(i\)</span></p>
<p>is in state 0 then there is no effect on qubits  <span class="math notranslate nohighlight">\(j\)</span></p>
<p>and  <span class="math notranslate nohighlight">\(k\)</span></p>
<p>, whereas if qubit  <span class="math notranslate nohighlight">\(i\)</span></p>
<p>is in state 1 then the state of qubits  <span class="math notranslate nohighlight">\(j\)</span></p>
<p>and  <span class="math notranslate nohighlight">\(k\)</span></p>
<p>is exchanged</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CSWAP</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">i_Integer</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="n">j_Integer</span><span class="p">,</span> <span class="n">k_Integer</span><span class="p">}]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">k</span> <span class="o">:=</span> <span class="n">CTRL</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">{</span><span class="n">i</span><span class="p">},</span> <span class="n">SWAP</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">{</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">}]]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="a-simple-circuit">
<h2>a simple circuit<a class="headerlink" href="#a-simple-circuit" title="Link to this heading">#</a></h2>
<p>the operator for the circuit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">.</span> <span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span> 
<span class="n">Normal</span><span class="p">[</span><span class="n">S</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>the basis set:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="n">n_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Tuples</span><span class="p">[{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="n">n</span><span class="p">]</span>
<span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>operate on the  <span class="math notranslate nohighlight">\(|00\rangle\)</span></p>
<p>input state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ψin</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span> 
<span class="n">ψout</span> <span class="o">=</span> <span class="n">S</span> <span class="o">.</span> <span class="n">ψin</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="quantum-fourier-transform">
<h2>Quantum Fourier Transform<a class="headerlink" href="#quantum-fourier-transform" title="Link to this heading">#</a></h2>
<p>The Quantum Fourier Transform (QFT) is assembled following Fig. 5.1 of M. Nielsen and I. Chuang,  <em>Quantum Computation and Quantum Information</em> , Cambridge University Press, 2010 (tenth anniversary edition).</p>
<p>The quantum circuit for a QFT is assembled from blocks that connect the  <span class="math notranslate nohighlight">\(i^{\text{th}}\)</span></p>
<p>qubit to the qubits  <span class="math notranslate nohighlight">\(\{i+1,i+2,\ldots ,n\}\)</span></p>
<p>via controlled phase gates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">QFTblock</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">i_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">Dot</span> <span class="o">@@</span> <span class="n">Table</span><span class="p">[</span><span class="n">CTRL</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">{</span><span class="n">j</span><span class="p">},</span> <span class="n">RZ</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">Pi</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">))]],</span> <span class="p">{</span><span class="n">j</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">}]</span> <span class="o">.</span> <span class="n">H</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>assemble the quantum Fourier transformation by connecting all qubits:</p>
<ol class="arabic simple">
<li><p>connect all qubits through the above QFTblock operation</p></li>
<li><p>swap the order of the qubits</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">QFT</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">Dot</span> <span class="o">@@</span> <span class="n">Table</span><span class="p">[</span><span class="n">SWAP</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">}],</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">}]</span> <span class="o">.</span> <span class="n">Dot</span> <span class="o">@@</span> <span class="n">Table</span><span class="p">[</span><span class="n">QFTblock</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<p>QFT consists of a polynomial number of gates:</p>
<p>·  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>Hadamard gates</p>
<p>·  <span class="math notranslate nohighlight">\(\frac{n(n-1)}{2}\)</span></p>
<p>controlled rotations</p>
<p>·  <span class="math notranslate nohighlight">\(\left\lfloor \frac{n}{2}\right\rfloor\)</span></p>
<p>swap gates</p>
<p>simple formula for the resulting matrix representation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">FullSimplify</span><span class="p">[</span><span class="n">Table</span><span class="p">[</span><span class="n">QFT</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">Table</span><span class="p">[</span><span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="p">)),</span> <span class="p">{</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">}],</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span> <span class="mi">6</span><span class="p">}]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="quantum-phase-estimation">
<h2>Quantum phase estimation<a class="headerlink" href="#quantum-phase-estimation" title="Link to this heading">#</a></h2>
<p>estimate the phase of this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">};</span> 
<span class="n">U</span><span class="p">[</span><span class="n">ϕ_</span><span class="p">]</span> <span class="o">=</span> <span class="p">{{</span><span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">ϕ</span><span class="p">)}};</span> 
</pre></div>
</div>
</div>
</div>
<p>check that we set up the problem correctly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">U</span><span class="p">[</span><span class="n">ϕ</span><span class="p">]</span> <span class="o">.</span> <span class="n">u</span> <span class="o">===</span> <span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Pi</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">ϕ</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="p">,</span> <span class="n">Norm</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>unit operator in the space of the system  <span class="math notranslate nohighlight">\(U\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">U0</span> <span class="o">=</span> <span class="n">IdentityMatrix</span><span class="p">[</span><span class="n">Length</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">SparseArray</span><span class="p">];</span> 
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(U\)</span></p>
<p>operator attached to  <span class="math notranslate nohighlight">\(n\)</span></p>
<p>qubits, controlled by the  <span class="math notranslate nohighlight">\(i^{\text{th}}\)</span></p>
<p>qubit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CTRLU</span><span class="p">[</span><span class="n">n_Integer</span><span class="p">,</span> <span class="n">i_Integer</span><span class="p">,</span> <span class="n">ϕ_</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">:=</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">P0</span><span class="p">],</span> <span class="n">U0</span><span class="p">]</span> <span class="o">+</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">op</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">P1</span><span class="p">],</span> <span class="n">U</span><span class="p">[</span><span class="n">ϕ</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>estimate to  <span class="math notranslate nohighlight">\(t\)</span></p>
<p>digits of precision:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> 
<span class="n">ϵ</span><span class="p">[</span><span class="n">ϕ_</span><span class="p">]</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">[</span><span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">ConjugateTranspose</span><span class="p">[</span><span class="n">QFT</span><span class="p">[</span><span class="n">t</span><span class="p">]],</span> <span class="n">U0</span><span class="p">]</span> <span class="o">.</span> <span class="n">Dot</span> <span class="o">@@</span> <span class="n">Table</span><span class="p">[</span><span class="n">CTRLU</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">ϕ</span><span class="p">],</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">}]</span> <span class="o">.</span> <span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">Dot</span> <span class="o">@@</span> <span class="n">Table</span><span class="p">[</span><span class="n">H</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="p">{</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">}],</span> <span class="n">U0</span><span class="p">]</span> <span class="o">.</span> <span class="n">Flatten</span><span class="p">[</span><span class="n">KroneckerProduct</span><span class="p">[</span><span class="n">SparseArray</span><span class="p">[</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="n">t</span><span class="p">],</span> <span class="n">u</span><span class="p">]]];</span> 
</pre></div>
</div>
</div>
</div>
<p>probabilities for measuring the different basis states: trace out the SUT and look at the diagonal elements of the reduced density matrix</p>
<p>(see ReducedDensityMatrix.nb)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rdm</span><span class="p">[(</span><span class="n">ψABC_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="p">{</span><span class="n">dA_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dA</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dB_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dB</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dC_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">dC</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Length</span><span class="p">[</span><span class="n">ψABC</span><span class="p">]</span> <span class="o">==</span> <span class="n">dA</span><span class="o">*</span><span class="n">dB</span><span class="o">*</span><span class="n">dC</span> <span class="o">:=</span> <span class="n">With</span><span class="p">[{</span><span class="n">P</span> <span class="o">=</span> <span class="n">ArrayReshape</span><span class="p">[</span><span class="n">ψABC</span><span class="p">,</span> <span class="p">{</span><span class="n">dA</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">dC</span><span class="p">}]},</span> <span class="n">Flatten</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">}]</span> <span class="o">.</span> <span class="n">ConjugateTranspose</span><span class="p">[</span><span class="n">P</span><span class="p">],</span> <span class="p">{{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}}]]</span>
<span class="n">traceout</span><span class="p">[(</span><span class="n">ψ_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="n">d_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">d</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Divisible</span><span class="p">[</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">],</span> <span class="n">d</span><span class="p">]</span> <span class="o">:=</span> <span class="n">rdm</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">}]</span>
<span class="n">traceout</span><span class="p">[(</span><span class="n">ψ_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="n">d_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">d</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="p">;</span> <span class="n">Divisible</span><span class="p">[</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">],</span> <span class="o">-</span><span class="n">d</span><span class="p">]</span> <span class="o">:=</span> <span class="n">rdm</span><span class="p">[</span><span class="n">ψ</span><span class="p">,</span> <span class="p">{</span><span class="n">Length</span><span class="p">[</span><span class="n">ψ</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">),</span> <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="p">[(</span><span class="n">ϕ_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Re</span><span class="p">[</span><span class="n">Diagonal</span><span class="p">[</span><span class="n">traceout</span><span class="p">[</span><span class="n">ϵ</span><span class="p">[</span><span class="n">N</span><span class="p">[</span><span class="n">ϕ</span><span class="p">]],</span> <span class="o">-</span><span class="n">Length</span><span class="p">[</span><span class="n">u</span><span class="p">]]]]</span>
</pre></div>
</div>
</div>
</div>
<p>When  <span class="math notranslate nohighlight">\(\phi\)</span></p>
<p>is an integer multiple of  <span class="math notranslate nohighlight">\(2^{-t}\)</span></p>
<p>, only one basis state has 100% probability of occurring. The  <span class="math notranslate nohighlight">\(i^{\text{th}}\)</span></p>
<p>basis state corresponds to a measurement of  <span class="math notranslate nohighlight">\(\phi =\frac{i-1}{2^t}\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MatrixForm</span><span class="p">[</span><span class="n">Chop</span><span class="p">[</span><span class="n">Table</span><span class="p">[</span><span class="n">prob</span><span class="p">[</span><span class="n">ϕ</span><span class="p">],</span> <span class="p">{</span><span class="n">ϕ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)}]]]</span>
</pre></div>
</div>
</div>
</div>
<p>When  <span class="math notranslate nohighlight">\(\phi\)</span></p>
<p>is not an integer multiple of  <span class="math notranslate nohighlight">\(2^{-t}\)</span></p>
<p>, all basis states can occur in measurement:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Round</span><span class="p">[</span><span class="n">prob</span><span class="p">[</span><span class="mf">0.2</span><span class="p">],</span> <span class="mf">0.001</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The mean measurement is a bad estimator (doesn’t converge as  <span class="math notranslate nohighlight">\(t\to \infty\)</span></p>
<p>).</p>
<p>The most likely measurement is a good estimator.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">[(</span><span class="n">ϕ_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">prob</span><span class="p">[</span><span class="n">ϕ</span><span class="p">]</span> <span class="o">.</span> <span class="p">(</span><span class="n">Range</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">t</span><span class="p">);</span> 
<span class="n">mostprobable</span><span class="p">[(</span><span class="n">ϕ_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">]</span> <span class="o">:=</span> <span class="p">(</span><span class="n">Ordering</span><span class="p">[</span><span class="n">prob</span><span class="p">[</span><span class="n">ϕ</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">][[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">t</span><span class="p">;</span> 
<span class="n">Plot</span><span class="p">[{</span><span class="n">ϕ</span><span class="p">,</span> <span class="n">mean</span><span class="p">[</span><span class="n">ϕ</span><span class="p">],</span> <span class="n">mostprobable</span><span class="p">[</span><span class="n">ϕ</span><span class="p">]},</span> <span class="p">{</span><span class="n">ϕ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="n">FrameLabel</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="s2">&quot;phase setting&quot;</span><span class="p">,</span> <span class="s2">&quot;phase measurement&quot;</span><span class="p">},</span> <span class="n">LabelStyle</span> <span class="o">-&gt;</span> <span class="n">Directive</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="n">Black</span><span class="p">,</span> <span class="n">Bold</span><span class="p">],</span> <span class="n">PlotRange</span> <span class="o">-&gt;</span> <span class="p">{{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">}},</span> <span class="n">PlotRangePadding</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">,</span> <span class="n">PlotStyle</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="n">Black</span><span class="p">,</span> <span class="p">{</span><span class="n">Thick</span><span class="p">,</span> <span class="n">Blue</span><span class="p">},</span> <span class="p">{</span><span class="n">Thick</span><span class="p">,</span> <span class="n">Red</span><span class="p">}},</span> <span class="n">AspectRatio</span> <span class="o">-&gt;</span> <span class="n">Automatic</span><span class="p">,</span> <span class="n">PlotTheme</span> <span class="o">-&gt;</span> <span class="s2">&quot;Scientific&quot;</span><span class="p">,</span> <span class="n">PlotLegends</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="s2">&quot;exact&quot;</span><span class="p">,</span> <span class="s2">&quot;mean of measurements&quot;</span><span class="p">,</span> <span class="s2">&quot;most frequent measurement&quot;</span><span class="p">},</span> <span class="n">GridLines</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="n">Range</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">t</span><span class="p">,</span> <span class="n">Range</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">^</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="o">^</span><span class="n">t</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<p>This Mathematica code is part of the lecture script  <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied. It is licensed under a  <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> .</p>
<img src="data:image/jpg;base64,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" class="img-responsive"/>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="particle-in-a-1d-gravity-well">
<h1>particle in a 1D gravity well<a class="headerlink" href="#particle-in-a-1d-gravity-well" title="Link to this heading">#</a></h1>
<section id="id4">
<h2>units<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>we use natural units for simplicity:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">ℏ</span> <span class="o">=</span> <span class="n">g</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>Other unit systems can be defined here.</p>
</section>
<section id="analytic-calculation">
<h2>analytic calculation<a class="headerlink" href="#analytic-calculation" title="Link to this heading">#</a></h2>
<p>Hamiltonian:</p>
<div class="math notranslate nohighlight">
\[\hat{H}=-\frac{\hbar ^2}{2m}\frac{d^2}{dx^2}+m g \hat{x}\]</div>
<p>exact energy eigenstates and energies:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ψ</span><span class="p">[</span><span class="n">k_</span><span class="p">,</span> <span class="n">x_</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">)</span><span class="o">/</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">AiryAi</span><span class="p">[</span><span class="n">AiryAiZero</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">)</span><span class="o">/</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)]</span><span class="o">/</span><span class="n">Derivative</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">AiryAi</span><span class="p">][</span><span class="n">AiryAiZero</span><span class="p">[</span><span class="n">k</span><span class="p">]]);</span> 
<span class="n">ϵ</span><span class="p">[</span><span class="n">k_</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">AiryAiZero</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="p">((</span><span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">);</span> 
</pre></div>
</div>
</div>
</div>
<p>show lowest energy eigenstates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Plot</span><span class="p">[</span><span class="n">Evaluate</span><span class="p">[</span><span class="n">Table</span><span class="p">[</span><span class="n">ψ</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">{</span><span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">}]],</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="system-setup">
<h2>system setup<a class="headerlink" href="#system-setup" title="Link to this heading">#</a></h2>
<p>basis set size:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nmax</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>computational box size:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="basis-set">
<h2>basis set<a class="headerlink" href="#basis-set" title="Link to this heading">#</a></h2>
<p>momentum-basis functions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ϕ</span><span class="p">[</span><span class="n">n_</span><span class="p">,</span> <span class="n">x_</span><span class="p">]</span> <span class="o">=</span> <span class="n">Sqrt</span><span class="p">[</span><span class="mi">2</span><span class="o">/</span><span class="n">a</span><span class="p">]</span><span class="o">*</span><span class="n">Sin</span><span class="p">[(</span><span class="n">n</span><span class="o">*</span><span class="n">Pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">];</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="numerical-solution-i-momentum-basis">
<h2>numerical solution (I): momentum basis<a class="headerlink" href="#numerical-solution-i-momentum-basis" title="Link to this heading">#</a></h2>
<p>kinetic-energy operator  <span class="math notranslate nohighlight">\(\hat{T}\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TM</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Range</span><span class="p">[</span><span class="n">nmax</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">Pi</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">))];</span> 
</pre></div>
</div>
</div>
</div>
<p>position operator  <span class="math notranslate nohighlight">\(\hat{x}\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xM</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[{</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="p">{</span><span class="n">n1_</span><span class="p">,</span> <span class="n">n2_</span><span class="p">}</span> <span class="o">/</span><span class="p">;</span> <span class="n">OddQ</span><span class="p">[</span><span class="n">n1</span> <span class="o">-</span> <span class="n">n2</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="p">((</span><span class="mi">8</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">n1</span><span class="o">*</span><span class="n">n2</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">n1</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">n2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">Pi</span><span class="o">^</span><span class="mi">2</span><span class="p">))},</span> <span class="p">{</span><span class="n">nmax</span><span class="p">,</span> <span class="n">nmax</span><span class="p">}];</span> 
</pre></div>
</div>
</div>
</div>
<p>potential-energy operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">VM</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">xM</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>Hamiltonian in the momentum representation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HM</span> <span class="o">=</span> <span class="n">TM</span> <span class="o">+</span> <span class="n">VM</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>ground state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gsM</span> <span class="o">=</span> <span class="o">-</span><span class="n">Eigensystem</span><span class="p">[</span><span class="o">-</span><span class="n">N</span><span class="p">[</span><span class="n">HM</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Method</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="s2">&quot;Arnoldi&quot;</span><span class="p">,</span> <span class="s2">&quot;Criteria&quot;</span> <span class="o">-&gt;</span> <span class="s2">&quot;RealPart&quot;</span><span class="p">,</span> <span class="n">MaxIterations</span> <span class="o">-&gt;</span> <span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">}];</span> 
</pre></div>
</div>
</div>
</div>
<p>ground-state energy, compared to analytic result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">gsM</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">N</span><span class="p">[</span><span class="n">ϵ</span><span class="p">[</span><span class="mi">1</span><span class="p">]]}</span>
</pre></div>
</div>
</div>
</div>
<p>numerical ground-state wavefunction:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ψ0</span><span class="p">[</span><span class="n">x_</span><span class="p">]</span> <span class="o">=</span> <span class="n">gsM</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span> <span class="o">.</span> <span class="n">Table</span><span class="p">[</span><span class="n">ϕ</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">{</span><span class="n">n</span><span class="p">,</span> <span class="n">nmax</span><span class="p">}];</span> 
</pre></div>
</div>
</div>
</div>
<p>overlap with the exact ground state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Abs</span><span class="p">[</span><span class="n">NIntegrate</span><span class="p">[</span><span class="n">ψ0</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="n">ψ</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">}]]</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="numerical-solution-ii-mixed-basis">
<h2>numerical solution (II): mixed basis<a class="headerlink" href="#numerical-solution-ii-mixed-basis" title="Link to this heading">#</a></h2>
<p>computational grid:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Δ</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> 
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">Range</span><span class="p">[</span><span class="n">nmax</span><span class="p">]</span><span class="o">*</span><span class="n">Δ</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>convert the kinetic-energy operator into the position basis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TM</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Range</span><span class="p">[</span><span class="n">nmax</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">Pi</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">))];</span> 
<span class="n">TP</span> <span class="o">=</span> <span class="n">FourierDST</span><span class="p">[</span><span class="n">TM</span><span class="p">,</span> <span class="mi">1</span><span class="p">];</span> 
</pre></div>
</div>
</div>
</div>
<p>potential-energy operator: gravity well  <span class="math notranslate nohighlight">\(W(x)=m g x\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">W</span><span class="p">[</span><span class="n">x_</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">x</span><span class="p">;</span> 
<span class="n">Wgrid</span> <span class="o">=</span> <span class="n">W</span> <span class="o">/@</span> <span class="n">xgrid</span><span class="p">;</span> 
<span class="n">VP</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Wgrid</span><span class="p">];</span> 
</pre></div>
</div>
</div>
</div>
<p>Hamiltonian in the position representation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HP</span> <span class="o">=</span> <span class="n">TP</span> <span class="o">+</span> <span class="n">VP</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>ground state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gsP</span> <span class="o">=</span> <span class="o">-</span><span class="n">Eigensystem</span><span class="p">[</span><span class="o">-</span><span class="n">N</span><span class="p">[</span><span class="n">HP</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Method</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="s2">&quot;Arnoldi&quot;</span><span class="p">,</span> <span class="s2">&quot;Criteria&quot;</span> <span class="o">-&gt;</span> <span class="s2">&quot;RealPart&quot;</span><span class="p">,</span> <span class="n">MaxIterations</span> <span class="o">-&gt;</span> <span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">}];</span> 
</pre></div>
</div>
</div>
</div>
<p>ground-state energy, compared to analytic result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="n">gsP</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">N</span><span class="p">[</span><span class="n">ϵ</span><span class="p">[</span><span class="mi">1</span><span class="p">]]}</span>
</pre></div>
</div>
</div>
</div>
<p>ground-state wavefunction as linear interpolation between grid points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">γ</span> <span class="o">=</span> <span class="n">Join</span><span class="p">[{{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}},</span> <span class="n">Transpose</span><span class="p">[{</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">gsP</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">/</span><span class="n">Sqrt</span><span class="p">[</span><span class="n">Δ</span><span class="p">]}],</span> <span class="p">{{</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">}}];</span> 
<span class="n">P1</span> <span class="o">=</span> <span class="n">ListLinePlot</span><span class="p">[</span><span class="n">γ</span><span class="p">];</span> 
<span class="n">P2</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">[</span><span class="n">ψ0</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="p">{</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">},</span> <span class="n">PlotStyle</span> <span class="o">-&gt;</span> <span class="n">Orange</span><span class="p">];</span> 
<span class="n">Show</span><span class="p">[</span><span class="n">P2</span><span class="p">,</span> <span class="n">P1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="wigner-distribution">
<h3>Wigner distribution<a class="headerlink" href="#wigner-distribution" title="Link to this heading">#</a></h3>
<p>calculate the  <span class="math notranslate nohighlight">\(k\)</span></p>
<p>-dependent Wigner distribution of a pure state with coefficient vector  <span class="math notranslate nohighlight">\(\overset{\rightharpoonup }{v}\)</span></p>
<p>on the spatial grid</p>
<p>return a function of one parameter  <span class="math notranslate nohighlight">\(\kappa =k a\)</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a\)</span></p></li>
</ul>
<p>is the size of the grid</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span></p></li>
</ul>
<p>is the number of grid points (the length of the vector  <span class="math notranslate nohighlight">\(\overset{\rightharpoonup }{v}\)</span></p>
<p>)</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta =\frac{a}{n+1}\)</span></p></li>
</ul>
<p>is the grid spacing</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(v_j=\langle j|\psi \rangle\)</span></p></li>
</ul>
<p>is the projection of the pure state onto the  <span class="math notranslate nohighlight">\(j^{\text{th}}\)</span></p>
<p>spatial basis function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WignerDistribution</span><span class="p">[(</span><span class="n">v_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">With</span><span class="p">[{</span><span class="n">nmax</span> <span class="o">=</span> <span class="n">Length</span><span class="p">[</span><span class="n">v</span><span class="p">]},</span> <span class="n">Function</span><span class="p">[</span><span class="n">κ</span><span class="p">,</span> <span class="n">Evaluate</span><span class="p">[(</span><span class="n">Sinc</span><span class="p">[</span><span class="n">κ</span><span class="o">/</span><span class="p">(</span><span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">/</span><span class="n">Pi</span><span class="p">)</span><span class="o">*</span><span class="n">Table</span><span class="p">[</span><span class="n">ComplexExpand</span><span class="p">[</span><span class="n">Re</span><span class="p">[</span><span class="n">Sum</span><span class="p">[</span><span class="n">v</span><span class="p">[[</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">]]</span><span class="o">*</span><span class="n">Conjugate</span><span class="p">[</span><span class="n">v</span><span class="p">[[</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span><span class="p">]]]</span><span class="o">*</span><span class="n">Exp</span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">κ</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">{</span><span class="n">m</span><span class="p">,</span> <span class="o">-</span><span class="n">Min</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">-</span> <span class="n">j</span><span class="p">],</span> <span class="n">Min</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">-</span> <span class="n">j</span><span class="p">]}]]],</span> <span class="p">{</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}]]]]</span>
</pre></div>
</div>
</div>
</div>
<p>plot the Wigner function of a pure state with coefficient vector  <span class="math notranslate nohighlight">\(Y=\overset{\rightharpoonup }{v}\)</span></p>
<p>or density matrix  <span class="math notranslate nohighlight">\(Y=R\)</span></p>
<p>:</p>
<p>(needs the grid coordinates,  <span class="math notranslate nohighlight">\(x\in \left[x_{\min },x_{\max }\right]\)</span></p>
<p>, for labeling the axes;  <span class="math notranslate nohighlight">\(a=x_{\max }-x_{\min }\)</span></p>
<p>)</p>
<p>color scale is  <span class="math notranslate nohighlight">\(\left[-,+\right]\)</span></p>
<p>with  <span class="math notranslate nohighlight">\(-\)</span></p>
<p>=blue,  <span class="math notranslate nohighlight">\(0\)</span></p>
<p>=white,  <span class="math notranslate nohighlight">\(+\frac{1}{\pi }\)</span></p>
<p>=red</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WignerDistributionPlot</span><span class="p">[(</span><span class="n">v_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">,</span> <span class="p">{(</span><span class="n">xmin_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="p">(</span><span class="n">xmax_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">}</span> <span class="o">/</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">&gt;</span> <span class="n">xmin</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Module</span><span class="p">[{</span><span class="n">nmax</span><span class="p">,</span> <span class="n">qmax</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">W</span><span class="p">},</span> <span class="n">nmax</span> <span class="o">=</span> <span class="n">Length</span><span class="p">[</span><span class="n">v</span><span class="p">];</span> <span class="n">w</span> <span class="o">=</span> <span class="n">WignerDistribution</span><span class="p">[</span><span class="n">v</span><span class="p">];</span> <span class="n">qmax</span> <span class="o">=</span> <span class="n">Floor</span><span class="p">[</span><span class="n">nmax</span><span class="o">/</span><span class="mi">2</span><span class="p">];</span> <span class="n">W</span> <span class="o">=</span> <span class="n">Table</span><span class="p">[</span><span class="n">w</span><span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">Pi</span><span class="p">],</span> <span class="p">{</span><span class="n">q</span><span class="p">,</span> <span class="o">-</span><span class="n">qmax</span><span class="p">,</span> <span class="n">qmax</span><span class="p">}];</span> <span class="n">ArrayPlot</span><span class="p">[</span><span class="n">W</span><span class="p">,</span> <span class="n">FrameTicks</span> <span class="o">-&gt;</span> <span class="n">Automatic</span><span class="p">,</span> <span class="n">DataRange</span> <span class="o">-&gt;</span> <span class="p">{{</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">},</span> <span class="p">((</span><span class="n">qmax</span><span class="o">*</span><span class="n">Pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">))</span><span class="o">*</span><span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}},</span> <span class="n">PlotRange</span> <span class="o">-&gt;</span> <span class="p">{{</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">},</span> <span class="p">((</span><span class="n">qmax</span><span class="o">*</span><span class="n">Pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">))</span><span class="o">*</span><span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}},</span> <span class="n">AspectRatio</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="n">GoldenRatio</span><span class="p">,</span> <span class="n">ColorFunctionScaling</span> <span class="o">-&gt;</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ColorFunction</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">Blend</span><span class="p">[{</span><span class="n">Blue</span><span class="p">,</span> <span class="n">White</span><span class="p">,</span> <span class="n">Red</span><span class="p">},</span> <span class="p">(</span><span class="n">Pi</span><span class="o">*</span><span class="c1">#1 + 1)/2] &amp; )]]</span>
</pre></div>
</div>
</div>
</div>
<p>plot the Wigner distribution of the ground state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WignerDistributionPlot</span><span class="p">[</span><span class="n">gsP</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
<p>This Mathematica code is part of the lecture script  <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied. It is licensed under a  <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> .</p>
<img src="data:image/jpg;base64,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" class="img-responsive"/>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="wigner-quasi-probability-distribution">
<h1>Wigner quasi-probability distribution<a class="headerlink" href="#wigner-quasi-probability-distribution" title="Link to this heading">#</a></h1>
<p>The Wigner quasi-probability distribution of a density operator  <span class="math notranslate nohighlight">\(\hat{\rho }\)</span></p>
<p>is</p>
<div class="math notranslate nohighlight">
\[W(x,k)=\frac{1}{\pi }\int _{-\infty }^{\infty }dy\left\langle x-y\left| \hat{\rho }\right| x+y\right\rangle e^{2i k y}\]</div>
<section id="definitions">
<h2>definitions<a class="headerlink" href="#definitions" title="Link to this heading">#</a></h2>
<p>calculate the  <span class="math notranslate nohighlight">\(k\)</span></p>
<p>-dependent Wigner distribution of a pure state with coefficient vector  <span class="math notranslate nohighlight">\(\overset{\rightharpoonup }{v}\)</span></p>
<p>on the spatial grid</p>
<p>return a function of one parameter  <span class="math notranslate nohighlight">\(\kappa =k a\)</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a\)</span></p></li>
</ul>
<p>is the size of the grid</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span></p></li>
</ul>
<p>is the number of grid points (the length of the vector  <span class="math notranslate nohighlight">\(\overset{\rightharpoonup }{v}\)</span></p>
<p>)</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta =\frac{a}{n+1}\)</span></p></li>
</ul>
<p>is the grid spacing</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(v_j=\langle j|\psi \rangle\)</span></p></li>
</ul>
<p>is the projection of the pure state onto the  <span class="math notranslate nohighlight">\(j^{\text{th}}\)</span></p>
<p>spatial basis function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WignerDistribution</span><span class="p">[(</span><span class="n">v_</span><span class="p">)</span><span class="err">?</span><span class="n">VectorQ</span><span class="p">]</span> <span class="o">:=</span> <span class="n">With</span><span class="p">[{</span><span class="n">nmax</span> <span class="o">=</span> <span class="n">Length</span><span class="p">[</span><span class="n">v</span><span class="p">]},</span> <span class="n">Function</span><span class="p">[</span><span class="n">κ</span><span class="p">,</span> <span class="n">Evaluate</span><span class="p">[(</span><span class="n">Sinc</span><span class="p">[</span><span class="n">κ</span><span class="o">/</span><span class="p">(</span><span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">/</span><span class="n">Pi</span><span class="p">)</span><span class="o">*</span><span class="n">Table</span><span class="p">[</span><span class="n">ComplexExpand</span><span class="p">[</span><span class="n">Re</span><span class="p">[</span><span class="n">Sum</span><span class="p">[</span><span class="n">v</span><span class="p">[[</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">]]</span><span class="o">*</span><span class="n">Conjugate</span><span class="p">[</span><span class="n">v</span><span class="p">[[</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span><span class="p">]]]</span><span class="o">*</span><span class="n">Exp</span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">κ</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">{</span><span class="n">m</span><span class="p">,</span> <span class="o">-</span><span class="n">Min</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">-</span> <span class="n">j</span><span class="p">],</span> <span class="n">Min</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">-</span> <span class="n">j</span><span class="p">]}]]],</span> <span class="p">{</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}]]]]</span>
</pre></div>
</div>
</div>
</div>
<p>same for a mixed state with coefficient matrix  <span class="math notranslate nohighlight">\(R\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WignerDistribution</span><span class="p">[</span><span class="n">R_</span> <span class="o">/</span><span class="p">;</span> <span class="n">MatrixQ</span><span class="p">[</span><span class="n">R</span><span class="p">,</span> <span class="n">NumericQ</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">Length</span><span class="p">[</span><span class="n">R</span><span class="p">]</span> <span class="o">==</span> <span class="n">Length</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">R</span><span class="p">]]]</span> <span class="o">:=</span> <span class="n">With</span><span class="p">[{</span><span class="n">nmax</span> <span class="o">=</span> <span class="n">Length</span><span class="p">[</span><span class="n">R</span><span class="p">]},</span> <span class="n">Function</span><span class="p">[</span><span class="n">κ</span><span class="p">,</span> <span class="n">Evaluate</span><span class="p">[(</span><span class="n">Sinc</span><span class="p">[</span><span class="n">κ</span><span class="o">/</span><span class="p">(</span><span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">/</span><span class="n">Pi</span><span class="p">)</span><span class="o">*</span><span class="n">Table</span><span class="p">[</span><span class="n">ComplexExpand</span><span class="p">[</span><span class="n">Re</span><span class="p">[</span><span class="n">Sum</span><span class="p">[</span><span class="n">R</span><span class="p">[[</span><span class="n">j</span> <span class="o">-</span> <span class="n">m</span><span class="p">,</span><span class="n">j</span> <span class="o">+</span> <span class="n">m</span><span class="p">]]</span><span class="o">*</span><span class="n">Exp</span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">κ</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="p">{</span><span class="n">m</span><span class="p">,</span> <span class="o">-</span><span class="n">Min</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">-</span> <span class="n">j</span><span class="p">],</span> <span class="n">Min</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">-</span> <span class="n">j</span><span class="p">]}]]],</span> <span class="p">{</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">}]]]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plotting">
<h2>plotting<a class="headerlink" href="#plotting" title="Link to this heading">#</a></h2>
<p>plot the Wigner function of a pure state with coefficient vector  <span class="math notranslate nohighlight">\(Y=\overset{\rightharpoonup }{v}\)</span></p>
<p>or density matrix  <span class="math notranslate nohighlight">\(Y=R\)</span></p>
<p>:</p>
<p>(needs the grid coordinates,  <span class="math notranslate nohighlight">\(x\in \left[x_{\min },x_{\max }\right]\)</span></p>
<p>, for labeling the axes;  <span class="math notranslate nohighlight">\(a=x_{\max }-x_{\min }\)</span></p>
<p>)</p>
<p>color scale is  <span class="math notranslate nohighlight">\(\left[-,+\right]\)</span></p>
<p>with  <span class="math notranslate nohighlight">\(-\)</span></p>
<p>=blue,  <span class="math notranslate nohighlight">\(0\)</span></p>
<p>=white,  <span class="math notranslate nohighlight">\(+\frac{1}{\pi }\)</span></p>
<p>=red</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">WignerDistributionPlot</span><span class="p">[</span><span class="n">Y_</span> <span class="o">/</span><span class="p">;</span> <span class="n">VectorQ</span><span class="p">[</span><span class="n">Y</span><span class="p">,</span> <span class="n">NumericQ</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="n">MatrixQ</span><span class="p">[</span><span class="n">Y</span><span class="p">,</span> <span class="n">NumericQ</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="n">Length</span><span class="p">[</span><span class="n">Y</span><span class="p">]</span> <span class="o">==</span> <span class="n">Length</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">Y</span><span class="p">]]),</span> <span class="p">{(</span><span class="n">xmin_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="p">(</span><span class="n">xmax_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">}</span> <span class="o">/</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">&gt;</span> <span class="n">xmin</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Module</span><span class="p">[{</span><span class="n">nmax</span><span class="p">,</span> <span class="n">qmax</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">W</span><span class="p">},</span> <span class="n">nmax</span> <span class="o">=</span> <span class="n">Length</span><span class="p">[</span><span class="n">Y</span><span class="p">];</span> <span class="n">w</span> <span class="o">=</span> <span class="n">WignerDistribution</span><span class="p">[</span><span class="n">Y</span><span class="p">];</span> <span class="n">qmax</span> <span class="o">=</span> <span class="n">Floor</span><span class="p">[</span><span class="n">nmax</span><span class="o">/</span><span class="mi">2</span><span class="p">];</span> <span class="n">W</span> <span class="o">=</span> <span class="n">Table</span><span class="p">[</span><span class="n">w</span><span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">Pi</span><span class="p">],</span> <span class="p">{</span><span class="n">q</span><span class="p">,</span> <span class="o">-</span><span class="n">qmax</span><span class="p">,</span> <span class="n">qmax</span><span class="p">}];</span> <span class="n">ArrayPlot</span><span class="p">[</span><span class="n">W</span><span class="p">,</span> <span class="n">FrameTicks</span> <span class="o">-&gt;</span> <span class="n">Automatic</span><span class="p">,</span> <span class="n">DataRange</span> <span class="o">-&gt;</span> <span class="p">{{</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">},</span> <span class="p">((</span><span class="n">qmax</span><span class="o">*</span><span class="n">Pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">))</span><span class="o">*</span><span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}},</span> <span class="n">PlotRange</span> <span class="o">-&gt;</span> <span class="p">{{</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">},</span> <span class="p">((</span><span class="n">qmax</span><span class="o">*</span><span class="n">Pi</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">))</span><span class="o">*</span><span class="p">{</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}},</span> <span class="n">AspectRatio</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="n">GoldenRatio</span><span class="p">,</span> <span class="n">ColorFunctionScaling</span> <span class="o">-&gt;</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ColorFunction</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">Blend</span><span class="p">[{</span><span class="n">Blue</span><span class="p">,</span> <span class="n">White</span><span class="p">,</span> <span class="n">Red</span><span class="p">},</span> <span class="p">(</span><span class="n">Pi</span><span class="o">*</span><span class="c1">#1 + 1)/2] &amp; )]]</span>
</pre></div>
</div>
</div>
</div>
<p>This Mathematica code is part of the lecture script  <em>Introduction to Computational Quantum Mechanics</em>  by Roman Schmied. It is licensed under a  <a class="reference external" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> .</p>
<img src="data:image/jpg;base64,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" class="img-responsive"/>
<p>You can download the associated lecture script at  <a class="reference external" href="http://arxiv.org/abs/1403.7050">http://arxiv.org/abs/1403.7050</a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dynamics-of-a-particle-moving-in-a-1d-potential-split-step-method">
<h1>dynamics of a particle moving in a 1D potential: split-step method<a class="headerlink" href="#dynamics-of-a-particle-moving-in-a-1d-potential-split-step-method" title="Link to this heading">#</a></h1>
<section id="id5">
<h2>units<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>we use natural units for simplicity:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">ℏ</span> <span class="o">=</span> <span class="n">g</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>Other unit systems can be defined here.</p>
</section>
<section id="id6">
<h2>system setup<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<p>basis set size:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nmax</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>computational grid:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span> 
<span class="n">Δ</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">nmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span> 
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">Range</span><span class="p">[</span><span class="n">nmax</span><span class="p">]</span><span class="o">*</span><span class="n">Δ</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
<p>potential: gravity well with potential  <span class="math notranslate nohighlight">\(W(x)=m g x\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">W</span><span class="p">[</span><span class="n">x_</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">x</span><span class="p">;</span> 
<span class="n">Wgrid</span> <span class="o">=</span> <span class="n">W</span> <span class="o">/@</span> <span class="n">xgrid</span><span class="p">;</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="exact-propagation">
<h2>exact propagation<a class="headerlink" href="#exact-propagation" title="Link to this heading">#</a></h2>
<p>propagation in the position-basis representation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">VP</span> <span class="o">=</span> <span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Wgrid</span><span class="p">];</span> 
<span class="n">TP</span> <span class="o">=</span> <span class="n">FourierDST</span><span class="p">[</span><span class="n">SparseArray</span><span class="p">[</span><span class="n">Band</span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}]</span> <span class="o">-&gt;</span> <span class="n">Range</span><span class="p">[</span><span class="n">nmax</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">Pi</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">))],</span> <span class="mi">1</span><span class="p">];</span> 
<span class="n">HP</span> <span class="o">=</span> <span class="n">TP</span> <span class="o">+</span> <span class="n">VP</span><span class="p">;</span> 
<span class="n">propExact</span><span class="p">[(</span><span class="n">Δt_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="n">v0_</span> <span class="o">/</span><span class="p">;</span> <span class="n">VectorQ</span><span class="p">[</span><span class="n">v0</span><span class="p">,</span> <span class="n">NumericQ</span><span class="p">]]</span> <span class="o">:=</span> <span class="n">MatrixExp</span><span class="p">[(</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">HP</span><span class="o">*</span><span class="n">N</span><span class="p">[</span><span class="n">Δt</span><span class="o">/</span><span class="n">ℏ</span><span class="p">]]</span> <span class="o">.</span> <span class="n">v0</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="split-step-propagation">
<h2>split-step propagation<a class="headerlink" href="#split-step-propagation" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">propApprox</span><span class="p">[(</span><span class="n">Δt_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="n">M_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">M</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v0_</span> <span class="o">/</span><span class="p">;</span> <span class="n">VectorQ</span><span class="p">[</span><span class="n">v0</span><span class="p">,</span> <span class="n">NumericQ</span><span class="p">]]</span> <span class="o">:=</span> <span class="n">Module</span><span class="p">[{</span><span class="n">λ</span><span class="p">,</span> <span class="n">Ke</span><span class="p">,</span> <span class="n">Pe2</span><span class="p">,</span> <span class="n">propKin</span><span class="p">,</span> <span class="n">propPot2</span><span class="p">,</span> <span class="n">prop</span><span class="p">},</span> <span class="n">λ</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">[</span><span class="n">Δt</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">ℏ</span><span class="p">)];</span> <span class="n">Ke</span> <span class="o">=</span> <span class="n">Exp</span><span class="p">[</span><span class="n">λ</span><span class="o">*</span><span class="n">Range</span><span class="p">[</span><span class="n">nmax</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">Pi</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">))];</span> <span class="n">propKin</span><span class="p">[</span><span class="n">v_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">FourierDST</span><span class="p">[</span><span class="n">Ke</span><span class="o">*</span><span class="n">FourierDST</span><span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">];</span> <span class="n">Pe2</span> <span class="o">=</span> <span class="n">Exp</span><span class="p">[(</span><span class="n">λ</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Wgrid</span><span class="p">];</span> <span class="n">propPot2</span><span class="p">[</span><span class="n">v_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Pe2</span><span class="o">*</span><span class="n">v</span><span class="p">;</span> <span class="n">prop</span><span class="p">[</span><span class="n">v_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">propPot2</span><span class="p">[</span><span class="n">propKin</span><span class="p">[</span><span class="n">propPot2</span><span class="p">[</span><span class="n">v</span><span class="p">]]];</span> <span class="n">Transpose</span><span class="p">[{(</span><span class="n">Range</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">M</span><span class="p">]</span><span class="o">/</span><span class="n">M</span><span class="p">)</span><span class="o">*</span><span class="n">Δt</span><span class="p">,</span> <span class="n">NestList</span><span class="p">[</span><span class="n">prop</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">M</span><span class="p">]}]]</span>
</pre></div>
</div>
</div>
</div>
<section id="initial-wavefunction">
<h3>initial wavefunction<a class="headerlink" href="#initial-wavefunction" title="Link to this heading">#</a></h3>
<p>starting point: Gaussian localized around the initial position  <span class="math notranslate nohighlight">\(x_0\)</span></p>
<p>in the simulation box</p>
<p>mean gridue:  <span class="math notranslate nohighlight">\(\left\langle \hat{x}\right\rangle =x_0\)</span></p>
<p>standard deviation:  <span class="math notranslate nohighlight">\(\left\langle \hat{x}^2\right\rangle -\left\langle \hat{x}\right\rangle ^2=\sigma ^2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span> 
<span class="n">σ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 
<span class="n">t1</span> <span class="o">=</span> <span class="n">Sqrt</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x0</span><span class="o">/</span><span class="n">g</span><span class="p">)];</span> 
<span class="n">vv</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">[</span><span class="n">N</span><span class="p">[</span><span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">xgrid</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">σ</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">)]];</span> 
<span class="n">ListLinePlot</span><span class="p">[</span><span class="n">Join</span><span class="p">[{{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}},</span> <span class="n">Transpose</span><span class="p">[{</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">vv</span><span class="o">/</span><span class="n">Sqrt</span><span class="p">[</span><span class="n">Δ</span><span class="p">]}],</span> <span class="p">{{</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">}}],</span> <span class="n">PlotRange</span> <span class="o">-&gt;</span> <span class="n">All</span><span class="p">,</span> <span class="n">AxesLabel</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;ψ(x)&quot;</span><span class="p">}]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-dependent-density">
<h3>time-dependent density<a class="headerlink" href="#time-dependent-density" title="Link to this heading">#</a></h3>
<p>propagate in time and show time-dependent density:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">Δt</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">},</span> <span class="n">ρ</span> <span class="o">=</span> <span class="n">ArrayPad</span><span class="p">[</span><span class="n">Abs</span><span class="p">[</span><span class="n">propApprox</span><span class="p">[</span><span class="n">Δt</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">vv</span><span class="p">][[</span><span class="n">All</span><span class="p">,</span><span class="mi">2</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">Δ</span><span class="p">,</span> <span class="p">{{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}}];</span> <span class="n">Pq</span> <span class="o">=</span> <span class="n">ArrayPlot</span><span class="p">[</span><span class="n">Reverse</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">ρ</span><span class="p">]],</span> <span class="n">DataRange</span> <span class="o">-&gt;</span> <span class="p">{{</span><span class="mi">0</span><span class="p">,</span> <span class="n">Δt</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">}}];</span> <span class="n">Pc</span> <span class="o">=</span> <span class="n">Plot</span><span class="p">[</span><span class="n">x0</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Mod</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">t1</span><span class="p">,</span> <span class="o">-</span><span class="n">t1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="p">{</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Δt</span><span class="p">},</span> <span class="n">PlotStyle</span> <span class="o">-&gt;</span> <span class="n">Orange</span><span class="p">];</span> <span class="n">Show</span><span class="p">[</span><span class="n">Pq</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">AspectRatio</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">FrameLabel</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">},</span> <span class="n">FrameTicks</span> <span class="o">-&gt;</span> <span class="n">Automatic</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>plot the time-dependent average position:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">Δt</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">},</span> <span class="n">Mq</span> <span class="o">=</span> <span class="n">ListLinePlot</span><span class="p">[({</span><span class="c1">#1[[1]], Abs[#1[[2]]]^2 . xgrid} &amp; ) /@ propApprox[Δt, M, vv], PlotRange -&gt; All]; Mc = Plot[x0 - (1/2)*Mod[t, 2*t1, -t1]^2, {t, 0, Δt}, PlotStyle -&gt; Orange, PlotRange -&gt; All]; Show[Mc, Mq, AxesLabel -&gt; {t, 〈 OverHat[x] 〉}]]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="split-step-propagation-with-a-time-dependent-potential">
<h2>split-step propagation with a time-dependent potential<a class="headerlink" href="#split-step-propagation-with-a-time-dependent-potential" title="Link to this heading">#</a></h2>
<p>propagate with a time-dependent potential given as a function  <span class="math notranslate nohighlight">\(W(x,t)\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">propApprox</span><span class="p">[</span><span class="n">Wt_</span><span class="p">,</span> <span class="p">(</span><span class="n">Δt_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="n">M_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">M</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v0_</span> <span class="o">/</span><span class="p">;</span> <span class="n">VectorQ</span><span class="p">[</span><span class="n">v0</span><span class="p">,</span> <span class="n">NumericQ</span><span class="p">]]</span> <span class="o">:=</span> <span class="n">Module</span><span class="p">[{</span><span class="n">λ</span><span class="p">,</span> <span class="n">Ke</span><span class="p">,</span> <span class="n">propKin</span><span class="p">,</span> <span class="n">propPot2</span><span class="p">,</span> <span class="n">prop</span><span class="p">},</span> <span class="n">λ</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">[</span><span class="n">Δt</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">ℏ</span><span class="p">)];</span> <span class="n">Ke</span> <span class="o">=</span> <span class="n">Exp</span><span class="p">[</span><span class="n">λ</span><span class="o">*</span><span class="n">Range</span><span class="p">[</span><span class="n">nmax</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">Pi</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">))];</span> <span class="n">propKin</span><span class="p">[</span><span class="n">v_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">FourierDST</span><span class="p">[</span><span class="n">Ke</span><span class="o">*</span><span class="n">FourierDST</span><span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">];</span> <span class="n">propPot2</span><span class="p">[</span><span class="n">t_</span><span class="p">,</span> <span class="n">v_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Exp</span><span class="p">[(</span><span class="n">λ</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Wt</span><span class="p">[</span><span class="c1">#1, t] &amp; ) /@ xgrid]*v; prop[v_, t_] := propPot2[t + (3*Δt)/(4*M), propKin[propPot2[t + Δt/(4*M), v]]]; Transpose[{(Range[0, M]/M)*Δt, FoldList[prop, v0, (Range[0, M - 1]/M)*Δt]}]]</span>
</pre></div>
</div>
</div>
</div>
<p>propagate in time and show time-dependent density:</p>
<p>resonant driving:  <span class="math notranslate nohighlight">\(W(x,t)=W(x)(1+A \sin (\omega  t))\)</span></p>
<p>, picking a resonant  <span class="math notranslate nohighlight">\(\omega =\pi \left/t_1\right.\)</span></p>
<p>to amplify the bouncing motion</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">A</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">ω</span> <span class="o">=</span> <span class="n">Pi</span><span class="o">/</span><span class="n">t1</span><span class="p">,</span> <span class="n">Δt</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">},</span> <span class="n">Wt</span><span class="p">[</span><span class="n">x_</span><span class="p">,</span> <span class="n">t_</span><span class="p">]</span> <span class="o">=</span> <span class="n">W</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">A</span><span class="o">*</span><span class="n">Sin</span><span class="p">[</span><span class="n">ω</span><span class="o">*</span><span class="n">t</span><span class="p">]);</span> <span class="n">ρ</span> <span class="o">=</span> <span class="n">ArrayPad</span><span class="p">[</span><span class="n">Abs</span><span class="p">[</span><span class="n">propApprox</span><span class="p">[</span><span class="n">Wt</span><span class="p">,</span> <span class="n">Δt</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">vv</span><span class="p">][[</span><span class="n">All</span><span class="p">,</span><span class="mi">2</span><span class="p">]]]</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">Δ</span><span class="p">,</span> <span class="p">{{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">}}];</span> <span class="n">Pq</span> <span class="o">=</span> <span class="n">ArrayPlot</span><span class="p">[</span><span class="n">Reverse</span><span class="p">[</span><span class="n">Transpose</span><span class="p">[</span><span class="n">ρ</span><span class="p">]],</span> <span class="n">DataRange</span> <span class="o">-&gt;</span> <span class="p">{{</span><span class="mi">0</span><span class="p">,</span> <span class="n">Δt</span><span class="p">},</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">}}];</span> <span class="n">Show</span><span class="p">[</span><span class="n">Pq</span><span class="p">,</span> <span class="n">AspectRatio</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">FrameLabel</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">},</span> <span class="n">FrameTicks</span> <span class="o">-&gt;</span> <span class="n">Automatic</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="split-step-propagation-with-a-time-dependent-potential-and-with-nonlinear-interaction">
<h2>split-step propagation with a time-dependent potential and with nonlinear interaction<a class="headerlink" href="#split-step-propagation-with-a-time-dependent-potential-and-with-nonlinear-interaction" title="Link to this heading">#</a></h2>
<p>propagate with a time-dependent potential given as a function  <span class="math notranslate nohighlight">\(W(x,t)+\kappa | \psi (x,t)| ^2\)</span></p>
<p>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">propApprox</span><span class="p">[</span><span class="n">Wt_</span><span class="p">,</span> <span class="p">(</span><span class="n">κ_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="p">(</span><span class="n">Δt_</span><span class="p">)</span><span class="err">?</span><span class="n">NumericQ</span><span class="p">,</span> <span class="n">M_Integer</span> <span class="o">/</span><span class="p">;</span> <span class="n">M</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v0_</span> <span class="o">/</span><span class="p">;</span> <span class="n">VectorQ</span><span class="p">[</span><span class="n">v0</span><span class="p">,</span> <span class="n">NumericQ</span><span class="p">]]</span> <span class="o">:=</span> <span class="n">Module</span><span class="p">[{</span><span class="n">λ</span><span class="p">,</span> <span class="n">Ke</span><span class="p">,</span> <span class="n">propKin</span><span class="p">,</span> <span class="n">propPot2</span><span class="p">,</span> <span class="n">prop</span><span class="p">},</span> <span class="n">λ</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">[</span><span class="n">Δt</span><span class="o">/</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">ℏ</span><span class="p">)];</span> <span class="n">Ke</span> <span class="o">=</span> <span class="n">Exp</span><span class="p">[</span><span class="n">λ</span><span class="o">*</span><span class="n">Range</span><span class="p">[</span><span class="n">nmax</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">Pi</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">))];</span> <span class="n">propKin</span><span class="p">[</span><span class="n">v_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">FourierDST</span><span class="p">[</span><span class="n">Ke</span><span class="o">*</span><span class="n">FourierDST</span><span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">];</span> <span class="n">propPot2</span><span class="p">[</span><span class="n">t_</span><span class="p">,</span> <span class="n">v_</span><span class="p">]</span> <span class="o">:=</span> <span class="n">Exp</span><span class="p">[(</span><span class="n">λ</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">Wt</span><span class="p">[</span><span class="c1">#1, t] &amp; ) /@ xgrid + κ*(Abs[v]^2/Δ))]*v; prop[v_, t_] := propPot2[t + (3*Δt)/(4*M), propKin[propPot2[t + Δt/(4*M), v]]]; Transpose[{(Range[0, M]/M)*Δt, FoldList[prop, v0, (Range[0, M - 1]/M)*Δt]}]]</span>
</pre></div>
</div>
</div>
</div>
<p>propagate in time and show time-dependent density:</p>
<p>[here using time-independent potential  <span class="math notranslate nohighlight">\(W(x,t)=W(x)\)</span></p>
<p>]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">κ</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">((</span><span class="n">g</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">Δt</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">},</span> <span class="n">ρ</span> <span class="o">=</span> <span class="n">ArrayPad</span><span class="p">[</span><span class="n">Abs</span><span class="p">[</span><span class="n">propApprox</span><span class="p">[</span><span class="n">W</span><span class="p">[</span><span class="c1">#1] &amp; , κ, Δt, M, vv][[All,2]]]^2/Δ, {{0, 0}, {1, 1}}]; Pq = ArrayPlot[Reverse[Transpose[ρ]], DataRange -&gt; {{0, Δt}, {0, a}}]; Show[Pq, AspectRatio -&gt; 1/2, FrameLabel -&gt; {t, x}, FrameTicks -&gt; Automatic]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">κ</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="p">((</span><span class="n">g</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">Δt</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">},</span> <span class="n">ρ</span> <span class="o">=</span> <span class="n">ArrayPad</span><span class="p">[</span><span class="n">Abs</span><span class="p">[</span><span class="n">propApprox</span><span class="p">[</span><span class="n">W</span><span class="p">[</span><span class="c1">#1] &amp; , κ, Δt, M, vv][[All,2]]]^2/Δ, {{0, 0}, {1, 1}}]; Pq = ArrayPlot[Reverse[Transpose[ρ]], DataRange -&gt; {{0, Δt}, {0, a}}]; Show[Pq, AspectRatio -&gt; 1/2, FrameLabel -&gt; {t, x}, FrameTicks -&gt; Automatic]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">With</span><span class="p">[{</span><span class="n">κ</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="p">((</span><span class="n">g</span><span class="o">*</span><span class="n">ℏ</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">Δt</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">},</span> <span class="n">ρ</span> <span class="o">=</span> <span class="n">ArrayPad</span><span class="p">[</span><span class="n">Abs</span><span class="p">[</span><span class="n">propApprox</span><span class="p">[</span><span class="n">W</span><span class="p">[</span><span class="c1">#1] &amp; , κ, Δt, M, vv][[All,2]]]^2/Δ, {{0, 0}, {1, 1}}]; Pq = ArrayPlot[Reverse[Transpose[ρ]], DataRange -&gt; {{0, Δt}, {0, a}}]; Show[Pq, AspectRatio -&gt; 1/2, FrameLabel -&gt; {t, x}, FrameTicks -&gt; Automatic]]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./17MCM_QM_ipynb/MOESM_MMA"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">many ways to define the factorial function</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-function-identity">—UNPARSED—. function identity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-function-forwarding">—UNPARSED—. function forwarding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-mathematical-equivalence-i">—UNPARSED—. mathematical equivalence (I)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-mathematical-equivalence-ii">—UNPARSED—. mathematical equivalence (II)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-recursion-i-pattern-matching">—UNPARSED—. recursion (I): pattern matching</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-recursion-ii-if-clause">—UNPARSED—. recursion (II): If clause</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-recursion-iii-anonymous-function">—UNPARSED—. recursion (III): anonymous function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-procedural-programming-i-do-loop">—UNPARSED—. procedural programming (I): Do loop</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-procedural-programming-ii-for-loop">—UNPARSED—. procedural programming (II): For loop</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-list-processing-i-automatic">—UNPARSED—. list processing (I): automatic</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-list-processing-ii-manual">—UNPARSED—. list processing (II): manual</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-functional-programming">—UNPARSED—. functional programming</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-permutation-group-size">—UNPARSED—. permutation group size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-repeated-pattern-matching-and-replacement">—UNPARSED—. repeated pattern matching and replacement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-string-processing">—UNPARSED—. string processing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-nested-lists-by-repeated-replacement">—UNPARSED—. nested lists by repeated replacement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unparsed-analytic-differentiation">—UNPARSED—. analytic differentiation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-density-matrices">reduced density matrices</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tripartite-cases">tripartite cases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-density-matrix-rho-text-abc">starting from a density matrix  <span class="math notranslate nohighlight">\(\rho _{\text{ABC}}\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-pure-state-psi-text-abc">starting from a pure state  <span class="math notranslate nohighlight">\(\psi _{\text{ABC}}\)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bipartite-cases">bipartite cases</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-density-matrix-rho">starting from a density matrix  <span class="math notranslate nohighlight">\(\rho\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-from-a-pure-state-psi">starting from a pure state  <span class="math notranslate nohighlight">\(\psi\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-mechanical-spin-and-angular-momentum-operators">quantum-mechanical spin and angular momentum operators</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-1-2-electron-in-a-dc-magnetic-field">spin-1/2 electron in a dc magnetic field</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#coupled-spin-systems-87-text-rb">coupled spin systems:  <span class="math notranslate nohighlight">\(\, ^{87}\text{Rb}\)</span></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-spin-operators">general spin operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specific-spin-operators">specific spin operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#units">units</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#physical-constants">physical constants</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperfine-hamiltonian">hyperfine Hamiltonian</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#static-magnetic-field">static magnetic field</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagonalize-the-hamiltonian">diagonalize the Hamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-energy-levels">plot the energy levels</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-the-energy-eigenstates">analyze the energy eigenstates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#field-free-limit">field-free limit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#low-field-limit">low-field limit</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#high-field-limit">high-field limit</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#magic-magnetic-field">“magic” magnetic field</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#oscillating-magnetic-field">oscillating magnetic field</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian">Hamiltonian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transition-matrix-elements">transition matrix elements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-time-dependent-schrodinger-equation-numerically">solve time-dependent Schrödinger equation numerically</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotating-wave-approximation">rotating-wave approximation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#transverse-ising-model">transverse Ising model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">quantum-mechanical spin and angular momentum operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators-acting-on-many-spins">operators acting on many spins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Hamiltonian</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#asymptotic-ground-states">asymptotic ground states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian-diagonalization">Hamiltonian diagonalization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-the-ground-state">analysis of the ground state</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-gap">energy gap</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overlap-with-asymptotic-wavefunctions">overlap with asymptotic wavefunctions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#magnetization">magnetization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlations">correlations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">reduced density matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#entropy-of-entanglement">entropy of entanglement</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-gates-and-quantum-computing">Quantum Gates and Quantum Computing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions-of-quantum-gates">definitions of quantum gates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-qubit-gates">single-qubit gates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-qubit-gates">two-qubit gates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#three-qubit-gates">three-qubit gates</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-circuit">a simple circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-fourier-transform">Quantum Fourier Transform</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-phase-estimation">Quantum phase estimation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#particle-in-a-1d-gravity-well">particle in a 1D gravity well</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analytic-calculation">analytic calculation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-setup">system setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basis-set">basis set</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-i-momentum-basis">numerical solution (I): momentum basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-ii-mixed-basis">numerical solution (II): mixed basis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wigner-distribution">Wigner distribution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#wigner-quasi-probability-distribution">Wigner quasi-probability distribution</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">definitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting">plotting</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamics-of-a-particle-moving-in-a-1d-potential-split-step-method">dynamics of a particle moving in a 1D potential: split-step method</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">system setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exact-propagation">exact propagation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-step-propagation">split-step propagation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-wavefunction">initial wavefunction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependent-density">time-dependent density</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-step-propagation-with-a-time-dependent-potential">split-step propagation with a time-dependent potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-step-propagation-with-a-time-dependent-potential-and-with-nonlinear-interaction">split-step propagation with a time-dependent potential and with nonlinear interaction</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonny, assisted by Tom
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>