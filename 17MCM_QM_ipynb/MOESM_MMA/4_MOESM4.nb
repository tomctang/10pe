(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30621,        769]
NotebookOptionsPosition[     27785,        720]
NotebookOutlinePosition[     28138,        736]
CellTagsIndexPosition[     28095,        733]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "This Mathematica code is part of the lecture script ",
 StyleBox["Introduction to Computational Quantum Mechanics",
  FontSlant->"Italic"],
 " by Roman Schmied. It is licensed under a ",
 ButtonBox["Creative Commons Attribution-ShareAlike 4.0 International License",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://creativecommons.org/licenses/by-sa/4.0/"], None},
  ButtonNote->"http://creativecommons.org/licenses/by-sa/4.0/"],
 "."
}], "Text",
 CellChangeTimes->{{3.669434091682116*^9, 3.669434147842166*^9}, {
  3.669435842013185*^9, 3.669435866952169*^9}, {3.669435915352921*^9, 
  3.669435921977655*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1: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
yoV9Oe0/TXxfaElz99px38MJ1qr/AASW71I=
    "], {{0, 31}, {88, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{88, 31},
  PlotRange->{{0, 88}, {0, 31}}]], "Text",
 CellChangeTimes->{3.669607172458665*^9}],

Cell[TextData[{
 "You can download the associated lecture script at ",
 ButtonBox["http://arxiv.org/abs/1403.7050",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://arxiv.org/abs/1403.7050"], None},
  ButtonNote->"http://arxiv.org/abs/1403.7050"]
}], "Text",
 CellChangeTimes->{{3.669434151914299*^9, 3.669434159778274*^9}, {
  3.669435746836981*^9, 3.669435760656741*^9}, {3.669435890511055*^9, 
  3.6694358923333282`*^9}, {3.682242719652669*^9, 3.6822427205773983`*^9}}],

Cell[CellGroupData[{

Cell["\<\
imaginary-time propagation for finding the ground state of the non-linear \
Schr\[ODoubleDot]dinger equation\
\>", "Title",
 CellChangeTimes->{{3.669356489273039*^9, 3.669356492332947*^9}, {
  3.672571380907549*^9, 3.6725713873462048`*^9}, {3.682678290678982*^9, 
  3.68267833186395*^9}, {3.682764418521792*^9, 3.682764435924129*^9}, {
  3.751372055285282*^9, 
  3.751372055540255*^9}},ExpressionUUID->"40fecad3-1358-40e8-a0e8-\
b8c82420394a"],

Cell[CellGroupData[{

Cell["units", "Subsection",
 CellChangeTimes->{{3.735577582186695*^9, 
  3.735577582608306*^9}},ExpressionUUID->"cff6192d-b56f-4f92-8680-\
54777f6a30d1"],

Cell["we use natural units for simplicity:", "Text",
 CellChangeTimes->{{3.735577584023155*^9, 
  3.735577602680982*^9}},ExpressionUUID->"0e1e061c-b49d-41b6-9ec6-\
dab153b1b877"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"\[HBar]", "=", 
    RowBox[{"g", "=", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735577590355571*^9, 3.735577592584391*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"68f259ee-c10d-484d-8e8f-8e4edd9d4782"],

Cell["Other unit systems can be defined here.", "Text",
 CellChangeTimes->{{3.735577840461472*^9, 
  3.7355778546570187`*^9}},ExpressionUUID->"c8b14e43-4251-40e7-ba85-\
e997282fa3b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["system setup", "Subsection",
 CellChangeTimes->{{3.68267845722009*^9, 
  3.6826784815236273`*^9}},ExpressionUUID->"7f3aaceb-989a-45ed-9ece-\
8736b4d2bb58"],

Cell["basis set size:", "Text",
 CellChangeTimes->{{3.682678482763608*^9, 
  3.6826784847316732`*^9}},ExpressionUUID->"47a935ae-45ff-400b-86fb-\
79b9101284dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nmax", "=", "1000"}], ";"}]], "Input",
 CellChangeTimes->{{3.682678485416091*^9, 3.68267848673153*^9}, 
   3.6826848702035227`*^9, 3.682757181910033*^9, {3.7336553478537083`*^9, 
   3.733655367241531*^9}, 3.735145026417994*^9, 3.735145968587099*^9, 
   3.735794583482712*^9, 3.735797457683577*^9, 3.7359244176237698`*^9, 
   3.735924660422327*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"47513bfc-b842-40a6-8ce4-556a1810fbd1"],

Cell["computational grid:", "Text",
 CellChangeTimes->{{3.73514366444119*^9, 
  3.735143670701551*^9}},ExpressionUUID->"fc2455e9-7cf9-486b-a004-\
a94eda5580b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "=", 
   FractionBox["a", 
    RowBox[{"nmax", "+", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xgrid", "=", 
   RowBox[{
    RowBox[{"Range", "[", "nmax", "]"}], "*", "\[CapitalDelta]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.735143671247781*^9, 3.7351436852512712`*^9}, 
   3.7351438031821404`*^9, {3.7351439704463377`*^9, 3.7351439706387987`*^9}, 
   3.7351450242437563`*^9, 3.735145967325892*^9, {3.735146139901506*^9, 
   3.735146140116096*^9}, {3.735147431364602*^9, 3.7351474315550013`*^9}, {
   3.7358228819363537`*^9, 3.735822882062357*^9}, {3.735822940269156*^9, 
   3.7358229404997473`*^9}, {3.7359237941890993`*^9, 3.735923794338772*^9}, 
   3.7513730194213552`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"f9f8e633-aab4-4bd0-9bf9-f068c6226e26"],

Cell[TextData[{
 "potential: gravity well with potential ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", "x", ")"}], "=", 
    RowBox[{"m", " ", "g", " ", "x"}]}], TraditionalForm]],ExpressionUUID->
  "04593b68-c2f1-4f91-8106-a9a956cf0336"]
}], "Text",
 CellChangeTimes->{{3.682678491243311*^9, 3.682678492619259*^9}, {
  3.734863460541471*^9, 3.734863466946596*^9}, {3.734870063307316*^9, 
  3.7348700772014713`*^9}, {3.7351436248258467`*^9, 3.735143633199037*^9}, {
  3.7356431206909943`*^9, 
  3.735643124031644*^9}},ExpressionUUID->"416d0fd2-cad8-4e87-81f5-\
aa517324cca8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", "x_", "]"}], "=", 
   RowBox[{"m", "*", "g", "*", "x"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Wgrid", "=", 
   RowBox[{"W", "/@", "xgrid"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.734870096232786*^9, 3.734870152825303*^9}, {
   3.73514364005796*^9, 3.735143642592679*^9}, 3.735143989405788*^9, {
   3.73564312639193*^9, 3.735643127189596*^9}, {3.735643212570636*^9, 
   3.7356432135437603`*^9}, {3.7513730202029743`*^9, 3.751373020835803*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"a37e1dec-4d9f-4d24-b6ae-16e3549827ff"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ground-state calculation", "Subsection",
 CellChangeTimes->{{3.6827645770914087`*^9, 
  3.682764580994*^9}},ExpressionUUID->"e16d5539-679b-43d1-bf79-647be44101ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"groundstate", "[", 
   RowBox[{
    RowBox[{"\[Delta]\[Beta]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[Kappa]_", "?", "NumericQ"}], ",", 
    RowBox[{"tolerance_:", 
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Ke", ",", "propKin", ",", "propPot2", ",", "prop", ",", "v0", ",", 
      "\[Gamma]", ",", "Ekin", ",", "Epot", ",", "Eint", ",", "Etot", ",", 
      "\[Mu]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "compute", " ", "the", " ", "diagonal", " ", "elements", " ", "of", " ", 
      
      RowBox[{"exp", "[", 
       RowBox[{
        RowBox[{"-", "\[Delta]\[Beta]"}], "*", "T"}], "]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ke", "=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "\[Delta]\[Beta]"}], "*", 
         SuperscriptBox[
          RowBox[{"Range", "[", "nmax", "]"}], "2"], "*", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[Pi]", "2"], 
           SuperscriptBox["\[HBar]", "2"]}], 
          RowBox[{"2", "m", " ", 
           SuperscriptBox["a", "2"]}]]}], "]"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "propagate", " ", "by", " ", "a", " ", "full", " ", "imaginary"}], "-",
        "time", "-", 
       RowBox[{"step", " ", "with", " ", "T"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"propKin", "[", "v_", "]"}], ":=", 
      RowBox[{"Normalize", "[", 
       RowBox[{"FourierDST", "[", 
        RowBox[{
         RowBox[{"Ke", "*", 
          RowBox[{"FourierDST", "[", 
           RowBox[{"v", ",", "1"}], "]"}]}], ",", "1"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "propagate", " ", "by", " ", "a", " ", "half", " ", "imaginary"}], "-",
        "time", "-", 
       RowBox[{"step", " ", "with", " ", "V"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"propPot2", "[", "v_", "]"}], ":=", 
      RowBox[{"Normalize", "[", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["\[Delta]\[Beta]", "2"]}], "*", 
          RowBox[{"(", 
           RowBox[{"Wgrid", "+", 
            RowBox[{"\[Kappa]", "*", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Abs", "[", "v", "]"}], "2"], "/", 
              "\[CapitalDelta]"}]}]}], ")"}]}], "]"}], "*", "v"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "propagate", " ", "by", " ", "a", " ", "full", " ", "imaginary"}], "-",
        "time", "-", 
       RowBox[{"step", " ", "by"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"H", "=", 
       RowBox[{"T", "+", 
        RowBox[{
        "V", " ", "using", " ", "the", " ", "Trotter", " ", 
         "approximation"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"prop", "[", "v_", "]"}], ":=", 
      RowBox[{"propPot2", "[", 
       RowBox[{"propKin", "[", 
        RowBox[{"propPot2", "[", "v", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"random", " ", "starting", " ", "point"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"v0", "=", 
      RowBox[{"Normalize", "@", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", "]"}], ",", "nmax"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "propagation", " ", "to", " ", "the", " ", "ground", " ", "state"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Gamma]", "=", 
      RowBox[{"FixedPoint", "[", 
       RowBox[{"prop", ",", "v0", ",", 
        RowBox[{"SameTest", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"v1", ",", "v2"}], "}"}], ",", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"v1", "-", "v2"}], "]"}], "<", "tolerance"}]}], 
          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"energy", " ", "components"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Ekin", "=", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[Pi]", "2"], 
         SuperscriptBox["\[HBar]", "2"]}], 
        RowBox[{"2", "m", " ", 
         SuperscriptBox["a", "2"]}]], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Range", "[", "nmax", "]"}], "2"], ".", 
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{"FourierDST", "[", 
           RowBox[{"\[Gamma]", ",", "1"}], "]"}], "]"}], "2"]}]}]}], ";", " ", 
     RowBox[{"(*", " ", "kinetic", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Epot", "=", 
      RowBox[{"Wgrid", ".", 
       SuperscriptBox[
        RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"]}]}], ";", " ", 
     RowBox[{"(*", " ", "potential", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Eint", "=", 
      RowBox[{
       FractionBox["\[Kappa]", 
        RowBox[{"2", "\[CapitalDelta]"}]], 
       RowBox[{"Total", "[", 
        SuperscriptBox[
         RowBox[{"Abs", "[", "\[Gamma]", "]"}], "4"], "]"}]}]}], ";", " ", 
     RowBox[{"(*", " ", "interaction", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"total", " ", "energy"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Etot", "=", 
      RowBox[{"Ekin", "+", "Epot", "+", "Eint"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"chemical", " ", "potential"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{"Ekin", "+", "Epot", "+", 
       RowBox[{"2", "Eint"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"return", " ", "energy"}], ",", " ", 
       RowBox[{"chemical", " ", "potential"}], ",", " ", 
       RowBox[{
        RowBox[{"and", " ", "ground"}], "-", 
        RowBox[{"state", " ", "coefficients"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Etot", ",", "\[Mu]", ",", "\[Gamma]"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.682764441950457*^9, 3.682764561161796*^9}, {
   3.682764601032049*^9, 3.6827646474274197`*^9}, {3.6827646779994164`*^9, 
   3.6827647453149652`*^9}, {3.682764805750387*^9, 3.6827648911267643`*^9}, {
   3.682764954814046*^9, 3.682765072118578*^9}, 3.682765805174741*^9, {
   3.682848895615068*^9, 3.6828490239085693`*^9}, {3.682849869820217*^9, 
   3.68284987744656*^9}, {3.6833723311799583`*^9, 3.683372347788813*^9}, {
   3.684057747198338*^9, 3.684057747513299*^9}, {3.6840577811953087`*^9, 
   3.6840578614196243`*^9}, 3.684059844784484*^9, {3.6840599202393513`*^9, 
   3.68405992821877*^9}, {3.684060354821858*^9, 3.684060356158882*^9}, {
   3.70341799655107*^9, 3.703417999390106*^9}, {3.73365761143338*^9, 
   3.733657652839747*^9}, {3.7359238114689903`*^9, 3.7359238400513067`*^9}, {
   3.7359238743748827`*^9, 3.735923894961347*^9}, {3.751373022074173*^9, 
   3.7513730231058903`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"69688f65-8e4b-4a3d-8181-286c4af1d09b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["calculations", "Subsection",
 CellChangeTimes->{{3.684060528507798*^9, 
  3.684060529665615*^9}},ExpressionUUID->"a91bbc54-1073-4df4-b7c7-\
d4d0411d1bc5"],

Cell["ground-state density for repulsive interactions:", "Text",
 CellChangeTimes->{{3.682765160373715*^9, 
  3.68276517104887*^9}},ExpressionUUID->"7392a106-ffcc-4b0a-b2e9-\
de12c1fc57e2"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"15", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"g", " ", 
           SuperscriptBox["\[HBar]", "4"]}], "m"], ")"}], 
        FractionBox["1", "3"]]}]}], ",", 
     RowBox[{"\[Delta]\[Beta]", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Etot", ",", "\[Mu]", ",", "\[Gamma]"}], "}"}], "=", 
     RowBox[{"groundstate", "[", 
      RowBox[{"\[Delta]\[Beta]", ",", "\[Kappa]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xgrid", ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"], "/", 
            "\[CapitalDelta]"}]}], "}"}], "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Etot", ",", "\[Mu]"}], "}"}]}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.682765175237936*^9, 3.682765238775673*^9}, {
   3.682766487895481*^9, 3.682766487985042*^9}, {3.682766756411784*^9, 
   3.682766763184895*^9}, {3.682849031963826*^9, 3.6828490393307467`*^9}, {
   3.683372429134417*^9, 3.683372438988524*^9}, {3.735923907553741*^9, 
   3.7359239174696207`*^9}, {3.735924087871704*^9, 3.7359240900357113`*^9}, {
   3.73592449975198*^9, 3.73592448944632*^9}, {3.735924580091707*^9, 
   3.735924590307501*^9}, {3.7359246569144*^9, 3.735924657358375*^9}, {
   3.7359246972564783`*^9, 3.735924706523806*^9}, 3.75137302398806*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"75088270-1ba8-4739-bc04-8b8a2d0c86ca"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"3", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"g", " ", 
           SuperscriptBox["\[HBar]", "4"]}], "m"], ")"}], 
        FractionBox["1", "3"]]}]}], ",", 
     RowBox[{"\[Delta]\[Beta]", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Etot", ",", "\[Mu]", ",", "\[Gamma]"}], "}"}], "=", 
     RowBox[{"groundstate", "[", 
      RowBox[{"\[Delta]\[Beta]", ",", "\[Kappa]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xgrid", ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"], "/", 
            "\[CapitalDelta]"}]}], "}"}], "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Etot", ",", "\[Mu]"}], "}"}]}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.682765175237936*^9, 3.682765238775673*^9}, {
   3.682766487895481*^9, 3.682766487985042*^9}, {3.682766756411784*^9, 
   3.682766763184895*^9}, {3.682849031963826*^9, 3.6828490393307467`*^9}, {
   3.683372429134417*^9, 3.683372438988524*^9}, {3.735923907553741*^9, 
   3.7359239174696207`*^9}, {3.735924087871704*^9, 3.7359240900357113`*^9}, {
   3.73592449975198*^9, 3.73592448944632*^9}, {3.735924580091707*^9, 
   3.735924590307501*^9}, {3.7359246569144*^9, 3.735924657358375*^9}, {
   3.7359246972564783`*^9, 3.735924706523806*^9}, {3.73596243603734*^9, 
   3.735962439590227*^9}, 3.7513730247221127`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"2ba507d7-e82c-4701-99cb-1bfe390d8f7f"],

Cell["ground-state density for no interactions:", "Text",
 CellChangeTimes->{{3.682765160373715*^9, 3.68276517104887*^9}, {
  3.682849060223571*^9, 
  3.682849061414551*^9}},ExpressionUUID->"feb31b84-4dba-4397-965f-\
86a89d31d888"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"0", "*", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"g", " ", 
           SuperscriptBox["\[HBar]", "4"]}], "m"], ")"}], 
        FractionBox["1", "3"]]}]}], ",", 
     RowBox[{"\[Delta]\[Beta]", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Etot", ",", "\[Mu]", ",", "\[Gamma]"}], "}"}], "=", 
     RowBox[{"groundstate", "[", 
      RowBox[{"\[Delta]\[Beta]", ",", "\[Kappa]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xgrid", ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"], "/", 
            "\[CapitalDelta]"}]}], "}"}], "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Etot", ",", "\[Mu]"}], "}"}]}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.682765175237936*^9, 3.682765238775673*^9}, {
   3.682766487895481*^9, 3.682766487985042*^9}, {3.682766756411784*^9, 
   3.682766763184895*^9}, {3.682849031963826*^9, 3.6828490393307467`*^9}, {
   3.683372429134417*^9, 3.683372438988524*^9}, {3.735923907553741*^9, 
   3.7359239174696207`*^9}, {3.735924087871704*^9, 3.7359240900357113`*^9}, {
   3.73592449975198*^9, 3.73592448944632*^9}, {3.735924580091707*^9, 
   3.735924590307501*^9}, {3.7359246569144*^9, 3.735924672237504*^9}, 
   3.735924712718996*^9, 
   3.751373025440488*^9},ExpressionUUID->"155d6785-b2ef-4779-8661-\
9489322888d6"],

Cell["ground-state density for attractive interactions:", "Text",
 CellChangeTimes->{{3.682765160373715*^9, 3.68276517104887*^9}, {
  3.682765245704303*^9, 
  3.682765248573104*^9}},ExpressionUUID->"1eee447b-a4fb-435f-a331-\
fd2be9de1c86"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "=", 
      RowBox[{
       RowBox[{"-", "3"}], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"g", " ", 
           SuperscriptBox["\[HBar]", "4"]}], "m"], ")"}], 
        FractionBox["1", "3"]]}]}], ",", 
     RowBox[{"\[Delta]\[Beta]", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Etot", ",", "\[Mu]", ",", "\[Gamma]"}], "}"}], "=", 
     RowBox[{"groundstate", "[", 
      RowBox[{"\[Delta]\[Beta]", ",", "\[Kappa]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xgrid", ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"], "/", 
            "\[CapitalDelta]"}]}], "}"}], "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Etot", ",", "\[Mu]"}], "}"}]}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.682765175237936*^9, 3.682765238775673*^9}, {
   3.682766487895481*^9, 3.682766487985042*^9}, {3.682766756411784*^9, 
   3.682766763184895*^9}, {3.682849031963826*^9, 3.6828490393307467`*^9}, {
   3.683372429134417*^9, 3.683372438988524*^9}, {3.735923907553741*^9, 
   3.7359239174696207`*^9}, {3.735924087871704*^9, 3.7359240900357113`*^9}, {
   3.73592449975198*^9, 3.73592448944632*^9}, {3.735924580091707*^9, 
   3.735924590307501*^9}, {3.7359246569144*^9, 3.7359246693701153`*^9}, 
   3.735924714726701*^9, 3.735962447299488*^9, 
   3.7513730260745077`*^9},ExpressionUUID->"98d06f98-1080-4098-9048-\
f1c707c50104"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "=", 
      RowBox[{
       RowBox[{"-", "15"}], "*", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"g", " ", 
           SuperscriptBox["\[HBar]", "4"]}], "m"], ")"}], 
        FractionBox["1", "3"]]}]}], ",", 
     RowBox[{"\[Delta]\[Beta]", "=", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Etot", ",", "\[Mu]", ",", "\[Gamma]"}], "}"}], "=", 
     RowBox[{"groundstate", "[", 
      RowBox[{"\[Delta]\[Beta]", ",", "\[Kappa]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xgrid", ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Abs", "[", "\[Gamma]", "]"}], "2"], "/", 
            "\[CapitalDelta]"}]}], "}"}], "\[Transpose]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"a", ",", "0"}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Etot", ",", "\[Mu]"}], "}"}]}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.682765175237936*^9, 3.682765238775673*^9}, {
   3.682766487895481*^9, 3.682766487985042*^9}, {3.682766756411784*^9, 
   3.682766763184895*^9}, {3.682849031963826*^9, 3.6828490393307467`*^9}, {
   3.683372429134417*^9, 3.683372438988524*^9}, {3.735923907553741*^9, 
   3.7359239174696207`*^9}, {3.735924087871704*^9, 3.7359240900357113`*^9}, {
   3.73592449975198*^9, 3.73592448944632*^9}, {3.735924580091707*^9, 
   3.735924590307501*^9}, {3.7359246569144*^9, 3.7359246693701153`*^9}, 
   3.735924714726701*^9, 
   3.751373026941078*^9},ExpressionUUID->"e7c47246-f886-4655-97ac-\
a59c5642ddde"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 778},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 638, 14, 58, "Text",ExpressionUUID->"c5e0a17f-60bd-4915-ace4-a70943a7ea05"],
Cell[1199, 36, 2633, 48, 46, "Text",ExpressionUUID->"2438a101-bb30-42fe-9131-27a476c317eb"],
Cell[3835, 86, 481, 10, 35, "Text",ExpressionUUID->"547ba051-1c08-434a-8df9-2e774b7f7c59"],
Cell[CellGroupData[{
Cell[4341, 100, 453, 9, 160, "Title",ExpressionUUID->"40fecad3-1358-40e8-a0e8-b8c82420394a"],
Cell[CellGroupData[{
Cell[4819, 113, 153, 3, 54, "Subsection",ExpressionUUID->"cff6192d-b56f-4f92-8680-54777f6a30d1"],
Cell[4975, 118, 178, 3, 35, "Text",ExpressionUUID->"0e1e061c-b49d-41b6-9ec6-dab153b1b877"],
Cell[5156, 123, 266, 6, 30, "Input",ExpressionUUID->"68f259ee-c10d-484d-8e8f-8e4edd9d4782"],
Cell[5425, 131, 183, 3, 35, "Text",ExpressionUUID->"c8b14e43-4251-40e7-ba85-e997282fa3b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5645, 139, 161, 3, 54, "Subsection",ExpressionUUID->"7f3aaceb-989a-45ed-9ece-8736b4d2bb58"],
Cell[5809, 144, 159, 3, 35, "Text",ExpressionUUID->"47a935ae-45ff-400b-86fb-79b9101284dd"],
Cell[5971, 149, 460, 8, 30, "Input",ExpressionUUID->"47513bfc-b842-40a6-8ce4-556a1810fbd1"],
Cell[6434, 159, 160, 3, 35, "Text",ExpressionUUID->"fc2455e9-7cf9-486b-a004-a94eda5580b9"],
Cell[6597, 164, 904, 19, 89, "Input",ExpressionUUID->"f9f8e633-aab4-4bd0-9bf9-f068c6226e26"],
Cell[7504, 185, 592, 14, 35, "Text",ExpressionUUID->"416d0fd2-cad8-4e87-81f5-aa517324cca8"],
Cell[8099, 201, 581, 12, 52, "Input",ExpressionUUID->"a37e1dec-4d9f-4d24-b6ae-16e3549827ff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8717, 218, 169, 2, 54, "Subsection",ExpressionUUID->"e16d5539-679b-43d1-bf79-647be44101ef"],
Cell[8889, 222, 7445, 188, 608, "Input",ExpressionUUID->"69688f65-8e4b-4a3d-8181-286c4af1d09b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16371, 415, 160, 3, 54, "Subsection",ExpressionUUID->"a91bbc54-1073-4df4-b7c7-d4d0411d1bc5"],
Cell[16534, 420, 189, 3, 35, "Text",ExpressionUUID->"7392a106-ffcc-4b0a-b2e9-de12c1fc57e2"],
Cell[16726, 425, 2109, 53, 110, "Input",ExpressionUUID->"75088270-1ba8-4739-bc04-8b8a2d0c86ca"],
Cell[18838, 480, 2161, 54, 110, "Input",ExpressionUUID->"2ba507d7-e82c-4701-99cb-1bfe390d8f7f"],
Cell[21002, 536, 231, 4, 35, "Text",ExpressionUUID->"feb31b84-4dba-4397-965f-86a89d31d888"],
Cell[21236, 542, 2066, 54, 110, "Input",ExpressionUUID->"155d6785-b2ef-4779-8661-9489322888d6"],
Cell[23305, 598, 239, 4, 35, "Text",ExpressionUUID->"1eee447b-a4fb-435f-a331-fd2be9de1c86"],
Cell[23547, 604, 2115, 55, 110, "Input",ExpressionUUID->"98d06f98-1080-4098-9048-f1c707c50104"],
Cell[25665, 661, 2092, 55, 110, "Input",ExpressionUUID->"e7c47246-f886-4655-97ac-a59c5642ddde"]
}, Open  ]]
}, Open  ]]
}
]
*)

