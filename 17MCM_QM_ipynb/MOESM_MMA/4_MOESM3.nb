(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63232,       1538]
NotebookOptionsPosition[     58898,       1467]
NotebookOutlinePosition[     59251,       1483]
CellTagsIndexPosition[     59208,       1480]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "This Mathematica code is part of the lecture script ",
 StyleBox["Introduction to Computational Quantum Mechanics",
  FontSlant->"Italic"],
 " by Roman Schmied. It is licensed under a ",
 ButtonBox["Creative Commons Attribution-ShareAlike 4.0 International License",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://creativecommons.org/licenses/by-sa/4.0/"], None},
  ButtonNote->"http://creativecommons.org/licenses/by-sa/4.0/"],
 "."
}], "Text",
 CellChangeTimes->{{3.669434091682116*^9, 3.669434147842166*^9}, {
  3.669435842013185*^9, 3.669435866952169*^9}, {3.669435915352921*^9, 
  3.669435921977655*^9}},ExpressionUUID->"fcfaf95e-7c4c-43a3-b1ff-\
3d86e6de8f76"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztWltPXFUUJuqDMSnhnYdiJCmYYKimXl5aTH3xDWtMfKlCFRuThhJobEgw
IqGaRiMhGKwmgE3f5DLcBpgLzMDMMHdmhpa+0oSH+kb4Bcv97cM63edw5nLm
UlrsShac2Ze1z/n22t9ae5/z+pXrl755qaqqqudV8edS+80Pu7vbez+tET8+
6+z59mpnx9cfd97ouNrR/f6Vl0XhaaGfC31FKBFV498LrYhW8bXTvUjL3iVy
ra2Qd91Da4E1Wg/5KRAJ0GYsRJFEmKLJKMW3YpRIxSmRTmgqruOpGMVEHdqg
bVD0QV+fsAFbrjWXtI0xFlbmaW55lmadDppZnKbphSmpU/OTNDn3z4lRFWfG
1u1z0eqGl/xBHwXCGxKraDIi8dvKJCl9P0WZB2na3tmm+w81xXXmQUbWoU1c
4I0+6Asb/pBP2oRtM8YO54yOMfA9qRgbsBV+B/8Lx8PSV4EZMB28NUgXP7pI
p6pPHVkHKEPd4E+Dsu3W9pacE/hzMBqUvry6sWrAeH5ljmaXHBrGC9N5fbi3
r5caGxuPjI0y1JWKRSXssw1wgootcEmk49Inh0eGqba2tmDOQdvh34dlX/AH
fDmkY+zVuWLRtUDzyxrGuXx45M4INTQ26PZbWlqoq6tLKq65HG3Q1i4GlbTP
fcGR4IQn2CakH7Z+0mrArqamhtra2qi/v598Pp9UXKMMdWpb9A2GA5TMaBjD
j8EVGh+v0JLHaeQJCx+euDdO1dXVmr3WVtrd3SWzoAx1aIO2djCotH3GArEM
XAlOgN+asQV2wHF/f//I+KpMTEwYcMacA2PMF+YNYyDmefxuWlld1njCwof5
/tivMH+qsH3z2Dxmoc9vZX9vb48i4bBUXJdin+8TaxfxCHyLda1i29zcbDmv
2QRzgD6qH8Mm+BhjPOEJxYeXhA8vzhg4ApzHfvVwZycvvhD2s0L40sr+vbt3
6Y3TdQZ1u1xF2VfxDUheiMhYBr5Vsc3ns4VgDD5GzJM8IcbyBTUfljzs1niY
OYLx5VhjZ27RlmNSvmc324e/As8L731AX33ZTt/13NAxHh4asm1fxVf6rvAv
8ALHMqzzVCplG1sVY+YK2IRt5G7sw951zYfVXELlCI41ZsFa5vs28waEY1Ih
z872Dw4OaGL0L4nlbz//otsaHxuTZWeb3rJtX8UX3JgUvoscjMvAt6UKcxYU
uRvWB/Pw2mG+pnKEGV/EcLOY8xWzoE+h+LJ94FtfXy+xbGho0G2Bf9mH/338
2JZ9FV/sy1KCI5HDsu+qvIA8AdyDuYOq2Jvrhg7XEgv7MGyDh7HPO8IRIleT
eYTCwU8TX4jT6aSmpib5PFb4Ptp9VDS+iGtYv7x3UNcdxrPKc4Glw+GwrFP7
83qGbezzwEOhw1zN4/fIPAIczHnacfADBHEM8S0aiehlU5OTOr527av44gxh
eyej/1Z9kONUXV2d5HfgjWusfa7jHAN4cx2LyhHYSycMHOwx5GkqvrniWzbf
LSW+MddCB38ckPrmmTPy953RP2zbN+Arcl6cJfBvdY3k4uNCuFr1f4yBXHgz
tpkXXzV/KhTfYvMzFmBqzs86r12T/GzX/rOOL+7Pzv6CebHU/UU8Fpe8AFXz
7mLs2+UHxDzkbLgGpio/mOtYiuUH3N9J2R/nim+5Ylgh8Y3nXYtvaTlWIfFN
xUA9f8Fcwj7sqnuYYs93KmnfnJ/xvhg5lXmNZ8vPgDGXm+sg8Gc1P4sq+Znb
lz0/s+LL5/V8kvcX6t7YnMcWI9n2FxuH+wucVfL+ItsZz/Os/OyhqPX+2M7e
3yyl7o+PG5ty4que74z/PWbgorKc74h1Ads438FYfEapnrObz3eOG5ty4gvt
+6FPP5+8/MVlA8Z2znng85bnk8L2wK0By3j4f9Gu7usyf0oXcb6OOrRRz9fP
vXtO8gLya8zfcT/fs6DfCxywBwDGqh8zznbeDwHbpLA1+udoSfekilpmblOJ
MUq1mxXjlPZ+E3xs+/3mCL/fjJeMrRk7q+tyYFvomOVScIX6fh6Y5Xs/j/cU
8v08voMQfcvFCVa+Ve5nz+a7lfJh6NvvnCXHvEPmbsiPU/r3JRnl+5KMLFO/
L5ldcND5C+fLdh+V5IVsY1Xaf1UFVrd/vU1ev1f5PupQ8X2UKEMd2pQTVytf
yoV9Oe0/TXxfaElz99px38MJ1qr/AASW71I=
    "], {{0, 31}, {88, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{88, 31},
  PlotRange->{{0, 88}, {0, 31}}]], "Text",
 CellChangeTimes->{
  3.669607172458665*^9},ExpressionUUID->"fd2d35df-1a38-4fca-89a9-\
57b4ac3dcb76"],

Cell[TextData[{
 "You can download the associated lecture script at ",
 ButtonBox["http://arxiv.org/abs/1403.7050",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://arxiv.org/abs/1403.7050"], None},
  ButtonNote->"http://arxiv.org/abs/1403.7050"]
}], "Text",
 CellChangeTimes->{{3.669434151914299*^9, 3.669434159778274*^9}, {
  3.669435746836981*^9, 3.669435760656741*^9}, {3.669435890511055*^9, 
  3.6694358923333282`*^9}, {3.682242719652669*^9, 
  3.6822427205773983`*^9}},ExpressionUUID->"77236a05-5474-4e22-bbd9-\
20965ebaa9c9"],

Cell[CellGroupData[{

Cell["\<\
dynamics of a particle moving in a 1D potential: split-step method\
\>", "Title",
 CellChangeTimes->{{3.669356489273039*^9, 3.669356492332947*^9}, {
  3.672571380907549*^9, 3.6725713873462048`*^9}, {3.682678290678982*^9, 
  3.68267833186395*^9}, {3.75137206134417*^9, 
  3.751372061542053*^9}},ExpressionUUID->"75490168-ae7d-40b1-b333-\
83cf4566235a"],

Cell[CellGroupData[{

Cell["units", "Subsection",
 CellChangeTimes->{{3.735577582186695*^9, 
  3.735577582608306*^9}},ExpressionUUID->"3f2fef13-c5f9-4b91-9673-\
0355f155b3ad"],

Cell["we use natural units for simplicity:", "Text",
 CellChangeTimes->{{3.735577584023155*^9, 
  3.735577602680982*^9}},ExpressionUUID->"b66f345d-0637-4472-b806-\
1071313c5761"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"\[HBar]", "=", 
    RowBox[{"g", "=", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735577590355571*^9, 3.735577592584391*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"2da02cd0-ec79-4e98-90d3-a127ea9b9bd5"],

Cell["Other unit systems can be defined here.", "Text",
 CellChangeTimes->{{3.735577840461472*^9, 
  3.7355778546570187`*^9}},ExpressionUUID->"fee92125-d943-4fda-b6a9-\
f8c88d382b1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["system setup", "Subsection",
 CellChangeTimes->{{3.68267845722009*^9, 
  3.6826784815236273`*^9}},ExpressionUUID->"d44117bb-e72e-43b0-aab3-\
e19c57016670"],

Cell["basis set size:", "Text",
 CellChangeTimes->{{3.682678482763608*^9, 
  3.6826784847316732`*^9}},ExpressionUUID->"7f7e1c21-93ee-4131-a723-\
6f25dba2b147"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nmax", "=", "1000"}], ";"}]], "Input",
 CellChangeTimes->{{3.682678485416091*^9, 3.68267848673153*^9}, 
   3.6826848702035227`*^9, 3.682757181910033*^9, {3.7336553478537083`*^9, 
   3.733655367241531*^9}, 3.735145026417994*^9, 3.735145968587099*^9, 
   3.735794583482712*^9, 3.735797457683577*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"8c2a86a2-6f6f-4f64-92e0-7d00aecd9f61"],

Cell["computational grid:", "Text",
 CellChangeTimes->{{3.73514366444119*^9, 
  3.735143670701551*^9}},ExpressionUUID->"ec9afeb0-6bf7-40a2-b7f7-\
7a9d30ca667e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "=", 
   FractionBox["a", 
    RowBox[{"nmax", "+", "1"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xgrid", "=", 
   RowBox[{
    RowBox[{"Range", "[", "nmax", "]"}], "*", "\[CapitalDelta]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.735143671247781*^9, 3.7351436852512712`*^9}, 
   3.7351438031821404`*^9, {3.7351439704463377`*^9, 3.7351439706387987`*^9}, 
   3.7351450242437563`*^9, 3.735145967325892*^9, {3.735146139901506*^9, 
   3.735146140116096*^9}, {3.735147431364602*^9, 3.7351474315550013`*^9}, {
   3.7358228819363537`*^9, 3.735822882062357*^9}, {3.735822940269156*^9, 
   3.7358229404997473`*^9}, 3.7513730365096827`*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"a84d051f-b1f9-4e75-97f7-2542e20d1683"],

Cell[TextData[{
 "potential: gravity well with potential ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", "x", ")"}], "=", 
    RowBox[{"m", " ", "g", " ", "x"}]}], TraditionalForm]],ExpressionUUID->
  "ca9aff49-22ed-4598-8c2e-5a412b192d07"]
}], "Text",
 CellChangeTimes->{{3.682678491243311*^9, 3.682678492619259*^9}, {
  3.734863460541471*^9, 3.734863466946596*^9}, {3.734870063307316*^9, 
  3.7348700772014713`*^9}, {3.7351436248258467`*^9, 3.735143633199037*^9}, {
  3.7356431206909943`*^9, 
  3.735643124031644*^9}},ExpressionUUID->"7daebace-68ee-4087-a558-\
a1200c3b2f4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", "x_", "]"}], "=", 
   RowBox[{"m", "*", "g", "*", "x"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Wgrid", "=", 
   RowBox[{"W", "/@", "xgrid"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.734870096232786*^9, 3.734870152825303*^9}, {
   3.73514364005796*^9, 3.735143642592679*^9}, 3.735143989405788*^9, {
   3.73564312639193*^9, 3.735643127189596*^9}, {3.735643212570636*^9, 
   3.7356432135437603`*^9}, {3.751373037329967*^9, 3.751373037781103*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"05ee2f44-5ac0-4c07-bf6e-2b8c8011ea3b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["exact propagation", "Subsection",
 CellChangeTimes->{{3.682678451701313*^9, 
  3.682678455676161*^9}},ExpressionUUID->"92a6180e-7c54-4d6a-a934-\
a9288c04dc98"],

Cell["propagation in the position-basis representation:", "Text",
 CellChangeTimes->{{3.733655406631453*^9, 
  3.733655425156996*^9}},ExpressionUUID->"27f5b001-967f-43cc-9aff-\
62ca765cb870"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VP", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{
     RowBox[{"Band", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", "Wgrid"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"TP", "=", 
   RowBox[{"FourierDST", "[", 
    RowBox[{
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"Band", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "]"}], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Range", "[", "nmax", "]"}], "2"], "*", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Pi]", "2"], 
          SuperscriptBox["\[HBar]", "2"]}], 
         RowBox[{"2", "m", " ", 
          SuperscriptBox["a", "2"]}]]}]}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"HP", "=", 
   RowBox[{"TP", "+", "VP"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"propExact", "[", 
   RowBox[{
    RowBox[{"\[CapitalDelta]t_", "?", "NumericQ"}], ",", 
    RowBox[{"v0_", "/;", 
     RowBox[{"VectorQ", "[", 
      RowBox[{"v0", ",", "NumericQ"}], "]"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "I"}], "*", "HP", "*", 
     RowBox[{"N", "[", 
      RowBox[{"\[CapitalDelta]t", "/", "\[HBar]"}], "]"}]}], "]"}], ".", 
   "v0"}]}]}], "Input",
 CellChangeTimes->{{3.6826785497515917`*^9, 3.68267854975263*^9}, {
   3.682678602214789*^9, 3.682678633548527*^9}, {3.68268435399006*^9, 
   3.682684355054474*^9}, {3.683369442892953*^9, 3.683369445244173*^9}, {
   3.697289966212805*^9, 3.697289980688085*^9}, {3.7336553963410473`*^9, 
   3.733655399850733*^9}, {3.733655498104642*^9, 3.733655502710231*^9}, {
   3.733657199287017*^9, 3.7336572003852797`*^9}, {3.7336580085439653`*^9, 
   3.733658012226302*^9}, {3.735143711627637*^9, 3.7351437180366488`*^9}, {
   3.735145550306814*^9, 3.735145567898345*^9}, {3.735381276292894*^9, 
   3.735381313936792*^9}, 3.735381597522464*^9, {3.735643222443812*^9, 
   3.735643225848687*^9}, 3.751373038782528*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"80b80027-ccf6-47ab-8fcc-880cab6159e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["split-step propagation", "Subsection",
 CellChangeTimes->{{3.682678652277269*^9, 
  3.682678657756053*^9}},ExpressionUUID->"760fd0c1-31aa-4182-9726-\
53f3ad5322dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"propApprox", "[", 
   RowBox[{
    RowBox[{"\[CapitalDelta]t_", "?", "NumericQ"}], ",", 
    RowBox[{"M_Integer", "/;", 
     RowBox[{"M", "\[GreaterEqual]", "1"}]}], ",", 
    RowBox[{"v0_", "/;", 
     RowBox[{"VectorQ", "[", 
      RowBox[{"v0", ",", "NumericQ"}], "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Lambda]", ",", "Ke", ",", "Pe2", ",", "propKin", ",", "propPot2", ",",
       "prop"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"compute", " ", "the", " ", "\[Lambda]", " ", "constant"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{
       RowBox[{"-", "I"}], "*", 
       RowBox[{"N", "[", 
        FractionBox["\[CapitalDelta]t", 
         RowBox[{"M", "*", "\[HBar]"}]], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "compute", " ", "the", " ", "diagonal", " ", "elements", " ", "of", " ", 
       RowBox[{"exp", "[", 
        RowBox[{"\[Lambda]", "*", "T"}], "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Ke", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{"\[Lambda]", "*", 
        SuperscriptBox[
         RowBox[{"Range", "[", "nmax", "]"}], "2"], "*", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Pi]", "2"], 
          SuperscriptBox["\[HBar]", "2"]}], 
         RowBox[{"2", "m", " ", 
          SuperscriptBox["a", "2"]}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"propagate", " ", "by", " ", "a", " ", "full", " ", "time"}], 
       "-", 
       RowBox[{"step", " ", "with", " ", "T"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"propKin", "[", "v_", "]"}], ":=", 
      RowBox[{"FourierDST", "[", 
       RowBox[{
        RowBox[{"Ke", "*", 
         RowBox[{"FourierDST", "[", 
          RowBox[{"v", ",", "1"}], "]"}]}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "compute", " ", "the", " ", "diagonal", " ", "elements", " ", "of", " ", 
       RowBox[{"exp", "[", 
        RowBox[{"\[Lambda]", "*", 
         RowBox[{"V", "/", "2"}]}], "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Pe2", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{
        FractionBox["\[Lambda]", "2"], "*", "Wgrid"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"propagate", " ", "by", " ", "a", " ", "half", " ", "time"}], 
       "-", 
       RowBox[{"step", " ", "with", " ", "V"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"propPot2", "[", "v_", "]"}], ":=", 
      RowBox[{"Pe2", "*", "v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "propagate", " ", "by", " ", "a", " ", "full", " ", "time", " ", 
        "step", " ", "by", " ", "H"}], "=", 
       RowBox[{"T", "+", 
        RowBox[{
        "V", " ", "using", " ", "the", " ", "Trotter", " ", 
         "approximation"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"prop", "[", "v_", "]"}], ":=", 
      RowBox[{"propPot2", "[", 
       RowBox[{"propKin", "[", 
        RowBox[{"propPot2", "[", "v", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"step", "-", "by", "-", 
       RowBox[{"step", " ", "propagation"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "M"}], "]"}], "M"], "\[CapitalDelta]t"}], ",", 
        RowBox[{"NestList", "[", 
         RowBox[{"prop", ",", "v0", ",", "M"}], "]"}]}], "}"}], 
      "\[Transpose]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.68267867322346*^9, 3.6826787056764927`*^9}, {
   3.6826843609059067`*^9, 3.682684463706279*^9}, {3.6826846404914837`*^9, 
   3.6826846738256493`*^9}, {3.682684705168401*^9, 3.68268477143119*^9}, {
   3.682740085738482*^9, 3.682740128605324*^9}, {3.682740398241913*^9, 
   3.682740468667066*^9}, {3.682740628351716*^9, 3.6827406302784357`*^9}, {
   3.6827408866861467`*^9, 3.6827409189173737`*^9}, {3.6827485458263063`*^9, 
   3.6827485471771383`*^9}, 3.682756520712385*^9, {3.683369498469699*^9, 
   3.683369500606691*^9}, {3.68337021393004*^9, 3.683370214973535*^9}, {
   3.733657208998028*^9, 3.7336572195268593`*^9}, {3.733658061443985*^9, 
   3.7336580855471163`*^9}, {3.735145547615834*^9, 3.735145591363285*^9}, {
   3.735145715523347*^9, 3.7351457202167263`*^9}, {3.735643262879987*^9, 
   3.735643271469833*^9}, {3.7356433018222437`*^9, 3.7356433035356207`*^9}, {
   3.735643334092183*^9, 3.7356433344554996`*^9}, {3.735644443717979*^9, 
   3.735644445640826*^9}, {3.735660202712412*^9, 3.735660208712117*^9}, 
   3.751373039832429*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"8c0e5ddc-9088-4562-b4fe-8833aaecd6ed"],

Cell[CellGroupData[{

Cell["initial wavefunction", "Subsubsection",
 CellChangeTimes->{{3.734863961457913*^9, 3.73486396352707*^9}, {
  3.7348701851028547`*^9, 
  3.734870187472745*^9}},ExpressionUUID->"e2b5ac84-3f18-45af-a87f-\
0791dfc7734f"],

Cell[TextData[{
 "starting point: Gaussian localized around the initial position ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "0"], TraditionalForm]],ExpressionUUID->
  "f544b62e-0685-4f17-9363-23827d2d3c70"],
 " in the simulation box\nmean gridue: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     OverscriptBox["x", "^"], "\[RightAngleBracket]"}], "=", 
    SubscriptBox["x", "0"]}], TraditionalForm]],ExpressionUUID->
  "65ba5147-7794-413f-8aba-655dac3eadc8"],
 "\nstandard deviation: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      SuperscriptBox[
       OverscriptBox["x", "^"], "2"], "\[RightAngleBracket]"}], "-", 
     SuperscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       OverscriptBox["x", "^"], "\[RightAngleBracket]"}], "2"]}], "=", 
    SuperscriptBox["\[Sigma]", "2"]}], TraditionalForm]],ExpressionUUID->
  "0260da94-fd6c-4f48-a366-91031b2b20ea"]
}], "Text",
 CellChangeTimes->{{3.73486396487423*^9, 3.734863979129157*^9}, {
   3.7348642130029793`*^9, 3.734864255339569*^9}, {3.734864378708108*^9, 
   3.734864382724291*^9}, {3.7348648254015713`*^9, 3.7348648469565573`*^9}, {
   3.734864924445517*^9, 3.734864924625655*^9}, {3.7348650153144503`*^9, 
   3.7348650170382767`*^9}, {3.734865050858309*^9, 3.734865054195795*^9}, {
   3.7348653864995203`*^9, 3.734865386878828*^9}, {3.734866931876141*^9, 
   3.734866960136722*^9}, 
   3.75137307315068*^9},ExpressionUUID->"2ae870da-e91d-4b51-9f9f-\
a1174191cfa3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"x0", "=", "15"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"starting", " ", "height"}], " ", "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"starting", " ", "width"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t1", "=", 
    SqrtBox[
     RowBox[{"2", 
      RowBox[{"x0", "/", "g"}]}]]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"classical", " ", "bounce", " ", "time"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vv", "=", 
   RowBox[{"Normalize", "[", 
    RowBox[{"N", "[", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"xgrid", "-", "x0"}], 
          RowBox[{"2", "\[Sigma]"}]], ")"}], "2"]}]], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xgrid", ",", 
        FractionBox["vv", 
         SqrtBox["\[CapitalDelta]"]]}], "}"}], "\[Transpose]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"a", ",", "0"}], "}"}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<\[Psi](x)\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.73486409865935*^9, 3.7348641223882236`*^9}, {
   3.734864167350746*^9, 3.734864202317896*^9}, {3.734864325606859*^9, 
   3.734864339085834*^9}, {3.734865319134941*^9, 3.7348653716296062`*^9}, {
   3.7348654803319893`*^9, 3.734865485562991*^9}, 3.734865670463435*^9, {
   3.7348657641479883`*^9, 3.734865789597015*^9}, {3.734865836266273*^9, 
   3.7348658401685867`*^9}, {3.734865906738781*^9, 3.7348659097708073`*^9}, {
   3.7348669213887987`*^9, 3.7348669286579447`*^9}, {3.7348707919588633`*^9, 
   3.73487079954324*^9}, {3.735143760273993*^9, 3.7351438386651382`*^9}, {
   3.735144000924508*^9, 3.735144028942224*^9}, {3.7351449612360363`*^9, 
   3.735144962626093*^9}, {3.7351450032304363`*^9, 3.735145044960273*^9}, {
   3.735145121662882*^9, 3.735145122455852*^9}, {3.735145183923057*^9, 
   3.735145184798626*^9}, {3.735145217086235*^9, 3.735145217596572*^9}, 
   3.7351456926355047`*^9, {3.735145989485569*^9, 3.735145994301661*^9}, {
   3.735146028679034*^9, 3.735146038067794*^9}, {3.7351460749539957`*^9, 
   3.735146120850203*^9}, {3.735146154151754*^9, 3.7351461806778183`*^9}, 
   3.735146301486989*^9, {3.735146489642846*^9, 3.7351464899732523`*^9}, {
   3.735147394398922*^9, 3.735147394982205*^9}, {3.735147447391974*^9, 
   3.735147447665468*^9}, {3.735644184205092*^9, 3.735644193809856*^9}, {
   3.735644742832665*^9, 3.735644750680346*^9}, 3.735822033453651*^9, {
   3.735822541886249*^9, 3.735822560573165*^9}, {3.7358226635434637`*^9, 
   3.735822663614081*^9}, {3.735822836252894*^9, 3.7358228363665752`*^9}, 
   3.735822876520677*^9, {3.735822945045027*^9, 3.735822946361289*^9}, {
   3.751373045455557*^9, 3.751373046539072*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"fd61ec15-5c6e-49a1-9204-f81becea6397"]
}, Open  ]],

Cell[CellGroupData[{

Cell["time-dependent density", "Subsubsection",
 CellChangeTimes->{{3.7348702005846853`*^9, 
  3.7348702038136377`*^9}},ExpressionUUID->"03185364-fcd0-4fc2-ac75-\
dc75b3ada76d"],

Cell["propagate in time and show time-dependent density:", "Text",
 CellChangeTimes->{{3.682684599764876*^9, 3.682684602780169*^9}, {
  3.682684914797099*^9, 3.682684916877984*^9}, {3.682684994224927*^9, 
  3.682684999756875*^9}},ExpressionUUID->"d7f1da0e-91b9-484a-b5d5-\
3bcb0b4dfef3"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]t", "=", "50"}], ",", 
     RowBox[{"M", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"quantum", " ", "density"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "=", 
     RowBox[{"ArrayPad", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"propApprox", "[", 
            RowBox[{"\[CapitalDelta]t", ",", "M", ",", "vv"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "2"], 
        "/", "\[CapitalDelta]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"plot", " ", "of", " ", "time"}], "-", 
      RowBox[{"dependent", " ", "quantum", " ", "density"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Pq", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Transpose", "[", "\[Rho]", "]"}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\[CapitalDelta]t"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "a"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"classical", " ", "bounce", " ", "trajectory"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Pc", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"x0", "-", 
        RowBox[{
         FractionBox["1", "2"], 
         SuperscriptBox[
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", 
            RowBox[{"2", "t1"}], ",", 
            RowBox[{"-", "t1"}]}], "]"}], "2"]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "\[CapitalDelta]t"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Orange"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"Pq", ",", "Pc", ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "x"}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.734865070141897*^9, 3.734865175475685*^9}, {
   3.7348652154577093`*^9, 3.7348652312818127`*^9}, {3.734865261591563*^9, 
   3.734865292545847*^9}, {3.734865402120591*^9, 3.7348654055444613`*^9}, 
   3.734865550097251*^9, {3.734865584541391*^9, 3.734865584673373*^9}, {
   3.7348656864966917`*^9, 3.7348656867446404`*^9}, {3.734866250603339*^9, 
   3.734866323482892*^9}, {3.734866632999112*^9, 3.7348667124205513`*^9}, 
   3.734866815796875*^9, {3.734866985410059*^9, 3.734866986206238*^9}, {
   3.734867077893033*^9, 3.734867090631703*^9}, 3.734869031191462*^9, {
   3.73487021682332*^9, 3.7348702223063583`*^9}, {3.7348708442419662`*^9, 
   3.734870943633401*^9}, {3.734871059980543*^9, 3.7348710701085052`*^9}, {
   3.735144989325079*^9, 3.735144989714406*^9}, {3.735145291233543*^9, 
   3.73514530011124*^9}, {3.735145526870173*^9, 3.7351455302079153`*^9}, {
   3.735145627510044*^9, 3.735145654333097*^9}, {3.7351457893177*^9, 
   3.735145820914537*^9}, {3.735145891755148*^9, 3.735145918188857*^9}, {
   3.7351459629003277`*^9, 3.7351459636254253`*^9}, {3.735146006549903*^9, 
   3.735146006780513*^9}, {3.735146052103322*^9, 3.735146052474738*^9}, {
   3.735146325133317*^9, 3.735146330979516*^9}, {3.7351463808971033`*^9, 
   3.735146435424038*^9}, {3.735150986676805*^9, 3.7351509878610687`*^9}, {
   3.7356440857001667`*^9, 3.735644180372007*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"0707da01-b1ac-47cf-ae91-5e393d46ece6"],

Cell["plot the time-dependent average position:", "Text",
 CellChangeTimes->{{3.682685052621209*^9, 
  3.682685059271225*^9}},ExpressionUUID->"af8c23c0-3f49-4ed9-a024-\
253456cb24ce"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[CapitalDelta]t", "=", "50"}], ",", 
     RowBox[{"M", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"quantum", " ", "mean", " ", "position"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mq", "=", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Abs", "[", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}], "2"], ".", "xgrid"}]}], "}"}], "&"}], "/@", 
        RowBox[{"propApprox", "[", 
         RowBox[{"\[CapitalDelta]t", ",", "M", ",", "vv"}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"classical", " ", "bounce", " ", "trajectory"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Mc", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"x0", "-", 
        RowBox[{
         FractionBox["1", "2"], 
         SuperscriptBox[
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", 
            RowBox[{"2", "t1"}], ",", 
            RowBox[{"-", "t1"}]}], "]"}], "2"]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "\[CapitalDelta]t"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Orange"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"Mc", ",", "Mq", ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"\[LeftAngleBracket]", 
          OverscriptBox["x", "^"], "\[RightAngleBracket]"}]}], "}"}]}]}], 
     "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.68268482076147*^9, 3.682684822482473*^9}, {
   3.682684859855893*^9, 3.6826849654808292`*^9}, {3.6826850043824587`*^9, 
   3.682685037277014*^9}, {3.682685068909391*^9, 3.6826850826251297`*^9}, {
   3.682685132182291*^9, 3.682685217806881*^9}, 3.682741385096553*^9, {
   3.682743029756823*^9, 3.682743029878831*^9}, {3.682757209549324*^9, 
   3.682757210066572*^9}, {3.6827579936796227`*^9, 3.6827579941403913`*^9}, {
   3.683370139845127*^9, 3.683370140036251*^9}, {3.733657322394125*^9, 
   3.73365732260106*^9}, {3.733658130705154*^9, 3.733658130999318*^9}, {
   3.7348654156186743`*^9, 3.734865429525961*^9}, {3.734865599798067*^9, 
   3.734865633608304*^9}, {3.734865711400723*^9, 3.734865742617956*^9}, {
   3.734866848011806*^9, 3.7348668936932507`*^9}, {3.734866981075869*^9, 
   3.734866981794248*^9}, 3.734867103557012*^9, 3.734869045486665*^9, {
   3.734870230133252*^9, 3.7348702303069267`*^9}, {3.734870407862892*^9, 
   3.7348704096088133`*^9}, {3.7348709783166933`*^9, 3.734871037827929*^9}, {
   3.73514525727355*^9, 3.735145257519586*^9}, {3.735145747718905*^9, 
   3.735145747987969*^9}, {3.735145828615011*^9, 3.735145867140579*^9}, {
   3.7351460165211163`*^9, 3.735146016729949*^9}, {3.735146058322523*^9, 
   3.735146058672068*^9}, {3.735146336532037*^9, 3.735146366130363*^9}, {
   3.735146440708271*^9, 3.735146441305646*^9}, {3.73564416567585*^9, 
   3.7356441659433393`*^9}, {3.735644217884598*^9, 3.735644246697481*^9}, 
   3.751373047658087*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"31ef602e-7a9d-488b-90fa-1e0a8a71dfb7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["split-step propagation with a time-dependent potential", "Subsection",
 CellChangeTimes->{{3.682747029570825*^9, 
  3.682747039853676*^9}},ExpressionUUID->"78e46ce7-2fd2-411a-8136-\
eba782f432f6"],

Cell[TextData[{
 "propagate with a time-dependent potential given as a function ",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "(", 
    RowBox[{"x", ",", "t"}], ")"}], TraditionalForm]],ExpressionUUID->
  "d966c9b5-acb8-4fc6-86d8-64c306ee49ab"],
 ":"
}], "Text",
 CellChangeTimes->{{3.682747096689556*^9, 3.682747124513315*^9}, {
  3.682756900725181*^9, 
  3.6827569025482483`*^9}},ExpressionUUID->"c03e4b90-fef7-4a19-a24a-\
d32f75e5bcf6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"propApprox", "[", 
   RowBox[{"Wt_", ",", " ", 
    RowBox[{"\[CapitalDelta]t_", "?", "NumericQ"}], ",", 
    RowBox[{"M_Integer", "/;", 
     RowBox[{"M", "\[GreaterEqual]", "1"}]}], ",", 
    RowBox[{"v0_", "/;", 
     RowBox[{"VectorQ", "[", 
      RowBox[{"v0", ",", "NumericQ"}], "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Lambda]", ",", "Ke", ",", "propKin", ",", "propPot2", ",", "prop"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"compute", " ", "the", " ", "\[Lambda]", " ", "constant"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{
       RowBox[{"-", "I"}], "*", 
       RowBox[{"N", "[", 
        FractionBox["\[CapitalDelta]t", 
         RowBox[{"M", "*", "\[HBar]"}]], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "compute", " ", "the", " ", "diagonal", " ", "elements", " ", "of", " ", 
       RowBox[{"exp", "[", 
        RowBox[{"\[Lambda]", "*", "T"}], "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Ke", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{"\[Lambda]", "*", 
        SuperscriptBox[
         RowBox[{"Range", "[", "nmax", "]"}], "2"], "*", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Pi]", "2"], 
          SuperscriptBox["\[HBar]", "2"]}], 
         RowBox[{"2", "m", " ", 
          SuperscriptBox["a", "2"]}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"propagate", " ", "by", " ", "a", " ", "full", " ", "time"}], 
       "-", 
       RowBox[{"step", " ", "with", " ", "T"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"propKin", "[", "v_", "]"}], ":=", 
      RowBox[{"FourierDST", "[", 
       RowBox[{
        RowBox[{"Ke", "*", 
         RowBox[{"FourierDST", "[", 
          RowBox[{"v", ",", "1"}], "]"}]}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"propagate", " ", "by", " ", "a", " ", "half", " ", "time"}], 
       "-", 
       RowBox[{"step", " ", "with", " ", "V"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "egriduating", " ", "the", " ", "potential", " ", "at", " ", "time", 
       " ", "t"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"propPot2", "[", 
       RowBox[{"t_", ",", "v_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         FractionBox["\[Lambda]", "2"], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Wt", "[", 
             RowBox[{"#", ",", "t"}], "]"}], "&"}], "/@", "xgrid"}], ")"}]}], 
        "]"}], "*", "v"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "propagate", " ", "by", " ", "a", " ", "full", " ", "time", " ", 
        "step", " ", "by", " ", "H"}], "=", 
       RowBox[{"T", "+", 
        RowBox[{
        "V", " ", "using", " ", "the", " ", "Trotter", " ", 
         "approximation"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"starting", " ", "at", " ", "time", " ", "t"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"prop", "[", 
       RowBox[{"v_", ",", "t_"}], "]"}], ":=", 
      RowBox[{"propPot2", "[", 
       RowBox[{
        RowBox[{"t", "+", 
         FractionBox[
          RowBox[{"3", "\[CapitalDelta]t"}], 
          RowBox[{"4", "M"}]]}], ",", 
        RowBox[{"propKin", "[", 
         RowBox[{"propPot2", "[", 
          RowBox[{
           RowBox[{"t", "+", 
            FractionBox["\[CapitalDelta]t", 
             RowBox[{"4", "M"}]]}], ",", "v"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"step", "-", "by", "-", 
       RowBox[{"step", " ", "propagation"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "M"}], "]"}], "M"], "\[CapitalDelta]t"}], ",", 
        RowBox[{"FoldList", "[", 
         RowBox[{"prop", ",", "v0", ",", 
          RowBox[{
           FractionBox[
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"M", "-", "1"}]}], "]"}], "M"], "\[CapitalDelta]t"}]}], 
         "]"}]}], "}"}], "\[Transpose]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.68267867322346*^9, 3.6826787056764927`*^9}, {
   3.6826843609059067`*^9, 3.682684463706279*^9}, {3.6826846404914837`*^9, 
   3.6826846738256493`*^9}, {3.682684705168401*^9, 3.68268477143119*^9}, {
   3.682740085738482*^9, 3.682740128605324*^9}, {3.682740398241913*^9, 
   3.682740468667066*^9}, {3.682740628351716*^9, 3.6827406302784357`*^9}, {
   3.6827408866861467`*^9, 3.6827409189173737`*^9}, {3.682747056054803*^9, 
   3.682747059463911*^9}, {3.682747130790473*^9, 3.68274742204381*^9}, {
   3.682747546605196*^9, 3.682747561104759*^9}, {3.682747599525558*^9, 
   3.6827476816490793`*^9}, {3.682747715321039*^9, 3.682747718021009*^9}, {
   3.682747795275813*^9, 3.682747806042561*^9}, {3.682748536636162*^9, 
   3.682748538559847*^9}, {3.682748651217442*^9, 3.682748663658579*^9}, 
   3.682756523947179*^9, {3.683370179783411*^9, 3.683370209438452*^9}, {
   3.733657330090589*^9, 3.733657340794982*^9}, {3.733658188678163*^9, 
   3.7336582132608223`*^9}, {3.735146738962935*^9, 3.7351468594398518`*^9}, {
   3.73564430651437*^9, 3.7356443242113237`*^9}, {3.735644422786953*^9, 
   3.7356444256331377`*^9}, {3.735644478226699*^9, 3.735644478358439*^9}, {
   3.735644524315716*^9, 3.735644542276944*^9}, {3.735660219784217*^9, 
   3.73566022351642*^9}, {3.7356610913514442`*^9, 3.7356610960817537`*^9}, 
   3.73566178125068*^9, {3.7513730633173227`*^9, 3.751373074648363*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"8ec2fffb-f71d-4c06-a188-8b28fab20348"],

Cell[TextData[{
 "propagate in time and show time-dependent density:\nresonant driving: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", 
     RowBox[{"x", ",", "t"}], ")"}], "=", 
    RowBox[{
     RowBox[{"W", "(", "x", ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"A", " ", 
        RowBox[{"sin", "(", 
         RowBox[{"\[Omega]", " ", "t"}], ")"}]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"8c8ec255-87c1-4b78-8ebc-a1e1663deead"],
 ", picking a resonant ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Omega]", "=", 
    RowBox[{"\[Pi]", "/", 
     SubscriptBox["t", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "ea53dda5-54f4-48dd-b8d6-924e187b9407"],
 " to amplify the bouncing motion"
}], "Text",
 CellChangeTimes->{{3.682684599764876*^9, 3.682684602780169*^9}, {
  3.682684914797099*^9, 3.682684916877984*^9}, {3.682684994224927*^9, 
  3.682684999756875*^9}, {3.735147472154928*^9, 3.735147521378427*^9}, {
  3.7351478455157013`*^9, 3.735147851281891*^9}, {3.735661140111494*^9, 
  3.735661142366791*^9}},ExpressionUUID->"2cc6b9e8-4c99-42c8-8c68-\
2dcc4af6fec7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "0.1"}], ",", 
     RowBox[{"\[Omega]", "=", 
      FractionBox["\[Pi]", "t1"]}], ",", 
     RowBox[{"\[CapitalDelta]t", "=", "50"}], ",", 
     RowBox[{"M", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Wt", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"W", "[", "x", "]"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"A", "*", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Omega]", "*", "t"}], "]"}]}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Rho]", "=", 
     RowBox[{"ArrayPad", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"propApprox", "[", 
            RowBox[{"Wt", ",", "\[CapitalDelta]t", ",", "M", ",", "vv"}], 
            "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "2"], 
        "/", "\[CapitalDelta]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Pq", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Transpose", "[", "\[Rho]", "]"}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\[CapitalDelta]t"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "a"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"Pq", ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "x"}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.682742424243373*^9, 3.6827424440324287`*^9}, {
   3.6827435054538803`*^9, 3.682743509705755*^9}, {3.682748135386084*^9, 
   3.682748156042446*^9}, {3.682757072275984*^9, 3.682757072965802*^9}, {
   3.682757214308216*^9, 3.682757214881482*^9}, {3.682757641772852*^9, 
   3.6827576439027023`*^9}, {3.6833701940595016`*^9, 3.683370194239077*^9}, {
   3.683430514037528*^9, 3.68343052144016*^9}, {3.73365734446002*^9, 
   3.7336573446104393`*^9}, {3.733658299231483*^9, 3.733658299496316*^9}, {
   3.735146980849345*^9, 3.735147187002706*^9}, {3.735147224856709*^9, 
   3.735147228908022*^9}, {3.7351472630348463`*^9, 3.735147266580917*^9}, {
   3.7351473317452707`*^9, 3.735147335624462*^9}, 3.73514738853207*^9, {
   3.735147541700872*^9, 3.7351475485737267`*^9}, 3.735150997275876*^9, {
   3.7351510657023277`*^9, 3.735151099529664*^9}, {3.7356445632460546`*^9, 
   3.7356445690914087`*^9}, {3.735644609761108*^9, 3.735644610293325*^9}, {
   3.7356611342636623`*^9, 3.7356611343222647`*^9}, {3.7356616753934317`*^9, 
   3.735661687737217*^9}, {3.735661720229957*^9, 3.735661745345071*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"44a0eb6e-0679-436a-8eea-942919c82816"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
split-step propagation with a time-dependent potential and with nonlinear \
interaction\
\>", "Subsection",
 CellChangeTimes->{{3.682747029570825*^9, 3.682747039853676*^9}, {
  3.682756865960825*^9, 
  3.682756870650587*^9}},ExpressionUUID->"10c367ae-7a89-4454-9c26-\
aab5f179403b"],

Cell[TextData[{
 "propagate with a time-dependent potential given as a function ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", 
     RowBox[{"x", ",", "t"}], ")"}], "+", 
    RowBox[{"\[Kappa]", 
     SuperscriptBox[
      RowBox[{"\[LeftBracketingBar]", 
       RowBox[{"\[Psi]", "(", 
        RowBox[{"x", ",", "t"}], ")"}], "\[RightBracketingBar]"}], "2"]}]}], 
   TraditionalForm]],ExpressionUUID->"df60e3ca-faef-4db6-82e6-2fed348c5ee6"],
 ":"
}], "Text",
 CellChangeTimes->{{3.682747096689556*^9, 3.682747124513315*^9}, {
  3.6827568756031713`*^9, 3.6827568952246017`*^9}, {3.73566499821738*^9, 
  3.735664998473464*^9}},ExpressionUUID->"1825a516-1890-4b11-a68e-\
83b9878d5e77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"propApprox", "[", 
   RowBox[{"Wt_", ",", " ", 
    RowBox[{"\[Kappa]_", "?", "NumericQ"}], ",", 
    RowBox[{"\[CapitalDelta]t_", "?", "NumericQ"}], ",", 
    RowBox[{"M_Integer", "/;", 
     RowBox[{"M", "\[GreaterEqual]", "1"}]}], ",", 
    RowBox[{"v0_", "/;", 
     RowBox[{"VectorQ", "[", 
      RowBox[{"v0", ",", "NumericQ"}], "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Lambda]", ",", "Ke", ",", "propKin", ",", "propPot2", ",", "prop"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"compute", " ", "the", " ", "\[Lambda]", " ", "constant"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Lambda]", "=", 
      RowBox[{
       RowBox[{"-", "I"}], "*", 
       RowBox[{"N", "[", 
        FractionBox["\[CapitalDelta]t", 
         RowBox[{"M", "*", "\[HBar]"}]], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "compute", " ", "the", " ", "diagonal", " ", "elements", " ", "of", " ", 
       RowBox[{"exp", "[", 
        RowBox[{"\[Lambda]", "*", "T"}], "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Ke", "=", 
      RowBox[{"Exp", "[", 
       RowBox[{"\[Lambda]", "*", 
        SuperscriptBox[
         RowBox[{"Range", "[", "nmax", "]"}], "2"], "*", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[Pi]", "2"], 
          SuperscriptBox["\[HBar]", "2"]}], 
         RowBox[{"2", "m", " ", 
          SuperscriptBox["a", "2"]}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"propagate", " ", "by", " ", "a", " ", "full", " ", "time"}], 
       "-", 
       RowBox[{"step", " ", "with", " ", "T"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"propKin", "[", "v_", "]"}], ":=", 
      RowBox[{"FourierDST", "[", 
       RowBox[{
        RowBox[{"Ke", "*", 
         RowBox[{"FourierDST", "[", 
          RowBox[{"v", ",", "1"}], "]"}]}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"propagate", " ", "by", " ", "a", " ", "half", " ", "time"}], 
       "-", 
       RowBox[{"step", " ", "with", " ", "V"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "evaluating", " ", "the", " ", "potential", " ", "at", " ", "time", " ",
        "t"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"propPot2", "[", 
       RowBox[{"t_", ",", "v_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{
         FractionBox["\[Lambda]", "2"], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Wt", "[", 
               RowBox[{"#", ",", "t"}], "]"}], "&"}], "/@", "xgrid"}], ")"}], 
           "+", 
           RowBox[{"\[Kappa]", "*", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Abs", "[", "v", "]"}], "2"], "/", 
             "\[CapitalDelta]"}]}]}], ")"}]}], "]"}], "*", "v"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"propagate", " ", "by", " ", "a", " ", "full", " ", "time"}], 
        "-", 
        RowBox[{"step", " ", "by", " ", "H"}]}], "=", 
       RowBox[{"T", "+", 
        RowBox[{
        "V", " ", "using", " ", "the", " ", "Trotter", " ", 
         "approximation"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"starting", " ", "at", " ", "time", " ", "t"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"prop", "[", 
       RowBox[{"v_", ",", "t_"}], "]"}], ":=", 
      RowBox[{"propPot2", "[", 
       RowBox[{
        RowBox[{"t", "+", 
         FractionBox[
          RowBox[{"3", "\[CapitalDelta]t"}], 
          RowBox[{"4", "M"}]]}], ",", 
        RowBox[{"propKin", "[", 
         RowBox[{"propPot2", "[", 
          RowBox[{
           RowBox[{"t", "+", 
            FractionBox["\[CapitalDelta]t", 
             RowBox[{"4", "M"}]]}], ",", "v"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"step", "-", "by", "-", 
       RowBox[{"step", " ", "propagation"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "M"}], "]"}], "M"], "\[CapitalDelta]t"}], ",", 
        RowBox[{"FoldList", "[", 
         RowBox[{"prop", ",", "v0", ",", 
          RowBox[{
           FractionBox[
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"M", "-", "1"}]}], "]"}], "M"], "\[CapitalDelta]t"}]}], 
         "]"}]}], "}"}], "\[Transpose]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.68267867322346*^9, 3.6826787056764927`*^9}, {
   3.6826843609059067`*^9, 3.682684463706279*^9}, {3.6826846404914837`*^9, 
   3.6826846738256493`*^9}, {3.682684705168401*^9, 3.68268477143119*^9}, {
   3.682740085738482*^9, 3.682740128605324*^9}, {3.682740398241913*^9, 
   3.682740468667066*^9}, {3.682740628351716*^9, 3.6827406302784357`*^9}, {
   3.6827408866861467`*^9, 3.6827409189173737`*^9}, {3.682747056054803*^9, 
   3.682747059463911*^9}, {3.682747130790473*^9, 3.68274742204381*^9}, {
   3.682747546605196*^9, 3.682747561104759*^9}, {3.682747599525558*^9, 
   3.6827476816490793`*^9}, {3.682747715321039*^9, 3.682747718021009*^9}, {
   3.682747795275813*^9, 3.682747806042561*^9}, {3.682748536636162*^9, 
   3.682748538559847*^9}, {3.682748651217442*^9, 3.682748663658579*^9}, 
   3.682756523947179*^9, {3.6827569074977903`*^9, 3.682756933213256*^9}, 
   3.682764748386978*^9, {3.683370221544806*^9, 3.683370227044888*^9}, 
   3.703414004937252*^9, {3.733657350181553*^9, 3.733657360825749*^9}, {
   3.733658306025887*^9, 3.733658330581171*^9}, {3.735147858216773*^9, 
   3.735147926986532*^9}, {3.735644617668721*^9, 3.735644676665357*^9}, {
   3.735660227127296*^9, 3.7356602304787188`*^9}, 3.7356648062276278`*^9, {
   3.735665001665166*^9, 3.7356650089860153`*^9}, {3.751373067768264*^9, 
   3.75137307567614*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"ae2f49a0-af30-4b3a-805e-d7c54d0351c5"],

Cell[TextData[{
 "propagate in time and show time-dependent density:\n[here using \
time-independent potential ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"W", "(", 
     RowBox[{"x", ",", "t"}], ")"}], "=", 
    RowBox[{"W", "(", "x", ")"}]}], TraditionalForm]],ExpressionUUID->
  "0ec878f6-5d01-457e-9057-2557f69ef32a"],
 "]"
}], "Text",
 CellChangeTimes->{{3.682684599764876*^9, 3.682684602780169*^9}, {
  3.682684914797099*^9, 3.682684916877984*^9}, {3.682684994224927*^9, 
  3.682684999756875*^9}, {3.682757104315175*^9, 3.682757117826558*^9}, {
  3.735147932814494*^9, 
  3.7351479331713*^9}},ExpressionUUID->"2eb1ec4e-0e81-4e56-a668-3a71a3b3b418"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "=", 
      RowBox[{
       RowBox[{"-", "3"}], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"g", " ", 
           SuperscriptBox["\[HBar]", "4"]}], "m"], ")"}], 
        FractionBox["1", "3"]]}]}], ",", 
     RowBox[{"\[CapitalDelta]t", "=", "50"}], ",", 
     RowBox[{"M", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "=", 
     RowBox[{"ArrayPad", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"propApprox", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"W", "[", "#1", "]"}], "&"}], ",", "\[Kappa]", ",", 
             "\[CapitalDelta]t", ",", "M", ",", "vv"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "2"], 
        "/", "\[CapitalDelta]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Pq", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Transpose", "[", "\[Rho]", "]"}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\[CapitalDelta]t"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "a"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"Pq", ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "x"}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.682742424243373*^9, 3.6827424440324287`*^9}, {
   3.6827435054538803`*^9, 3.682743509705755*^9}, {3.682748135386084*^9, 
   3.682748156042446*^9}, {3.68275694772738*^9, 3.6827569487163258`*^9}, {
   3.682757005709731*^9, 3.6827571529161663`*^9}, {3.682759209192045*^9, 
   3.682759215898859*^9}, {3.6833703808447437`*^9, 3.683370405312964*^9}, {
   3.683430529460878*^9, 3.683430536154694*^9}, {3.7336573677600727`*^9, 
   3.7336573678698606`*^9}, {3.733658335383943*^9, 3.733658335750223*^9}, {
   3.735147941473497*^9, 3.7351481135519667`*^9}, 3.735151009285385*^9, {
   3.7351511052998133`*^9, 3.735151116182412*^9}, {3.735644681385727*^9, 
   3.735644690339077*^9}, {3.7356650673052998`*^9, 3.735665081172181*^9}, {
   3.735665786000471*^9, 3.735665801747473*^9}, {3.7356663125859118`*^9, 
   3.735666323011455*^9}, {3.735794136993668*^9, 3.7357941383130836`*^9}, 
   3.73579424760061*^9, {3.7357975594902983`*^9, 3.7357975806375713`*^9}, 
   3.735816253283293*^9, {3.735822589964274*^9, 3.735822634689385*^9}, {
   3.735822708862054*^9, 3.735822732444078*^9}, {3.7358354567573137`*^9, 
   3.735835463771694*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"b02c9efb-f644-4862-8546-1cc1baae30c8"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"0", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"g", " ", 
           SuperscriptBox["\[HBar]", "4"]}], "m"], ")"}], 
        FractionBox["1", "3"]]}]}], ",", 
     RowBox[{"\[CapitalDelta]t", "=", "50"}], ",", 
     RowBox[{"M", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "=", 
     RowBox[{"ArrayPad", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"propApprox", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"W", "[", "#1", "]"}], "&"}], ",", "\[Kappa]", ",", 
             "\[CapitalDelta]t", ",", "M", ",", "vv"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "2"], 
        "/", "\[CapitalDelta]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Pq", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Transpose", "[", "\[Rho]", "]"}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\[CapitalDelta]t"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "a"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"Pq", ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "x"}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.682742424243373*^9, 3.6827424440324287`*^9}, {
   3.6827435054538803`*^9, 3.682743509705755*^9}, {3.682748135386084*^9, 
   3.682748156042446*^9}, {3.68275694772738*^9, 3.6827569487163258`*^9}, {
   3.682757005709731*^9, 3.6827571529161663`*^9}, {3.682759209192045*^9, 
   3.682759215898859*^9}, {3.6833703808447437`*^9, 3.683370405312964*^9}, {
   3.683430529460878*^9, 3.683430536154694*^9}, {3.7336573677600727`*^9, 
   3.7336573678698606`*^9}, {3.733658335383943*^9, 3.733658335750223*^9}, {
   3.735147941473497*^9, 3.7351481135519667`*^9}, 3.735151009285385*^9, {
   3.7351511052998133`*^9, 3.735151116182412*^9}, {3.735644681385727*^9, 
   3.735644690339077*^9}, {3.7356650673052998`*^9, 3.735665081172181*^9}, {
   3.735665786000471*^9, 3.735665801747473*^9}, {3.7356663125859118`*^9, 
   3.735666323011455*^9}, {3.735794136993668*^9, 3.7357941383130836`*^9}, 
   3.73579424760061*^9, {3.7357975594902983`*^9, 3.7357975806375713`*^9}, 
   3.735816253283293*^9, {3.735822589964274*^9, 3.735822634689385*^9}, {
   3.735822708862054*^9, 3.735822709716854*^9}, 3.735835468214273*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"14f1391f-c471-4184-a241-f3d454b5ef6d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"3", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"g", " ", 
           SuperscriptBox["\[HBar]", "4"]}], "m"], ")"}], 
        FractionBox["1", "3"]]}]}], ",", 
     RowBox[{"\[CapitalDelta]t", "=", "50"}], ",", 
     RowBox[{"M", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Rho]", "=", 
     RowBox[{"ArrayPad", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"propApprox", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"W", "[", "#1", "]"}], "&"}], ",", "\[Kappa]", ",", 
             "\[CapitalDelta]t", ",", "M", ",", "vv"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "2"], 
        "/", "\[CapitalDelta]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Pq", "=", 
     RowBox[{"ArrayPlot", "[", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"Transpose", "[", "\[Rho]", "]"}], "]"}], ",", 
       RowBox[{"DataRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\[CapitalDelta]t"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "a"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"Pq", ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"t", ",", "x"}], "}"}]}], ",", 
      RowBox[{"FrameTicks", "\[Rule]", "Automatic"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.682742424243373*^9, 3.6827424440324287`*^9}, {
   3.6827435054538803`*^9, 3.682743509705755*^9}, {3.682748135386084*^9, 
   3.682748156042446*^9}, {3.68275694772738*^9, 3.6827569487163258`*^9}, {
   3.682757005709731*^9, 3.6827571529161663`*^9}, {3.682759209192045*^9, 
   3.682759215898859*^9}, {3.6833703808447437`*^9, 3.683370405312964*^9}, {
   3.683430529460878*^9, 3.683430536154694*^9}, {3.7336573677600727`*^9, 
   3.7336573678698606`*^9}, {3.733658335383943*^9, 3.733658335750223*^9}, {
   3.735147941473497*^9, 3.7351481135519667`*^9}, 3.735151009285385*^9, {
   3.7351511052998133`*^9, 3.735151116182412*^9}, {3.735644681385727*^9, 
   3.735644690339077*^9}, {3.7356650673052998`*^9, 3.735665081172181*^9}, {
   3.735665786000471*^9, 3.735665801747473*^9}, {3.7356663125859118`*^9, 
   3.735666323011455*^9}, {3.735794136993668*^9, 3.7357941383130836`*^9}, 
   3.73579424760061*^9, {3.7357975594902983`*^9, 3.7357975806375713`*^9}, 
   3.735816253283293*^9, {3.735822589964274*^9, 3.735822634689385*^9}, {
   3.735822708862054*^9, 3.735822765783576*^9}, 3.735835470967279*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"eb52ed33-6df4-4005-b977-a1085a1f53c7"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 778},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 695, 15, 58, "Text",ExpressionUUID->"fcfaf95e-7c4c-43a3-b1ff-3d86e6de8f76"],
Cell[1256, 37, 2693, 50, 46, "Text",ExpressionUUID->"fd2d35df-1a38-4fca-89a9-57b4ac3dcb76"],
Cell[3952, 89, 541, 12, 35, "Text",ExpressionUUID->"77236a05-5474-4e22-bbd9-20965ebaa9c9"],
Cell[CellGroupData[{
Cell[4518, 105, 361, 7, 98, "Title",ExpressionUUID->"75490168-ae7d-40b1-b333-83cf4566235a"],
Cell[CellGroupData[{
Cell[4904, 116, 153, 3, 54, "Subsection",ExpressionUUID->"3f2fef13-c5f9-4b91-9673-0355f155b3ad"],
Cell[5060, 121, 178, 3, 35, "Text",ExpressionUUID->"b66f345d-0637-4472-b806-1071313c5761"],
Cell[5241, 126, 266, 6, 30, "Input",ExpressionUUID->"2da02cd0-ec79-4e98-90d3-a127ea9b9bd5"],
Cell[5510, 134, 183, 3, 35, "Text",ExpressionUUID->"fee92125-d943-4fda-b6a9-f8c88d382b1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5730, 142, 161, 3, 54, "Subsection",ExpressionUUID->"d44117bb-e72e-43b0-aab3-e19c57016670"],
Cell[5894, 147, 159, 3, 35, "Text",ExpressionUUID->"7f7e1c21-93ee-4131-a723-6f25dba2b147"],
Cell[6056, 152, 410, 7, 30, "Input",ExpressionUUID->"8c2a86a2-6f6f-4f64-92e0-7d00aecd9f61"],
Cell[6469, 161, 160, 3, 35, "Text",ExpressionUUID->"ec9afeb0-6bf7-40a2-b7f7-7a9d30ca667e"],
Cell[6632, 166, 852, 18, 89, "Input",ExpressionUUID->"a84d051f-b1f9-4e75-97f7-2542e20d1683"],
Cell[7487, 186, 592, 14, 35, "Text",ExpressionUUID->"7daebace-68ee-4087-a558-a1200c3b2f4a"],
Cell[8082, 202, 579, 12, 52, "Input",ExpressionUUID->"05ee2f44-5ac0-4c07-bf6e-2b8c8011ea3b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8698, 219, 165, 3, 54, "Subsection",ExpressionUUID->"92a6180e-7c54-4d6a-a934-a9288c04dc98"],
Cell[8866, 224, 191, 3, 35, "Text",ExpressionUUID->"27f5b001-967f-43cc-9aff-62ca765cb870"],
Cell[9060, 229, 2121, 55, 119, "Input",ExpressionUUID->"80b80027-ccf6-47ab-8fcc-880cab6159e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11218, 289, 170, 3, 54, "Subsection",ExpressionUUID->"760fd0c1-31aa-4182-9726-53f3ad5322dc"],
Cell[11391, 294, 5076, 124, 406, "Input",ExpressionUUID->"8c0e5ddc-9088-4562-b4fe-8833aaecd6ed"],
Cell[CellGroupData[{
Cell[16492, 422, 221, 4, 45, "Subsubsection",ExpressionUUID->"e2b5ac84-3f18-45af-a87f-0791dfc7734f"],
Cell[16716, 428, 1517, 36, 83, "Text",ExpressionUUID->"2ae870da-e91d-4b51-9f9f-a1174191cfa3"],
Cell[18236, 466, 3331, 76, 161, "Input",ExpressionUUID->"fd61ec15-5c6e-49a1-9204-f81becea6397"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21604, 547, 177, 3, 45, "Subsubsection",ExpressionUUID->"03185364-fcd0-4fc2-ac75-dc75b3ada76d"],
Cell[21784, 552, 287, 4, 35, "Text",ExpressionUUID->"d7f1da0e-91b9-484a-b5d5-3bcb0b4dfef3"],
Cell[22074, 558, 4064, 93, 210, "Input",ExpressionUUID->"0707da01-b1ac-47cf-ae91-5e393d46ece6"],
Cell[26141, 653, 183, 3, 35, "Text",ExpressionUUID->"af8c23c0-3f49-4ed9-a024-253456cb24ce"],
Cell[26327, 658, 3598, 78, 168, "Input",ExpressionUUID->"31ef602e-7a9d-488b-90fa-1e0a8a71dfb7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29974, 742, 202, 3, 54, "Subsection",ExpressionUUID->"78e46ce7-2fd2-411a-8136-eba782f432f6"],
Cell[30179, 747, 438, 12, 35, "Text",ExpressionUUID->"c03e4b90-fef7-4a19-a24a-d32f75e5bcf6"],
Cell[30620, 761, 6086, 148, 423, "Input",ExpressionUUID->"8ec2fffb-f71d-4c06-a188-8b28fab20348"],
Cell[36709, 911, 1117, 29, 58, "Text",ExpressionUUID->"2cc6b9e8-4c99-42c8-8c68-2dcc4af6fec7"],
Cell[37829, 942, 3303, 78, 138, "Input",ExpressionUUID->"44a0eb6e-0679-436a-8eea-942919c82816"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41169, 1025, 292, 7, 54, "Subsection",ExpressionUUID->"10c367ae-7a89-4454-9c26-aab5f179403b"],
Cell[41464, 1034, 699, 18, 35, "Text",ExpressionUUID->"1825a516-1890-4b11-a68e-83b9878d5e77"],
Cell[42166, 1054, 6370, 158, 423, "Input",ExpressionUUID->"ae2f49a0-af30-4b3a-805e-d7c54d0351c5"],
Cell[48539, 1214, 663, 16, 58, "Text",ExpressionUUID->"2eb1ec4e-0e81-4e56-a668-3a71a3b3b418"],
Cell[49205, 1232, 3255, 77, 133, "Input",ExpressionUUID->"b02c9efb-f644-4862-8546-1cc1baae30c8"],
Cell[52463, 1311, 3202, 75, 133, "Input",ExpressionUUID->"14f1391f-c471-4184-a241-f3d454b5ef6d"],
Cell[55668, 1388, 3202, 75, 133, "Input",ExpressionUUID->"eb52ed33-6df4-4005-b977-a1085a1f53c7"]
}, Open  ]]
}, Open  ]]
}
]
*)

