
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sympy Solving Common Quantum Mechanics Problems &#8212; Jonny Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=8dedbda2" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '17MCM_QM/0Example_Quantum_Calculations_sympy';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Jonny Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Mathe &amp; FP/Language</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Alevel/Alevel_math.html">1. A-level-math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Alevel/Alevel_math_further.html">2. A-level-further</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_MCM.html">3. Math Computational Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_Lean.html">4. Lean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/00intro_math.html">5. Math-FP-Lang Combo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/01number_algebra.html">6. Number &amp; Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/02discrete_continuous.html">7. Discrete &amp; Continuous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/03real_world.html">8. Real World Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/05math_as_code.html">9. Math as code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CS &amp; Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Course_MIT6001Python.html">10. MIT_CS6001-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_MIT6002thinking.html">11. MIT_CS6002-CS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PE/PE50.html">12. Project Euler Q1-50</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PE/PE75.html">13. Project Euler Q51-</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_MCM_QM.html">14. Quantum Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_MCM_QFT.html">15. QFT</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../nb_past_courses.html">16. Past courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geo/nb_Geo.html">17. Geography and Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nb_lottery_simulator.html">18. Lottery Math</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/10pe" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/17MCM_QM/0Example_Quantum_Calculations_sympy.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sympy Solving Common Quantum Mechanics Problems</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Sympy Solving Common Quantum Mechanics Problems</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-properties-of-wavefunctions">General properties of wavefunctions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">Your Turn</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizing-functions">Normalizing functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-interlude-complex-numbers-in-sympy-and-python">python interlude: complex numbers in sympy and python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Your Turn</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-wavefunction-and-probability-amplitude">Plot the wavefunction and probability amplitude</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-probability-of-finding-a-particle-in-a-specified-region">Calculating probability of finding a particle in a specified region</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-average-values">Calculate average values</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-an-uncertainty-standard-deviation-and-variance-in-the-expectation-value-for-position">Calculate an uncertainty (standard deviation and variance) in the expectation value for position</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#is-a-wavefunction-an-eigenfunction-of-an-operator">Is a wavefunction an eigenfunction of an operator?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#is-a-function-orthogonal-to-another-function">Is a function orthogonal to another function?</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Your Turn</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-interlude-range-and-loops">Python interlude: range() and loops</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sympy-solving-common-quantum-mechanics-problems">
<h1>Sympy Solving Common Quantum Mechanics Problems<a class="headerlink" href="#sympy-solving-common-quantum-mechanics-problems" title="Link to this heading">#</a></h1>
<p>E. Harvey <a class="reference external" href="http://www.chemeddl.org/alfresco/service/org/chemeddl/symmath/frameset?guest=true">JCE Symmath</a> (2019-09).</p>
<ul class="simple">
<li><p>This notebook show basic examples for quantum calculations encountered in undergraduate physical chemistry course.</p></li>
<li><p>The purpose of this notebook is not to explain the theory behind the calculations, bur rather show how python can be used for solving typical problems.</p></li>
<li><p>The <a class="reference external" href="http://docs.sympy.org/latest/tutorial/index.html">sympy tutorial</a> describes all of the functions used in the notebook.</p></li>
</ul>
<p>After completing this work you should be able to use python and sympy to</p>
<ol class="arabic simple">
<li><p>calculate a normalization constant</p></li>
<li><p>calculate an expectation value and its variance</p></li>
<li><p>determine whether a function is an eigenvalue of an operator</p></li>
<li><p>determine if functions are orthogonal</p></li>
</ol>
<p>Prerequisites</p>
<ul class="simple">
<li><p>basic knowledge of python and sympy</p></li>
<li><p>the python <a class="reference external" href="http://www.scipy.org">SciPy</a> stack</p></li>
<li><p>the python <a class="reference external" href="http://www.sympy.org">sympy</a> symbolic computation library</p></li>
<li><p>basic understanding of eigenfuctions, normalization, orthogonality, and expectation values</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import and initialize libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="c1"># uncomment one of these and comment the other</span>
<span class="n">init_printing</span><span class="p">()</span> <span class="c1"># jupyter, cocalc</span>
<span class="c1">#init_printing(use_latex=False) # colaboratory</span>
</pre></div>
</div>
</div>
</div>
<section id="general-properties-of-wavefunctions">
<h2>General properties of wavefunctions<a class="headerlink" href="#general-properties-of-wavefunctions" title="Link to this heading">#</a></h2>
<p>Remind yourself of some key properties of wavefunctions. These properties (sometimes call Born’s conditions) are generally found in a discussion on the postulates of quantum mechanics.</p>
<section id="your-turn">
<h3>Your Turn<a class="headerlink" href="#your-turn" title="Link to this heading">#</a></h3>
<p>List as many properties of wavefunctions as you can and give a brief summary of the meaning of the property (one is given as an example)</p>
<p>(double click this cell to add answers…)</p>
<ol class="arabic simple">
<li><p>A wavefunction must be single-valued. This means that <span class="math notranslate nohighlight">\(\psi(x)\)</span> must have a unique value for any value of x.</p></li>
<li></li>
<li></li>
<li></li>
</ol>
</section>
</section>
<section id="normalizing-functions">
<h2>Normalizing functions<a class="headerlink" href="#normalizing-functions" title="Link to this heading">#</a></h2>
<p>One of the postulates of quantum mechanics states we can calculate the probability of finding an electron in space if the wavefunction is known. The <em>normalization condition</em> must be satisfied:
$<span class="math notranslate nohighlight">\( \int_{0}^a \psi(x)^* \psi(x)\; dx = 1 \)</span>$</p>
<p>We start with a simple function representing the wavefunction of a particle</p>
<div class="math notranslate nohighlight">
\[ f(x) = N_0 e^{-ax^2/2} \]</div>
<p>where <span class="math notranslate nohighlight">\(N_0\)</span> and <span class="math notranslate nohighlight">\(a_0\)</span> are constants.</p>
<p>Start by identifying the variables in the function. We also include sensible assumptions about certain variables if they are known. This is not necessary, but allows us to disregard physically impossible results (and speed up some computations).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">N0</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a x N0&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">E</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
</div>
<p>Define a wavefunction <span class="math notranslate nohighlight">\(\psi(x)\)</span> using <code class="docutils literal notranslate"><span class="pre">f</span></code> and a normalization constant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">N0</span> <span class="o">*</span> <span class="n">f</span>
<span class="n">psi</span>
</pre></div>
</div>
</div>
</div>
<p>sympy’s <code class="docutils literal notranslate"><span class="pre">conjugate()</span></code> gives the complex conjugate. Because <code class="docutils literal notranslate"><span class="pre">psi(x)</span></code> is real, its complex conjugate is the same function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sympy conjugate() gives the complex conjugate of a function</span>
<span class="n">psi_star</span> <span class="o">=</span> <span class="n">conjugate</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
<span class="n">psi</span><span class="p">,</span> <span class="n">psi_star</span>
</pre></div>
</div>
</div>
</div>
<section id="python-interlude-complex-numbers-in-sympy-and-python">
<h3>python interlude: complex numbers in sympy and python<a class="headerlink" href="#python-interlude-complex-numbers-in-sympy-and-python" title="Link to this heading">#</a></h3>
<p>In python, complex numbers (those related to <span class="math notranslate nohighlight">\(\sqrt{-1}\)</span>, the <a class="reference external" href="https://en.wikipedia.org/wiki/Imaginary_unit">imaginary unit</a>) and <span class="math notranslate nohighlight">\(e^x\)</span> can be entered in different ways. If <code class="docutils literal notranslate"><span class="pre">sympy</span></code> is loaded, <code class="docutils literal notranslate"><span class="pre">I</span></code> is the imaginary unit and <code class="docutils literal notranslate"><span class="pre">E</span></code> is the Euler <span class="math notranslate nohighlight">\(e\)</span>. In ‘plain’ python these are <code class="docutils literal notranslate"><span class="pre">1j</span></code> and <code class="docutils literal notranslate"><span class="pre">exp()</span></code>. For example <span class="math notranslate nohighlight">\(e^{ix}\)</span> can be entered as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E**(I*x)</span></code> or <code class="docutils literal notranslate"><span class="pre">exp(I*x)</span></code> if sympy has been loaded</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exp((1j</span> <span class="pre">*</span> <span class="pre">x))</span></code> if using ‘plain’ python</p></li>
</ul>
<p>If in doubt, use the <code class="docutils literal notranslate"><span class="pre">type()</span></code> function to see what the computer thinks you’re using:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>Your Turn<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Enter an expression for a complex function. Use the <code class="docutils literal notranslate"><span class="pre">conjugate()</span></code> function to compute the complex conjugate. Then multiply the expression and its conjugate. Print all three.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>
<span class="n">psij</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">E</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">psijc</span> <span class="o">=</span> <span class="n">conjugate</span><span class="p">(</span><span class="n">psij</span><span class="p">)</span>
<span class="n">psij</span><span class="p">,</span> <span class="n">psijc</span><span class="p">,</span> <span class="n">psij</span><span class="o">*</span><span class="n">psijc</span>
</pre></div>
</div>
</div>
</div>
<p>To determine <span class="math notranslate nohighlight">\(N_0\)</span>, integrate over the domain space. In this case, <span class="math notranslate nohighlight">\(-\infty\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span>, represented in sympy by <code class="docutils literal notranslate"><span class="pre">-oo</span></code> and <code class="docutils literal notranslate"><span class="pre">oo</span></code> (two lowercase letter o ; which look similar to the infinity glyph).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;prob&#39; is short for &#39;probability&#39;</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">psi</span> <span class="o">*</span> <span class="n">psi_star</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="n">prob</span>
</pre></div>
</div>
</div>
</div>
<p>Solve the equation</p>
<div class="math notranslate nohighlight">
\[ \int_{-\infty} ^{\infty} \psi(x)^* \psi(x) dx = 1 \]</div>
<p>for <span class="math notranslate nohighlight">\(N_0\)</span>. The symbolic solver in sympy equates an expression to zero, and then solves for a variable. We need to rearrange the equation to</p>
<div class="math notranslate nohighlight">
\[ \int_{-\infty} ^{\infty} \psi(x)^* \psi(x) dx - 1 = 0\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solve</span><span class="p">(</span><span class="n">prob</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Although there is only one solution, the brackets tell us sympy returned a list. This is handy if more than one solution exists. To use the normalization constant later, assign the name <code class="docutils literal notranslate"><span class="pre">norm</span></code> to the first (and only) entry in the solution list. Remember, python lists are zero-indexed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">N0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<p>Verify that the normlization constant is correct by substituting <code class="docutils literal notranslate"><span class="pre">norm</span></code> for <span class="math notranslate nohighlight">\(N_0\)</span> in the expression for <code class="docutils literal notranslate"><span class="pre">prob</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">N0</span><span class="p">,</span><span class="n">norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>It is useful to use ‘actual’ numbers and verify the symbolic result.</p>
<p>Assign a numeric value to <span class="math notranslate nohighlight">\(a\)</span> (let’s use 3), and repeat the process. Use <code class="docutils literal notranslate"><span class="pre">.evalf()</span></code> method, or the <code class="docutils literal notranslate"><span class="pre">N()</span></code> function to get numeric results from symbolic expressions. (Recall, <span class="math notranslate nohighlight">\(f\)</span> was the unormalized function.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="p">(</span><span class="n">norm</span> <span class="o">*</span> <span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">psi_star</span> <span class="o">=</span> <span class="n">conjugate</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">integrate</span> <span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">psi_star</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="n">prob</span>
</pre></div>
</div>
</div>
</div>
<p>Suppose we want the probability for <span class="math notranslate nohighlight">\(0 \le x \le 1\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># N gives numeric (floating point) result</span>
<span class="n">N</span><span class="p">(</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">psi_star</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-the-wavefunction-and-probability-amplitude">
<h1>Plot the wavefunction and probability amplitude<a class="headerlink" href="#plot-the-wavefunction-and-probability-amplitude" title="Link to this heading">#</a></h1>
<p>Sympy takes a different approach to plotting than matplotlib/pyplot. The sympy plotting functions generally produce figures that look more like those from “math books”.  For example, axis origin is a the center of a figure rather than the lower left corner.  Sympy also assumes a plot range of -1 &lt; x &lt; 1 unless told otherwise.</p>
<p>Use sympy to plot <span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\(\psi^* \psi\)</span>, the normalized wavefunctions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># subs = substitute values for variables</span>
<span class="c1"># Use a dictionary or list for multiple substitutions</span>

<span class="n">psi</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="n">N0</span><span class="p">:</span><span class="n">norm</span><span class="p">}</span> <span class="p">)</span>
<span class="n">psi_star</span> <span class="o">=</span> <span class="n">psi_star</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span> <span class="p">[(</span><span class="n">a</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="n">N0</span><span class="p">,</span><span class="n">norm</span><span class="p">)]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\psi(x)$&#39;</span>
<span class="n">p1</span><span class="o">.</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="n">p1</span><span class="o">.</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<span class="n">p1</span><span class="o">.</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span>

<span class="n">p2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">psi</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">line_color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\psi^2(x)$&#39;</span>

<span class="n">p1</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="n">p1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The probability amplitude, <span class="math notranslate nohighlight">\(\psi^2\)</span> has a narrower shape. Is <span class="math notranslate nohighlight">\(\psi\)</span> normlized?</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculating-probability-of-finding-a-particle-in-a-specified-region">
<h1>Calculating probability of finding a particle in a specified region<a class="headerlink" href="#calculating-probability-of-finding-a-particle-in-a-specified-region" title="Link to this heading">#</a></h1>
<p>Calculate the probability of finding a particle described by the function in a
specified region that can be easily changed. We’ll start with x1 = 0 and x2 = 0.5.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span>

<span class="n">integrate</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">psi_star</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">))</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This process might be repeated frequently. If so, it’s probably worth defining in the form of a python function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># default limits of infinity are provided, but can be overridden</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prob_func</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x_lower</span><span class="o">=-</span><span class="n">oo</span><span class="p">,</span> <span class="n">x_upper</span><span class="o">=</span><span class="n">oo</span><span class="p">):</span>
    <span class="s1">&#39;integrate the normalized wavefunction f(x) from x_l to x_u&#39;</span>
    
    <span class="n">fstar</span> <span class="o">=</span> <span class="n">conjugate</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">fstar</span> <span class="o">*</span> <span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_lower</span><span class="p">,</span> <span class="n">x_upper</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">prob</span>
</pre></div>
</div>
</div>
</div>
<p>Print the probability over 10 intervals within the box.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">a</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">N0</span><span class="p">:</span><span class="n">norm</span><span class="p">})</span>
<span class="n">lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">/</span><span class="mi">10</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Probability over intervals&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lengths</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prob_func</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculate-average-values">
<h1>Calculate average values<a class="headerlink" href="#calculate-average-values" title="Link to this heading">#</a></h1>
<p>The expectation value <span class="math notranslate nohighlight">\(\langle a \rangle\)</span> for an observable or property is calculated by finding the operator that describes that observable, finding a normalized wavefunction that describes the system under consideration, and using the integral definition for expectation value:</p>
<div class="math notranslate nohighlight">
\[ \langle a \rangle = \int \psi^*(x)\, \hat{A}\, \psi(x)\ dx \]</div>
<p>The position operator is <span class="math notranslate nohighlight">\(\hat{x} = x\)</span>; just multiplication by <span class="math notranslate nohighlight">\(x\)</span>. In our example, the range for <span class="math notranslate nohighlight">\(x\)</span> is <span class="math notranslate nohighlight">\(-\infty\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span>, so the average (or <em>expectation</em>) value might be predictable looking at the symmetry of the probability plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_avg</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">psi_star</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">psi</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="n">x_avg</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculate-an-uncertainty-standard-deviation-and-variance-in-the-expectation-value-for-position">
<h1>Calculate an uncertainty (standard deviation and variance) in the expectation value for position<a class="headerlink" href="#calculate-an-uncertainty-standard-deviation-and-variance-in-the-expectation-value-for-position" title="Link to this heading">#</a></h1>
<p>Variance in a quantity can be calculated simply as the expectation value for the quantity squared (position squared in this case, <span class="math notranslate nohighlight">\(\langle x^2\rangle\)</span>) minus the (expectation value for the quantity)-squared (<span class="math notranslate nohighlight">\(\langle x \rangle^2\)</span> in this case.)</p>
<div class="math notranslate nohighlight">
\[\sigma^2 = \int \psi^*\, x^2\, \psi\; dx - \left ( \int \psi^*\, x\, \psi \;dx \right )^2 \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma_squared</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">psi_star</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">psi</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span><span class="n">oo</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_star</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">psi</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span><span class="n">oo</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma_squared</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="is-a-wavefunction-an-eigenfunction-of-an-operator">
<h1>Is a wavefunction an eigenfunction of an operator?<a class="headerlink" href="#is-a-wavefunction-an-eigenfunction-of-an-operator" title="Link to this heading">#</a></h1>
<p>Eigenfunctions of an operator have the property</p>
<div class="math notranslate nohighlight">
\[ \hat{A}f = a f\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is the eigenvalue.</p>
<p>See if the function <span class="math notranslate nohighlight">\(\psi(x)=\exp(-a_0 x^2/2)\)</span> is an eigenfunction of the kinetic energy operator $<span class="math notranslate nohighlight">\(\hat{T} = \frac{\hbar^2}{2m} \frac{d^2 \psi(x)}{dx^2} \)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this could be done as an expression, but seems a natural for python function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">T_hat</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="s2">&quot;Apply the kinetic energy operator T on function f(x)&quot;</span>
    <span class="n">hbar</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;hbar m&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hbar</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">N0</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_hat</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">T_hat()</span></code> returned the result of operating on <span class="math notranslate nohighlight">\(\psi\)</span>. If <span class="math notranslate nohighlight">\(\psi\)</span> is an eigenfunction, we should be able to factor this result into <span class="math notranslate nohighlight">\(a\psi\)</span> where <span class="math notranslate nohighlight">\(a\)</span> is the eigenvalue. Another approach would be to divide both sides by the function and see if the result is a constant.
$<span class="math notranslate nohighlight">\(\frac{\hat{A}f}{f} = a\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_hat</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">/</span><span class="n">psi</span>
</pre></div>
</div>
</div>
</div>
<p>Because this result contains <span class="math notranslate nohighlight">\(x^2\)</span>, it is not a constant. Therefore, <span class="math notranslate nohighlight">\(\psi\)</span> is not an eigenfunction of the kinetic energy operator <span class="math notranslate nohighlight">\(\hat{T}\)</span>.</p>
<p>How about <span class="math notranslate nohighlight">\(\cos(x)\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_hat</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>So, <span class="math notranslate nohighlight">\(\cos(x)\)</span> is indeed an eigenfunction of <span class="math notranslate nohighlight">\(\hat{T}\)</span> and the eigenvalue is <span class="math notranslate nohighlight">\(-\hbar^2/2m\)</span>. However, <span class="math notranslate nohighlight">\(\cos(x)\)</span> is not a valid wavefunction for the particle-in-a-box model.  Why not?</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="is-a-function-orthogonal-to-another-function">
<h1>Is a function orthogonal to another function?<a class="headerlink" href="#is-a-function-orthogonal-to-another-function" title="Link to this heading">#</a></h1>
<p>The functions</p>
<div class="math notranslate nohighlight">
\[\phi_n(\theta) = e^{in\theta} \]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is an integer and <span class="math notranslate nohighlight">\(0 \le \theta \le 2\pi\)</span> are orthogonal if</p>
<div class="math notranslate nohighlight">
\[\int_0^{2\pi} \phi_n^*(\theta) \phi_m^*(\theta)\; d\theta = 0 \]</div>
<p>for <span class="math notranslate nohighlight">\(m\ne n\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;theta n&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">phi</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">conjugate</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">phi</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\phi_1\)</span> and <span class="math notranslate nohighlight">\(\phi_2\)</span> are orgthogonal.</p>
<section id="id2">
<h2>Your Turn<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>Are the <span class="math notranslate nohighlight">\(\phi_n(\theta)\)</span> wavefunctions normlized? If not, how could you normalize them? Try it.</p>
</section>
<section id="python-interlude-range-and-loops">
<h2>Python interlude: range() and loops<a class="headerlink" href="#python-interlude-range-and-loops" title="Link to this heading">#</a></h2>
<p>Using loops can make quick work of iterating over many combinations. (NB: This is a silly example, as it only shows a pattern for a few specific cases; orthogonality is not proven in general)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m, n, integral</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">conjugate</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="o">*</span> <span class="n">phi</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span>
        <span class="n">pprint</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./17MCM_QM"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Sympy Solving Common Quantum Mechanics Problems</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-properties-of-wavefunctions">General properties of wavefunctions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">Your Turn</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizing-functions">Normalizing functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-interlude-complex-numbers-in-sympy-and-python">python interlude: complex numbers in sympy and python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Your Turn</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-wavefunction-and-probability-amplitude">Plot the wavefunction and probability amplitude</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-probability-of-finding-a-particle-in-a-specified-region">Calculating probability of finding a particle in a specified region</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-average-values">Calculate average values</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-an-uncertainty-standard-deviation-and-variance-in-the-expectation-value-for-position">Calculate an uncertainty (standard deviation and variance) in the expectation value for position</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#is-a-wavefunction-an-eigenfunction-of-an-operator">Is a wavefunction an eigenfunction of an operator?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#is-a-function-orthogonal-to-another-function">Is a function orthogonal to another function?</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Your Turn</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-interlude-range-and-loops">Python interlude: range() and loops</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonny, assisted by Tom
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>