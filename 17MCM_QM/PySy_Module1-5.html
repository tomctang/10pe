
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>I. Commutators &#8212; Jonny Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=8dedbda2" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '17MCM_QM/PySy_Module1-5';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Jonny Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Mathe &amp; FP/Language</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Alevel/Alevel_math.html">1. A-level-math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Alevel/Alevel_math_further.html">2. A-level-further</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_MCM.html">3. Math Computational Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_Lean.html">4. Lean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/00intro_math.html">5. Math-FP-Lang Combo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/01number_algebra.html">6. Number &amp; Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/02discrete_continuous.html">7. Discrete &amp; Continuous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/03real_world.html">8. Real World Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/05math_as_code.html">9. Math as code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CS &amp; Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Course_MIT6001Python.html">10. MIT_CS6001-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_MIT6002thinking.html">11. MIT_CS6002-CS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PE/PE50.html">12. Project Euler Q1-50</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PE/PE75.html">13. Project Euler Q51-</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_MCM_QM.html">14. Quantum Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Course_MCM_QFT.html">15. QFT</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../nb_past_courses.html">16. Past courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geo/nb_Geo.html">17. Geography and Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nb_lottery_simulator.html">18. Lottery Math</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/10pe" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/17MCM_QM/PySy_Module1-5.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>I. Commutators</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">I. Commutators</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-commutators">1. Introduction to Commutators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heisenberg-equations-of-motion">2. Heisenberg Equations of Motion</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ii-pib">II. PIB</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizing-particle-in-a-box">1. Normalizing Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-value-of-the-position-operator-for-particle-in-a-box">2. Expectation Value of the Position Operator for Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-value-of-the-kinetic-energy-operator-for-particle-in-a-box">Expectation Value of the Kinetic Energy Operator for Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphing-the-wavefunction-of-particle-in-a-box">Graphing the WaveFunction of Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalzing-2-dimensional-particle-in-a-box">Normalzing 2-Dimensional Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphing-the-wavefunction-of-2-d-particle-in-a-box">Graphing the WaveFunction of 2-D Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#answers">Answers</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#iii-the-morse-potential">III. The Morse Potential</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-potential">1. The Potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-of-qhd-formulas">2. Derivation of  QHD formulas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphing">3. Graphing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-to-classical-equations-of-motion">4. Comparing to Classical Equations of Motion</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#iv-the-gaussian-potential">IV. The Gaussian Potential</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1. The Potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2. Derivation of  QHD formulas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">3. Graphing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">4. Comparing to Classical Equations of Motion</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#v-the-double-well-potential">V. The Double Well Potential</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2. Derivation of  QHD formulas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">3. Graphing</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="i-commutators">
<h1>I. Commutators<a class="headerlink" href="#i-commutators" title="Link to this heading">#</a></h1>
<p>In order to run pysycomp, please make sure that both SymPy and Matplotlib are installed on your system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../src&#39;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pysycomp</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<section id="introduction-to-commutators">
<h2>1. Introduction to Commutators<a class="headerlink" href="#introduction-to-commutators" title="Link to this heading">#</a></h2>
<p><strong>1.1 Momentum and Position</strong></p>
<p>In this first example, the momentum operator (defined in pysycomp as <code class="docutils literal notranslate"><span class="pre">lin_mom(x,</span> <span class="pre">exp)</span></code> where <code class="docutils literal notranslate"><span class="pre">x</span></code> is the variable of interest, and the position <code class="docutils literal notranslate"><span class="pre">q</span></code> is shown. You can calculate the commutator by using the <code class="docutils literal notranslate"><span class="pre">comm(commutator_1,</span> <span class="pre">commutator_2,</span> <span class="pre">aux)</span></code> function. The first arguement is the first variable, the second argument is the second variable, and the <code class="docutils literal notranslate"><span class="pre">aux</span></code> argument describes the auxilliary function, usually of the form <code class="docutils literal notranslate"><span class="pre">f(var)</span></code> where <code class="docutils literal notranslate"><span class="pre">var</span></code> represents the variable of interest, which is usually what the first and second variables are with respect to.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">lin_mom</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">comm</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c8b371a414db0c2efbb71498a9e2613d5c44978451483eebf49ee0a6cafe3e2e.png" src="../_images/c8b371a414db0c2efbb71498a9e2613d5c44978451483eebf49ee0a6cafe3e2e.png" />
</div>
</div>
<p>A non-zero answer shows that both the momentum and position cannot be known simulataneously.</p>
<p><strong>1.2 Momentum and Momentum</strong></p>
<p>Now, we can calculate the commutator between two different momenta, <code class="docutils literal notranslate"><span class="pre">p</span></code> (as defined in part <strong>1</strong>) and <code class="docutils literal notranslate"><span class="pre">p1</span></code>, which is taken with respect to <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span> <span class="o">=</span> <span class="n">lin_mom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">comm</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7c06c283855ab6e39f0773271bd59bc5b03bd7cee6531fb026e8cc6f5faf6294.png" src="../_images/7c06c283855ab6e39f0773271bd59bc5b03bd7cee6531fb026e8cc6f5faf6294.png" />
</div>
</div>
<p>Since we received <code class="docutils literal notranslate"><span class="pre">0</span></code> as our answer, both momenta can be known simulataneously.</p>
<p><strong>1.3 Angular Momentum</strong></p>
<p>Lastly, we can calculate the commutator between two angular momentum operators. Note that this is a two-step process. First, we shall use the <code class="docutils literal notranslate"><span class="pre">comm()</span></code> function as described in the previous two sections. Then, we must simplify further.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L_z</span><span class="p">,</span> <span class="n">L_y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;L_z, L_y&quot;</span><span class="p">)</span>

<span class="n">xl</span> <span class="o">=</span> <span class="n">comm</span><span class="p">(</span><span class="n">L_z</span><span class="p">,</span> <span class="n">L_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>

<span class="n">xl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8ebdb7405528e087a160f4aa4eeaf9c5411156456a51f785ddb620dcf00eeeaf.png" src="../_images/8ebdb7405528e087a160f4aa4eeaf9c5411156456a51f785ddb620dcf00eeeaf.png" />
</div>
</div>
<p>Now, we are able to simplify the above expression by using the <code class="docutils literal notranslate"><span class="pre">factorization(var,</span> <span class="pre">var)</span></code> command where the second argument is the variable in which the auxilliary function (<code class="docutils literal notranslate"><span class="pre">f(x)</span></code>) is taken with respect to.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factorization</span><span class="p">(</span><span class="n">xl</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5da787a3477e14dd2f05e71fe836dca61a1fa9d11eb1f859d0fbddf358f298bc.png" src="../_images/5da787a3477e14dd2f05e71fe836dca61a1fa9d11eb1f859d0fbddf358f298bc.png" />
</div>
</div>
</section>
<section id="heisenberg-equations-of-motion">
<h2>2. Heisenberg Equations of Motion<a class="headerlink" href="#heisenberg-equations-of-motion" title="Link to this heading">#</a></h2>
<p>We will be using the <code class="docutils literal notranslate"><span class="pre">ham(p,</span> <span class="pre">q)</span></code> function, which is the Hamiltonian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ham</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e008edefd69f875ef43a9c2d1b07e0ae3f08cbbddf148de1fde3ba5445a1365e.png" src="../_images/e008edefd69f875ef43a9c2d1b07e0ae3f08cbbddf148de1fde3ba5445a1365e.png" />
</div>
</div>
<p>Please note that the placeholder of <code class="docutils literal notranslate"><span class="pre">1</span></code> is used when printing the Hamiltonian.</p>
<p>In this example, we will calculate the commutator:</p>
<div class="math notranslate nohighlight">
\[[q, H]\]</div>
<p>This represents the commutator between <code class="docutils literal notranslate"><span class="pre">q</span></code>, the position, and <code class="docutils literal notranslate"><span class="pre">H</span></code>, the Hamiltonian. Because we are looking at the position, <code class="docutils literal notranslate"><span class="pre">q</span></code>, the auxilliary function as defined in the next cell is with respect to <code class="docutils literal notranslate"><span class="pre">q</span></code> as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">Operator</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="s2">&quot;f&quot;</span><span class="p">)(</span><span class="n">q</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>For simplicity, we may take the commutator, using the <code class="docutils literal notranslate"><span class="pre">time_deriv(var,</span> <span class="pre">order)</span></code> function as defined in QHD. This function utilizes the <code class="docutils literal notranslate"><span class="pre">comm</span></code> function as described in the previous parts.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_deriv</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/975382c87d014233c1b5306c60168174faf85f22ff936f31327c0a3288080f8f.png" src="../_images/975382c87d014233c1b5306c60168174faf85f22ff936f31327c0a3288080f8f.png" />
</div>
</div>
<p>We can also take the commutator of <code class="docutils literal notranslate"><span class="pre">p</span></code> and the Hamiltonian, <code class="docutils literal notranslate"><span class="pre">ham</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">time_deriv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/547b63dd151d410d356bf5a1c651ad9dc90547a75b37318ae9becfeb96efa0f6.png" src="../_images/547b63dd151d410d356bf5a1c651ad9dc90547a75b37318ae9becfeb96efa0f6.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ii-pib">
<h1>II. PIB<a class="headerlink" href="#ii-pib" title="Link to this heading">#</a></h1>
<section id="normalizing-particle-in-a-box">
<h2>1. Normalizing Particle in a Box<a class="headerlink" href="#normalizing-particle-in-a-box" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../src&#39;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pysycomp</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<p>This can be done in one line, using the <code class="docutils literal notranslate"><span class="pre">PIB()</span></code> function, and the <code class="docutils literal notranslate"><span class="pre">normalization_constant()</span></code> function</p>
<ol class="arabic simple">
<li><p>Try running just the <code class="docutils literal notranslate"><span class="pre">PIB()</span></code> function with variables <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">L</span></code>, and <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Now, try normalizing using the <code class="docutils literal notranslate"><span class="pre">normalization_constant()</span></code> function with the same parameters, from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p></li>
</ol>
<p>Please note the normalization constant provides the <em>constant</em> and not the normalized wave function. To get the normalized wave function, multiply the normalization constant with the original wave function.</p>
<ol class="arabic simple" start="3">
<li><p>What is the normalized wave function?</p></li>
</ol>
<p>The normalized Particle in a Box, although we were able to compute it, is given by the function <code class="docutils literal notranslate"><span class="pre">PIB_normalize()</span></code> with the same parameters as the <code class="docutils literal notranslate"><span class="pre">PIB()</span></code> function. You can check your answers to number 3 by using the below function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PIB_normalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03657b532ad286a46aabb6bc4fc276b7a3b42293c6071757aa0b742e8f0929b2.png" src="../_images/03657b532ad286a46aabb6bc4fc276b7a3b42293c6071757aa0b742e8f0929b2.png" />
</div>
</div>
</section>
<section id="expectation-value-of-the-position-operator-for-particle-in-a-box">
<h2>2. Expectation Value of the Position Operator for Particle in a Box<a class="headerlink" href="#expectation-value-of-the-position-operator-for-particle-in-a-box" title="Link to this heading">#</a></h2>
<p>We can also do a simple positional expectation value using the normalized Particle in a Box.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">expectation_value()</span></code> function calculates the expectation value for an operator of interest. In this example we are using the “x”, or positional, operator.</p>
<ol class="arabic simple" start="4">
<li><p>Find the position (<code class="docutils literal notranslate"><span class="pre">x</span></code>) expectation value of a one dimensional particle in a box from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p></li>
</ol>
<p>The expectation value is the average value of an operator for a given WaveFunction between certain bounds. This quantity, L/2, for the positional operator, indicates the most likely location to find the particle in a 1-dimensional box at L/2, which is the center of the box.</p>
</section>
<section id="expectation-value-of-the-kinetic-energy-operator-for-particle-in-a-box">
<h2>Expectation Value of the Kinetic Energy Operator for Particle in a Box<a class="headerlink" href="#expectation-value-of-the-kinetic-energy-operator-for-particle-in-a-box" title="Link to this heading">#</a></h2>
<p>Now, we can calculate the kinetic energy expectation value for a one-dimensional particle in a box.</p>
<ol class="arabic simple" start="5">
<li><p>Find the kinetic energy (<code class="docutils literal notranslate"><span class="pre">kinetic_energy()</span></code>) expectation value for a one-dimensional particle in a box from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">L</span></code>.</p></li>
</ol>
</section>
<section id="graphing-the-wavefunction-of-particle-in-a-box">
<h2>Graphing the WaveFunction of Particle in a Box<a class="headerlink" href="#graphing-the-wavefunction-of-particle-in-a-box" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">PIB_normalized</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))))</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Length of Box&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Length of Box&#39;)
</pre></div>
</div>
<img alt="../_images/cc071b5e062dbea5fef087f03fb88e51ffb086040f391c702991a06581b2bcd3.png" src="../_images/cc071b5e062dbea5fef087f03fb88e51ffb086040f391c702991a06581b2bcd3.png" />
</div>
</div>
<ol class="arabic simple" start="6">
<li><p>Plot the wave function for n = 2 for a one-dimensional particle in a box.</p></li>
</ol>
</section>
<section id="normalzing-2-dimensional-particle-in-a-box">
<h2>Normalzing 2-Dimensional Particle in a Box<a class="headerlink" href="#normalzing-2-dimensional-particle-in-a-box" title="Link to this heading">#</a></h2>
<p>Let’s look at a particle in a square box with length <code class="docutils literal notranslate"><span class="pre">L</span></code>. We can use the pre-defined <code class="docutils literal notranslate"><span class="pre">PIB_2D()</span></code> function to calculate this, along with the <code class="docutils literal notranslate"><span class="pre">normalization_constant()</span></code> function used with the one-dimensional box.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">L_x</span><span class="p">,</span> <span class="n">L_y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x, y, L_x, L_y&quot;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">normalization_constant</span><span class="p">(</span><span class="n">PIB_2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{cases} \frac{2}{\sqrt{L^{2}}} &amp; \text{for}\: L &gt; -\infty \wedge L &lt; \infty \wedge L \neq 0 \\\tilde{\infty} &amp; \text{otherwise} \end{cases}\end{split}\]</div>
</div>
</div>
</section>
<section id="graphing-the-wavefunction-of-2-d-particle-in-a-box">
<h2>Graphing the WaveFunction of 2-D Particle in a Box<a class="headerlink" href="#graphing-the-wavefunction-of-2-d-particle-in-a-box" title="Link to this heading">#</a></h2>
<p>To plot in 3D, the pysycomp function <code class="docutils literal notranslate"><span class="pre">plot_function()</span></code> is used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n_x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n_y</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x, y&quot;</span><span class="p">)</span>

<span class="n">plot_function</span><span class="p">(</span><span class="n">PIB_2D_normalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/725d73683e3f5718537db3e88371969ef283326deb7dadc19d8b96e563b3f570.png" src="../_images/725d73683e3f5718537db3e88371969ef283326deb7dadc19d8b96e563b3f570.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sympy.plotting.plot.Plot at 0x7f8c412712a0&gt;
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="7">
<li><p>Plot the three-dimensional wave function for n = 2</p></li>
</ol>
</section>
<section id="answers">
<h2>Answers<a class="headerlink" href="#answers" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x, y, L&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple">
<li></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PIB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bd2c4cd27a6acbf5195f48e40542b410779e56c9f5141ca9b943c481d9960e1a.png" src="../_images/bd2c4cd27a6acbf5195f48e40542b410779e56c9f5141ca9b943c481d9960e1a.png" />
</div>
</div>
<ol class="arabic simple" start="2">
<li></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normalization_constant</span><span class="p">(</span><span class="n">PIB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{cases} \frac{\sqrt{2}}{\sqrt{L}} &amp; \text{for}\: \left(L &gt; -\infty \vee L &gt; 0\right) \wedge \left(L &gt; -\infty \vee L &lt; \infty\right) \wedge \left(L &gt; 0 \vee L &lt; 0\right) \wedge \left(L &lt; 0 \vee L &lt; \infty\right) \\\tilde{\infty} &amp; \text{otherwise} \end{cases}\end{split}\]</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">L</span><span class="p">))</span><span class="o">*</span><span class="n">PIB</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0d7d92c483507dba0e078add229ff626701f5f408078f49387eb8f5b379957ca.png" src="../_images/0d7d92c483507dba0e078add229ff626701f5f408078f49387eb8f5b379957ca.png" />
</div>
</div>
<ol class="arabic simple" start="4">
<li></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expectation_value</span><span class="p">(</span><span class="n">PIB_normalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">PIB_normalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1778bf3977ee6026682eb2269dad58980f09def6aa5679884d9dbf6f8a74e676.png" src="../_images/1778bf3977ee6026682eb2269dad58980f09def6aa5679884d9dbf6f8a74e676.png" />
</div>
</div>
<ol class="arabic simple" start="5">
<li></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expectation_value</span><span class="p">(</span><span class="n">PIB_normalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">kinetic_energy</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">PIB_normalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \begin{cases} \frac{\pi^{2} \hbar^{2}}{2 L^{2} m} &amp; \text{for}\: L &gt; -\infty \wedge L &lt; \infty \wedge L \neq 0 \\0 &amp; \text{otherwise} \end{cases}\end{split}\]</div>
</div>
</div>
<ol class="arabic simple" start="6">
<li></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">PIB_normalized</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))))</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Length of Box&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Length of Box&#39;)
</pre></div>
</div>
<img alt="../_images/e1f2ca5c7151bebd806c32fb6eb2e7b136dae18e9558dca684923a4d9f2fc3cc.png" src="../_images/e1f2ca5c7151bebd806c32fb6eb2e7b136dae18e9558dca684923a4d9f2fc3cc.png" />
</div>
</div>
<ol class="arabic simple" start="7">
<li></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x, y&quot;</span><span class="p">)</span>

<span class="n">plot_function</span><span class="p">(</span><span class="n">PIB_2D_normalized</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b334cc5893c87d67d8af8bb9859509c2f0fc8b19f22d4579ff48feb6b1d7a223.png" src="../_images/b334cc5893c87d67d8af8bb9859509c2f0fc8b19f22d4579ff48feb6b1d7a223.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sympy.plotting.plot.Plot at 0x7f8c40c670d0&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="iii-the-morse-potential">
<h1>III. The Morse Potential<a class="headerlink" href="#iii-the-morse-potential" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../src&#39;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pysycomp</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>For this first module, we will be looking at a morse potential.</p>
<section id="the-potential">
<h2>1. The Potential<a class="headerlink" href="#the-potential" title="Link to this heading">#</a></h2>
<p>We first must define the potential along with its parameters, as described below for the O-H stretch in a water molecule.</p>
<p><strong>Parameters</strong></p>
<p><span class="math notranslate nohighlight">\(D = 4.419 eV\)</span></p>
<p><span class="math notranslate nohighlight">\(\alpha = 2.567 A^{(-1)}\)</span></p>
<p><span class="math notranslate nohighlight">\(q_0 = 0 A\)</span></p>
<p><strong>Potential</strong></p>
<p><span class="math notranslate nohighlight">\(V(q) = D*(1-e^{-\alpha(q-q_0)})^2\)</span></p>
<p>We can define this potential as <code class="docutils literal notranslate"><span class="pre">potential</span></code>, and define the given parameters as <code class="docutils literal notranslate"><span class="pre">D</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, and <code class="docutils literal notranslate"><span class="pre">q_0</span></code> as described below. We will also need to define the dependent variable, in this case <code class="docutils literal notranslate"><span class="pre">q</span></code> as a range using the <code class="docutils literal notranslate"><span class="pre">linspace</span></code> function found in <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. The parameters are all in <em>atomic units</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="mf">4.419</span> 
<span class="n">D1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">D2</span> <span class="o">=</span> <span class="mi">10</span> 
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">2.567</span> <span class="c1"># Angstrom(-1) </span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Angstrom</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="c1"># Angstrom</span>

<span class="n">potential</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">q_0</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">potential1</span> <span class="o">=</span> <span class="n">D1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">q_0</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">potential2</span> <span class="o">=</span> <span class="n">D2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">q_0</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Above values given in QHD paper for water O-H stretch</span>
</pre></div>
</div>
</div>
</div>
<p>Now that the parameters and potential have been defined, the potential can be plotted using the <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> library. Any of the lines can be changed as desired.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">potential1</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">potential2</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;D = 4.419 eV&quot;</span><span class="p">,</span> <span class="s2">&quot;D = 1 eV&quot;</span><span class="p">,</span> <span class="s2">&quot;D = 10 eV&quot;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="c1"># (Lower, Upper) limit of the y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Potential, V(q) / eV&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span> <span class="c1"># (Lower, Upper) limit of the x-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Position, q / $\AA$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;morse_vVq.png&#39;) # Save to this file name, as a png file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/791cfd9c036241cdc77d512bd6938bc84f465e4e4ae3fc44b5283834b994dff1.png" src="../_images/791cfd9c036241cdc77d512bd6938bc84f465e4e4ae3fc44b5283834b994dff1.png" />
</div>
</div>
</section>
<section id="derivation-of-qhd-formulas">
<h2>2. Derivation of  QHD formulas<a class="headerlink" href="#derivation-of-qhd-formulas" title="Link to this heading">#</a></h2>
<p>Here, we use the pysycomp library, able to derive the equations of motion in the QHD method. We will need to define the <code class="docutils literal notranslate"><span class="pre">q</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">p2</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">x2</span></code>, and <code class="docutils literal notranslate"><span class="pre">xp</span></code> variables. In order to do this, we must first calculate the first and second derivatives of the potential of interest, defined in section 1. We will also use a change of variables as well, described below.</p>
<p><strong>2.1 The First and Second Derivatives of the Potential</strong></p>
<p>To take the derivatives, we must represent the potential symbolically. This can be done by:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, we must define all the parameters as stated in section 1 as symbols:</span>

<span class="n">D</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;D, alpha, q&quot;</span><span class="p">)</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1"># When computing symbolically, we do not need to use the numpy exponential function.</span>

<span class="n">potential_sym</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">q_0</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Now that the potential is represented symbolically, we may take the first and second derivatives, described by <code class="docutils literal notranslate"><span class="pre">diff1</span></code> and <code class="docutils literal notranslate"><span class="pre">diff2</span></code>, respectively. Here you can use the <code class="docutils literal notranslate"><span class="pre">diff</span></code> function, which is found in the <code class="docutils literal notranslate"><span class="pre">sympy</span></code> library. This fuction takes the derivative symbolically with respect to the variable of interest, in this case <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">diff2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">diff1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="n">diff1</span><span class="p">,</span> <span class="n">diff2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/564cc385acc6dc5d92fdaecce80c6458bdc3c45c27de39ec3adc8265572d852e.png" src="../_images/564cc385acc6dc5d92fdaecce80c6458bdc3c45c27de39ec3adc8265572d852e.png" />
</div>
</div>
<p><strong>2.2 Change of Variable</strong></p>
<p>We can now perform a change of variables, using <code class="docutils literal notranslate"><span class="pre">x</span></code> to represent the exponential term:</p>
<div class="math notranslate nohighlight">
\[x=e^{-\alpha q}\]</div>
<p>And so:</p>
<div class="math notranslate nohighlight">
\[V(q)=D[x^2-2x]\]</div>
<p>We will now take the first and second derivatives of the original potential, and then perform the change of variables.</p>
<ul class="simple">
<li><p>The First Derivative:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>

<span class="n">diff11</span> <span class="o">=</span> <span class="n">diff1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">q_0</span><span class="p">)),</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">q_0</span><span class="p">)),</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">diff11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d83cd1a7d6c8d8d72298ec51beec40dbd7368d8c11627eac2589ec053c525c0e.png" src="../_images/d83cd1a7d6c8d8d72298ec51beec40dbd7368d8c11627eac2589ec053c525c0e.png" />
</div>
</div>
<ul class="simple">
<li><p>The Second Derivative:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff22</span> <span class="o">=</span> <span class="n">diff2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">q_0</span><span class="p">)),</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">q_0</span><span class="p">)),</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">diff22</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/30b4f7072b42674becefe9a4af6de327832a81d4447f1be1260019c58bc56307.png" src="../_images/30b4f7072b42674becefe9a4af6de327832a81d4447f1be1260019c58bc56307.png" />
</div>
</div>
<p>By performing this change of variables, it makes solving for the equations of motion simpler. We can now solve for the equations of motion, using the new variable <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p><strong>2.3 Solving for the Equations of Motion</strong></p>
<p>We must solve the equations of motion for <code class="docutils literal notranslate"><span class="pre">q</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">x2</span></code>, and <code class="docutils literal notranslate"><span class="pre">xp</span></code> using the parameters defined in section 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Again, we must first define all variables as symbols. #</span>

<span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;q, p, p2, x, x2, xp, dt, mass, D, alpha&quot;</span><span class="p">)</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">alp</span> <span class="o">=</span> <span class="n">alpha</span>
<span class="n">aux</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

<span class="c1">########## EOM Calculations ##########</span>

<span class="n">px</span> <span class="o">=</span> <span class="n">xp</span>
<span class="n">q1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;q = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">q1</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">q</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-alpha*q)&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="n">x1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>

<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;v(q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">))</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-2*alpha*q)&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-alpha*q)&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;v(q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">))</span>
<span class="n">p21</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-alpha*q)&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-2*alpha*q)&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;alpha**2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-alpha*q)&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-2*alpha*q)&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p2 = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p21</span><span class="p">))</span>

<span class="c1">### Please note these last two need to be in functions to work properly.</span>

<span class="k">def</span><span class="w"> </span><span class="nf">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="mf">4.0</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">xp</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="mf">4.0</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">xp</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span>
    <span class="k">return</span> <span class="n">x2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x2 = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mf">3.0</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span>  <span class="o">-</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">dt</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span><span class="o">*</span><span class="n">xp</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mf">3.0</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span>  <span class="o">-</span> <span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">xp</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xp = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>q = dt*p/mass + q
x = -0.5*alpha*dt*xp/mass + x
p = dt*(1.0*D*alpha*x2 - 1.0*D*alpha*x) + p
p2 = dt*(-2.0*D*alpha*xp + 2.0*D*alpha*(-2*p*x**2 + p*x2 + 2*x*xp)) + p2
x2 = -2.0*alpha*dt*x*(-p*x + xp)/mass + (-2.0*alpha*dt*x*(-p*x + xp)/mass + x2)*exp(-2.0*alpha*dt*p/mass)
xp = 0.5*dt*(2.0*D*alpha*(x*(-2*x**2 + 3.0*x2) - x2) - alpha*x*(-2.0*p**2 + p2)/mass) + (0.5*dt*(2.0*D*alpha*(x*(-2*x**2 + 3.0*x2) - x2) - alpha*x*(-2.0*p**2 + p2)/mass) + xp)*exp(-2.0*alpha*dt*p/mass)
</pre></div>
</div>
</div>
</div>
<p>Now, we are ready to make plots of the data based on the EOM’s as computed above.</p>
</section>
<section id="graphing">
<h2>3. Graphing<a class="headerlink" href="#graphing" title="Link to this heading">#</a></h2>
<p><strong>3.1 Generating Time-Dependent Values</strong></p>
<p>We will first define all of the parameters necessary to perform the QHD calculations. The below parameters are defined as followed:</p>
<p><code class="docutils literal notranslate"><span class="pre">hbar</span></code>: Plancks constant</p>
<p><code class="docutils literal notranslate"><span class="pre">convert</span></code>: A conversion factor for the mass</p>
<p><code class="docutils literal notranslate"><span class="pre">mass</span></code>: The mass of the particle in the potential. In this case, the mass of a hydrogen atom is used.</p>
<p><code class="docutils literal notranslate"><span class="pre">q0</span></code>: The starting position value</p>
<p><code class="docutils literal notranslate"><span class="pre">p0</span></code>: The starting momentum value</p>
<p><code class="docutils literal notranslate"><span class="pre">s0</span></code>: The mean width</p>
<p><code class="docutils literal notranslate"><span class="pre">ps0</span></code>: The mean width momentum</p>
<p><code class="docutils literal notranslate"><span class="pre">alp</span></code> (<code class="docutils literal notranslate"><span class="pre">alpha</span></code>): A constant in the morse potential</p>
<p><code class="docutils literal notranslate"><span class="pre">D</span></code>: A constant in the morse potential</p>
<p><code class="docutils literal notranslate"><span class="pre">dt</span></code>: The time step used</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Constants #####</span>

<span class="n">hbar</span> <span class="o">=</span> <span class="mf">0.6582</span>  <span class="c1"># eV * fs</span>
<span class="n">convert</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">17.586</span><span class="p">)</span>

<span class="c1"># Feel free to change any of the below parameters to observe what happens when you change them</span>
<span class="n">mass</span> <span class="o">=</span> <span class="mf">2980.0</span><span class="o">*</span><span class="n">convert</span>
<span class="n">q0</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">ps0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">alp</span> <span class="o">=</span> <span class="mf">2.567</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">alp</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">4.419</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Q1.</strong> Qualitatively, how does the <code class="docutils literal notranslate"><span class="pre">D</span></code> value affect the potential? The <code class="docutils literal notranslate"><span class="pre">alpha</span></code> value?</p>
<p>Below, the initial conditions are described. These initial conditions describe a gaussian wavepacket, and do not need to be changed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Initial Conditions (Do Not Change) #####</span>

<span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>    
<span class="n">Etot</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p0</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="n">s0</span><span class="o">*</span><span class="n">s0</span>
<span class="n">pq</span> <span class="o">=</span> <span class="n">ps0</span><span class="o">*</span><span class="n">s0</span> <span class="o">+</span> <span class="n">q</span><span class="o">*</span><span class="n">p</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">ps0</span><span class="o">*</span><span class="n">ps0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">hbar</span><span class="o">/</span><span class="n">s0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alp</span><span class="o">*</span><span class="n">q0</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">q0</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">xq</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">s0</span><span class="o">*</span><span class="n">ps0</span><span class="o">*</span><span class="n">alp</span><span class="p">)</span>

<span class="n">xp</span> <span class="o">=</span> <span class="n">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Below, empty lists are created to store the data generated. Feel free to create your own lists to examine how different variables change over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Empty Lists for Data Storage: #####</span>

<span class="n">q_list</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">p_list</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Q2.</strong> Create an empty list for <code class="docutils literal notranslate"><span class="pre">p2</span></code> values and observe how this variable changes over time.</p>
<p>Now that the parameters have been defined, we can compute the desired values of position and momentum over a given time interval.</p>
<p><strong>Q3.</strong> Try changing the time step (<code class="docutils literal notranslate"><span class="pre">dt</span></code>) or the finish time (<code class="docutils literal notranslate"><span class="pre">t_f</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Time how long it takes to compute ###</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span> 
<span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading...&quot;</span><span class="p">)</span>

<span class="c1">### Compute the x values ###</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># step size</span>
<span class="n">t_i</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># start</span>
<span class="n">t_f</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># finish</span>

<span class="c1">#### --- Do Not Change Anything Below --- #####</span>

<span class="c1">### Compute the y values ###</span>

<span class="k">while</span> <span class="n">t_i</span><span class="o">&lt;=</span><span class="n">t_f</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>

    <span class="n">t_i</span> <span class="o">=</span> <span class="n">t_i</span> <span class="o">+</span> <span class="n">dt</span>

<span class="c1">##### --- #####</span>

    <span class="c1"># Here is where you add the lists to store data</span>
    
    <span class="n">q_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        
<span class="c1">### Compute the end time ###</span>
    
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># store end time</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  
<span class="c1"># total time taken</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total runtime is </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">begin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading...
Total runtime is 28.23112201690674
</pre></div>
</div>
</div>
</div>
<p>For the x values, we create a range with <code class="docutils literal notranslate"><span class="pre">(t_i,</span> <span class="pre">t_f,</span> <span class="pre">dt)</span></code> as the parameters. Due to the increasing nature of <code class="docutils literal notranslate"><span class="pre">t_i</span></code>, the initial value of <code class="docutils literal notranslate"><span class="pre">0.0</span></code> is used in its place.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Define the x values ###</span>

<span class="k">if</span> <span class="n">t_f</span> <span class="o">==</span> <span class="mi">1000</span> <span class="ow">and</span> <span class="n">dt</span> <span class="o">==</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span> <span class="o">+</span> <span class="n">dt</span>

<span class="n">x_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>3.2 Graphing Position versus Time</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">q_list</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Position, q / $\AA$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>
<span class="c1">#plt.savefig(&quot;morse_qvt.png&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a30766cfac3b99ffd140ee2fe257750bb30dab6b0cb4a765ca827c2be09d4b0d.png" src="../_images/a30766cfac3b99ffd140ee2fe257750bb30dab6b0cb4a765ca827c2be09d4b0d.png" />
</div>
</div>
<p><strong>3.3 Graphing Momentum versus Time</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">p_list</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum, p&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&quot;morse_pvt.png&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cf268dc3d6d9d2048797999ac466fde0df20a2e0b57652b435e555e97ae641b8.png" src="../_images/cf268dc3d6d9d2048797999ac466fde0df20a2e0b57652b435e555e97ae641b8.png" />
</div>
</div>
<p><strong>Q4.</strong> How does increasing <code class="docutils literal notranslate"><span class="pre">D</span></code> to <code class="docutils literal notranslate"><span class="pre">10</span></code> affect the position and momentum? What about decreasing to <code class="docutils literal notranslate"><span class="pre">1</span></code>?</p>
</section>
<section id="comparing-to-classical-equations-of-motion">
<h2>4. Comparing to Classical Equations of Motion<a class="headerlink" href="#comparing-to-classical-equations-of-motion" title="Link to this heading">#</a></h2>
<p>Here, you will compare classical equations of motion to the QHD equations of motion as described in the previous sections. In order to do this, we must repeat some of the above codes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Again, we must first define all variables as symbols. #</span>

<span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;q, p, p2, x, x2, xp, dt, mass, D, alpha&quot;</span><span class="p">)</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1">########## Classical EOM Calculations ##########</span>

<span class="n">px</span> <span class="o">=</span> <span class="n">xp</span>
<span class="n">q1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;q = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">q1</span><span class="p">))</span>


<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;v(q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">))</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>

<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;v(q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">))</span>
<span class="n">p21</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">p21</span><span class="p">)</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p2 = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p21</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>q = dt*p/mass + q
p = dt*(-1.0*D*alpha*exp(-alpha*q) + 1.0*D*alpha*exp(-2*alpha*q)) + p
p2 = dt*(2.0*D*alpha*p*exp(-alpha*q) - 2.0*D*alpha*p*exp(-2*alpha*q)) + p2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Constants #####</span>

<span class="n">hbar</span> <span class="o">=</span> <span class="mf">0.6582</span>  <span class="c1"># eV * fs</span>
<span class="n">convert</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">17.586</span><span class="p">)</span>

<span class="c1"># Feel free to change any of the below parameters to observe what happens when you change them</span>
<span class="n">mass</span> <span class="o">=</span> <span class="mf">2980.0</span><span class="o">*</span><span class="n">convert</span>
<span class="n">q0</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">ps0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">alp</span> <span class="o">=</span> <span class="mf">2.567</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">alp</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># Step size</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">4.417</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Initial Conditions (Do Not Change) #####</span>

<span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>    
<span class="n">Etot</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p0</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="n">s0</span><span class="o">*</span><span class="n">s0</span>
<span class="n">pq</span> <span class="o">=</span> <span class="n">ps0</span><span class="o">*</span><span class="n">s0</span> <span class="o">+</span> <span class="n">q</span><span class="o">*</span><span class="n">p</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">ps0</span><span class="o">*</span><span class="n">ps0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">hbar</span><span class="o">/</span><span class="n">s0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alp</span><span class="o">*</span><span class="n">q0</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">q0</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">xq</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">s0</span><span class="o">*</span><span class="n">ps0</span><span class="o">*</span><span class="n">alp</span><span class="p">)</span>

<span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Empty Lists for Data Storage: #####</span>

<span class="n">q_list_classical</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">p_list_classical</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Time how long it takes to compute ###</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span> 
<span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading...&quot;</span><span class="p">)</span>

<span class="c1">### Compute the x values ###</span>

<span class="n">t_i</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># start</span>
<span class="n">t_f</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># finish</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># timestep</span>


<span class="c1">### Compute the y values ###</span>

<span class="k">while</span> <span class="n">t_i</span><span class="o">&lt;=</span><span class="n">t_f</span><span class="p">:</span>

    <span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>

    <span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>

    <span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>


    <span class="n">t_i</span> <span class="o">=</span> <span class="n">t_i</span> <span class="o">+</span> <span class="n">dt</span>
        
    <span class="c1"># Here is where you add the lists to store data</span>
    <span class="n">q_list_classical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">p_list_classical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>


<span class="c1">### Compute the end time ###</span>
    
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># store end time</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  
<span class="c1"># total time taken</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total runtime is </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">begin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading...
Total runtime is 11.883639097213745
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Define the x values ###</span>

<span class="k">if</span> <span class="n">t_f</span> <span class="o">==</span> <span class="mi">1000</span> <span class="ow">and</span> <span class="n">dt</span> <span class="o">==</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span> <span class="o">+</span> <span class="n">dt</span>

<span class="n">x_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now plot the classical position and the QHD position on the same graph</p>
<p><strong>Q5.</strong> Predict qualitatively what the classical motion will look like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">q_list_classical</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">q_list</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Classical&quot;</span><span class="p">,</span> <span class="s2">&quot;QHD&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Position, q / $\AA$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&quot;morse_classical_comparison_qvt.png&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b45347967842094ffdfe1dc4ff7082a45bbe90c2835f3414fa91b57ea9f9ce9f.png" src="../_images/b45347967842094ffdfe1dc4ff7082a45bbe90c2835f3414fa91b57ea9f9ce9f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">p_list_classical</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">p_list</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Classical&quot;</span><span class="p">,</span> <span class="s2">&quot;QHD&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum, p&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&quot;morse_classical_comparison_pvt.png&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6b4f13aca52c55b4a29cfeb564c654507b17fe32e65e02fe1f0a235a57d0c125.png" src="../_images/6b4f13aca52c55b4a29cfeb564c654507b17fe32e65e02fe1f0a235a57d0c125.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="iv-the-gaussian-potential">
<h1>IV. The Gaussian Potential<a class="headerlink" href="#iv-the-gaussian-potential" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../src&#39;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pysycomp</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>We first must define the potential along with its parameters, as described below, given by Rossman et. al</p>
<section id="id1">
<h2>1. The Potential<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p><strong>Parameters</strong></p>
<p><span class="math notranslate nohighlight">\(v_0 = 1\)</span> Hartree</p>
<p><span class="math notranslate nohighlight">\(\sigma = 0.1\)</span> Angstrom</p>
<p><strong>Potential</strong></p>
<p><span class="math notranslate nohighlight">\(V(q)=-v_0*e^{(\frac{-q^2}{2*\sigma^2})}\)</span></p>
<p>We can define this potential as <code class="docutils literal notranslate"><span class="pre">potential</span></code>, and define the given parameters as <code class="docutils literal notranslate"><span class="pre">D</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, and <code class="docutils literal notranslate"><span class="pre">q_0</span></code> as described below. We will also need to define the dependent variable, in this case <code class="docutils literal notranslate"><span class="pre">q</span></code> as a range using the <code class="docutils literal notranslate"><span class="pre">linspace</span></code> function found in <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. The parameters are all in <em>atomic units</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v_0</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Hartree</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="c1"># Angstrom</span>
<span class="n">sigma1</span> <span class="o">=</span> <span class="mf">1.5</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">alpha1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">potential</span> <span class="o">=</span> <span class="o">-</span><span class="n">v_0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">potential1</span> <span class="o">=</span> <span class="o">-</span><span class="n">v_0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha1</span><span class="o">*</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that the parameters and potential have been defined, the potential can be plotted using the <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> library. Any of the lines can be changed as desired.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">potential</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">potential1</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">r</span><span class="s2">&quot;$\sigma$ = 0.75&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\sigma$ = 1.5&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Position, q / $\AA$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Potential, V(q) / eV&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&quot;gaussian_vVq.png&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7da52761b6f813be98d9f357b13159c12e7b06d7647e74edec0df3376203e50e.png" src="../_images/7da52761b6f813be98d9f357b13159c12e7b06d7647e74edec0df3376203e50e.png" />
</div>
</div>
</section>
<section id="id2">
<h2>2. Derivation of  QHD formulas<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>Here, we use the pysycomp library, able to derive the equations of motion in the QHD method. We will need to define the <code class="docutils literal notranslate"><span class="pre">q</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">p2</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">x2</span></code>, and <code class="docutils literal notranslate"><span class="pre">xp</span></code> variables. In order to do this, we must first calculate the first and second derivatives of the potential of interest, defined in section 1. We will also use a change of variables as well, described below.</p>
<p><strong>2.1 The First and Second Derivatives of the Potential</strong></p>
<p>To take the derivatives, we must represent the potential symbolically. This can be done by:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, we must define all the parameters as stated in section 1 as symbols:</span>

<span class="n">v_0</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;v_0, sigma q alpha&quot;</span><span class="p">)</span>

<span class="c1"># When computing symbolically, we do not need to use the numpy exponential function.</span>

<span class="n">potential_sym</span> <span class="o">=</span> <span class="o">-</span><span class="n">v_0</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that the potential is represented symbolically, we may take the first and second derivatives, described by diff1 and diff2, respectively</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">diff2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">diff1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="n">diff1</span><span class="p">,</span> <span class="n">diff2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5f49b26f7da3f3dd8bf81f0462f82beb9872e58bfa7f3ba684ec48c91703888b.png" src="../_images/5f49b26f7da3f3dd8bf81f0462f82beb9872e58bfa7f3ba684ec48c91703888b.png" />
</div>
</div>
<p><strong>2.2 Change of Variable</strong></p>
<p>We can do a change of variable in the potential to:</p>
<div class="math notranslate nohighlight">
\[x=e^{-\alpha*q^2}\]</div>
<p>And so:</p>
<div class="math notranslate nohighlight">
\[V(q)=A*x\]</div>
<p>We will now take the first and second derivatives of the original potential, and then perform the change of variables.</p>
<ul class="simple">
<li><p>The First Derivative:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>

<span class="n">diff11</span> <span class="o">=</span> <span class="n">diff1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>

<span class="n">diff11</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/294a6cc63300f3acd3b6c45606c04eca96b3ed5be83636df9b25946286caddbe.png" src="../_images/294a6cc63300f3acd3b6c45606c04eca96b3ed5be83636df9b25946286caddbe.png" />
</div>
</div>
<ul class="simple">
<li><p>The Second Derivative:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff22</span> <span class="o">=</span> <span class="n">diff2</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>

<span class="n">diff22</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a2c6c73d81240b23a0a6442a7b18a2ad255b3257a80602c50683258a46828cea.png" src="../_images/a2c6c73d81240b23a0a6442a7b18a2ad255b3257a80602c50683258a46828cea.png" />
</div>
</div>
<p><strong>2.3 Solving for the Equations of Motion</strong></p>
<p>We must solve the equations of motion for <code class="docutils literal notranslate"><span class="pre">q</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">x2</span></code>, and <code class="docutils literal notranslate"><span class="pre">xp</span></code> using the parameters defined in section 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Again, we must first define all variables as symbols. #</span>

<span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;q, p, p2, x, x2, xp, dt, mass, D, alpha, sigma q2&quot;</span><span class="p">)</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1">########## EOM Calculations ##########</span>

<span class="c1"># If you want to see the output of any of the below, uncomment the desired print line. #</span>

<span class="n">px</span> <span class="o">=</span> <span class="n">xp</span>
<span class="n">q1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span>
<span class="c1">#print(&quot;q = &quot; + str(q1))</span>

<span class="n">q21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">q2</span><span class="p">)</span>
<span class="c1">#print(q21)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-alpha*q**2)&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="n">x1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
<span class="n">x1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;p*q*x&quot;</span><span class="p">,</span> <span class="s2">&quot;q*xp&quot;</span><span class="p">)</span>
<span class="c1">#print(&quot;x = &quot; + str(x1))</span>

<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;v(q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">))</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-2.0*q**2)&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;alpha**2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-alpha*q**2)&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="c1">#print(&quot;p = &quot; + str(p1))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;v(q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">))</span>
<span class="n">p21</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-alpha*q**2)&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-2*alpha*q**2)&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;alpha**2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-alpha*q**2)&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;exp(-2.0*q**2)&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">)</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;p*q*v_0*x&quot;</span><span class="p">,</span> <span class="s2">&quot;v_0*q*xp&quot;</span><span class="p">)</span>
<span class="c1">#print(&quot;p2 = &quot; + str(p21))</span>

<span class="c1">### Please note these last two need to be in functions to work properly.</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">xp</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="n">mass</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span> <span class="c1">#4.0*(alp/mass)*x*(xp - x*p)*0.5*dt</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="p">(</span><span class="n">dt</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">xp</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">p</span><span class="p">))</span><span class="o">/</span><span class="n">mass</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span>  <span class="c1">#4.0*(alp/mass)*x*(xp - x*p)*0.5*dt</span>
    <span class="k">return</span> <span class="n">x2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">mass</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">v_0</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="n">v_0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">q2</span><span class="o">*</span><span class="n">x2</span><span class="p">))</span><span class="c1">#0.5*dt*(2.0*alp*D*(x*(3.0*x2 - 2*x*x) - x2)  - (alp*x/mass)*(p2 - 2.0*p*p) )</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">dt</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">xp</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">p</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">mass</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">v_0</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="n">v_0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">q2</span><span class="o">*</span><span class="n">x2</span><span class="p">))</span><span class="c1">#0.5*dt*(2.0*alp*D*(x*(3.0*x2 - 2*x*x) - x2)  - (alp*x/mass)*(p2 - 2.0*p*p) )</span>
    <span class="k">return</span> <span class="n">xp</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we are ready to make plots of the data based on the EOM’s as computed above.</p>
</section>
<section id="id3">
<h2>3. Graphing<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p><strong>3.1 Generating Time-Dependent Values</strong></p>
<p>We will first define all of the parameters necessary to perform the QHD calculations as followed:</p>
<p><code class="docutils literal notranslate"><span class="pre">hbar</span></code>: Plancks constant</p>
<p><code class="docutils literal notranslate"><span class="pre">convert</span></code>: A conversion factor for the mass</p>
<p><code class="docutils literal notranslate"><span class="pre">mass</span></code>: The mass of the particle in the potential. In this case, the mass of a hydrogen atom is used.</p>
<p><code class="docutils literal notranslate"><span class="pre">q0</span></code>: The starting position value</p>
<p><code class="docutils literal notranslate"><span class="pre">p0</span></code>: The starting momentum value</p>
<p><code class="docutils literal notranslate"><span class="pre">s0</span></code>: The mean width</p>
<p><code class="docutils literal notranslate"><span class="pre">ps0</span></code>: The mean width momentum</p>
<p><code class="docutils literal notranslate"><span class="pre">sigma</span></code>: A constant in the guassian potential</p>
<p><code class="docutils literal notranslate"><span class="pre">alp</span></code> (<code class="docutils literal notranslate"><span class="pre">alpha</span></code>): A constant in the gaussian potential</p>
<p><code class="docutils literal notranslate"><span class="pre">D</span></code>: A constant in the gaussian potential</p>
<p><code class="docutils literal notranslate"><span class="pre">dt</span></code>: The time step used</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Constants #####</span>

<span class="n">v_0</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Hartree</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="c1"># Angstrom</span>
<span class="n">mass</span> <span class="o">=</span> <span class="mi">1836</span> <span class="c1"># a.u.</span>
<span class="n">hbar</span> <span class="o">=</span> <span class="mf">0.6582</span>  <span class="c1"># eV * fs</span>
<span class="n">convert</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">17.586</span><span class="p">)</span>


<span class="c1"># Feel free to change any of the below parameters to observe what happens when you change them</span>
<span class="n">mass</span> <span class="o">=</span>  <span class="mf">2980.0</span><span class="o">*</span><span class="n">convert</span>
<span class="n">q0</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">ps0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">alp</span> <span class="o">=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Q1.</strong> How does the <code class="docutils literal notranslate"><span class="pre">alpha</span></code> parameter change the potential, qualitatively?</p>
<p>Below, the initial conditions are described. These initial conditions describe a gaussian wavepacket, and do not need to be changed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Initial Conditions (Do Not Change) #####</span>

<span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>    
<span class="n">Etot</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p0</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="n">s0</span><span class="o">*</span><span class="n">s0</span>
<span class="n">pq</span> <span class="o">=</span> <span class="n">ps0</span><span class="o">*</span><span class="n">s0</span> <span class="o">+</span> <span class="n">q</span><span class="o">*</span><span class="n">p</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">ps0</span><span class="o">*</span><span class="n">ps0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">hbar</span><span class="o">/</span><span class="n">s0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alp</span><span class="o">*</span><span class="n">q0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">q0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">xq</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">s0</span><span class="o">*</span><span class="n">ps0</span><span class="o">*</span><span class="n">alp</span><span class="p">)</span>

<span class="c1">##### ----- #####</span>

<span class="n">xp</span> <span class="o">=</span> <span class="n">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
<span class="n">q2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q21</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">q2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q21</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Below, empty lists are created to store the data generated. Feel free to create your own lists to examine how different variables change over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Empty Lists for Data Storage: #####</span>

<span class="n">q_list</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">p_list</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Q2.</strong> Create an empty list for <code class="docutils literal notranslate"><span class="pre">p2</span></code> and <code class="docutils literal notranslate"><span class="pre">q2</span></code> values and observe how this variable changes over time.</p>
<p>Now that the parameters have been defined, we can compute the desired values of position and energy over a given time interval.</p>
<p><strong>Q3.</strong> Try changing the time step (<code class="docutils literal notranslate"><span class="pre">dt</span></code>) or the finish time (<code class="docutils literal notranslate"><span class="pre">t_f</span></code>). For running dissociation, only run for <code class="docutils literal notranslate"><span class="pre">t_f=19</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Time how long it takes to compute ###</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span> 
<span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading...&quot;</span><span class="p">)</span>

<span class="c1">### Compute the x values ###</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># step size</span>
<span class="n">t_i</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># start</span>
<span class="n">t_f</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># finish</span>


<span class="c1">#### --- Do Not Change Anything Below --- #####</span>

<span class="c1">### Compute the y values ###</span>

<span class="k">while</span> <span class="n">t_i</span><span class="o">&lt;=</span><span class="n">t_f</span><span class="p">:</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
    <span class="n">q2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q21</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">q2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q21</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">integrate_x2</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">integrate_xp</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span><span class="p">,</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>

    <span class="n">t_i</span> <span class="o">=</span> <span class="n">t_i</span> <span class="o">+</span> <span class="n">dt</span>

<span class="c1">##### --- #####</span>

    <span class="c1"># Here is where you add the lists to store data</span>
    
    <span class="n">q_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="c1">### Compute the end time ###</span>
    
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># store end time</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  
<span class="c1"># total time taken</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total runtime is </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">begin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading...
Total runtime is 21.93367099761963
</pre></div>
</div>
</div>
</div>
<p>For the x values, we create a range with <code class="docutils literal notranslate"><span class="pre">(t_i,</span> <span class="pre">t_f,</span> <span class="pre">dt)</span></code> as the parameters. Due to the increasing nature of <code class="docutils literal notranslate"><span class="pre">t_i</span></code>, the initial value of <code class="docutils literal notranslate"><span class="pre">0.0</span></code> is used in its place.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Define the x values ###</span>

<span class="k">if</span> <span class="n">t_f</span> <span class="o">==</span> <span class="mi">1000</span> <span class="ow">and</span> <span class="n">dt</span> <span class="o">==</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span> <span class="o">+</span> <span class="n">dt</span>

<span class="n">x_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>3.2 Graphing Position versus Time</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">q_list</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
<span class="c1">#plt.ylim(-0.8, 1.5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Position, q / $\AA$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;gaussian_qVt_15.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/52ce0efcd17ebd91f4cb045077bb87530ae055ebbc1ace7ce8f131e8b3406eca.png" src="../_images/52ce0efcd17ebd91f4cb045077bb87530ae055ebbc1ace7ce8f131e8b3406eca.png" />
</div>
</div>
<p><strong>3.3 Graphing Momentum versus Time</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">p_list</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
<span class="c1">#plt.ylim(-0.8, 30)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum, p&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;gaussian_pVt_15.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/55ff404ead993e272f5e29212e5ec7b732d7105ae5b0f0141549f1711b90da33.png" src="../_images/55ff404ead993e272f5e29212e5ec7b732d7105ae5b0f0141549f1711b90da33.png" />
</div>
</div>
<p><strong>Q4.</strong> How does increasing <code class="docutils literal notranslate"><span class="pre">sigma</span></code> to <code class="docutils literal notranslate"><span class="pre">1.5</span></code> affect the position and momentum?</p>
<p><strong>Q5.</strong> How does changing the starting position, <code class="docutils literal notranslate"><span class="pre">q0</span></code>, affect the position versus time? At what value of <code class="docutils literal notranslate"><span class="pre">q0</span></code> does the particle dissociate?</p>
</section>
<section id="id4">
<h2>4. Comparing to Classical Equations of Motion<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>Here, you will compare classical equations of motion to the QHD equations of motion as described in the previous sections. In order to do this, we must repeat some of the above codes.</p>
<p><strong>Q6.</strong> What do you predict the classical plot to look like? The QHD plot?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Again, we must first define all variables as symbols. #</span>

<span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;q, p, p2, x, x2, xp, dt, mass, D, alpha, sigma q2&quot;</span><span class="p">)</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1">########## EOM Calculations ##########</span>

<span class="c1"># If you want to see the output of any of the below, uncomment the desired print line. #</span>

<span class="c1"># There are two ways to derive the EOM&#39;s, using the `time_deriv` function and then the original way is with `QHD_int`</span>
<span class="c1"># The `time_deriv` function is used as it&#39;s more versatile at this time, however it&#39;s still not perfect.</span>
<span class="c1"># `QHD_int` uses the `time_deriv` function</span>

<span class="n">px</span> <span class="o">=</span> <span class="n">xp</span>
<span class="n">q1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;q = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">q1</span><span class="p">))</span>

<span class="n">q21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">q2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">q21</span><span class="p">)</span>

<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;v(q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">))</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">p1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>

<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_deriv</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;v(q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">))</span>
<span class="n">p21</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">sympify</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="n">p2</span><span class="p">)</span>
<span class="n">p21</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p2 = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p21</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>q = dt*p/mass + q
2*dt*p*q/mass + q2
p = -1.0*alpha*dt*q*v_0*exp(-alpha*q**2) + p
p2 = -2.0*alpha*dt*p*q*v_0*exp(-alpha*q**2) + p2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Constants #####</span>

<span class="n">v_0</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># Hartree</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="c1"># Angstrom</span>
<span class="n">mass</span> <span class="o">=</span> <span class="mi">1836</span> <span class="c1"># a.u.</span>

<span class="c1"># Feel free to change any of the below parameters to observe what happens when you change them</span>
<span class="n">hbar</span> <span class="o">=</span> <span class="mf">0.6582</span>  <span class="c1"># eV * fs</span>
<span class="n">convert</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">17.586</span><span class="p">)</span>
<span class="n">mass</span> <span class="o">=</span>  <span class="mf">2980.0</span><span class="o">*</span><span class="n">convert</span>
<span class="n">q0</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">ps0</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">alp</span> <span class="o">=</span> <span class="n">alpha</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Initial Conditions (Do Not Change) #####</span>

<span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>    
<span class="n">Etot</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">xp</span><span class="p">,</span><span class="n">xq</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p0</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="n">s0</span><span class="o">*</span><span class="n">s0</span>
<span class="n">pq</span> <span class="o">=</span> <span class="n">ps0</span><span class="o">*</span><span class="n">s0</span> <span class="o">+</span> <span class="n">q</span><span class="o">*</span><span class="n">p</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">ps0</span><span class="o">*</span><span class="n">ps0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">hbar</span><span class="o">/</span><span class="n">s0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alp</span><span class="o">*</span><span class="n">q0</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">q0</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">xq</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="n">alp</span><span class="o">*</span><span class="n">s0</span><span class="o">*</span><span class="n">s0</span><span class="p">)</span>
<span class="n">xp</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">s0</span><span class="o">*</span><span class="n">ps0</span><span class="o">*</span><span class="n">alp</span><span class="p">)</span>

<span class="c1">##### ----- #####</span>

<span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
<span class="n">q2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q21</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">q2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q21</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Empty Lists for Data Storage: #####</span>

<span class="n">q_list_classical</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">p_list_classical</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Time how long it takes to compute ###</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span> 
<span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading...&quot;</span><span class="p">)</span>

<span class="c1">### Compute the x values ###</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># step size</span>
<span class="n">t_i</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># start</span>
<span class="n">t_f</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># finish</span>


<span class="c1">### Compute the y values ###</span>

<span class="k">while</span> <span class="n">t_i</span><span class="o">&lt;=</span><span class="n">t_f</span><span class="p">:</span>

    <span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>
    <span class="n">q2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q21</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">q2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q21</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">p21</span><span class="p">)</span>

    <span class="n">t_i</span> <span class="o">=</span> <span class="n">t_i</span> <span class="o">+</span> <span class="n">dt</span>
    
    <span class="c1"># Here is where you add the lists to store data</span>
    <span class="n">q_list_classical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">p_list_classical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="c1">### Compute the end time ###</span>
    
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># store end time</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  
<span class="c1"># total time taken</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total runtime is </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">begin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading...
Total runtime is 9.537335872650146
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">t_f</span> <span class="o">==</span> <span class="mi">1000</span> <span class="ow">and</span> <span class="n">dt</span> <span class="o">==</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span> <span class="o">+</span> <span class="n">dt</span>

<span class="n">x_list_classical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">q_list</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list_classical</span><span class="p">,</span> <span class="n">q_list_classical</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.ylim(-2, 1.5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Position, q / $\AA$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;gaussian_qVt_classical_dissoc.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a0b490c5aef0a2e705735e8349a4c9515409bfd7dcdbbff2c70ac82aa394e67d.png" src="../_images/a0b490c5aef0a2e705735e8349a4c9515409bfd7dcdbbff2c70ac82aa394e67d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">p_list</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list_classical</span><span class="p">,</span> <span class="n">p_list_classical</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.ylim(-30, 40)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum, p&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;gaussian_pVt_classical_dissoc.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/056e76def2f07bd0cca97072eb4aa523c32eae238d45d1381f0bc0514d92bba5.png" src="../_images/056e76def2f07bd0cca97072eb4aa523c32eae238d45d1381f0bc0514d92bba5.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="v-the-double-well-potential">
<h1>V. The Double Well Potential<a class="headerlink" href="#v-the-double-well-potential" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;../src&#39;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pysycomp</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p><strong>1. The Potential</strong></p>
<p>We first must define the potential along with its parameters, as described below.</p>
<p><strong>Parameters</strong></p>
<p><span class="math notranslate nohighlight">\(m=1836\)</span> This is mass</p>
<p><span class="math notranslate nohighlight">\(\lambda=m\)</span> This is a constant which can be set equal to the mass, <code class="docutils literal notranslate"><span class="pre">m</span></code>, or any other value</p>
<p><span class="math notranslate nohighlight">\(B=2\)</span> This is simply a constant which can be changed as well</p>
<p><strong>Potential</strong></p>
<p><span class="math notranslate nohighlight">\(V(q)=(q^2 - B)^2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B1</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">B2</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">B3</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">potential1</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">potential2</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">potential3</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">potential1</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">potential2</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">potential3</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Potential, V(q) / eV&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Position, q / $\AA$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;B=5&quot;</span><span class="p">,</span> <span class="s2">&quot;B=2&quot;</span><span class="p">,</span> <span class="s2">&quot;B=0&quot;</span><span class="p">])</span>
<span class="c1">#plt.savefig(&#39;doublewell_vVq.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/39bab3fa2b6aa9105c64b9653c60401fe0b78010fb7e189e70670550465a006b.png" src="../_images/39bab3fa2b6aa9105c64b9653c60401fe0b78010fb7e189e70670550465a006b.png" />
</div>
</div>
<section id="id5">
<h2>2. Derivation of  QHD formulas<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>Here, we use the pysycomp library, able to derive the equations of motion in the QHD method. We will need to define the <code class="docutils literal notranslate"><span class="pre">q</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>, and <code class="docutils literal notranslate"><span class="pre">p2</span></code> variables. In order to do this, we must first calculate the first and second derivatives of the potential of interest, defined in section 1. We will also use a change of variables as well, described below.</p>
<p>Please note that because the potential is quadratic, we do not need a change of variables.</p>
<p><strong>2.1 The First and Second Derivatives of the Potential</strong></p>
<p>To take the derivatives, we must represent the potential symbollically. This can be done by:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, we must define all the parameters as stated in section 1 as symbols:</span>

<span class="n">q</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;q, B&quot;</span><span class="p">)</span>

<span class="c1"># When computing symbolically, we do not need to use the numpy exponential function.</span>

<span class="n">potential_sym</span> <span class="o">=</span><span class="p">(</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Now that the potential is represented symbolically, we may take the first and second derivatives, described by <code class="docutils literal notranslate"><span class="pre">diff1</span></code> and <code class="docutils literal notranslate"><span class="pre">diff2</span></code>, respectively. Here you can use the <code class="docutils literal notranslate"><span class="pre">diff</span></code> function, which is found in the <code class="docutils literal notranslate"><span class="pre">sympy</span></code> library. This fuction takes the derivative symbolically with respect to the variable of interest, in this case <code class="docutils literal notranslate"><span class="pre">q</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">potential_sym</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="n">diff2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">diff1</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="n">diff1</span><span class="p">,</span> <span class="n">diff2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/863c87736e5f707b8f7e4c5bc28ba871fb76fa84103e64ecd47a8f2b060e818c.png" src="../_images/863c87736e5f707b8f7e4c5bc28ba871fb76fa84103e64ecd47a8f2b060e818c.png" />
</div>
</div>
<p><strong>2.2 Solving for the Equations of Motion</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Again, we must first define all variables as symbols. #</span>

<span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;q, p, x, x2, xp, dt, mass, alpha, D&quot;</span><span class="p">)</span>



<span class="c1">########## EOM Calculations ##########</span>

<span class="n">q1</span> <span class="o">=</span> <span class="n">QHD_int</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1">#print(q1)</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">QHD_int</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Derivative(v(q), q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">diff1</span><span class="p">)))</span>

<span class="c1">#print(p1)</span>

<span class="n">p21</span> <span class="o">=</span> <span class="n">sympify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">QHD_int</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Derivative(v(q), (q, 2))&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">diff2</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Derivative(v(q), q)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">diff1</span><span class="p">)))</span>

<span class="c1">#print(p21)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we are ready to make plots of the data based on the EOM’s as computed above.</p>
</section>
<section id="id6">
<h2>3. Graphing<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<p><strong>3.1 Generating Time-Dependent Values</strong></p>
<p>We will first define all of the parameters necessary to perform the QHD calculations. The below parameters are defined as followed:</p>
<p><code class="docutils literal notranslate"><span class="pre">hbar</span></code>: Plancks constant</p>
<p><code class="docutils literal notranslate"><span class="pre">convert</span></code>: A conversion factor for the mass</p>
<p><code class="docutils literal notranslate"><span class="pre">mass</span></code>: The mass of the particle in the potential. In this case, the mass of a hydrogen atom is used.</p>
<p><code class="docutils literal notranslate"><span class="pre">q0</span></code>: The starting position value</p>
<p><code class="docutils literal notranslate"><span class="pre">p0</span></code>: The starting momentum value</p>
<p><code class="docutils literal notranslate"><span class="pre">s0</span></code>: The mean width</p>
<p><code class="docutils literal notranslate"><span class="pre">ps0</span></code>: The mean width momentum</p>
<p><code class="docutils literal notranslate"><span class="pre">B</span></code>: A constant in the double well potential</p>
<p><code class="docutils literal notranslate"><span class="pre">dt</span></code>: The time step used</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Constants #####</span>

<span class="n">hbar</span> <span class="o">=</span> <span class="mf">0.6582</span>  <span class="c1"># eV * fs</span>

<span class="c1"># Feel free to change any of the below parameters to observe what happens when you change them</span>
<span class="n">q0</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="n">p0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">ps0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">mass</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
<p>Below, the initial conditions are described. These initial conditions describe a gaussian wavepacket, and do not need to be changed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Initial Conditions (Do Not Change) #####</span>

<span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>    
<span class="n">Etot</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">Etot_cl0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">pq</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">q0</span><span class="p">,</span> <span class="n">p0</span>
<span class="n">q_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">q</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="n">s0</span><span class="o">*</span><span class="n">s0</span>
<span class="n">pq</span> <span class="o">=</span> <span class="n">ps0</span><span class="o">*</span><span class="n">s0</span> <span class="o">+</span> <span class="n">q</span><span class="o">*</span><span class="n">p</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">ps0</span><span class="o">*</span><span class="n">ps0</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">hbar</span><span class="o">/</span><span class="n">s0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
<span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">q1</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Below, empty lists are created to store the data generated. Feel free to create your own lists to examine how different variables change over time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">##### Empty Lists for Data Storage: #####</span>

<span class="n">q_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">p_list</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Q2.</strong> Create an empty list for <code class="docutils literal notranslate"><span class="pre">q2</span></code> values and observe how this variable changes over time.</p>
<p>Now that the parameters have been defined, we can compute the desired values of position and momentum over a given time interval.</p>
<p><strong>Q3.</strong> Try changing the time step (<code class="docutils literal notranslate"><span class="pre">dt</span></code>) or the finish time (<code class="docutils literal notranslate"><span class="pre">t_f</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Time how long it takes to compute ###</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">time</span> 
<span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading...&quot;</span><span class="p">)</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">t_i</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">t_f</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1">#### --- Do Not Change Anything Below --- #####</span>

<span class="c1">### Compute the y values ###</span>

<span class="k">while</span> <span class="n">t_i</span> <span class="o">&lt;=</span> <span class="n">t_f</span><span class="p">:</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
    
    <span class="n">q</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">q1</span><span class="p">))</span>

    <span class="n">p</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p1</span><span class="p">))</span>
    
    <span class="n">t_i</span> <span class="o">=</span> <span class="n">t_i</span> <span class="o">+</span> <span class="n">dt</span>
   
    <span class="c1">##### --- #####</span>

    <span class="c1"># Here is where you add the lists to store data</span>
    
    <span class="n">q_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="n">p_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    
<span class="c1">### Compute the end time ###</span>
    
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># store end time</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
  
<span class="c1"># total time taken</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total runtime is </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">begin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading...
Total runtime is 6.525593042373657
</pre></div>
</div>
</div>
</div>
<p>For the x values, we create a range with <code class="docutils literal notranslate"><span class="pre">(t_i,</span> <span class="pre">t_f,</span> <span class="pre">dt)</span></code> as the parameters. Due to the increasing nature of <code class="docutils literal notranslate"><span class="pre">t_i</span></code>, the initial value of <code class="docutils literal notranslate"><span class="pre">0.0</span></code> is used in its place.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Define the x values ###</span>

<span class="k">if</span> <span class="n">t_f</span> <span class="o">==</span> <span class="mi">1000</span> <span class="ow">and</span> <span class="n">dt</span> <span class="o">==</span> <span class="mf">0.1</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">t_f</span> <span class="o">=</span> <span class="n">t_f</span> <span class="o">+</span> <span class="n">dt</span>

<span class="n">x_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>3.2 Graphing Position versus Time</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">q_list</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Position, q / $\AA$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;doublewell_qVt_B5_-25.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/547060c9f76534a837cf3507404de6ec2af7a2c68cfcc6eb7ef4aeda48940bd8.png" src="../_images/547060c9f76534a837cf3507404de6ec2af7a2c68cfcc6eb7ef4aeda48940bd8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">p_list</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time / fs&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Momentum, p&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1">#plt.savefig(&#39;double_well_pvt_B5_-25.png&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e77d9017cc304e46ca425a3d27e6600bb170a9bc8095f0d655bfb68e10192df0.png" src="../_images/e77d9017cc304e46ca425a3d27e6600bb170a9bc8095f0d655bfb68e10192df0.png" />
</div>
</div>
<p><strong>Q4.</strong> How does decreasing <code class="docutils literal notranslate"><span class="pre">B</span></code> affect the position and momentum? How does it affect the shape of the potential?</p>
<p><strong>Q5.</strong> How does changing <code class="docutils literal notranslate"><span class="pre">q0</span></code> to <code class="docutils literal notranslate"><span class="pre">0.15</span></code> affect the position and momentum graphs?</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./17MCM_QM"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">I. Commutators</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-commutators">1. Introduction to Commutators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heisenberg-equations-of-motion">2. Heisenberg Equations of Motion</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ii-pib">II. PIB</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizing-particle-in-a-box">1. Normalizing Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-value-of-the-position-operator-for-particle-in-a-box">2. Expectation Value of the Position Operator for Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-value-of-the-kinetic-energy-operator-for-particle-in-a-box">Expectation Value of the Kinetic Energy Operator for Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphing-the-wavefunction-of-particle-in-a-box">Graphing the WaveFunction of Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalzing-2-dimensional-particle-in-a-box">Normalzing 2-Dimensional Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphing-the-wavefunction-of-2-d-particle-in-a-box">Graphing the WaveFunction of 2-D Particle in a Box</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#answers">Answers</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#iii-the-morse-potential">III. The Morse Potential</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-potential">1. The Potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-of-qhd-formulas">2. Derivation of  QHD formulas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphing">3. Graphing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-to-classical-equations-of-motion">4. Comparing to Classical Equations of Motion</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#iv-the-gaussian-potential">IV. The Gaussian Potential</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1. The Potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">2. Derivation of  QHD formulas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">3. Graphing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">4. Comparing to Classical Equations of Motion</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#v-the-double-well-potential">V. The Double Well Potential</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">2. Derivation of  QHD formulas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">3. Graphing</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonny, assisted by Tom
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>