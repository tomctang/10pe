
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sympy’s Symbolic Quantum Mechanics Package &#8212; Jonny Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=550f00eb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '0qm_qc_sympy-GOOD';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Jonny Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Math &amp; FP/Language</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Alevel/Alevel_math.html">A-level-math</a></li>
<li class="toctree-l1"><a class="reference internal" href="Alevel/Alevel_math_further.html">A-level-further</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_MCM.html">Math Computational Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_Lean.html">Lean</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CS &amp; Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Course_MIT6001Python.html">MIT_CS6001-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_MIT6002thinking.html">MIT_CS6002-CS</a></li>
<li class="toctree-l1"><a class="reference internal" href="PE_Informatics/PE100.html">Project Euler Q1-100</a></li>
<li class="toctree-l1"><a class="reference internal" href="PE_Informatics/PE200.html">Project Euler Q101-</a></li>
<li class="toctree-l1"><a class="reference internal" href="PE_Informatics/PE_tags.html">PE Tags &amp; Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_MCM_QM.html">Quantum Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_MCM_QFT.html">QFT</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="nb_past_courses.html">Past courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="geo/nb_Geo.html">Geography and Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="nb_lottery_simulator.html">Lottery Math</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notes by Tom</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="math/00intro_math.html">Math-FP-Lang Combo</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/01number_algebra.html">Number &amp; Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/02discrete_continuous.html">Discrete &amp; Continuous</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/03real_world.html">Real World Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="How_Dad_organise_QM.html">How Dad learn QM</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/10pe" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/0qm_qc_sympy-GOOD.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sympy’s Symbolic Quantum Mechanics Package</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Sympy’s Symbolic Quantum Mechanics Package</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-symbolic-qm-dirac">Basic Symbolic QM - dirac</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bras-and-kets">Bras and kets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-products">Tensor products</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#density-operator-and-matrix">Density Operator and Matrix</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-density-operator">Basic density operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#density-operator-for-spin-states">Density operator for spin states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-entropy-of-the-density-matrices">Evaluate entropy of the density matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#density-operators-with-tensor-products">Density operators with tensor products</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trace-operators-on-density-operators-with-spin-states">Trace operators on density operators with spin states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-trace-on-density-operators-with-mixed-state">Partial Trace on density operators with mixed state</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-trace-on-density-operators-with-spin-states">Partial trace on density operators with spin states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-of-qapply-on-density-matrices-with-spin-states">Examples of <code class="docutils literal notranslate"><span class="pre">qapply()</span></code> on density matrices with spin states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-qapply-on-density-matrices-with-qubits">Example of <code class="docutils literal notranslate"><span class="pre">qapply()</span></code> on density matrices with qubits</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-angular-momentum">Quantum Angular Momentum</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-spin-states-and-operators">Basic spin states and operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#utilizing-different-bases">Utilizing different bases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotation-operator">Rotation operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coupled-and-uncoupled-states-and-operators">Coupled and uncoupled states and operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coupled-states-and-operators">Coupled states and operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uncoupled-states-and-operators">Uncoupled states and operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coulping-and-uncoupling-states">Coulping and Uncoupling States</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-orbit-interaction">Spin-Orbit Interaction</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-calculation">Symbolic calculation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#d-simple-harmonic-oscillator">1D Simple Harmonic Oscillator</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#printing-of-operators">Printing Of Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#printing-of-states">Printing of States</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#properties">Properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-operator-and-hamiltonian">Number operator and Hamiltonian</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Properties</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representation">Representation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-quantum-computing-qubits">Symbolic Quantum Computing - qubits</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qubits">Qubits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gates">Gates</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#gate-decomposition">Gate Decomposition</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fidelity-of-quantum-states">Fidelity of quantum states</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-fidelity-using-spin-kets">Basic fidelity using spin kets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fidelity-with-qubit-states">Fidelity with qubit states</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#teleportation">Teleportation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Teleportation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dense-coding">Dense Coding</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Dense coding</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-error-correction">Quantum Error Correction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-fourier-transform">Quantum Fourier Transform</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qft-gate-and-circuit">QFT Gate and Circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qft-in-action">QFT in action</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grover-s-algorithm">Grover’s Algorithm</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grover-s-algorithm-for-3-qubits">Grover’s algorithm for 3 qubits</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sympy-s-symbolic-quantum-mechanics-package">
<h1>Sympy’s Symbolic Quantum Mechanics Package<a class="headerlink" href="#sympy-s-symbolic-quantum-mechanics-package" title="Link to this heading">#</a></h1>
<p>SymPy has a subpackage, <code class="docutils literal notranslate"><span class="pre">sympy.physics.quantum</span></code> implements a general symbolic QM. We mix a standard QM and Q information/computing (QC) as below.</p>
<p>QM Foundations</p>
<ul class="simple">
<li><p>dirac notation.ipynb (QM – absolutely fundamental formalism)</p></li>
<li><p>density.ipynb (QM – mixed states, statistical interpretation)</p></li>
<li><p>angular_momentum.ipynb (QM – core operator, must-know)</p></li>
<li><p>spin_orbit interaction.ipynb (QM – physical coupling, often tested)</p></li>
<li><p>sho1d.ipynb (QM – harmonic oscillator, cornerstone model)</p></li>
</ul>
<p>QC Core Tools</p>
<ul class="simple">
<li><p>qubits.ipynb (QM/QC bridge – two-level systems, essential for both)</p></li>
<li><p>decompose.ipynb (QC – gate decomposition, useful for implementation)</p></li>
<li><p>fidelity.ipynb (QC – measure of state overlap, key in protocols)</p></li>
<li><p>teleportation.ipynb (QC – fundamental protocol, conceptually important)</p></li>
<li><p>dense coding.ipynb (QC – paired with teleportation, shows entanglement power)</p></li>
<li><p>error_correction.ipynb (QC – crucial for real systems, higher-level)</p></li>
<li><p>qft.ipynb (QC – advanced, building block for Shor’s algorithm, etc.)</p></li>
<li><p>grovers.ipynb (QC – advanced, canonical quantum speedup algorithm)</p></li>
</ul>
<p>Example: using <code class="docutils literal notranslate"><span class="pre">sympy.physics.quantum</span></code> to create a 3 qubit <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_Fourier_transform">Quantum Fourier Transform</a>, decompose the circuit into primitive gates, and then visualize the circuit:</p>
<img src="https://raw.githubusercontent.com/tomctang/NB_img/main/qft_example.png" alt="exp.1" width="500">
</section>
<section class="tex2jax_ignore mathjax_ignore" id="basic-symbolic-qm-dirac">
<h1>Basic Symbolic QM - dirac<a class="headerlink" href="#basic-symbolic-qm-dirac" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from sympy import init_printing</span>
<span class="c1"># init_printing(use_latex=True)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Rational</span><span class="p">,</span> <span class="n">srepr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">expand</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.gate</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.grover</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qft</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFT</span><span class="p">,</span> <span class="n">IQFT</span><span class="p">,</span> <span class="n">Fourier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.circuitplot</span><span class="w"> </span><span class="kn">import</span> <span class="n">circuit_plot</span>
</pre></div>
</div>
</div>
</div>
<section id="bras-and-kets">
<h2>Bras and kets<a class="headerlink" href="#bras-and-kets" title="Link to this heading">#</a></h2>
<p>Symbolic kets can be created using the <code class="docutils literal notranslate"><span class="pre">Ket</span></code> class as seen below.
These ket instances are fully symbolic and behave exactly like the corresponding mathematical entities.
For example, one can form a linear combination using addition and scalar multiplication:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phi</span><span class="p">,</span> <span class="n">psi</span> <span class="o">=</span> <span class="n">Ket</span><span class="p">(</span><span class="s1">&#39;phi&#39;</span><span class="p">),</span> <span class="n">Ket</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="nb">complex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="nb">complex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">psi</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="n">phi</span><span class="p">;</span> <span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<p>Bras can be created using the <code class="docutils literal notranslate"><span class="pre">Bra</span></code> class directly or by using the <code class="docutils literal notranslate"><span class="pre">Dagger</span></code> class
on an expression involving kets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="o">=</span> <span class="n">Dagger</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">*</span><span class="n">state</span><span class="p">;</span> <span class="n">ip</span>
</pre></div>
</div>
</div>
</div>
<p>Because this is a standard SymPy expression, we can use standard SymPy functions and methods
for manipulating expression. Here we use expand to multiply this expression out, followed
by <code class="docutils literal notranslate"><span class="pre">qapply</span></code> which identifies inner and outer products in an expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">expand</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="operators">
<h2>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h2>
<p>SymPy also has a full set of classes for handling symbolic operators.  Here we create three operators,
one of which is hermitian:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">Operator</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">Operator</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">HermitianOperator</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">expand</span><span class="p">((</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#SymPy knows that operators do not commute in polynomial of operators</span>
</pre></div>
</div>
</div>
</div>
<p>Commutators of operators can also be created:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comm</span> <span class="o">=</span> <span class="n">Commutator</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">B</span><span class="p">,</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="p">);</span> <span class="n">comm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># expand() has custom logic for expanding standard commutator relations</span>
<span class="n">comm</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">commutator</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Any commutator can be performed (<span class="math notranslate nohighlight">\([A,B]\rightarrow AB-BA\)</span>) using the <code class="docutils literal notranslate"><span class="pre">doit</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Dagger</span></code> class also works with operators and is aware of the properties of unitary
and hermitian operators:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dagger</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tensor-products">
<h2>Tensor products<a class="headerlink" href="#tensor-products" title="Link to this heading">#</a></h2>
<p>Symbolic tensor products of operators and states can also be created and manipulated:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">op</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="o">+</span><span class="n">C</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span> <span class="c1"># Here simplification is automatic</span>
<span class="n">op</span><span class="o">*</span><span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<p>and expanded:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expand</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="density-operator-and-matrix">
<h1>Density Operator and Matrix<a class="headerlink" href="#density-operator-and-matrix" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: there is a bug in density.py that is preventing this from working, uncomment to reproduce</span>
<span class="c1"># from sympy import init_printing</span>
<span class="c1"># init_printing(use_latex=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.core.trace</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.density</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.spin</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Jx</span><span class="p">,</span> <span class="n">Jy</span><span class="p">,</span> <span class="n">Jz</span><span class="p">,</span> <span class="n">Jplus</span><span class="p">,</span> <span class="n">Jminus</span><span class="p">,</span> <span class="n">J2</span><span class="p">,</span>
    <span class="n">JxBra</span><span class="p">,</span> <span class="n">JyBra</span><span class="p">,</span> <span class="n">JzBra</span><span class="p">,</span>
    <span class="n">JxKet</span><span class="p">,</span> <span class="n">JyKet</span><span class="p">,</span> <span class="n">JzKet</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="basic-density-operator">
<h2>Basic density operator<a class="headerlink" href="#basic-density-operator" title="Link to this heading">#</a></h2>
<p>Create a density matrix using symbolic states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">Ket</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">Ket</span><span class="p">(</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">((</span><span class="n">psi</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),(</span><span class="n">phi</span><span class="p">,</span><span class="mf">0.5</span><span class="p">));</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">states</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">probs</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dagger</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">Operator</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">apply_op</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="density-operator-for-spin-states">
<h2>Density operator for spin states<a class="headerlink" href="#density-operator-for-spin-states" title="Link to this heading">#</a></h2>
<p>Now create a density operator using spin states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">up</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">down</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d2</span> <span class="o">=</span> <span class="n">Density</span><span class="p">((</span><span class="n">up</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),(</span><span class="n">down</span><span class="p">,</span><span class="mf">0.5</span><span class="p">));</span> <span class="n">d2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d2</span><span class="o">.</span><span class="n">apply_op</span><span class="p">(</span><span class="n">Jz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">((</span><span class="n">Jy</span><span class="o">*</span><span class="n">d2</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluate-entropy-of-the-density-matrices">
<h2>Evaluate entropy of the density matrices<a class="headerlink" href="#evaluate-entropy-of-the-density-matrices" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">entropy</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">entropy</span><span class="p">(</span><span class="n">represent</span><span class="p">(</span><span class="n">d2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">entropy</span><span class="p">(</span><span class="n">represent</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;numpy&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">entropy</span><span class="p">(</span><span class="n">represent</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;scipy.sparse&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="density-operators-with-tensor-products">
<h2>Density operators with tensor products<a class="headerlink" href="#density-operators-with-tensor-products" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;A B C D&#39;</span><span class="p">,</span><span class="n">commutative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>

<span class="n">t2</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">t2</span><span class="o">+</span><span class="n">t3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="trace-operators-on-density-operators-with-spin-states">
<h2>Trace operators on density operators with spin states<a class="headerlink" href="#trace-operators-on-density-operators-with-spin-states" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">JzKet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mf">0.5</span><span class="p">],[</span><span class="n">JzKet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mf">0.5</span><span class="p">]);</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tr</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="partial-trace-on-density-operators-with-mixed-state">
<h2>Partial Trace on density operators with mixed state<a class="headerlink" href="#partial-trace-on-density-operators-with-mixed-state" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;A B C D&#39;</span><span class="p">,</span><span class="n">commutative</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">t1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>

<span class="n">t2</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="n">t3</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="n">t3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tr</span> <span class="o">=</span> <span class="n">Tr</span><span class="p">(</span><span class="n">d</span><span class="p">,[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">tr</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="partial-trace-on-density-operators-with-spin-states">
<h2>Partial trace on density operators with spin states<a class="headerlink" href="#partial-trace-on-density-operators-with-spin-states" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tp1</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">JzKet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">JzKet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Trace out the <code class="docutils literal notranslate"><span class="pre">0</span></code> index:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">tp1</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tr</span><span class="p">(</span><span class="n">d</span><span class="p">,[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Trace out the <code class="docutils literal notranslate"><span class="pre">1</span></code> index:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">Tr</span><span class="p">(</span><span class="n">d</span><span class="p">,[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="examples-of-qapply-on-density-matrices-with-spin-states">
<h2>Examples of <code class="docutils literal notranslate"><span class="pre">qapply()</span></code> on density matrices with spin states<a class="headerlink" href="#examples-of-qapply-on-density-matrices-with-spin-states" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">Ket</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">Ket</span><span class="p">(</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">UnitaryOperator</span><span class="p">()</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">((</span><span class="n">psi</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),(</span><span class="n">phi</span><span class="p">,</span><span class="mf">0.5</span><span class="p">));</span> <span class="n">d</span>

<span class="n">qapply</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">up</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">down</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">((</span><span class="n">up</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),(</span><span class="n">down</span><span class="p">,</span><span class="mf">0.5</span><span class="p">))</span>

<span class="n">uMat</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">qapply</span><span class="p">(</span><span class="n">uMat</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-of-qapply-on-density-matrices-with-qubits">
<h2>Example of <code class="docutils literal notranslate"><span class="pre">qapply()</span></code> on density matrices with qubits<a class="headerlink" href="#example-of-qapply-on-density-matrices-with-qubits" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.gate</span><span class="w"> </span><span class="kn">import</span> <span class="n">UGate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Qubit</span>

<span class="n">uMat</span> <span class="o">=</span> <span class="n">UGate</span><span class="p">((</span><span class="mi">0</span><span class="p">,),</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]))</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="mf">0.5</span><span class="p">],[</span><span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#after applying Not gate</span>
<span class="n">qapply</span><span class="p">(</span><span class="n">uMat</span><span class="o">*</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="quantum-angular-momentum">
<h1>Quantum Angular Momentum<a class="headerlink" href="#quantum-angular-momentum" title="Link to this heading">#</a></h1>
<p>This file will show how to use the various objects and methods in the <code class="docutils literal notranslate"><span class="pre">sympy.physics.quantum.spin</span></code> module, with some examples. Much of the work in this module is based off Varschalovich “Quantum Theory of Angular Momentum”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">factor</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Sum</span><span class="p">,</span> <span class="n">symbols</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.spin</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Jminus</span><span class="p">,</span> <span class="n">Jx</span><span class="p">,</span> <span class="n">Jz</span><span class="p">,</span> <span class="n">J2</span><span class="p">,</span> <span class="n">J2Op</span><span class="p">,</span> <span class="n">JzKet</span><span class="p">,</span> <span class="n">JzKetCoupled</span><span class="p">,</span> <span class="n">Rotation</span><span class="p">,</span> <span class="n">WignerD</span><span class="p">,</span> <span class="n">couple</span><span class="p">,</span> <span class="n">uncouple</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Dagger</span><span class="p">,</span> <span class="n">hbar</span><span class="p">,</span> <span class="n">qapply</span><span class="p">,</span> <span class="n">represent</span><span class="p">,</span> <span class="n">TensorProduct</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="basic-spin-states-and-operators">
<h2>Basic spin states and operators<a class="headerlink" href="#basic-spin-states-and-operators" title="Link to this heading">#</a></h2>
<p>We can define simple spin states and operators and manipulate them with standard quantum machinery.</p>
<p>Define a spin ket:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jz</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">jz</span>
</pre></div>
</div>
</div>
</div>
<p>Find the vector representation of the state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">jz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Create and evaluate an innerproduct of a bra and a ket:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span> <span class="o">=</span> <span class="n">Dagger</span><span class="p">(</span><span class="n">jz</span><span class="p">)</span><span class="o">*</span><span class="n">jz</span>
<span class="n">ip</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ip</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Apply an angular momentum operator to the state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Jz</span><span class="o">*</span><span class="n">jz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">Jz</span><span class="o">*</span><span class="n">jz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Jminus</span><span class="o">*</span><span class="n">jz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">Jminus</span><span class="o">*</span><span class="n">jz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can also do this for symbolic angular momentum states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">j</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;j m&#39;</span><span class="p">)</span>
<span class="n">jz</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">);</span> <span class="n">jz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">J2</span><span class="o">*</span><span class="n">jz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">J2</span><span class="o">*</span><span class="n">jz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Find the matrix representation of a angular momentum operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">Jz</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="utilizing-different-bases">
<h2>Utilizing different bases<a class="headerlink" href="#utilizing-different-bases" title="Link to this heading">#</a></h2>
<p>Angular momentum states and operators can be transformed between different spin bases. We can rewrite states as states in another basis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jz</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">jz</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s2">&quot;Jx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Vector representation can also be done into different bases:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">jz</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">Jx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>When applying operators in another spin basis, any conversion necessary to apply the state is done, then the states are given back in the original basis. So in the following example, the state returned by <code class="docutils literal notranslate"><span class="pre">qapply</span></code> are in the <span class="math notranslate nohighlight">\(J_z\)</span> basis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Jx</span><span class="o">*</span><span class="n">jz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">Jx</span><span class="o">*</span><span class="n">jz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Rewriting states and applying operators between bases can also be done symbolically. In this case, the result is given in terms of Wigner-D matrix elements (see the next section for more information on the <code class="docutils literal notranslate"><span class="pre">Rotation</span></code> operator).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jz</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">jz</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s2">&quot;Jx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="rotation-operator">
<h2>Rotation operator<a class="headerlink" href="#rotation-operator" title="Link to this heading">#</a></h2>
<p>Arbitrary rotations of spin states, written in terms of Euler angles, can be modeled using the rotation operator. These methods are utilized to go between spin bases, as seen in the section above.</p>
<p>Define an arbitrary rotation operator. The given angles are Euler angles in the <code class="docutils literal notranslate"><span class="pre">z-y-z</span></code> convention.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;alpha beta gamma&#39;</span><span class="p">)</span>
<span class="n">Rotation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Find the Wigner-D matrix elements of the rotation operator as given by <span class="math notranslate nohighlight">\(\langle j, m'|\mathcal{R}(\alpha, \beta, \gamma)|j,m\rangle\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mp</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;mp&#39;</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">D</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<p>Numerical matrix elements can be evaluated using the <code class="docutils literal notranslate"><span class="pre">.doit()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">D</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The Wigner small-d matrix elements give rotations when <span class="math notranslate nohighlight">\(\alpha=\gamma=0\)</span>. These matrix elements can be found in the same manner as above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>You can also directly create a Wigner-D matrix element:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">WignerD</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="coupled-and-uncoupled-states-and-operators">
<h2>Coupled and uncoupled states and operators<a class="headerlink" href="#coupled-and-uncoupled-states-and-operators" title="Link to this heading">#</a></h2>
<p>States and operators can also written in terms of coupled or uncoupled angular momentum spaces.</p>
<section id="coupled-states-and-operators">
<h3>Coupled states and operators<a class="headerlink" href="#coupled-states-and-operators" title="Link to this heading">#</a></h3>
<p>Define a simple coupled state of two <span class="math notranslate nohighlight">\(j=1\)</span> spin states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jzc</span> <span class="o">=</span> <span class="n">JzKetCoupled</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span> <span class="n">jzc</span>
</pre></div>
</div>
</div>
</div>
<p>Note that the Hilbert space of coupled states is the direct sum of the coupled spin spaces. This can be seen in the matrix representation of coupled states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jzc</span><span class="o">.</span><span class="n">hilbert_space</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">jzc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can also couple more than two spaces together. See the <code class="docutils literal notranslate"><span class="pre">JzKetCoupled</span></code> documentation for more complex coupling schemes involving more than 2 spaces.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jzc</span> <span class="o">=</span> <span class="n">JzKetCoupled</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">jzc</span>
</pre></div>
</div>
</div>
</div>
<p>The normal operators are assumed to be diagonal in the corresponding coupled basis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">Jz</span><span class="o">*</span><span class="n">jzc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="uncoupled-states-and-operators">
<h3>Uncoupled states and operators<a class="headerlink" href="#uncoupled-states-and-operators" title="Link to this heading">#</a></h3>
<p>Uncoupled states are defined as tensor products of states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jzu</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">JzKet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span> <span class="n">jzu</span>
</pre></div>
</div>
</div>
</div>
<p>Vector representation of tensor product states gives the vector in the direct product space:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">jzu</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Uncoupled operators are also defined as tensor products:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jzopu</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">Jz</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">jzopu</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">jzopu</span><span class="o">*</span><span class="n">jzu</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Coupled operators which are diagonalized by uncoupled states (e.g. <span class="math notranslate nohighlight">\(J_z\)</span> and uncoupled <span class="math notranslate nohighlight">\(J_z\)</span> eigenstates) can also be applied:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">Jz</span><span class="o">*</span><span class="n">jzu</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Rewriting states works as before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jzu</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s2">&quot;Jx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="coulping-and-uncoupling-states">
<h3>Coulping and Uncoupling States<a class="headerlink" href="#coulping-and-uncoupling-states" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">couple</span></code> method will couple an uncoupled state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jzu</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">JzKet</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="n">couple</span><span class="p">(</span><span class="n">jzu</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Similarly, the uncouple method will uncouple a coupled state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jzc</span> <span class="o">=</span> <span class="n">JzKetCoupled</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="n">uncouple</span><span class="p">(</span><span class="n">jzc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Uncoupling can also be done with the <code class="docutils literal notranslate"><span class="pre">.rewrite</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jzc</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s2">&quot;Jz&quot;</span><span class="p">,</span> <span class="n">coupled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">uncouple</span></code> method can also uncouple normal states if given a set of spin bases to consider:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jz</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">uncouple</span><span class="p">(</span><span class="n">jz</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="spin-orbit-interaction">
<h1>Spin-Orbit Interaction<a class="headerlink" href="#spin-orbit-interaction" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">factor</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Sum</span><span class="p">,</span> <span class="n">symbols</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.spin</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Jminus</span><span class="p">,</span> <span class="n">Jx</span><span class="p">,</span> <span class="n">Jz</span><span class="p">,</span> <span class="n">J2</span><span class="p">,</span> <span class="n">J2Op</span><span class="p">,</span> <span class="n">JzKet</span><span class="p">,</span> <span class="n">JzKetCoupled</span><span class="p">,</span> <span class="n">Rotation</span><span class="p">,</span> <span class="n">WignerD</span><span class="p">,</span> <span class="n">couple</span><span class="p">,</span> <span class="n">uncouple</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Dagger</span><span class="p">,</span> <span class="n">hbar</span><span class="p">,</span> <span class="n">qapply</span><span class="p">,</span> <span class="n">represent</span><span class="p">,</span> <span class="n">TensorProduct</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="symbolic-calculation">
<h2>Symbolic calculation<a class="headerlink" href="#symbolic-calculation" title="Link to this heading">#</a></h2>
<p>If we start with a hydrogen atom, i.e. a nucleus of charge <span class="math notranslate nohighlight">\(Ze\)</span> orbited by a single electron of charge <span class="math notranslate nohighlight">\(e\)</span> with reduced mass <span class="math notranslate nohighlight">\(\mu\)</span>, ignoring energy from center-of-mass motion, we can write the Hamiltonian in terms of the relative momentum, <span class="math notranslate nohighlight">\(p\)</span>, and position, <span class="math notranslate nohighlight">\(r\)</span>, as:</p>
<div class="math notranslate nohighlight">
\[H=\frac{p^2}{2\mu} - \frac{Ze^2}{r}\]</div>
<p>The resulting eigenfunctions have a seperate radial and angular compents, <span class="math notranslate nohighlight">\(\psi=R_{n,l}(r)Y_{l,m}(\phi,\theta)\)</span>. While the radial component is a complicated function involving Laguere polynomials, the radial part is the familiar spherical harmonics with orbital angular momentum <span class="math notranslate nohighlight">\(\vec{L}\)</span>, where <span class="math notranslate nohighlight">\(l\)</span> and <span class="math notranslate nohighlight">\(m\)</span> give the orbital angular momentum quantum numbers. We represent this as a angular momentum state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l</span><span class="p">,</span> <span class="n">ml</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;l m_l&#39;</span><span class="p">)</span>
<span class="n">orbit</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">ml</span><span class="p">)</span>
<span class="n">orbit</span>
</pre></div>
</div>
</div>
</div>
<p>Now, the spin orbit interaction arises from the electron experiencing a magnetic field as it orbits the electrically charged nucleus. This magnetic field is:</p>
<div class="math notranslate nohighlight">
\[\vec{B} = \frac{1}{c}\frac{Ze\vec{v}\times\vec{r}}{r^3} = \frac{Ze\vec{p}\times\vec{r}}{mcr^3}=\frac{Ze\vec{L}}{mc\hbar r^3}\]</div>
<p>Then the spin-orbit Hamiltonian can be written, using the electron’s magnetic dipole moment <span class="math notranslate nohighlight">\(\mu\)</span>, as:</p>
<div class="math notranslate nohighlight">
\[H_{SO} = -\vec{\mu}\cdot\vec{B} = -\left(-\frac{g\mu_B \vec{S}}{\hbar}\right)\cdot\left(\frac{Ze\vec{L}}{mc\hbar r^3}\right)\]</div>
<p>Ignoring the radial term:</p>
<div class="math notranslate nohighlight">
\[\propto \vec{L}\cdot\vec{S} = J^2 - L^2 - S^2\]</div>
<p>for <span class="math notranslate nohighlight">\(\vec{J}\)</span>, the coupled angular momentum.</p>
<p>The electron spin angular momentum is given as <span class="math notranslate nohighlight">\(\vec{S}\)</span>, where the spin wavefunction is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ms</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;m_s&#39;</span><span class="p">)</span>
<span class="n">spin</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">ms</span><span class="p">)</span>
<span class="n">spin</span>
</pre></div>
</div>
</div>
</div>
<p>From this we build our uncoupled state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">orbit</span><span class="p">,</span> <span class="n">spin</span><span class="p">)</span>
<span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<p>For clarity we will define <span class="math notranslate nohighlight">\(L^2\)</span> and <span class="math notranslate nohighlight">\(S^2\)</span> operators. These behave the same as <code class="docutils literal notranslate"><span class="pre">J2</span></code>, they only display differently.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L2</span> <span class="o">=</span> <span class="n">J2Op</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">)</span>
<span class="n">S2</span> <span class="o">=</span> <span class="n">J2Op</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We also have the spin-orbit Hamiltonian:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hso</span> <span class="o">=</span> <span class="n">J2</span> <span class="o">-</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">L2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">S2</span><span class="p">)</span>
<span class="n">hso</span>
</pre></div>
</div>
</div>
</div>
<p>Now we apply this to our state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">apply1</span> <span class="o">=</span> <span class="n">qapply</span><span class="p">(</span><span class="n">hso</span><span class="o">*</span><span class="n">state</span><span class="p">)</span>
<span class="n">apply1</span>
</pre></div>
</div>
</div>
</div>
<p>Note this has not applied the coupled <span class="math notranslate nohighlight">\(J^2\)</span> operator to the states, so we couple the states and apply again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">apply2</span> <span class="o">=</span> <span class="n">qapply</span><span class="p">(</span><span class="n">couple</span><span class="p">(</span><span class="n">apply1</span><span class="p">))</span>
<span class="n">apply2</span>
</pre></div>
</div>
</div>
</div>
<p>We now collect the terms of the sum, since they share the same limits, and factor the result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">sum_term</span> <span class="ow">in</span> <span class="n">apply2</span><span class="o">.</span><span class="n">atoms</span><span class="p">(</span><span class="n">Sum</span><span class="p">):</span>
    <span class="n">subs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sum_term</span><span class="p">,</span> <span class="n">sum_term</span><span class="o">.</span><span class="n">function</span><span class="p">))</span>
    <span class="n">limits</span> <span class="o">=</span> <span class="n">sum_term</span><span class="o">.</span><span class="n">limits</span>
<span class="n">final</span> <span class="o">=</span> <span class="n">Sum</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">apply2</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">subs</span><span class="p">)),</span> <span class="n">limits</span><span class="p">)</span>
<span class="n">final</span>
</pre></div>
</div>
</div>
</div>
<p>This gives us the modification of the angular part of the spin-orbit Hamiltonian. We see there is now the new <span class="math notranslate nohighlight">\(j\)</span> quantum number in the coupled states, which we see from looking at the equation will have values <span class="math notranslate nohighlight">\(l\pm \frac{1}{2}\)</span>, and <span class="math notranslate nohighlight">\(m_j=m_l + m_s\)</span>. We still have the <span class="math notranslate nohighlight">\(l\)</span> and <span class="math notranslate nohighlight">\(s\)</span> quantum numbers.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="d-simple-harmonic-oscillator">
<h1>1D Simple Harmonic Oscillator<a class="headerlink" href="#d-simple-harmonic-oscillator" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">display_pretty</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.sho1d</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.tests.test_sho1d</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<section id="printing-of-operators">
<h2>Printing Of Operators<a class="headerlink" href="#printing-of-operators" title="Link to this heading">#</a></h2>
<p>Create a raising and lowering operator and make sure they print correctly</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span> <span class="o">=</span> <span class="n">RaisingOp</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">ad</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">LoweringOp</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">a</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">ad</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_pretty</span><span class="p">(</span><span class="n">ad</span><span class="p">)</span>
<span class="n">display_pretty</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">srepr</span><span class="p">(</span><span class="n">ad</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">srepr</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">ad</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="printing-of-states">
<h2>Printing of States<a class="headerlink" href="#printing-of-states" title="Link to this heading">#</a></h2>
<p>Create a simple harmonic state and check its printing</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">SHOKet</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">k</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">SHOBra</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pretty</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pretty</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">srepr</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">srepr</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="properties">
<h2>Properties<a class="headerlink" href="#properties" title="Link to this heading">#</a></h2>
<p>Take the dagger of the raising and lowering operators. They should return each other:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dagger</span><span class="p">(</span><span class="n">ad</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dagger</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Check commutators of the raising and lowering operators</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Commutator</span><span class="p">(</span><span class="n">ad</span><span class="p">,</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Commutator</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">ad</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Take a look at the dual states of the bra and ket</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="o">.</span><span class="n">dual</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">dual</span>
</pre></div>
</div>
</div>
</div>
<p>Taking the inner product of the bra and ket will return the Kronecker delta function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">InnerProduct</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Take a look at how the raising and lowering operators act on states. We use qapply to apply an operator to a state</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">ad</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>But the states may have an explicit energy level. Let’s look at the ground and first excited states</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kg</span> <span class="o">=</span> <span class="n">SHOKet</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kf</span> <span class="o">=</span> <span class="n">SHOKet</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">ad</span><span class="o">*</span><span class="n">kg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">ad</span><span class="o">*</span><span class="n">kf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">kf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="number-operator-and-hamiltonian">
<h2>Number operator and Hamiltonian<a class="headerlink" href="#number-operator-and-hamiltonian" title="Link to this heading">#</a></h2>
<p>Let’s look at the number operator and Hamiltonian operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">SHOKet</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ad</span> <span class="o">=</span> <span class="n">RaisingOp</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">LoweringOp</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">NumberOp</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">Hamiltonian</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The number operator is simply expressed as <code class="docutils literal notranslate"><span class="pre">ad*a</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The number operator expressed in terms of the position and momentum operators:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s1">&#39;xp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>It can also be expressed in terms of the Hamiltonian operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The Hamiltonian operator can be expressed in terms of the raising and lowering operators, position and momentum operators, and the number operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s1">&#39;xp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The raising and lowering operators can also be expressed in terms of the position and momentum operators</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s1">&#39;xp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="s1">&#39;xp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3>Properties<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Let’s take a look at how the number operator and Hamiltonian act on states:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Apply the number operator to a state returns the state times the ket:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ks</span> <span class="o">=</span> <span class="n">SHOKet</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qapply</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">ks</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">H</span><span class="o">*</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s see how the operators commute with each other:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Commutator</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">ad</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Commutator</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Commutator</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="representation">
<h2>Representation<a class="headerlink" href="#representation" title="Link to this heading">#</a></h2>
<p>We can express the operators in number operator basis. There are different ways to create a matrix in Python, we will use 3 different ways.</p>
<p>Sympy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">ad</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">ad</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">scipy.sparse</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sparse_rep</span> <span class="o">=</span> <span class="n">represent</span><span class="p">(</span><span class="n">ad</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;scipy.sparse&#39;</span><span class="p">,</span> <span class="n">spmatrix</span><span class="o">=</span><span class="s1">&#39;lil&#39;</span><span class="p">)</span>
<span class="n">sparse_rep</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sparse_rep</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The same can be done for the other operators</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Bras and kets can also be represented:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k0</span> <span class="o">=</span> <span class="n">SHOKet</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">k1</span> <span class="o">=</span> <span class="n">SHOKet</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b0</span> <span class="o">=</span> <span class="n">SHOBra</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">SHOBra</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">k0</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="symbolic-quantum-computing-qubits">
<h1>Symbolic Quantum Computing - qubits<a class="headerlink" href="#symbolic-quantum-computing-qubits" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">expand</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">srepr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.gate</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.grover</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qft</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFT</span><span class="p">,</span> <span class="n">IQFT</span><span class="p">,</span> <span class="n">Fourier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.circuitplot</span><span class="w"> </span><span class="kn">import</span> <span class="n">circuit_plot</span>
</pre></div>
</div>
</div>
</div>
<section id="qubits">
<h2>Qubits<a class="headerlink" href="#qubits" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;alpha beta&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;00&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">);</span> <span class="n">psi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Dagger</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">Dagger</span><span class="p">(</span><span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;00&#39;</span><span class="p">))</span><span class="o">*</span><span class="n">psi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">state</span><span class="p">,</span> <span class="n">prob</span> <span class="ow">in</span> <span class="n">measure_all</span><span class="p">(</span><span class="n">psi</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Qubits can be represented in the computational basis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="gates">
<h2>Gates<a class="headerlink" href="#gates" title="Link to this heading">#</a></h2>
<p>Gate objects are the operators which act on a quantum state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">g</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;00&#39;</span><span class="p">)</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">gate</span> <span class="ow">in</span> <span class="p">[</span><span class="n">H</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span><span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)]:</span>
        <span class="n">lhs</span> <span class="o">=</span> <span class="n">gate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">state</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="n">qapply</span><span class="p">(</span><span class="n">lhs</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="n">rhs</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<h2>Symbolic gate rules and circuit simplification</h2><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">g1</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">H</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">g2</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">H</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">Commutator</span><span class="p">(</span><span class="n">g1</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">g2</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">g1</span> <span class="o">!=</span> <span class="n">g2</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">e</span><span class="o">.</span><span class="n">doit</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_plot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>This performs a commutator/anticommutator aware bubble sort algorithm to simplify a circuit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gate_simp</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_plot</span><span class="p">(</span><span class="n">gate_simp</span><span class="p">(</span><span class="n">c</span><span class="p">),</span><span class="n">nqubits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="gate-decomposition">
<h1>Gate Decomposition<a class="headerlink" href="#gate-decomposition" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">expand</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.gate</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.grover</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qft</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFT</span><span class="p">,</span> <span class="n">IQFT</span><span class="p">,</span> <span class="n">Fourier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.circuitplot</span><span class="w"> </span><span class="kn">import</span> <span class="n">circuit_plot</span>
</pre></div>
</div>
</div>
</div>
<h2>Example 1</h2><p>Create a symbolic controlled-Y gate</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CY10</span> <span class="o">=</span> <span class="n">CGate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="n">CY10</span>
</pre></div>
</div>
</div>
</div>
<p>Decompose it into elementary gates and plot it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CY10</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_plot</span><span class="p">(</span><span class="n">CY10</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<h2>Example 2</h2><p>Create a controlled-Z gate</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CZ01</span> <span class="o">=</span> <span class="n">CGate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="n">CZ01</span>
</pre></div>
</div>
</div>
</div>
<p>Decompose and plot it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CZ01</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_plot</span><span class="p">(</span><span class="n">CZ01</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<h2>Example 3</h2><p>Create a SWAP gate</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SWAP10</span> <span class="o">=</span> <span class="n">SWAP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">SWAP10</span>
</pre></div>
</div>
</div>
</div>
<p>Decompose and plot it</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SWAP10</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_plot</span><span class="p">(</span><span class="n">SWAP10</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<h2>All together now</h2><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gates</span> <span class="o">=</span> <span class="p">[</span><span class="n">CGate</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Y</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">CGate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">SWAP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gates</span><span class="p">:</span>
    <span class="n">dg</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">dg</span><span class="p">))</span>
    <span class="n">circuit_plot</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">circuit_plot</span><span class="p">(</span><span class="n">dg</span><span class="p">,</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>    
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="fidelity-of-quantum-states">
<h1>Fidelity of quantum states<a class="headerlink" href="#fidelity-of-quantum-states" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Fidelity_of_quantum_states">https://en.wikipedia.org/wiki/Fidelity_of_quantum_states</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.density</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.spin</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Jx</span><span class="p">,</span> <span class="n">Jy</span><span class="p">,</span> <span class="n">Jz</span><span class="p">,</span> <span class="n">Jplus</span><span class="p">,</span> <span class="n">Jminus</span><span class="p">,</span> <span class="n">J2</span><span class="p">,</span>
    <span class="n">JxBra</span><span class="p">,</span> <span class="n">JyBra</span><span class="p">,</span> <span class="n">JzBra</span><span class="p">,</span>
    <span class="n">JxKet</span><span class="p">,</span> <span class="n">JyKet</span><span class="p">,</span> <span class="n">JzKet</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.core.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display_pretty</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.operator</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<section id="basic-fidelity-using-spin-kets">
<h2>Basic fidelity using spin kets<a class="headerlink" href="#basic-fidelity-using-spin-kets" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">up</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">down</span> <span class="o">=</span> <span class="n">JzKet</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">amp</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">updown</span> <span class="o">=</span> <span class="p">(</span><span class="n">amp</span> <span class="o">*</span> <span class="n">up</span> <span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">amp</span> <span class="o">*</span> <span class="n">down</span><span class="p">)</span>
<span class="n">updown</span>
</pre></div>
</div>
</div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">represent</span></code> turns the kets into matrices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">up_dm</span> <span class="o">=</span> <span class="n">represent</span><span class="p">(</span><span class="n">up</span> <span class="o">*</span> <span class="n">Dagger</span><span class="p">(</span><span class="n">up</span><span class="p">))</span>
<span class="n">down_dm</span> <span class="o">=</span> <span class="n">represent</span><span class="p">(</span><span class="n">down</span> <span class="o">*</span> <span class="n">Dagger</span><span class="p">(</span><span class="n">down</span><span class="p">))</span> 
<span class="n">updown_dm</span> <span class="o">=</span> <span class="n">represent</span><span class="p">(</span><span class="n">updown</span> <span class="o">*</span> <span class="n">Dagger</span><span class="p">(</span><span class="n">updown</span><span class="p">))</span>
<span class="n">updown_dm</span>
</pre></div>
</div>
</div>
</div>
<p>Another entangled state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">updown2</span> <span class="o">=</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="p">)</span><span class="o">*</span> <span class="n">up</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">down</span>
<span class="n">updown2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fidelity</span><span class="p">(</span><span class="n">up_dm</span><span class="p">,</span> <span class="n">up_dm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fidelity</span><span class="p">(</span><span class="n">up_dm</span><span class="p">,</span> <span class="n">down_dm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fidelity</span><span class="p">(</span><span class="n">up_dm</span><span class="p">,</span> <span class="n">updown_dm</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Alternatively, put kets into density operator and compute fidelity:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d1</span> <span class="o">=</span> <span class="n">Density</span><span class="p">(</span> <span class="p">[</span><span class="n">updown</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="p">[</span><span class="n">updown2</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">Density</span><span class="p">(</span> <span class="p">[</span><span class="n">updown</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span> <span class="p">[</span><span class="n">updown2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
<span class="n">fidelity</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="fidelity-with-qubit-states">
<h2>Fidelity with qubit states<a class="headerlink" href="#fidelity-with-qubit-states" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Qubit</span>
<span class="n">state1</span> <span class="o">=</span> <span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="n">state2</span> <span class="o">=</span> <span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">state3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">state1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">state2</span>
<span class="n">state4</span> <span class="o">=</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">state1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">state2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state1_dm</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">state1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">state2_dm</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">state2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">state3_dm</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">state3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d1</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">state3</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">],</span> <span class="p">[</span><span class="n">state4</span><span class="p">,</span> <span class="mf">0.30</span><span class="p">])</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">Density</span><span class="p">([</span><span class="n">state3</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">],</span> <span class="p">[</span><span class="n">state4</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">])</span>
<span class="n">fidelity</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="teleportation">
<h1>Teleportation<a class="headerlink" href="#teleportation" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_teleportation">https://en.wikipedia.org/wiki/Quantum_teleportation</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">expand</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.gate</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.grover</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qft</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFT</span><span class="p">,</span> <span class="n">IQFT</span><span class="p">,</span> <span class="n">Fourier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.circuitplot</span><span class="w"> </span><span class="kn">import</span> <span class="n">circuit_plot</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2>Teleportation<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;000&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;001&#39;</span><span class="p">)</span><span class="o">*</span><span class="n">b</span>
<span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">entangle1_2</span> <span class="o">=</span> <span class="n">CNOT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">HadamardGate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">entangle1_2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">qapply</span><span class="p">(</span><span class="n">entangle1_2</span><span class="o">*</span><span class="n">state</span><span class="p">)</span>
<span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">entangle0_1</span> <span class="o">=</span> <span class="n">HadamardGate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">entangle0_1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_plot</span><span class="p">(</span><span class="n">entangle0_1</span><span class="o">*</span><span class="n">entangle1_2</span><span class="p">,</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">qapply</span><span class="p">(</span><span class="n">entangle0_1</span><span class="o">*</span><span class="n">state</span><span class="p">)</span>
<span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">measure_partial</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">qapply</span><span class="p">(</span><span class="n">XGate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">state</span><span class="p">)</span>
<span class="n">state</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dense-coding">
<h1>Dense Coding<a class="headerlink" href="#dense-coding" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">expand</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.gate</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.grover</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qft</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFT</span><span class="p">,</span> <span class="n">IQFT</span><span class="p">,</span> <span class="n">Fourier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.circuitplot</span><span class="w"> </span><span class="kn">import</span> <span class="n">circuit_plot</span>
</pre></div>
</div>
</div>
</div>
<section id="id3">
<h2>Dense coding<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;00&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;11&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">psi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuits</span> <span class="o">=</span> <span class="p">[</span><span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">circuit</span> <span class="ow">in</span> <span class="n">circuits</span><span class="p">:</span>
    <span class="n">circuit_plot</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">circuit</span><span class="o">*</span><span class="n">psi</span><span class="p">,</span><span class="n">qapply</span><span class="p">(</span><span class="n">circuit</span><span class="o">*</span><span class="n">psi</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="quantum-error-correction">
<h1>Quantum Error Correction<a class="headerlink" href="#quantum-error-correction" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">expand</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.gate</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.grover</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qft</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFT</span><span class="p">,</span> <span class="n">IQFT</span><span class="p">,</span> <span class="n">Fourier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.circuitplot</span><span class="w"> </span><span class="kn">import</span> <span class="n">circuit_plot</span>
</pre></div>
</div>
</div>
</div>
<h2>5 qubit code</h2><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M0</span> <span class="o">=</span> <span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">M0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">Z</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">M1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M2</span> <span class="o">=</span> <span class="n">Z</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">M2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M3</span> <span class="o">=</span> <span class="n">Z</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">M3</span>
</pre></div>
</div>
</div>
</div>
<p>These operators should mutually commute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gate_simp</span><span class="p">(</span><span class="n">Commutator</span><span class="p">(</span><span class="n">M0</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>And square to the identity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="p">[</span><span class="n">M0</span><span class="p">,</span><span class="n">M1</span><span class="p">,</span><span class="n">M2</span><span class="p">,</span><span class="n">M3</span><span class="p">]:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">gate_simp</span><span class="p">(</span><span class="n">o</span><span class="o">*</span><span class="n">o</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<h2>Codewords</h2><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zero</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">M0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">M1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">M2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">M3</span><span class="p">)</span><span class="o">*</span><span class="n">IntQubit</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">zero</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">zero</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">M0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">M1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">M2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">M3</span><span class="p">)</span><span class="o">*</span><span class="n">IntQubit</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">one</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">one</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<h2>The encoding circuit</h2><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encoding_circuit</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span>\
                   <span class="n">CNOT</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span>\
                   <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">CNOT</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">Z</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_plot</span><span class="p">(</span><span class="n">encoding_circuit</span><span class="p">,</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">encoding_circuit</span><span class="p">,</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="quantum-fourier-transform">
<h1>Quantum Fourier Transform<a class="headerlink" href="#quantum-fourier-transform" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_Fourier_transform">https://en.wikipedia.org/wiki/Quantum_Fourier_transform</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">clear_output</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">Audio</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">expand</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.gate</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.grover</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qft</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFT</span><span class="p">,</span> <span class="n">IQFT</span><span class="p">,</span> <span class="n">Fourier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.circuitplot</span><span class="w"> </span><span class="kn">import</span> <span class="n">circuit_plot</span>
</pre></div>
</div>
</div>
</div>
<section id="qft-gate-and-circuit">
<h2>QFT Gate and Circuit<a class="headerlink" href="#qft-gate-and-circuit" title="Link to this heading">#</a></h2>
<p>The Quantum Fourier Transform (QFT) is useful for a quantum algorithm for factoring numbers which is exponentially faster than what is thought to be possible on a classical machine. The transform does a DFT on the state of a quantum system. There is a simple decomposition of the QFT in terms of a few elementary gates.</p>
<p>Build a 3 qubit QFT and decompose it into primitive gates:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fourier</span> <span class="o">=</span> <span class="n">QFT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span>
<span class="n">fourier</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_plot</span><span class="p">(</span><span class="n">fourier</span><span class="p">,</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_qft</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">circuit_plot</span><span class="p">(</span><span class="n">QFT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">(),</span> <span class="n">nqubits</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">plot_qft</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<p>The QFT circuit can be represented in various symbolic forms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">represent</span><span class="p">(</span><span class="n">QFT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">represent</span><span class="p">(</span><span class="n">Fourier</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">nqubits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="qft-in-action">
<h2>QFT in action<a class="headerlink" href="#qft-in-action" title="Link to this heading">#</a></h2>
<p>Build a 3 qubit state to take the QFT of:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="p">(</span><span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;000&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;010&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qubit</span><span class="p">(</span><span class="s1">&#39;110&#39;</span><span class="p">))</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<p>Perform the QFT:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qapply</span><span class="p">(</span><span class="n">fourier</span><span class="o">*</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply_qft</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">Qubit</span><span class="p">(</span><span class="n">IntQubit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">qapply</span><span class="p">(</span><span class="n">QFT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">decompose</span><span class="p">()</span><span class="o">*</span><span class="n">state</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">apply_qft</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="grover-s-algorithm">
<h1>Grover’s Algorithm<a class="headerlink" href="#grover-s-algorithm" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Grover%27s_algorithm">https://en.wikipedia.org/wiki/Grover’s_algorithm</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">init_printing</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">use_latex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Rational</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">expand</span><span class="p">,</span> <span class="n">Eq</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qubit</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.gate</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.grover</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.qft</span><span class="w"> </span><span class="kn">import</span> <span class="n">QFT</span><span class="p">,</span> <span class="n">IQFT</span><span class="p">,</span> <span class="n">Fourier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy.physics.quantum.circuitplot</span><span class="w"> </span><span class="kn">import</span> <span class="n">circuit_plot</span>
</pre></div>
</div>
</div>
</div>
<section id="grover-s-algorithm-for-3-qubits">
<h2>Grover’s algorithm for 3 qubits<a class="headerlink" href="#grover-s-algorithm-for-3-qubits" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nqubits</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<p>Grover’s algorithm is a quantum algorithm which searches an unordered database (inverts a function). It provides polynomial speedup over classical brute-force search (<span class="math notranslate nohighlight">\(O(\sqrt{N}) vs. O(N))\)</span></p>
<p>Define a black box function that returns True if it is passed the state we are searching for.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">black_box</span><span class="p">(</span><span class="n">qubits</span><span class="p">):</span>
    <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">qubits</span> <span class="o">==</span> <span class="n">IntQubit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">qubits</span><span class="o">.</span><span class="n">nqubits</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
<p>Build a uniform superposition state to start the search.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">superposition_basis</span><span class="p">(</span><span class="n">nqubits</span><span class="p">)</span>
<span class="n">psi</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">OracleGate</span><span class="p">(</span><span class="n">nqubits</span><span class="p">,</span> <span class="n">black_box</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Perform two iterations of Grover’s algorithm.  Each iteration, the amplitude of the target state increases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iter1</span> <span class="o">=</span> <span class="n">qapply</span><span class="p">(</span><span class="n">grover_iteration</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="n">iter1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iter2</span> <span class="o">=</span> <span class="n">qapply</span><span class="p">(</span><span class="n">grover_iteration</span><span class="p">(</span><span class="n">iter1</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="n">iter2</span>
</pre></div>
</div>
</div>
</div>
<p>A single shot measurement is performed to retrieve the target state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">measure_all_oneshot</span><span class="p">(</span><span class="n">iter2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sagemath"
        },
        kernelOptions: {
            name: "sagemath",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sagemath'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Sympy’s Symbolic Quantum Mechanics Package</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-symbolic-qm-dirac">Basic Symbolic QM - dirac</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bras-and-kets">Bras and kets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-products">Tensor products</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#density-operator-and-matrix">Density Operator and Matrix</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-density-operator">Basic density operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#density-operator-for-spin-states">Density operator for spin states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluate-entropy-of-the-density-matrices">Evaluate entropy of the density matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#density-operators-with-tensor-products">Density operators with tensor products</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trace-operators-on-density-operators-with-spin-states">Trace operators on density operators with spin states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-trace-on-density-operators-with-mixed-state">Partial Trace on density operators with mixed state</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-trace-on-density-operators-with-spin-states">Partial trace on density operators with spin states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-of-qapply-on-density-matrices-with-spin-states">Examples of <code class="docutils literal notranslate"><span class="pre">qapply()</span></code> on density matrices with spin states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-qapply-on-density-matrices-with-qubits">Example of <code class="docutils literal notranslate"><span class="pre">qapply()</span></code> on density matrices with qubits</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-angular-momentum">Quantum Angular Momentum</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-spin-states-and-operators">Basic spin states and operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#utilizing-different-bases">Utilizing different bases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotation-operator">Rotation operator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coupled-and-uncoupled-states-and-operators">Coupled and uncoupled states and operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coupled-states-and-operators">Coupled states and operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uncoupled-states-and-operators">Uncoupled states and operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coulping-and-uncoupling-states">Coulping and Uncoupling States</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#spin-orbit-interaction">Spin-Orbit Interaction</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-calculation">Symbolic calculation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#d-simple-harmonic-oscillator">1D Simple Harmonic Oscillator</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#printing-of-operators">Printing Of Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#printing-of-states">Printing of States</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#properties">Properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-operator-and-hamiltonian">Number operator and Hamiltonian</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Properties</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representation">Representation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-quantum-computing-qubits">Symbolic Quantum Computing - qubits</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qubits">Qubits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gates">Gates</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#gate-decomposition">Gate Decomposition</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fidelity-of-quantum-states">Fidelity of quantum states</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-fidelity-using-spin-kets">Basic fidelity using spin kets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fidelity-with-qubit-states">Fidelity with qubit states</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#teleportation">Teleportation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Teleportation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dense-coding">Dense Coding</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Dense coding</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-error-correction">Quantum Error Correction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-fourier-transform">Quantum Fourier Transform</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qft-gate-and-circuit">QFT Gate and Circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#qft-in-action">QFT in action</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#grover-s-algorithm">Grover’s Algorithm</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grover-s-algorithm-for-3-qubits">Grover’s algorithm for 3 qubits</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonny, assisted by Tom
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>