
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Free particle wave function &#8212; Jonny Workbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=8dedbda2" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '0QM_Sage_calculus-way';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Jonny Workbook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Mathe &amp; FP/Language</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Alevel/Alevel_math.html">1. A-level-math</a></li>
<li class="toctree-l1"><a class="reference internal" href="Alevel/Alevel_math_further.html">2. A-level-further</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_MCM.html">3. Math Computational Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_Lean.html">4. Lean</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/00intro_math.html">5. Math-FP-Lang Combo</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/01number_algebra.html">6. Number &amp; Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/02discrete_continuous.html">7. Discrete &amp; Continuous</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/03real_world.html">8. Real World Math</a></li>
<li class="toctree-l1"><a class="reference internal" href="math/05math_as_code.html">9. Math as code</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CS &amp; Physics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Course_MIT6001Python.html">10. MIT_CS6001-Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_MIT6002thinking.html">11. MIT_CS6002-CS</a></li>
<li class="toctree-l1"><a class="reference internal" href="PE/PE50.html">12. Project Euler Q1-50</a></li>
<li class="toctree-l1"><a class="reference internal" href="PE/PE75.html">13. Project Euler Q51-</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_MCM_QM.html">14. Quantum Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="How_Dad_organise_QM.html">15. How Dad learn QM</a></li>
<li class="toctree-l1"><a class="reference internal" href="Course_MCM_QFT.html">16. QFT</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="nb_past_courses.html">17. Past courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="geo/nb_Geo.html">18. Geography and Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="nb_lottery_simulator.html">19. Lottery Math</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/tomctang/10pe" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/0QM_Sage_calculus-way.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1. Free particle wave function</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1. Free particle wave function</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-variables-and-functions">Defining variables and functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-free-particle-wave-function-solution-to-schrodinger-s-equation">What is the free particle wave function solution to Schrodinger’s equation?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-functions">Plotting functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-does-the-free-particle-wave-function-look-like">What does the free particle wave function look like?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-you-to-try">For You To Try:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-plots">Animating plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#which-way-is-the-free-particle-wave-function-moving">Which way is the free particle wave function moving?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note">Note:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-complex-functions">Working with complex functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-probability-density-for-the-free-particle-wave-function">Calculate the probability density for the free particle wave function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">For You To Try:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#taking-derivatives-of-functions">Taking derivatives of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Note:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-functionals-involved-derivatives">Defining functionals involved derivatives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#momentum-operator">Momentum Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">For You To Try:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-exampe-of-defining-functionals-involving-derivatives">Another exampe of defining functionals involving derivatives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-schrodinger-s-equation-in-sagemath">Defining Schrodinger’s equation in SageMath</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-algebraic-equations">Solving algebraic equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-values-of-k-that-satisfy-schrodinger-s-equation">Find the values of <span class="math notranslate nohighlight">\(k\)</span> that satisfy Schrodinger’s equation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">For You To Try:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-a-solution-from-a-list-of-answers">Extract a solution from a list of answers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-check-that-k-satisfies-the-wave-equation">Double-check that <span class="math notranslate nohighlight">\(k\)</span> satisfies the wave equation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-a-function">Integrating a function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-the-wave-function-and-find-the-probability-to-find-the-free-particle-between-to-points-in-space">Normalize the wave function and find the probability to find the free particle between to points in space</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-ways-to-do-things">Other ways to do things</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#project-ideas-and-problems-to-solve">Project Ideas and Problems to Solve</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#particle-in-1d-box-solving-differential-equations">2. Particle in 1D box - Solving differential equations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-general-solution-to-schrodinger-s-equation">Find general solution to Schrodinger’s equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#satisfying-boundary-conditions">Satisfying boundary conditions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-functions">Integrating functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deterimine-normalization-constant">Deterimine normalization constant</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-integration-examples">More integration examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-orthogonality-of-infinite-square-well-solutions">Check orthogonality of infinite square well solutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-plots-of-functions">2D plots of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-wave-function-and-probabilty-density">Plot wave function and probabilty density</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-example-of-integration">Another example of integration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilities-to-find-the-particle">Probabilities to find the particle</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expanding-symbolic-answers-and-obtaining-numerical-results">Expanding symbolic answers and obtaining numerical results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-expectation-values">Calculating expectation values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependent-behavior-of-the-wave-function-and-probability-densities">Time-dependent behavior of the wave function and probability densities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">For You To Try:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animate-plot-of-superposition-of-two-states">Animate plot of superposition of two states</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Project Ideas and Problems to Solve</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#q-harmonic-oscillator-solving-des">3. Q harmonic oscillator - Solving DEs</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fancier-2d-plotting">Fancier 2D Plotting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">For You To Try:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-harmonic-oscillator-energy-from-schrodinger-equation-and-wave-function">Calculate harmonic oscillator energy from Schrodinger equation and wave function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simplify-symbolic-expressions">Simplify Symbolic Expressions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">For You To Try:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-commutator-hat-x-hat-p">Calculate the commutator <span class="math notranslate nohighlight">\([\hat{x},\hat{p}]\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raising-and-lowering-operators">Raising and Lowering Operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrate-that-a-psi-0-x-psi-1-x">Demonstrate that <span class="math notranslate nohighlight">\(a_+ \psi_{0}(x)= \psi_{1}(x)\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrate-that-a-psi-1-x-sqrt-2-psi-2-x">Demonstrate that <span class="math notranslate nohighlight">\(a_+ \psi_{1}(x)= \sqrt{2}\psi_{2}(x)\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">For You To Try</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#projects-and-problem-ideas">Projects and Problem Ideas</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#scattering-tunneling-from-step-potentials">4. Scattering &amp; Tunneling from Step Potentials</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unbound-states-scattering-and-tunneling">Unbound States - Scattering and Tunneling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-wave-function-for-the-step-potential">Plotting the wave function for the step potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#animated-plot-of-wave-function">Animated plot of wave function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-potential-e-v-0">Step Potential: <span class="math notranslate nohighlight">\(E&gt;V_0\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-a-system-of-equations">Solve a system of equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#barrier-tunneling">Barrier Tunneling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">For You To Try</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Projects and Problem Ideas</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>This SageMath will explain how to define variables and functions, evaluate and plot functions, as well as finding derivatives and integrals of symbolic functions(<strong>Calculus way</strong>).</p>
<section class="tex2jax_ignore mathjax_ignore" id="free-particle-wave-function">
<h1>1. Free particle wave function<a class="headerlink" href="#free-particle-wave-function" title="Link to this heading">#</a></h1>
<p>We will use the quantum mechanical wave function of a free particle as an example. Goals:</p>
<ul class="simple">
<li><p>Defining functions and variables</p></li>
<li><p>Taking derivatives of a function</p></li>
<li><p>Plot the real and imaginary elements of the free particle wave function <span class="math notranslate nohighlight">\(\psi(x,t) = A_0 e^{i(kx - \omega t)}\)</span></p></li>
<li><p>Create an animated plot of the wave function</p></li>
<li><p>Check that the wave function satisfies the Schrodinger’s equation</p>
<ul>
<li><p>Extract solution from a list of answers</p></li>
<li><p>Solving algebraic equations</p></li>
</ul>
</li>
</ul>
<p>Schrodinger’s equation for a 1D system (e.g. think of an electron confined to a nanowire) is <span class="math notranslate nohighlight">\(\frac{-\hbar^2}{2m}\frac{\partial^2}{\partial x^2} \psi(x,t) +V(x)\psi(x,t) = i\hbar \frac{\partial}{\partial t} \psi(x,t)\)</span>.</p>
<p>A free particle is a particle that does not experience any forces along the direction of motion and can move freely without any walls.  In truth there is no such thing as a free particle since all particle are confined in some ways but as long as the dimensions of confinement are much much larger than the wavelength of the particle we can treat the particle as free.  An electron confined to a nanowire with a length on the order of millimeters would be a good example of this.</p>
<section id="defining-variables-and-functions">
<h2>Defining variables and functions<a class="headerlink" href="#defining-variables-and-functions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>All variables must be explicitly declared (except for the variable ‘x’ and variables used as arguments of functions) using the <strong>var()</strong> command</p></li>
<li><p>Variables cannot start with numbers or contain spaces but they can contain underscores</p></li>
<li><p>Functions can be evaluated by inserting values for the arguments</p></li>
<li><p>To evaluate an input cell in this worksheet, put the cursor in the cell and hit Shift+Enter.  The output will be displayed in the cell below the input cell.</p></li>
</ul>
<section id="what-is-the-free-particle-wave-function-solution-to-schrodinger-s-equation">
<h3>What is the free particle wave function solution to Schrodinger’s equation?<a class="headerlink" href="#what-is-the-free-particle-wave-function-solution-to-schrodinger-s-equation" title="Link to this heading">#</a></h3>
<p>The general solution to Schrodinger’s equation is <span class="math notranslate nohighlight">\(\psi(x,t) = A_0 e^{i(kx-\omega t)} + B_0 e^{i(kx + \omega t)}\)</span> where the only difference between the two terms is the sign in front of <span class="math notranslate nohighlight">\(\omega t\)</span>, which determines which direction the wave travels.  For the moment we will only look at the first term by setting <span class="math notranslate nohighlight">\(B_0=0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This is a calculation input cell.  SageMath will operate on anything typing into this cell and output the results in the cell below.</span>
<span class="c1">#Insert the cursor in this cell and hit Shift-Enter to evaluate it.</span>
<span class="c1"># Any text after the hashtag is ignored by SageMath</span>

<span class="n">A_0</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">omega</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;A_0,k,omega, m&#39;</span><span class="p">)</span>  <span class="c1">#Variables are defined using the &#39;var()&#39; command.</span>

<span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">A_0</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>  <span class="c1">#This is a how you define a function.  Arguments of the function are placed in parentheses.</span>
<span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="c1"># When a function is defined SageMath does not output the equation.  </span>
<span class="n">s</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>

<span class="n">psi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>  <span class="c1">#Functions are evaluated by plugging in values for the arguments.  </span>
            <span class="c1"># Notice that the wave function at x=0, t=0 has the value of A_0</span>
<span class="n">s</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>  <span class="c1">#Nicer looking output</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle A_{0} e^{\left(-i \, \omega t + i \, k x\right)} \qquad   \]</div>
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle A_{0} \qquad   \]</div>
</div>
</div>
</section>
</section>
<section id="plotting-functions">
<h2>Plotting functions<a class="headerlink" href="#plotting-functions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>To replace variables with numerical values you need to use the <strong>.substitute()</strong> command.</p>
<ul>
<li><p>To replace all values of the variable <span class="math notranslate nohighlight">\(A_0\)</span> with the value <span class="math notranslate nohighlight">\(1\)</span>, append ‘.substitute(A_0=1)’ to the function name.</p></li>
</ul>
</li>
<li><p>The real and imaginary parts of a function can be obtained by using <strong>.real()</strong> and <strong>.imag()</strong>.</p></li>
<li><p>Since SageMath is based on Python, everything is an object.  This means that you can modify properties or act on things using the “dot” notation.</p></li>
</ul>
<section id="what-does-the-free-particle-wave-function-look-like">
<h3>What does the free particle wave function look like?<a class="headerlink" href="#what-does-the-free-particle-wave-function-look-like" title="Link to this heading">#</a></h3>
<p>The solution to Schrodinger’s equation must be a complex function so the wave function must be split into it’s real part and imaginary part to plot the function.  The free particle wave function for a one-dimensional system is <span class="math notranslate nohighlight">\(\psi(x,t) = e^{i(kx -\omega t)}\)</span>.  What do you think the graph of the real part of the wave function will look like?  What do you think the imaginary part of the wave function will look like?  (Hint: What is Euler’s identity?)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plotting the real and imaginary parts of the wave function</span>
<span class="n">psi_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">A_0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">omega</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#Since psi was defined with variable values for A_0, k, and omega, </span>
                    <span class="c1"># we must use the &#39;.substitute()&#39; command to change the variables into numerical values</span>
<span class="c1">#psi_plot(x,t) is the same function as psi(x,t) with A_0=1, k=1, and omega=1</span>

<span class="n">psi_plot_Re</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">psi_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">real</span><span class="p">()</span>  <span class="c1">#The &#39;.real()&#39; command extracts the real component of the function</span>
<span class="n">psi_plot_Im</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">psi_plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span> <span class="c1">#The &#39;.imag()&#39; command gets the imaginary component</span>

<span class="n">P1</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_plot_Re</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;Real Part&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Real and Imaginary Component of Free-Particle Wave Function&#39;</span><span class="p">)</span>
<span class="n">P2</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_plot_Im</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;Imaginary Part&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">P</span><span class="o">=</span><span class="n">P1</span><span class="o">+</span><span class="n">P2</span>  <span class="c1">#Combine the two graphs into one plot</span>
<span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1">#Show the plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/85193187d47e95c895f1e62f11a1d87dcec41b35b0e8d81c340a9b3cd3e37e77.png" src="_images/85193187d47e95c895f1e62f11a1d87dcec41b35b0e8d81c340a9b3cd3e37e77.png" />
</div>
</div>
</section>
<section id="for-you-to-try">
<h3>For You To Try:<a class="headerlink" href="#for-you-to-try" title="Link to this heading">#</a></h3>
<p>Use the fact that <span class="math notranslate nohighlight">\(e^{i \theta} = \cos(\theta) + i \sin(\theta)\)</span> to plot the real part of the wave function at time <span class="math notranslate nohighlight">\(t = 1\)</span>.  Type your work into the input cell below.</p>
<p>How does your graph for the real part of the wave function compare to the graph of the real part above?  What function do you think represents the imaginary part of the free particle wave function?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Add your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="animating-plots">
<h2>Animating plots<a class="headerlink" href="#animating-plots" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>A collection of still images can be combined to create an animation</p></li>
<li><p>Put all images in a list (square brackets denote a list)</p></li>
<li><p>Use the list of images as an argument to the <code class="docutils literal notranslate"><span class="pre">animage(list_of_images_here)</span></code> command</p></li>
</ul>
<section id="which-way-is-the-free-particle-wave-function-moving">
<h3>Which way is the free particle wave function moving?<a class="headerlink" href="#which-way-is-the-free-particle-wave-function-moving" title="Link to this heading">#</a></h3>
<p>To determine the direction that the wave is moving you can create an animated plot at different times using a short Python script.  You will need to create a list of plot snapshots at different times and then combine them into an animation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times</span> <span class="o">=</span> <span class="n">sxrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1">#Create a list of the times for evaluation. sxrange() creates a list of numbers from 0 to 5 in steps of 0.5</span>
<span class="n">plot_graph</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1">#Create an empty list to store the plotted graphs at different times</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>    <span class="c1">#Loop through all times</span>
    <span class="n">new_plot</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_plot_Re</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_plot_Im</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>   <span class="c1">#Create plot at time t for each value of t</span>
    <span class="n">plot_graph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_plot</span><span class="p">)</span>  <span class="c1"># rgba(170, 221, 221, 1) the new plot to the final list</span>

<span class="n">a</span><span class="o">=</span><span class="n">animate</span><span class="p">(</span><span class="n">plot_graph</span><span class="p">)</span>    <span class="c1">#Combine all plots contained in plot_graph into an animation</span>
<span class="n">show</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1">#Show the animation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/tom/miniconda3/envs/sage/lib/python3.12/site-packages/sage/repl/rich_output/display_manager.py:594: RichReprWarning: Exception in _rich_repr_ while displaying object: Error: Neither ImageMagick nor ffmpeg appear to be installed. Saving an animation to a GIF file or displaying an animation requires one of these packages, so please install one of them and try again. See www.imagemagick.org and www.ffmpeg.org for more information.
  warnings.warn(
</pre></div>
</div>
<div class="output text_html"><html>\(\displaystyle \verb|Animation|\verb| |\verb|with|\verb| |\verb|10|\verb| |\verb|frames|\)</html></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_plot_Re</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_plot_Im</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sxrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">.5</span><span class="p">)]</span>
<span class="n">a</span><span class="o">=</span><span class="n">animate</span><span class="p">(</span><span class="n">plot_graph</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Animation with 10 frames
</pre></div>
</div>
</div>
</div>
</section>
<section id="note">
<h3>Note:<a class="headerlink" href="#note" title="Link to this heading">#</a></h3>
<p>You can accomplish the same thing with more compact code using Python list comprehensions:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>plot_graph = [plot(psi_plot_Re(x,t),x,0,10)+plot(psi_plot_Im(x,t),x,0,10,color=&#39;red&#39;) for t in sxrange(0,5,.5)]
a=animate(plot_graph)
a.show()
</pre></div>
</div>
</section>
</section>
<section id="working-with-complex-functions">
<h2>Working with complex functions<a class="headerlink" href="#working-with-complex-functions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Assumptions about variables can be specified using the <strong>assume()</strong> command.  In this case we assume all variables are real.</p></li>
<li><p>The complex conjugate can be found using <strong>.conjugate()</strong>.</p></li>
<li><p><strong>print()</strong> and <strong>s()</strong> can be used to include text in an output cell.</p></li>
</ul>
<section id="calculate-the-probability-density-for-the-free-particle-wave-function">
<h3>Calculate the probability density for the free particle wave function<a class="headerlink" href="#calculate-the-probability-density-for-the-free-particle-wave-function" title="Link to this heading">#</a></h3>
<p>The wave function <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> is called the probability amplitude of the particle.  The probility density <span class="math notranslate nohighlight">\(\rho(x,t)\)</span> is equal to the magnitude of the probability amplitude squared.  Since <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> is complex, the magnitude squared <em>is not the same as</em> the square of <span class="math notranslate nohighlight">\(\psi(x,t)\)</span>.  You must multiply <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> by it’s complex conjugate, which is written as <span class="math notranslate nohighlight">\(\psi^*(x,t)\)</span>.  The probability density is then given by <span class="math notranslate nohighlight">\(\rho(x,t) = \psi^*(x,t) \psi(x,t)\)</span>.</p>
<p>How would you find the probability to find a particle between two points given the probability density?  In other words, how is the probability density related to the probability to find the particle within some region of space?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#All of these quantities are real.  to specify they are real because we will calculate the complex conjugate of psi(x,t)</span>
<span class="c1">#Without assumption that these variables are real, rho(x,t) below will not simplify to A_0^2</span>
<span class="n">var</span><span class="p">(</span><span class="s1">&#39;omega k x t A_0&#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">A_0</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>

<span class="n">rho</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span> <span class="c1">#When defining a function, the results are not printed out ...</span>
<span class="n">rho</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>  <span class="c1">#... so you&#39;ll need to call the function to get SageMath to print it in the output cell</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The probability density rho(x,t) for a free partile is&#39;</span><span class="p">,</span> <span class="n">rho</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>

<span class="c1">#You can typeset the print statement using Latex by calling &#39;s()&#39;...</span>
<span class="n">s</span><span class="p">(</span><span class="s1">&#39;The probability density $</span><span class="se">\\</span><span class="s1">rho(x,t)$ for a free particle is&#39;</span><span class="p">,</span> <span class="n">rho</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>

<span class="c1">#Notice that print only requires quote marks around text while s() uses parentheses and quote marks</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The probability density rho(x,t) for a free partile is A_0^2
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \text{\texttt{The{ }probability{ }density{ }{\char`\$}{\char`\\}rho(x,t){\char`\$}{ }for{ }a{ }free{ }particle{ }is}} \qquad   A_{0}^{2} \qquad   \end{split}\]</div>
</div>
</div>
</section>
<section id="id1">
<h3>For You To Try:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>To see what other assumptions you can make, type ‘assume?’ into the input cell below.</p></li>
<li><p>To get help with the <strong>integral()</strong> command, first type ‘int’ and then hit Tab to use autocomplete.  Select ‘integral’ from the pop-up list and add a question mark to the end before evaluating the cell by hitting Shift+Enter</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Input your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="taking-derivatives-of-functions">
<h2>Taking derivatives of functions<a class="headerlink" href="#taking-derivatives-of-functions" title="Link to this heading">#</a></h2>
<ul>
<li><p>The command <strong>.derivative()</strong> will find the derivative of a symbolic function.</p></li>
<li><p>The arguments of the <strong>.derivative()</strong> command are the variable of differentiation and the order of the derivative</p>
<ul>
<li><p>To find the third derivative of the function <span class="math notranslate nohighlight">\(f\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span> use:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> f.derivative(x, 3)
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
<p>The output from the <strong>.derivative()</strong> command is another function, which you can evaluate or set equal to another variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#Taking the first derivative with respect to x</span>
<span class="n">psi</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1">#First order derivative is assumed if no number is given</span>
<span class="n">psi</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>  <span class="c1">#If you don&#39;t specify the differentiation variable, SageMath will return a list with all possible derivatives</span>

<span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1">#If you explicitly include the arguments of the function the result will be returned without (x,t) |--&gt;</span>


<span class="n">psi</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#You can evaluate the derivative at a point but specifying the values for x and t...</span>

<span class="n">psi_prime</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>   <span class="c1">#... or you can define your result as a new function...</span>
<span class="n">psi_prime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>    <span class="c1">#... and evaluate this new function at the point x=1, t=1</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h3>Note:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Rather than using the “dot” notation, you can treat the <strong>derivative()</strong> command as a function.  You can also use <strong>diff()</strong> in place of <strong>derivative</strong>; the results are the same for both commands.</p>
<ul>
<li><p>Here are a couple of examples that are all equivalent:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>derivative(f,x,2)

diff(f,x,2)

f.derivative(x,2)

f.diff(x,2)
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section id="defining-functionals-involved-derivatives">
<h2>Defining functionals involved derivatives<a class="headerlink" href="#defining-functionals-involved-derivatives" title="Link to this heading">#</a></h2>
<p>Another way to define functions is using Python commands.</p>
<ul class="simple">
<li><p>Definition must start with <strong>def</strong> followed by the name of the function and the arguments of the function.</p></li>
<li><p>First line of function definition must end with a colon <strong>:</strong></p></li>
<li><p>All code included in the function must be indented four spaces (one tab)</p></li>
<li><p>Last line of function defintion must return resulting equation</p></li>
</ul>
<section id="momentum-operator">
<h3>Momentum Operator<a class="headerlink" href="#momentum-operator" title="Link to this heading">#</a></h3>
<p>In quantum mechanics, all observable quantities have an associated operator.  These operators require a wave function to operate on.  The momentum operator in one-dimension is defined as <span class="math notranslate nohighlight">\(\hat{p}=-i\hbar \frac{d}{dx}\)</span>.  The value of the momentum <span class="math notranslate nohighlight">\(p\)</span> is found by applying the operator to the wave function.  In other words, <span class="math notranslate nohighlight">\(p\psi(x,t) = \hat{p} \psi(x,t)\)</span> or, dividing both sides by <span class="math notranslate nohighlight">\(\psi(x,t)\)</span>, <span class="math notranslate nohighlight">\(p=\frac{\hat{p}\psi(x,t)}{\psi(x,t)}.\)</span>  Notice that <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> doesn’t cancel out the <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> in the numerator because the numerator is <span class="math notranslate nohighlight">\(\hat{p}\)</span> <em>operating</em> on <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> which is different than multiplying the two terms together.</p>
<p>The momentum of a free particle is given by <span class="math notranslate nohighlight">\(\hbar k\)</span>, which is what the following calculation demonstrates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hbar</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;hbar&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\hbar&#39;</span><span class="p">)</span>  <span class="c1">#This extra defintion will display the hbar symbol when using .show()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">P</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>   <span class="c1">#This will define the momentum operator P</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">hbar</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>    <span class="c1">#The function returns -i*hbar*diff(f,x) when called</span>

<span class="n">P</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>  <span class="c1">#Calculating momentum using P-operator.  Notice psi indicate P is operating on the function</span>
<span class="n">P</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
<span class="n">P</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># if I explicitly include the arguments of psi that (x,t) |--&gt; is not included in the output</span>

<span class="n">momentum</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span><span class="o">/</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">s</span><span class="p">(</span><span class="s1">&#39;The momentum of a free particle is $p=$&#39;</span><span class="p">,</span> <span class="n">momentum</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>For You To Try:<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Schrodinger’s equation is given by <span class="math notranslate nohighlight">\(\frac{-\hbar^2}{2m}\frac{\partial^2}{\partial x^2} \psi(x,t) +V(x)\psi(x,t) = i\hbar \frac{\partial}{\partial t} \psi(x,t).\)</span>  In order to demonstrate that <span class="math notranslate nohighlight">\(\psi(x,t) = A_0 e^{i(kx - \omega t)}\)</span> satisfies this equation, you need to plug this equation for <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> into both sides of the equation and show both sides are equal to one another.</p>
<p>First, take the second derivative of the wave function <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span> in the cell below.  Multiply this by <span class="math notranslate nohighlight">\(-\hbar^2/(2m)\)</span>.  This will give you the left-hand side of Schrodinger’s equation.</p>
<p>Next find the first derivative of <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> with respect to <span class="math notranslate nohighlight">\(t\)</span>.  Multiply this result by <span class="math notranslate nohighlight">\(i \hbar\)</span> to get the right-hand side of Schrodinger’s equation.   Compare this equation to the previous equation.  The two equations should agree if you recognize that <span class="math notranslate nohighlight">\(\omega = \hbar k^2/(2m)\)</span>.</p>
<p>Use <strong>.substitute(omega = hbar k^2/(2*M))</strong> on this second equation and both equations should match, showing that this wave function satisfies Schrodinger’s equation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="another-exampe-of-defining-functionals-involving-derivatives">
<h2>Another exampe of defining functionals involving derivatives<a class="headerlink" href="#another-exampe-of-defining-functionals-involving-derivatives" title="Link to this heading">#</a></h2>
<p>We will use the Python <strong>def</strong> command again to define our two functions.   To define the Hamiltonian operator <span class="math notranslate nohighlight">\(\hat{H} = \frac{-\hbar^2}{2m} \frac{d^2}{dx^2} \)</span> we would use a Python definition that returns the desired function.  We can define the energy operator <span class="math notranslate nohighlight">\(\hat{E} = -i \hbar \frac{d}{dt}\)</span> in a similar fashion.  These two functions can then be used to find <span class="math notranslate nohighlight">\(\hat{H}\psi(x,t)\)</span> and <span class="math notranslate nohighlight">\(\hat{E}\psi(x,t)\)</span></p>
<section id="defining-schrodinger-s-equation-in-sagemath">
<h3>Defining Schrodinger’s equation in SageMath<a class="headerlink" href="#defining-schrodinger-s-equation-in-sagemath" title="Link to this heading">#</a></h3>
<p>The left-hand side of Schrodinger’s equation is called the Hamiltonian which you may have heard of in a classical physics course.  The Hamiltonian <span class="math notranslate nohighlight">\(\hat{H}\)</span> and energy <span class="math notranslate nohighlight">\(\hat{E}\)</span> are operators which must have a function to operate on.  In this worksheet we use the hat symbol <span class="math notranslate nohighlight">\(\hat{}\)</span> above the letter to indicate an operator but your instructor may use different notation.  The operator <span class="math notranslate nohighlight">\(\hat{H}\)</span> is called ‘H-hat’.</p>
<p>In terms of operators, Schrodinger’s equation can be written as <span class="math notranslate nohighlight">\(\hat{H}\psi(x,t) = \hat{E} \psi(x,t)\)</span> where we understand that <span class="math notranslate nohighlight">\(\hat{H}\)</span> and <span class="math notranslate nohighlight">\(\hat{E}\)</span> operator on the functions immediately to their right.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hbar</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;hbar&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\hbar&#39;</span><span class="p">)</span>  <span class="c1">#This defintion will display the hbar symbol when using .show() or s</span>

<span class="k">def</span><span class="w"> </span><span class="nf">H</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>    <span class="c1">#The first line of the definition must include the name of the function, the variables, and end with a colon</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">hbar</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>   <span class="c1">#all lines that make up the function must be indented four spaces (one tab)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">E</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>   <span class="c1">#This function is the right-hand side of Schrodinger&#39;s equation</span>
    <span class="k">return</span> <span class="n">i</span><span class="o">*</span><span class="n">hbar</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>

<span class="n">Hamil_term</span><span class="o">=</span><span class="n">H</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>   <span class="c1">#Calculate the Hamiltonian operating on psi</span>
<span class="n">Ener_term</span><span class="o">=</span><span class="n">E</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>    <span class="c1">#Calculate the energy operator on psi</span>

<span class="n">Hamil_term</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>    <span class="c1">#Show pretty versions of H(psi)</span>
<span class="n">Ener_term</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>     <span class="c1">#Show a pretty version of E(psi)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="solving-algebraic-equations">
<h2>Solving algebraic equations<a class="headerlink" href="#solving-algebraic-equations" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>When solving equations you must remember the difference between <span class="math notranslate nohighlight">\(==\)</span> and <span class="math notranslate nohighlight">\(=\)</span>.</p>
<ul>
<li><p>The ‘double-equals’ sign <span class="math notranslate nohighlight">\(==\)</span> is a comparison and is what you should use with the <strong>solve()</strong> command.</p></li>
<li><p>The “single-equals’ sign <span class="math notranslate nohighlight">\(=\)</span> is an assignment operator and sets the left hand side to the value on the right.</p></li>
</ul>
</li>
<li><p>The arguments of <strong>solve()</strong> are the equation to solve and the variable to solve for.</p></li>
<li><p>Type <strong>solve?</strong> into an input cell to see the other options available for the <strong>solve()</strong> command.</p></li>
</ul>
<section id="find-the-values-of-k-that-satisfy-schrodinger-s-equation">
<h3>Find the values of <span class="math notranslate nohighlight">\(k\)</span> that satisfy Schrodinger’s equation<a class="headerlink" href="#find-the-values-of-k-that-satisfy-schrodinger-s-equation" title="Link to this heading">#</a></h3>
<p>We’ve already specified the equation that relates <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> but the following will show you how to use SageMath to find this relation using Schrodinger’s equation.  We’ll use the previous definitions of <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(E\)</span> along with <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> to find <span class="math notranslate nohighlight">\(k\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ans</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">))</span><span class="o">==</span><span class="n">E</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)),</span><span class="n">k</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Here are two other examples using the solve command&quot;</span><span class="p">)</span>
<span class="n">ans2</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">s</span><span class="p">(</span><span class="s2">&quot;The solution to $cos(k*x)=0$ is &quot;</span><span class="p">,</span> <span class="n">ans2</span> <span class="p">)</span>  <span class="c1">#This only gives one answer.  This equation holds true for *any* integer multiple of this answer.</span>

<span class="n">ans3</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">==</span><span class="mi">6</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">s</span><span class="p">(</span><span class="s2">&quot;The solutions to x^2+x = 6 are &quot;</span><span class="p">,</span><span class="n">ans3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>For You To Try:<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Solve the equation <span class="math notranslate nohighlight">\(H \psi(x,t) == E \psi(x,t)\)</span> for <strong>omega</strong> rather than <strong>k</strong> and show the result is <span class="math notranslate nohighlight">\(\omega = \frac{\hbar^2 k^2}{2m}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="extract-a-solution-from-a-list-of-answers">
<h2>Extract a solution from a list of answers<a class="headerlink" href="#extract-a-solution-from-a-list-of-answers" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The solution from the <strong>solve()</strong> command is a Python list and we can extract elements of the equations from the list.  Python starts indices at 0 rather than 1 so the first element in <em>ans</em> is <em>ans[0]</em> and the second element is <em>ans[1]</em>.</p></li>
<li><p>You can extract the <strong>r</strong>ight <strong>h</strong>and <strong>s</strong>ide of an equation using <strong>.rhs()</strong>.</p></li>
<li><p>To see if the equation holds true we need to compare the two sides using a double equals sign (==) and force SageMath to give us a Boolean answer by using <strong>bool()</strong>.</p></li>
</ul>
<section id="double-check-that-k-satisfies-the-wave-equation">
<h3>Double-check that <span class="math notranslate nohighlight">\(k\)</span> satisfies the wave equation<a class="headerlink" href="#double-check-that-k-satisfies-the-wave-equation" title="Link to this heading">#</a></h3>
<p>To help practice using SageMath, we will take the solution obtained for <span class="math notranslate nohighlight">\(k\)</span> and plug it back into Schrodinger’s equation (again).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1">#Extract first equation from list of solutions</span>
<span class="n">ans</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1">#Extract second equation from list of solutions</span>

<span class="n">k1</span> <span class="o">=</span> <span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>   <span class="c1">#Extract right-hand side of first solution...</span>
<span class="n">k1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#... and show the typeset version</span>

<span class="n">k2</span> <span class="o">=</span> <span class="n">ans</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>   <span class="c1">#Extract right-hand side of second solution...</span>
<span class="n">k2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>        <span class="c1">#... and make it look nice</span>


<span class="n">t_or_f1</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">k1</span><span class="p">))</span><span class="o">==</span><span class="n">E</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">k1</span><span class="p">)))</span>   <span class="c1">#Check if the two equations are equal for solution k1...</span>
<span class="n">s</span><span class="p">(</span><span class="s2">&quot;$k_1$ satisfies the Schrodinger equation:&quot;</span><span class="p">,</span> <span class="n">t_or_f1</span><span class="p">)</span>    <span class="c1">#... and print the results</span>


<span class="n">t_or_f2</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">k2</span><span class="p">))</span><span class="o">==</span><span class="n">E</span><span class="p">(</span><span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">k2</span><span class="p">)))</span>   <span class="c1">#Check if the two equations are equal for solution k2...</span>
<span class="n">s</span><span class="p">(</span><span class="s2">&quot;$k_2$ satisfies the Schrodinger equation:&quot;</span><span class="p">,</span> <span class="n">t_or_f2</span><span class="p">)</span>    <span class="c1">#... and print the results</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="integrating-a-function">
<h2>Integrating a function<a class="headerlink" href="#integrating-a-function" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The command to integrate is <strong>.integrate()</strong> or you can apply <strong>integrate()</strong> as a function to the equation.</p></li>
<li><p>For an indefinite integral you only need to specify the variable of integration</p></li>
<li><p>For a definite integral you must specify the variable of integration and the limits.</p>
<ul>
<li><p>For example, to integrate the function <span class="math notranslate nohighlight">\(f(x)\)</span> from <span class="math notranslate nohighlight">\(x=0\)</span> to <span class="math notranslate nohighlight">\(x=L\)</span> you’d type:
integrate(f(x),[x,0,L])</p></li>
</ul>
</li>
</ul>
<section id="normalize-the-wave-function-and-find-the-probability-to-find-the-free-particle-between-to-points-in-space">
<h3>Normalize the wave function and find the probability to find the free particle between to points in space<a class="headerlink" href="#normalize-the-wave-function-and-find-the-probability-to-find-the-free-particle-between-to-points-in-space" title="Link to this heading">#</a></h3>
<p>To normalize the wave function, the total probability to find the particle <em>somewhere</em> must equal 1.  Unfortunately with the free particle you run into an issue because the free particle can be anywhere between <span class="math notranslate nohighlight">\(-\infty\)</span> and <span class="math notranslate nohighlight">\(\infty\)</span>.  Using these limits results in a divergent integral.  To get around the infinite integral we will consider the case where the particle is limited to some region between <span class="math notranslate nohighlight">\(x=+L\)</span> and <span class="math notranslate nohighlight">\(x=-L\)</span> where <span class="math notranslate nohighlight">\(L \gg \lambda\)</span> where <span class="math notranslate nohighlight">\(\lambda\)</span> is the wavelength of the free particle.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">norm_integral_1</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">psi</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),</span><span class="n">x</span><span class="p">);</span> <span class="n">norm_integral_1</span>   <span class="c1">#Set the value of the indefnite integral = norm1, and display norm1</span>
<span class="n">solve</span><span class="p">(</span><span class="n">norm_integral_1</span> <span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="n">A_0</span><span class="p">)</span>  <span class="c1">#Solve for the values of A_0</span>

<span class="n">L</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">)</span>  <span class="c1">#Define L as a variable</span>
<span class="n">assume</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>  <span class="c1">#Specify that L is a real quantity</span>
<span class="n">norm_integral_2</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">psi</span><span class="o">*</span><span class="n">psi</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),[</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="p">]);</span><span class="n">norm_integral_2</span>  <span class="c1">#Solve definite int using -L &amp; L as the lower &amp; upper bounds</span>
<span class="n">norm_const</span><span class="o">=</span><span class="n">solve</span><span class="p">(</span><span class="n">norm_integral_2</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="n">A_0</span><span class="p">);</span><span class="n">norm_const</span>  <span class="c1">#Solve for A_0</span>
<span class="n">show</span><span class="p">(</span><span class="s2">&quot;If the particle is confined to a region of length 2L, the normalization constant $A_0$ is &quot;</span><span class="p">,</span> <span class="n">norm_const</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span> <span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="s2">&quot;The wave function $\psi(x,t)$, including the normalization constant is $psi(x,t)=$&quot;</span><span class="p">,</span> <span class="n">psi</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">A_0</span><span class="o">=</span><span class="n">norm_const</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="other-ways-to-do-things">
<h2>Other ways to do things<a class="headerlink" href="#other-ways-to-do-things" title="Link to this heading">#</a></h2>
<p>In addition to using the “dot” notation to operate on functions, you can also use various operations as functions.  For instance, <em>derivative(psi,x)</em> gives the same result as <em>psi.derivative(x)</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">derivative</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">psi</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">integrate</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="n">psi</span><span class="o">.</span><span class="n">real</span><span class="p">()</span>
<span class="n">real</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>

<span class="n">psi</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span>
<span class="n">imag</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>

<span class="n">psi</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="project-ideas-and-problems-to-solve">
<h2>Project Ideas and Problems to Solve<a class="headerlink" href="#project-ideas-and-problems-to-solve" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Have students find realistic values for masses and velocities for electrons, protons, or neutrons and use de Broglie’s equation to find <span class="math notranslate nohighlight">\(k\)</span>, <span class="math notranslate nohighlight">\(\omega\)</span>, and total energy <span class="math notranslate nohighlight">\(E\)</span>.</p></li>
<li><p>Plot wave functions for electrons and protons on the same plot and have students explain why electron microscopes are used for imaging small objects while ‘proton microscopes’ aren’t as useful.</p></li>
<li><p>Have students complete homework problems from the end of the textbook chapter.</p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="particle-in-1d-box-solving-differential-equations">
<h1>2. Particle in 1D box - Solving differential equations<a class="headerlink" href="#particle-in-1d-box-solving-differential-equations" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Solving DEs</p></li>
<li><p>Integrating a function</p></li>
<li><p>Plotting functions</p></li>
<li><p>Creating an animated plot</p></li>
<li><p>Approximate numerical results</p></li>
<li><p>Expand symbolic expressions</p></li>
</ul>
<p>When solving DEs it helps to specify which variables are real and which are positive using the <strong>assume()</strong> command.</p>
<ul class="simple">
<li><p>You need to specify the independent variable (<strong>IV</strong>) of your function.  In this case we specify that <span class="math notranslate nohighlight">\(\psi\)</span> is a function of <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>The DE is defined using the Python <strong>def</strong> method.</p>
<ul>
<li><p>This creates a function which we can differential, integrate, or use <strong>desolve()</strong>.</p></li>
<li><p><strong>desolve()</strong> includes the DE to solve, the dependent variable (<span class="math notranslate nohighlight">\(\psi\)</span> in this case), and the IV x (specified using <strong>ivar=x</strong> to indicate IV).</p></li>
</ul>
</li>
</ul>
<section id="find-general-solution-to-schrodinger-s-equation">
<h2>Find general solution to Schrodinger’s equation<a class="headerlink" href="#find-general-solution-to-schrodinger-s-equation" title="Link to this heading">#</a></h2>
<p>The time-independent Schrodinger’s equation in one dimension is <span class="math notranslate nohighlight">\(\frac{-\hbar^2}{2m} \frac{d^2}{dx^2}\psi(x) + V(x)\psi(x) = E \psi(x)\)</span>.  For an infinite square well of width <span class="math notranslate nohighlight">\(L\)</span> the potential energy function is given by</p>
<p><span class="math notranslate nohighlight">\(V(x) = \left\{ \begin{array}{cc} \infty &amp; \text{if } x\ge L\\ 0 &amp; \text{if } 0&lt; x &lt; L \\ \infty &amp; \text{if } x \le 0 \end{array}\right.\)</span></p>
<p>Note: To solve this differential equation we set the potential energy to zero inside the box and rearrange Schrodinger’s equation so it has the form <span class="math notranslate nohighlight">\(\frac{-\hbar^2}{2m} \frac{d^2}{dx^2}\psi(x) - E \psi(x) = 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">L</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;psi,m,L&#39;</span><span class="p">)</span>  <span class="c1">#Declare wave function, mass, and box length as variables</span>

<span class="n">Ener</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;Ener&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\mathcal</span><span class="si">{E}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1">#Declare Ener as energy variable but will display a script E when using show() </span>
<span class="n">hbar</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;hbar&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\hbar&#39;</span><span class="p">)</span>  <span class="c1">#Declares hbar as a variable and displays hbar symbol when using show() </span>

<span class="n">assume</span><span class="p">(</span><span class="n">Ener</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>   <span class="c1">#Assume the variable Ener (the energy) only takes real values...</span>
<span class="n">assume</span><span class="p">(</span><span class="n">Ener</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>        <span class="c1">#... and assume the energy is greater than zero.  These are needed for desolve()</span>

<span class="n">assume</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>   <span class="c1">#Assume the mass is real...</span>
<span class="n">assume</span><span class="p">(</span><span class="n">m</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>        <span class="c1">#... and positive.  </span>
              <span class="c1">#If you don&#39;t make assumptions you will get an error message asking if these variables are positive, negative, or zero</span>

<span class="c1">#To solve DE, we must tell Sage that psi is a function called &#39;psi&#39; with a single dependent variable</span>
<span class="n">psi</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>   

<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">psi</span><span class="p">):</span>  <span class="c1">#Define the equation to solve.</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">hbar</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">Ener</span><span class="o">*</span><span class="n">psi</span>   <span class="c1">#This is the differential equation to be solved</span>

<span class="n">general_soln</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">psi</span><span class="p">,</span><span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>


<span class="n">s</span><span class="p">(</span><span class="s1">&#39;The general solution to Schrodinger</span><span class="se">\&#39;</span><span class="s1">s equation is $\psi(x)=$&#39;</span><span class="p">,</span> <span class="n">general_soln</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="satisfying-boundary-conditions">
<h2>Satisfying boundary conditions<a class="headerlink" href="#satisfying-boundary-conditions" title="Link to this heading">#</a></h2>
<p>The boundary conditions require that <span class="math notranslate nohighlight">\(\psi(x,t)\)</span> must be zero at the two walls.  In other words, <span class="math notranslate nohighlight">\(\psi(x=0,t)=0\)</span> and <span class="math notranslate nohighlight">\(\psi(x=L,t)=0\)</span>.  Since <span class="math notranslate nohighlight">\(\sin(0)=0\)</span> and <span class="math notranslate nohighlight">\(\cos(0)=1\)</span>, this means that <span class="math notranslate nohighlight">\(K_2=0\)</span>.  The boundary condition at <span class="math notranslate nohighlight">\(x=L\)</span> says that <span class="math notranslate nohighlight">\(K_1 \sin(\sqrt{2 \mathcal{E} m} x/\hbar) = 0\)</span> which is true if the argument of <span class="math notranslate nohighlight">\(\sin()\)</span> is an integer multiple of <span class="math notranslate nohighlight">\(\pi\)</span>.  Thus <span class="math notranslate nohighlight">\(\frac{\sqrt{2 m \mathcal{E}}L}{\hbar} = n \pi\)</span> for <span class="math notranslate nohighlight">\(n = 1, 2, 3, ...\)</span>.  To be consistent with previous notation we will set <span class="math notranslate nohighlight">\(A_0 = K_1\)</span>.  The wave function for the particle in a box is <span class="math notranslate nohighlight">\(\psi(x,t) = A_0 \sin(\frac{n \pi x}{L}).\)</span></p>
</section>
<section id="integrating-functions">
<h2>Integrating functions<a class="headerlink" href="#integrating-functions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>To integrate the function <strong>f(x)</strong> you can either use <strong>f(x).integrate(x)</strong> or <strong>integrate(f(x),x)</strong>.</p></li>
<li><p>For a definite integral, instead of just specifying the integration variable <strong>x</strong> you should specify the variable <em>and</em> the limits <strong>[x,0,L]</strong>.</p></li>
<li><p>Integrals frequently gives errors asking if a quantity is positive, negative, or zero.  Use <strong>assume()</strong> commands to resolve this question.</p></li>
</ul>
<section id="deterimine-normalization-constant">
<h3>Deterimine normalization constant<a class="headerlink" href="#deterimine-normalization-constant" title="Link to this heading">#</a></h3>
<p>The integral of the probability density over some region of space gives the probability of finding the particle in that region.  If we integrate over all possible places the particle might be, the total probability has to be 1 ( which corresponds to 100%).  We can use this fact to find the normalization constant <span class="math notranslate nohighlight">\(A_0\)</span>.  In other words, by requiring <span class="math notranslate nohighlight">\(\int_0^L \psi^*(x,t) \psi(x,t) dx = 1\)</span> we can solve for <span class="math notranslate nohighlight">\(A_0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_0</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;A_0,n &#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>  <span class="c1">#Assume L is a real number</span>
<span class="n">assume</span><span class="p">(</span><span class="n">L</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>  <span class="c1">#Assume L is positive</span>
<span class="n">assume</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>   <span class="c1">#n must be an integer for a particle in an infinite square well - this is why we have quantization</span>


<span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="n">A_0</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">L</span><span class="p">)</span>   <span class="c1">#Define the wave function</span>

<span class="n">norm_int</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_well</span><span class="o">*</span><span class="n">psi_well</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">])</span>   <span class="c1">#Integrate the probability density (psi* x psi) over the width of the well</span>
<span class="n">s</span><span class="p">(</span><span class="s1">&#39;The normalization integral gives &#39;</span><span class="p">,</span> <span class="n">norm_int</span><span class="p">)</span>

<span class="n">answer</span><span class="o">=</span><span class="n">solve</span><span class="p">(</span><span class="n">norm_int</span><span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="n">A_0</span><span class="p">)</span>   <span class="c1">#What value does A_0 need to have for a total probability of 1</span>
<span class="n">s</span><span class="p">(</span><span class="s1">&#39;The possible answers for $A_0$ are &#39;</span><span class="p">,</span> <span class="n">answer</span><span class="p">)</span>

<span class="n">norm_const</span><span class="o">=</span><span class="n">answer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>   <span class="c1">#Select only the right hand side of the last term</span>
<span class="n">s</span><span class="p">(</span><span class="s1">&#39;We are only interested in the positive value  which is $A_0=$&#39;</span><span class="p">,</span> <span class="n">norm_const</span><span class="p">)</span>

<span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">=</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">A_0</span><span class="o">=</span><span class="n">norm_const</span><span class="p">)</span>  <span class="c1">#Substitute our value for A_0 into the wave function</span>
<span class="n">show</span><span class="p">(</span><span class="s1">&#39;The equation for our wave function inside an infinite potential well is $\psi(x)=$&#39;</span><span class="p">,</span> <span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="more-integration-examples">
<h2>More integration examples<a class="headerlink" href="#more-integration-examples" title="Link to this heading">#</a></h2>
<section id="check-orthogonality-of-infinite-square-well-solutions">
<h3>Check orthogonality of infinite square well solutions<a class="headerlink" href="#check-orthogonality-of-infinite-square-well-solutions" title="Link to this heading">#</a></h3>
<p>The wave functions for differing values of <span class="math notranslate nohighlight">\(n\)</span> should be orthogonal to one another.  This means that <span class="math notranslate nohighlight">\(\int_0^L \psi_n^*(x) \psi_m(x) dx = \delta_{mn}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>

<span class="n">probability_not_orthogonal</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">])</span>  <span class="c1">#Calculate for m=n</span>
<span class="n">show</span><span class="p">(</span><span class="s1">&#39; If both wave functions have same n-value, then $\int_0^a\psi_n^*(x) \psi_n(x)dx$ = &#39;</span><span class="p">,</span> <span class="n">probability_not_orthogonal</span><span class="p">)</span>


<span class="n">probability_orthogonal</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">m</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">])</span>   <span class="c1">#Calculate for m not equal to n</span>
<span class="n">show</span><span class="p">(</span><span class="s1">&#39; If m is not equal to n, then $\int_0^a\psi_n^*(x) \psi_m(x)dx$ = &#39;</span><span class="p">,</span> <span class="n">probability_orthogonal</span><span class="p">)</span>  <span class="c1">#%todo: \ne or \neq not working</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="d-plots-of-functions">
<h2>2D plots of functions<a class="headerlink" href="#d-plots-of-functions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>To plot a function <span class="math notranslate nohighlight">\(f(x)\)</span> vs. <span class="math notranslate nohighlight">\(x\)</span> from <span class="math notranslate nohighlight">\(x=0\)</span> to <span class="math notranslate nohighlight">\(x=2\)</span>, use <strong>plot(f(x),[x,0,2])</strong></p></li>
<li><p>You can change the color of the line plotted by setting the color argument (e.g. <strong>color=’black’</strong>)</p></li>
<li><p>Multiple graphs can be combined into a single plot window by adding the <strong>plot()</strong> commands together.</p></li>
<li><p>Plots have various properties, such as line color, type of line, points plotted, titles, and axes labels that can be changed</p></li>
<li><p>Use the <strong>show()</strong> command to display a plot</p></li>
<li><p>When plotting functions with unspecified variables, set all variables to 1 using <strong>.substitute()</strong>.</p></li>
</ul>
<section id="plot-wave-function-and-probabilty-density">
<h3>Plot wave function and probabilty density<a class="headerlink" href="#plot-wave-function-and-probabilty-density" title="Link to this heading">#</a></h3>
<p>The following commands demonstrate how to plot the wave function and probability densities for the first three lowest energy states of the 1D particle-in-a-box.</p>
<p>Since the potential energy (and thus the Hamiltonian) is symmetric about the center of the well (about the point <span class="math notranslate nohighlight">\(x=L/2\)</span>), the wave functions will either be symmetric or antisymmetric about <span class="math notranslate nohighlight">\(x=L/2\)</span>.  Since we haven’t specified the length of the box we will set <span class="math notranslate nohighlight">\(L=1\)</span> for purposes of plotting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi_well_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#n = 1 ground state with L=1</span>
<span class="n">psi_well_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#n = 2 first excited state with L=1</span>
<span class="n">psi_well_3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">#n=3 second excited state with L=1</span>

<span class="c1">#The following three lines create plots of psi vs x</span>
<span class="n">P1</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_well_1</span><span class="p">(</span><span class="n">x</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;n=1 State&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;First three wave functions of infinite well&#39;</span><span class="p">,</span><span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Position x&#39;</span><span class="p">,</span><span class="s1">&#39;$\psi(x)$&#39;</span><span class="p">])</span>
<span class="n">P2</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_well_2</span><span class="p">(</span><span class="n">x</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;n=2 State&#39;</span><span class="p">)</span>
<span class="n">P3</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_well_3</span><span class="p">(</span><span class="n">x</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;n=3 State&#39;</span><span class="p">)</span>


<span class="n">P</span><span class="o">=</span><span class="n">P1</span><span class="o">+</span><span class="n">P2</span><span class="o">+</span><span class="n">P3</span>  <span class="c1">#Combine graphs of first three states into a single object called &#39;P&#39;...</span>
<span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1">#... and display P on the screen</span>

<span class="c1">#The following three lines create plots of the probability density (psi*)psi vs x</span>
<span class="n">P4</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_well_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">psi_well_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;n=1 State&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Probability density of first three states of infinite well&#39;</span><span class="p">,</span><span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Position x&#39;</span><span class="p">,</span><span class="s1">&#39;|$\psi(x)|^2$&#39;</span><span class="p">])</span>
<span class="n">P5</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_well_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">psi_well_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;n=2 State&#39;</span><span class="p">)</span>
<span class="n">P6</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_well_3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">psi_well_3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;n=3 State&#39;</span><span class="p">)</span>


<span class="n">PB</span><span class="o">=</span><span class="n">P4</span><span class="o">+</span><span class="n">P5</span><span class="o">+</span><span class="n">P6</span> <span class="c1">#Combine the three graphs of probability density...</span>
<span class="n">PB</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1">#...and show them on the screen</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id5">
<h2>For You To Try:<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>How does the number of peaks of the wave function compare to the value of n?
How does the number of nodes of the wave function compare to the value of n?
To help answer this question, plot the wave functions for the n=4 and n=5 states and see if they agree with your answer to these two questions.  You can use psi_well(x,n) to define your wave functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="another-example-of-integration">
<h2>Another example of integration<a class="headerlink" href="#another-example-of-integration" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>SageMath will leave answers in exact form (e.g. 1/4 or pi) so to get numerical approximations you must use <strong>.n()</strong></p></li>
<li><p>You can specify how many digits are returned using <strong>.n(digits=3)</strong></p></li>
</ul>
<section id="probabilities-to-find-the-particle">
<h3>Probabilities to find the particle<a class="headerlink" href="#probabilities-to-find-the-particle" title="Link to this heading">#</a></h3>
<p>The probability to find a particle between <span class="math notranslate nohighlight">\(x=a\)</span> and <span class="math notranslate nohighlight">\(x=b\)</span> is found by integrating the probability density over the region: <span class="math notranslate nohighlight">\(\int_a^b \psi^*(x) \psi(x) dx \)</span></p>
<p>What is the probability to find the particle somewhere in the box?</p>
<p>What is the probability of finding the particle in the left half of the box (between <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=L/2\)</span>)?</p>
<p>What is the probability of finding the particle in the left quarter of the box (between <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=L/4\)</span>)?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">probability_somewhere</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">])</span>

<span class="n">s</span><span class="p">(</span><span class="s2">&quot;The probablity to find the particle somewhere is &quot;</span><span class="p">,</span> <span class="n">probability_somewhere</span><span class="p">)</span>

<span class="n">probability_left_half</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>

<span class="n">s</span><span class="p">(</span><span class="s2">&quot;The probability to find the particle in the left half of the box between $x=0$ and $x=L/2$ is &quot;</span><span class="p">,</span> <span class="n">probability_left_half</span><span class="p">)</span>

<span class="n">probability_left_quarter</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>

<span class="n">show</span><span class="p">(</span><span class="s2">&quot;The probability to find the particle in the left quarter of the box between $x=0$ and $x=L/4$ is &quot;</span><span class="p">,</span> <span class="n">probability_left_quarter</span><span class="p">,</span> <span class="s2">&quot; = &quot;</span><span class="p">,</span> <span class="n">probability_left_quarter</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id6">
<h2>For You To Try:<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<p>How do you think these three probabilities would differ for the <span class="math notranslate nohighlight">\(n=2\)</span> state?</p>
<p>Calculate the probability for the particle to be somewhere inside the well, in the left half of the well, and in the left quarter of the well for the <span class="math notranslate nohighlight">\(n=2\)</span> state.  Compare these results to the answers for the <span class="math notranslate nohighlight">\(n=1\)</span> state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="expanding-symbolic-answers-and-obtaining-numerical-results">
<h2>Expanding symbolic answers and obtaining numerical results<a class="headerlink" href="#expanding-symbolic-answers-and-obtaining-numerical-results" title="Link to this heading">#</a></h2>
<section id="calculating-expectation-values">
<h3>Calculating expectation values<a class="headerlink" href="#calculating-expectation-values" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.expand()</span></code> will distribute terms and expand powers in a symbolic expression</p>
<ul>
<li><p>Note: When using <code class="docutils literal notranslate"><span class="pre">.expand()</span></code> on an express (rather than a variable), it helps to put parenthese around the expression.</p>
<ul>
<li><p>This won’t work <code class="docutils literal notranslate"><span class="pre">3*(x+y).expand()</span></code> but <code class="docutils literal notranslate"><span class="pre">(3*(x+y)).expand()</span></code> will work.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>SageMath keeps results in exact form (e.g. <span class="math notranslate nohighlight">\(\sin(\pi/4)\)</span> rather than <span class="math notranslate nohighlight">\(0.707\)</span>) but you can force SageMath to give an approximate answer using <code class="docutils literal notranslate"><span class="pre">.n()</span></code></p>
<ul>
<li><p>You can specify the number of digits the approximate result should have using <code class="docutils literal notranslate"><span class="pre">.n(digits=3)</span></code></p></li>
</ul>
</li>
</ul>
<p>What is the expected value of the position of the particle <span class="math notranslate nohighlight">\(&lt;x&gt;\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_exp</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">]);</span><span class="n">x_exp</span>  <span class="c1">#Expecatation value of position &lt;x&gt;</span>

<span class="n">x_exp</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>  <span class="c1">#Simplify the result by multiplying terms together</span>

<span class="n">x_numeric</span><span class="o">=</span><span class="n">x_exp</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mf">1E-9</span><span class="p">)</span>   <span class="c1">#Set size of box to 1 nm</span>
<span class="n">x_numeric</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>   <span class="c1">#Force SageMath to compute numerical result</span>
<span class="n">x_numeric</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>   <span class="c1">#You can specify the number of significant figures</span>
<span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>   <span class="c1">#Pi to seven places</span>

<span class="k">def</span><span class="w"> </span><span class="nf">P</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>   <span class="c1">#Definition of momentum operator</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">hbar</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>


<span class="n">p_exp</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">P</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">])</span>  <span class="c1">#Expectation value of momentum &lt;p&gt;</span>
<span class="n">p_exp</span>

<span class="n">K_exp</span><span class="o">=</span><span class="n">integrate</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">P</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">psi_well</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">L</span><span class="p">])</span>  <span class="c1">#Expectation value of kinetic energy &lt;K&gt;=&lt;p^2&gt;/2m</span>
<span class="n">K_exp</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-dependent-behavior-of-the-wave-function-and-probability-densities">
<h3>Time-dependent behavior of the wave function and probability densities<a class="headerlink" href="#time-dependent-behavior-of-the-wave-function-and-probability-densities" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi_plot_1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="n">psi_well_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">pi</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>


<span class="n">plot_graph</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_plot_1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">(),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sxrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">.1</span><span class="p">)]</span>
<span class="n">a</span><span class="o">=</span><span class="n">animate</span><span class="p">(</span><span class="n">plot_graph</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_graph_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot</span><span class="p">(</span><span class="n">real</span><span class="p">(</span><span class="n">psi_plot_1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">psi_plot_1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sxrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">.1</span><span class="p">)]</span>
<span class="n">b</span><span class="o">=</span><span class="n">animate</span><span class="p">(</span><span class="n">plot_graph_b</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id7">
<h2>For You To Try:<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<p>Why does the wave function oscillate but the probability density does not?  (Hint: the probability density involves multiplying the wave function by its complex conjugate)</p>
<p>Plot the wave function and probability density for the n=2 state and see if it displays the same behavior.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
<section id="animate-plot-of-superposition-of-two-states">
<h3>Animate plot of superposition of two states<a class="headerlink" href="#animate-plot-of-superposition-of-two-states" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi_super</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="n">psi_well_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">pi</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">psi_well_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">plot_graph_c</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot</span><span class="p">(</span><span class="n">psi_super</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">(),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sxrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">.1</span><span class="p">)]</span>
<span class="n">c</span><span class="o">=</span><span class="n">animate</span><span class="p">(</span><span class="n">plot_graph_c</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_graph_d</span> <span class="o">=</span> <span class="p">[</span><span class="n">plot</span><span class="p">(</span><span class="n">real</span><span class="p">(</span><span class="n">psi_super</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">psi_super</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">6.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">sxrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">.1</span><span class="p">)]</span>
<span class="n">d</span><span class="o">=</span><span class="n">animate</span><span class="p">(</span><span class="n">plot_graph_d</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id8">
<h2>For You To Try:<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<p>Why does the probability density of the superposition state vary with time while the pure n=1 and n=2 states do not vary (Hint: The time dependence of the wave function is contained in the term <span class="math notranslate nohighlight">\(e^{iE_n t/\hbar}\)</span>.  What happens to this time dependence when you calculate <span class="math notranslate nohighlight">\(\psi^* \psi\)</span> for the pure n=1 state or n=2 state? )</p>
<p>Plot the real part of a superposition of the n=1 and n=3 states <span class="math notranslate nohighlight">\(\psi_{super}(x,t)=\psi_{n=1}(x,t)+\psi_{n=3}(x,t)\)</span>.  Remember that the time dependency is <span class="math notranslate nohighlight">\(e^{iE_n t/\hbar}\)</span> where <span class="math notranslate nohighlight">\(E_n=\frac{n^2\pi^2\hbar^2}{2mL^2}\)</span> where we have assumed <span class="math notranslate nohighlight">\(\hbar=1\)</span>, <span class="math notranslate nohighlight">\(m=1\)</span>, and <span class="math notranslate nohighlight">\(L=1\)</span> for plotting purposes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h2>Project Ideas and Problems to Solve<a class="headerlink" href="#id9" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Normalize a 50/50 superposition of the n=1 and n=3 state where <span class="math notranslate nohighlight">\(\psi_{super}(x,t)=A_{norm}\left( \psi_{n=1}(x,t)+\psi_{n=3}(x,t)\right)\)</span>.  In other words, find the value of <span class="math notranslate nohighlight">\(A_{norm}\)</span> such that <span class="math notranslate nohighlight">\(\int_{-\infty}^{\infty}\psi^*(x,0) \psi(x,0) dx = 1\)</span>.</p></li>
<li><p>Calculate <x> for a particle in a superposition of the n=1 and n=3 states <span class="math notranslate nohighlight">\(\psi_{super}(x,t)=\psi_{n=1}(x,t)+\psi_{n=3}(x,t)\)</span>.</p></li>
<li><p>Use the fact that the uncertainty of an observable is defined as <span class="math notranslate nohighlight">\(\Delta A = \sqrt{&lt; A^2 &gt; - &lt; A &gt;^2}\)</span> to find the uncertainty in the position and momentum for the first three states.</p></li>
<li><p>Repeat the previous question for the superposition of the n=1 and n=3 states.</p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="q-harmonic-oscillator-solving-des">
<h1>3. Q harmonic oscillator - Solving DEs<a class="headerlink" href="#q-harmonic-oscillator-solving-des" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Solving differential equations</p></li>
<li><p>Plot dotted, dashed, or solid lines</p></li>
<li><p>Placement of plot titles</p></li>
<li><p>Adding arrows and text to plots</p></li>
<li><p>Simplify symbolic expressions</p></li>
</ul>
<p>Physicists LOVE the harmonic oscillator potential.  It is one of our favorites for two very important reasons: 1) It is one of handful of potentials that we can solve exactly and 2) <em>any</em> restoring force potential can be approximated as a harmonic oscillator near the equilibrium point.  This is why we often approximate solid matter as a collection of ball-and-springs; the molecular bonds between atoms behave like springs if you don’t compress the solid too much.</p>
<p>The harmonic potential energy equation is <span class="math notranslate nohighlight">\(U=\frac{1}{2}m \omega^2 x^2\)</span>.  Plugging this into Schrodinger’s equation gives</p>
<p><span class="math notranslate nohighlight">\(\frac{-\hbar^2}{2m} \frac{d^2}{dx^2}\psi(x) + \frac{1}{2}m \omega^2 x^2 \psi(x) = E \psi(x)\)</span></p>
<ul class="simple">
<li><p>When solving differential equations it helps to specify which variables are real and which are positive using the <code class="docutils literal notranslate"><span class="pre">assume()</span></code> command.</p></li>
<li><p>You need to specify the independent variable of your function.  In this case we specify that <span class="math notranslate nohighlight">\(\psi\)</span> is a function of <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>The differential equation is defined using the Python <code class="docutils literal notranslate"><span class="pre">def</span></code> method.</p>
<ul>
<li><p>This creates a function which we can differential, integrate, or solve using the differential equation solver.</p></li>
</ul>
</li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">desolve()</span></code> to solve the differential equation.  The arguments of <code class="docutils literal notranslate"><span class="pre">desolve()</span></code> are the differential equation to solve, the dependent variable (<span class="math notranslate nohighlight">\(\psi\)</span> in this case), and the independent variable x (specified using <code class="docutils literal notranslate"><span class="pre">ivar=x</span></code> to indicate the independent variable).  In this case, <code class="docutils literal notranslate"><span class="pre">desolve()</span></code> with encounter an issue unless you specify <code class="docutils literal notranslate"><span class="pre">contrib_ode=True</span></code>, in which case a slightly different solver is used to handle the differential equation.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">omega</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;psi,m,L,omega&#39;</span><span class="p">)</span>  <span class="c1">#Declare wave function, mass, and box length as variables</span>

<span class="n">Ener</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;Ener&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\mathcal</span><span class="si">{E}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1">#Declare Ener as energy variable but will display a script E when using show()  </span>
<span class="n">hbar</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;hbar&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\hbar&#39;</span><span class="p">)</span>  <span class="c1">#Declares hbar as a variable and displays hbar symbol when using show()  </span>

<span class="n">assume</span><span class="p">(</span><span class="n">Ener</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>   <span class="c1">#Assume the variable Ener (the energy) only takes real values...</span>
<span class="n">assume</span><span class="p">(</span><span class="n">Ener</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>   <span class="c1">#... and assume the energy is greater than zero.  These are needed for desolve()</span>

<span class="n">assume</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>   <span class="c1">#Assume the mass is real...</span>
<span class="n">assume</span><span class="p">(</span><span class="n">m</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>     <span class="c1">#... and positive.   </span>

<span class="c1">#To solve the differential equation we must tell SageMath that psi is a function called &#39;psi&#39; with a single dependent variable</span>
<span class="n">psi</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>   

<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">psi</span><span class="p">):</span>  <span class="c1">#Define the equation to solve.</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">hbar</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">omega</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">Ener</span><span class="p">)</span><span class="o">*</span><span class="n">psi</span>   <span class="c1">#This is the differential equation to be solved</span>

<span class="n">general_soln</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">psi</span><span class="p">,</span><span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   <span class="c1">#</span>


<span class="n">s</span><span class="p">(</span><span class="s1">&#39;The general solution to Schrodinger</span><span class="se">\&#39;</span><span class="s1">s equation is &#39;</span><span class="p">,</span> <span class="n">general_soln</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The Kummer functions are <a class="reference external" href="https://en.wikipedia.org/wiki/Confluent_hypergeometric_function">confluent hypergeometric functions</a>.  At present SageMath cannot evaluate these functions so I’ll enter the first few wave functions for you manually below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Harmonic Oscillator Wavefunction and energy</span>
<span class="n">m</span><span class="p">,</span><span class="n">omega</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;m,omega&#39;</span><span class="p">)</span>
<span class="n">hbar</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;hbar&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\hbar&#39;</span><span class="p">)</span>                                  <span class="c1">#Declares hbar as a variable and displays hbar symbol </span>
<span class="n">alpha</span><span class="o">=</span><span class="n">m</span><span class="o">*</span><span class="n">omega</span><span class="o">/</span><span class="n">hbar</span>         <span class="c1">#If alpha is defined after the wave functions are defined, you need to use .substitute(alpha=m*omega/hbar)</span>

<span class="n">psi_HO0</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>                        <span class="c1">#n=0 state of 1D harmonic oscillator</span>
<span class="n">psi_HO1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">alpha</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>                  <span class="c1">#n=1 state of 1D harmonic oscillator</span>
<span class="n">psi_HO2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>    <span class="c1">#n=2 state of 1D harmonic oscillator</span>
<span class="n">psi_HO3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="c1">#n=3 state of 1D harmonic oscillator</span>
<span class="n">psi_HO4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="mi">36</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">#n=4 state of 1D harmonic oscillator</span>
<span class="n">psi_HO5</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="mi">225</span><span class="o">*</span><span class="n">pi</span><span class="p">))</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="o">^</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">alpha</span><span class="o">^</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">15</span><span class="o">*</span><span class="n">alpha</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">#n=5 state  </span>

<span class="k">def</span><span class="w"> </span><span class="nf">E_n</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">omega</span><span class="p">):</span>                                                     <span class="c1">#1D harmonic oscillator energy function</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">hbar</span><span class="o">*</span><span class="n">omega</span>

<span class="k">def</span><span class="w"> </span><span class="nf">H</span><span class="p">(</span><span class="n">psi</span><span class="p">):</span>                                                           <span class="c1">#1D harmonic oscillator Hamiltonian</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">hbar</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">omega</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">psi</span>
</pre></div>
</div>
</div>
</div>
<p>In general, the quantum harmonic oscillator wave function can be found from the following relationships:</p>
<p><span class="math notranslate nohighlight">\(\psi_n(x) = \left( \frac{1}{2^n n!} \right) \left( \frac{\alpha}{\pi} \right) H_n(\alpha^{1/2}x) e^{-\alpha x^2/2}   \)</span></p>
<p>where the Hermite polynomial <span class="math notranslate nohighlight">\(H_n(x)\)</span> is found from</p>
<p><span class="math notranslate nohighlight">\(H_n(x) = (-1)^n e^{x^2} \frac{d^n}{dx^n} e^{-x^2} \)</span></p>
<section id="id10">
<h2>For You To Try:<a class="headerlink" href="#id10" title="Link to this heading">#</a></h2>
<p>Prove that the quantum harmonic oscillator wave functions are normalized</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="fancier-2d-plotting">
<h2>Fancier 2D Plotting<a class="headerlink" href="#fancier-2d-plotting" title="Link to this heading">#</a></h2>
<ul>
<li><p>You can add titles, label axes, change label size, and move the title of plots</p></li>
<li><p>You can specify different line styles:</p>
<ul class="simple">
<li><p>Solid lines ‘-’</p></li>
<li><p>Dashed lines ‘–’</p></li>
<li><p>Dash dot ‘-.’</p></li>
<li><p>Dotted ‘:’</p></li>
</ul>
</li>
<li><p>If you assign a plot to a variable name, you can add on additional plots and features.</p>
<ul class="simple">
<li><p>In Python, <code class="docutils literal notranslate"><span class="pre">P+=text...</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">P=P+text...</span></code>.  This is called in-place addition</p></li>
<li><p>Text can be added to a plot using <code class="docutils literal notranslate"><span class="pre">text('something</span> <span class="pre">profound',</span> <span class="pre">(x,y),</span> <span class="pre">color='red)</span></code> where <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are the location of the midpoint of the text.</p></li>
<li><p>Arrows can be added to point out features by specifying the location of the head and tail of the arrow <code class="docutils literal notranslate"><span class="pre">arrow2d((x1,y1),(x2,y2))</span></code></p></li>
<li><p>Multiple plots can be combined into a single graph by adding <code class="docutils literal notranslate"><span class="pre">plot()</span></code> commands to<code class="docutils literal notranslate"><span class="pre">P</span></code></p></li>
</ul>
<h3 class="rubric" id="plot-the-ground-state-wavefunction-of-the-one-dimensional-harmonic-oscillator">Plot the ground state wavefunction of the one-dimensional harmonic oscillator</h3>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#To plot a function, all variables must be defined - chose variables = 1 for simplicity</span>
<span class="n">psi0_plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">psi_HO0</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">omega</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">hbar</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>      

<span class="n">P</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">psi0_plot</span><span class="p">(</span><span class="n">x</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;n=1 State of QHO&#39;</span><span class="p">,</span> <span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Position x&#39;</span><span class="p">,</span> <span class="s1">&#39;$\psi(x)$&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title_pos</span><span class="o">=</span><span class="p">(</span><span class="mf">.3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">P</span><span class="o">+=</span> <span class="n">text</span><span class="p">(</span><span class="s1">&#39;Wave function peak&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">P</span><span class="o">+=</span><span class="n">arrow2d</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.75</span><span class="p">))</span>
<span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h2>For You To Try:<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Plot the <span class="math notranslate nohighlight">\(n=1\)</span>, <span class="math notranslate nohighlight">\(n=2\)</span>, and <span class="math notranslate nohighlight">\(n=3\)</span> wave functions for the quantum harmonic oscillator on the same plot</p></li>
<li><p>Describe how the number of nodes in the wave function relates to the value of n</p></li>
<li><p>Draw arrows to indicate the location of the nodes of the wave function</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your code here</span>
</pre></div>
</div>
</div>
</div>
<section id="calculate-harmonic-oscillator-energy-from-schrodinger-equation-and-wave-function">
<h3>Calculate harmonic oscillator energy from Schrodinger equation and wave function<a class="headerlink" href="#calculate-harmonic-oscillator-energy-from-schrodinger-equation-and-wave-function" title="Link to this heading">#</a></h3>
<p>We can check that the wave functions satisfy Schrodinger’s equation and give the correct energy.  The equation is</p>
<p><span class="math notranslate nohighlight">\(\hat{H}\psi(x) = E \psi(x).\)</span></p>
<p>Since <span class="math notranslate nohighlight">\(E\)</span> is a number (unlike <span class="math notranslate nohighlight">\(\hat{H}\)</span>, which is an operator), we can divide both sides of the equation by <span class="math notranslate nohighlight">\(\psi(x)\)</span> and cancel the terms on the right hand side to get an equation for the energy.</p>
<p><span class="math notranslate nohighlight">\(\frac{\hat{H}\psi(x)}{\psi(x)} = E.\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="n">H</span><span class="p">(</span><span class="n">psi_HO0</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">psi_HO0</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="simplify-symbolic-expressions">
<h2>Simplify Symbolic Expressions<a class="headerlink" href="#simplify-symbolic-expressions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">.expand()</span></code> command will distribute terms and expand powers in an expression</p>
<ul>
<li><p>Useful for getting terms to cancel out</p></li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">.canonicalize_radical()</span></code> command returns the <em>canonical</em> form of logs and exponents</p></li>
<li><p>Other simplification commands include:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">.combine()</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.simplify_fill()</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.simplify_trig()</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.reduce_trig()</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.simplify_log()</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.trig_expand()</span></code></p></li>
</ul>
</li>
</ul>
<p>This result does not look like what we would expect.  However, computer algebra systems like Maxima (the heart of SageMath computer algebra) sometimes have issues with non-integer powers.  One trick is to raise this function to the nth power (in this case it would be to the 4th power) to get rid of non-integer powers, simplify the equation, then take the nth root to get the final result.  Let’s try this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f4</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>    <span class="c1">#Fourth power</span>

<span class="n">s</span><span class="p">(</span><span class="s1">&#39;Taking the fourth power of our original result simplifies things down to $f^4=$&#39;</span><span class="p">,</span> <span class="n">f4</span><span class="p">)</span> 

<span class="n">f1</span><span class="o">=</span><span class="p">(</span><span class="n">f4</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">canonicalize_radical</span><span class="p">()</span>    <span class="c1">#.canonicalize_radical() simplifies terms involving exponents</span>

<span class="n">s</span><span class="p">(</span><span class="s1">&#39;Taking the fourth root and using the .canonicalize_radical() command gives us &#39;</span><span class="p">,</span> <span class="n">f1</span><span class="p">)</span>
<span class="n">s</span><span class="p">(</span><span class="s1">&#39;The energy of the n=1 state from the energy function E_n(n,omega) is $E_n=$&#39;</span><span class="p">,</span> <span class="n">E_n</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">omega</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id12">
<h2>For You To Try:<a class="headerlink" href="#id12" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Use the Hamiltonian to find the energies of the <span class="math notranslate nohighlight">\(n=1\)</span>, <span class="math notranslate nohighlight">\(n=2\)</span>, and <span class="math notranslate nohighlight">\(n=3\)</span> states.</p>
<ul>
<li><p>Remember that <span class="math notranslate nohighlight">\(E = \frac{H \psi(x)}{\psi(x)}\)</span></p></li>
<li><p>If your resulting equation is a huge mess, try squaring, expanding, then simplifying the equation</p></li>
</ul>
</li>
<li><p>Check that your results are correct by using the function <code class="docutils literal notranslate"><span class="pre">E_n(n,omega)</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
<section id="calculate-the-commutator-hat-x-hat-p">
<h3>Calculate the commutator <span class="math notranslate nohighlight">\([\hat{x},\hat{p}]\)</span><a class="headerlink" href="#calculate-the-commutator-hat-x-hat-p" title="Link to this heading">#</a></h3>
<p>We can define the momentum operator <span class="math notranslate nohighlight">\(\hat{p}\)</span> using <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">p:</span></code>.  The operator <span class="math notranslate nohighlight">\(\hat{x}\)</span> is just multiplication by the variable <span class="math notranslate nohighlight">\(x\)</span> so we don’t need to define a separate operator.  One thing to keep in mind is that we must explicitly apply the operators (i.e. All terms that the operator operates on must be inside the parentheses as an argument to the operator function)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">p</span><span class="p">(</span><span class="n">psi</span><span class="p">):</span>   <span class="c1">#momentum operator</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">hbar</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>


<span class="n">psi</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>   <span class="c1">#Dummy function</span>


<span class="n">com</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">p</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">-</span><span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">psi</span><span class="p">)</span>   <span class="c1">#Calculate the commutation relation [x,p]</span>
<span class="n">s</span><span class="p">(</span><span class="s1">&#39;The commutation relation between $\hat</span><span class="si">{x}</span><span class="s1">$ and $\hat</span><span class="si">{p}</span><span class="s1">$ is $[\hat</span><span class="si">{x}</span><span class="s1">,\hat</span><span class="si">{p}</span><span class="s1">]\psi(x) = $&#39;</span><span class="p">,</span> <span class="n">com</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>  
<span class="c1">#.expand() required to simplify expression</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="raising-and-lowering-operators">
<h3>Raising and Lowering Operators<a class="headerlink" href="#raising-and-lowering-operators" title="Link to this heading">#</a></h3>
<p>The raising and lowering operators are powerful tools for exploring the quantum harmonic oscillator.  Most quantum physics texts will cover these in detail.  The following cells will explore a few things you can do in SageMath with the raising and lowering operators.  The cell below defines the operators.</p>
<p>Note: The output from the cell below includes a term <span class="math notranslate nohighlight">\(D[0]\psi(x)\)</span>.  This is SageMath notation for the derivative with respect to the first variable in the function (remember that Python starts numbering at zero).  If <span class="math notranslate nohighlight">\(\psi\)</span> was a function of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, then the derivative of <span class="math notranslate nohighlight">\(\psi(x,y)\)</span> with respect to <span class="math notranslate nohighlight">\(y\)</span> would be denoted <span class="math notranslate nohighlight">\(D[1]\psi(x,y)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">omega</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;psi,m,L,omega,f&#39;</span><span class="p">)</span>                    <span class="c1">#Declare wave function, mass, and box length as variables</span>

<span class="n">Ener</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;Ener&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\mathcal</span><span class="si">{E}</span><span class="s1">&#39;</span><span class="p">)</span>                 <span class="c1">#Declare Ener as energy variable but will display a script E </span>
<span class="n">hbar</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;hbar&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\hbar&#39;</span><span class="p">)</span>                       <span class="c1">#Declares hbar as a variable and displays hbar symbol  </span>

<span class="n">psi</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;psi&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>    <span class="c1">#Define dummy function</span>

<span class="k">def</span><span class="w"> </span><span class="nf">p</span><span class="p">(</span><span class="n">psi</span><span class="p">):</span>   <span class="c1">#momentum operator</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">hbar</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">a_plus</span><span class="p">(</span><span class="n">psi</span><span class="p">):</span>   <span class="c1">#raising operator</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">hbar</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">omega</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">p</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">psi</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">a_minus</span><span class="p">(</span><span class="n">psi</span><span class="p">):</span>   <span class="c1">#lowering operator</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">hbar</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">omega</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">p</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span><span class="o">+</span><span class="n">m</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">psi</span><span class="p">)</span>

<span class="n">show</span><span class="p">(</span><span class="n">a_plus</span><span class="p">(</span><span class="n">psi</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="demonstrate-that-a-psi-0-x-psi-1-x">
<h3>Demonstrate that <span class="math notranslate nohighlight">\(a_+ \psi_{0}(x)= \psi_{1}(x)\)</span><a class="headerlink" href="#demonstrate-that-a-psi-0-x-psi-1-x" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Any easy way to show two equations are equal is to divide one equation by the other and show the result is equal to 1</p>
<ul>
<li><p>This cuts down on manipulation of equations to put them in the same format</p></li>
</ul>
</li>
<li><p>To get all terms to cancel we will raise everything to the 4th power and then take the 4th root</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">.canonicalize_radical()</span></code> command is used to expand the exponent terms</p></li>
</ul>
<p>Show that <span class="math notranslate nohighlight">\(\frac{a_+ \psi_0(x)}{\psi_1(x)} = 1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="n">a_plus</span><span class="p">(</span><span class="n">psi_HO0</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">psi_HO1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">s</span><span class="p">(</span><span class="s1">&#39; $ a_+ \psi_0(x)/\psi_1(x) = $&#39;</span> <span class="p">,</span><span class="n">f</span><span class="p">)</span>   <span class="c1">#It&#39;s not clear this is equal to one but ...</span>
<span class="n">f4</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>                                              <span class="c1">#... with a little nudge...</span>
<span class="n">f1</span><span class="o">=</span><span class="p">(</span><span class="n">f4</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">canonicalize_radical</span><span class="p">()</span>
<span class="n">s</span><span class="p">(</span><span class="s1">&#39; $ a_+ \psi_0(x)/\psi_1(x) = $&#39;</span> <span class="p">,</span><span class="n">f1</span><span class="p">)</span>  <span class="c1">#...everything works out nicely</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="demonstrate-that-a-psi-1-x-sqrt-2-psi-2-x">
<h3>Demonstrate that <span class="math notranslate nohighlight">\(a_+ \psi_{1}(x)= \sqrt{2}\psi_{2}(x)\)</span><a class="headerlink" href="#demonstrate-that-a-psi-1-x-sqrt-2-psi-2-x" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>In addition to <code class="docutils literal notranslate"><span class="pre">.canonicalize_radical()</span></code> we also have to use <code class="docutils literal notranslate"><span class="pre">.combine()</span></code> to collect terms over a common denominator, and <code class="docutils literal notranslate"><span class="pre">.expand()</span></code>.</p></li>
</ul>
<p>Show that <span class="math notranslate nohighlight">\(\frac{a_+ \psi_1(x)}{\psi_2(x)} = \sqrt{2}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="n">a_plus</span><span class="p">(</span><span class="n">psi_HO1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">psi_HO2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">combine</span><span class="p">()</span>

<span class="n">s</span><span class="p">(</span><span class="s1">&#39; $ a_+ \psi_1(x)/\psi_2(x) = $&#39;</span> <span class="p">,</span><span class="n">f</span><span class="p">)</span> 

<span class="n">f4</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">f1</span><span class="o">=</span><span class="p">(</span><span class="n">f4</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">canonicalize_radical</span><span class="p">()</span>

<span class="n">s</span><span class="p">(</span><span class="s1">&#39; $ a_+ \psi_1(x)/\psi_2(x) = $&#39;</span> <span class="p">,</span><span class="n">f1</span><span class="p">)</span>
<span class="n">s</span><span class="p">(</span><span class="s1">&#39; or equivalently $ a_+ \psi_1(x) =$&#39;</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="s1">&#39; $\psi_2(x)$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h3>For You To Try<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>Show that Show that <span class="math notranslate nohighlight">\(\frac{a_+ \psi_2(x)}{\psi_1(x)} = \sqrt{3}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="projects-and-problem-ideas">
<h2>Projects and Problem Ideas<a class="headerlink" href="#projects-and-problem-ideas" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Use <span class="math notranslate nohighlight">\(a_+\)</span> to generate higher quantum harmonic oscillator wave functions and then use <span class="math notranslate nohighlight">\(H=\hbar \omega(a_- a_+ - \frac{1}{2})\)</span> to determine the energy of those states.</p></li>
<li><p>Rewrite <span class="math notranslate nohighlight">\(\hat{x}\)</span> and <span class="math notranslate nohighlight">\(\hat{p}\)</span> in terms of <span class="math notranslate nohighlight">\(a_-\)</span> and <span class="math notranslate nohighlight">\(a_+\)</span> and use the raising and lowering operators to calculate the expectation values <span class="math notranslate nohighlight">\(&lt;x&gt;\)</span> and <span class="math notranslate nohighlight">\(&lt;p&gt;\)</span>.  Compare your results to what you get from <span class="math notranslate nohighlight">\(\int \psi^*(x) x \psi(x) dx\)</span> and <span class="math notranslate nohighlight">\(\int \psi^*(x) p \psi(x) dx\)</span>.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="scattering-tunneling-from-step-potentials">
<h1>4. Scattering &amp; Tunneling from Step Potentials<a class="headerlink" href="#scattering-tunneling-from-step-potentials" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Solving systems of equations</p></li>
<li><p>Simplifying symbolic expressions</p></li>
</ul>
<p>Note: Hit <code class="docutils literal notranslate"><span class="pre">Restart</span></code> between cases</p>
<p>I’ve reused variable names for each case and failure to restart can cause results from a previous problem to cause issues with later solutions.</p>
<p>The three cases I’ve looked at are:</p>
<ul class="simple">
<li><p>Wave function hitting a step potential with <span class="math notranslate nohighlight">\(E&lt;V_0\)</span></p></li>
<li><p>Wave function hitting a step potential with <span class="math notranslate nohighlight">\(E&gt;V_0\)</span></p></li>
<li><p>Wave function hitting a barrier potential with <span class="math notranslate nohighlight">\(E&lt;V_0\)</span></p></li>
</ul>
<section id="unbound-states-scattering-and-tunneling">
<h2>Unbound States - Scattering and Tunneling<a class="headerlink" href="#unbound-states-scattering-and-tunneling" title="Link to this heading">#</a></h2>
<p>Solving the Schrodinger equation for unbound states is good practice for students in devloping an understanding of the wave function.  It also gives students their first glimpse of quantum tunneling.  This worksheet walks you through how to set up and solve the boundary conditions for the wave function and how to plot the graphs to gain deeper understanding.</p>
<p>The first case is a step potential with particle energy lower than the step potential height (<span class="math notranslate nohighlight">\(E &lt; V_0\)</span>)</p>
<p>To solve this problem we assume a different wave function in each region but require that (1) the wave functions be continuous at the boundary and (2) the derivatives of the wave functions be continuous at the boundary.  The two wave functions are:</p>
<p><span class="math notranslate nohighlight">\(\psi_I(x) = A e^{ik_1 x} + B e^{-ik_1 x}\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\psi_{II}(x) = C e^{k_2 x} + D e^{-k_2 x}.\)</span></p>
<p>The wave function must remain finite for all values of <span class="math notranslate nohighlight">\(x\)</span>, which means that the first term in <span class="math notranslate nohighlight">\(\psi_{II}(x)\)</span> must be zero (i.e. <span class="math notranslate nohighlight">\(C=0\)</span>)</p>
<p>The boundary conditions require:</p>
<p><span class="math notranslate nohighlight">\(\psi_I(0) = \psi_{II}(0)\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\frac{d \psi_I(x)}{dx}_{x=0} = \frac{d \psi_{II}(x)}{dx}_{x=0} .\)</span></p>
<p>These equations are solved long-hand to demonstrate some of the symbolic manipulation functions of SageMath</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.expand()</span></code>  Distributes and multiplies out all terms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.combine()</span></code>  Collect terms over a common denominator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.full_simplify()</span></code>  Runs numerous simplification routines</p></li>
</ul>
<p>Assuming the particles are incident form the left, the coefficient <span class="math notranslate nohighlight">\(A\)</span> is associated with the density of incoming particles.  The reflection coefficient <span class="math notranslate nohighlight">\(R\)</span>, which is the probability that a particle is reflected, can be found from the ratio of incoming to returning particles.</p>
<p><span class="math notranslate nohighlight">\(R=\frac{BB^*}{AA^*} = \left| \frac{B}{A} \right|^2 \)</span></p>
<p>As expected, in this case we find that the reflection probability is <span class="math notranslate nohighlight">\(1\)</span>, which means 100% of the particles are reflected back.  However, the particles do penetrate into the classically forbidden region.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Step potential with E&lt;V_0</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">V_0</span><span class="p">,</span><span class="n">k_1</span><span class="p">,</span><span class="n">k_2</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;A,B,C,D,m,E,V_0,k_1,k_2&#39;</span><span class="p">)</span>


<span class="n">C</span><span class="o">=</span><span class="mi">0</span>   <span class="c1">#Wave must decay as x-&gt;+oo (positive infinity) which means C must be zero</span>

<span class="n">psi_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">A</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">k_1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">k_1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">psi_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">C</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">k_2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">k_2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">psi_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">psi_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>



<span class="c1">#Continuity of w.f.</span>
<span class="n">eqn1</span> <span class="o">=</span> <span class="n">psi_2</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="n">psi_1</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">eqn1</span><span class="p">)</span>

<span class="c1">#Continuity of derivative of w.f.</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">psi_1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="n">diff</span><span class="p">(</span><span class="n">psi_2</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>

<span class="n">eqn2A</span><span class="o">=</span><span class="n">eqn2</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">eqn2A</span><span class="p">)</span>

<span class="c1">#Solve equations (long-hand solution)</span>
<span class="n">eqn2B</span><span class="o">=</span><span class="n">eqn2A</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">D</span><span class="o">=</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">eqn2B</span><span class="p">)</span>

<span class="n">B_ans1</span><span class="o">=</span><span class="n">solve</span><span class="p">(</span><span class="n">eqn2B</span><span class="p">,</span><span class="n">B</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">show</span><span class="p">(</span><span class="n">B_ans1</span><span class="p">)</span>
<span class="n">B_ans2</span><span class="o">=</span><span class="n">B_ans1</span><span class="o">.</span><span class="n">divide_both_sides</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">B_ans2</span><span class="p">)</span>
<span class="n">eqn3</span><span class="o">=</span><span class="n">B_ans2</span><span class="o">.</span><span class="n">lhs</span><span class="p">()</span><span class="o">==</span><span class="n">B_ans2</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span><span class="o">.</span><span class="n">combine</span><span class="p">()</span>


<span class="n">show</span><span class="p">(</span><span class="n">eqn3</span><span class="p">)</span>
<span class="n">R</span><span class="o">=</span><span class="p">(</span><span class="n">eqn3</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span><span class="o">*</span><span class="n">conjugate</span><span class="p">(</span><span class="n">eqn3</span><span class="o">.</span><span class="n">rhs</span><span class="p">()))</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
<span class="n">s</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;The probabilty of a particle being reflected is $R =  \frac{BB^*}{AA^*}  = $&#39;</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plotting-the-wave-function-for-the-step-potential">
<h2>Plotting the wave function for the step potential<a class="headerlink" href="#plotting-the-wave-function-for-the-step-potential" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The step occurs at <span class="math notranslate nohighlight">\(x=0\)</span></p></li>
<li><p>The red part of the wave function shows where the particle tunnels into the step, which is classically forbidden</p></li>
</ul>
<p>To animate the plot we add in the time dependence <span class="math notranslate nohighlight">\(e^{i\omega t}\)</span> with <span class="math notranslate nohighlight">\(\omega =1\)</span> for simplicity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot real part of w.f. for k_2=0.5*k_1 and A=1</span>

<span class="n">wf1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">psi_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="n">B_ans2</span><span class="o">.</span><span class="n">rhs</span><span class="p">(),</span><span class="n">A</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">k_2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">wf2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">psi_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">D</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">B_ans2</span><span class="o">.</span><span class="n">rhs</span><span class="p">(),</span><span class="n">A</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">k_2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="n">omega</span><span class="o">=</span><span class="mi">1</span>  <span class="c1">#Set angular frequency to a nice easy number for animated plot</span>

<span class="n">wf1_real</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="n">real</span><span class="p">(</span><span class="n">wf1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>  <span class="c1">#Add in time-dependent term and take real part</span>
<span class="n">P</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">wf1_real</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Wave function at a step potential&#39;</span><span class="p">,</span><span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Position x&#39;</span><span class="p">,</span><span class="s1">&#39;$\psi(x$)&#39;</span><span class="p">],</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">title_pos</span><span class="o">=</span><span class="p">[</span><span class="mf">.8</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">wf2_real</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span><span class="o">=</span><span class="n">real</span><span class="p">(</span><span class="n">wf2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">))</span> <span class="c1">#Add in time-dependent term and take real part</span>
<span class="n">P</span><span class="o">+=</span><span class="n">plot</span><span class="p">(</span><span class="n">wf2_real</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="animated-plot-of-wave-function">
<h2>Animated plot of wave function<a class="headerlink" href="#animated-plot-of-wave-function" title="Link to this heading">#</a></h2>
<p>The following code creates an animation of the real part of the wavefunction to show how it changes in time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create animated plot of real part of w.f.</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">sxrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>   <span class="c1">#the times for evaluation. sxrange() creates a list of numbers from 0 to 10 in steps of 0.5</span>
<span class="n">plot_graph</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1">#Create an empty list to store the plotted graphs at different times</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>    <span class="c1">#Loop through all times</span>
    <span class="n">new_plot</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">wf1_real</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">2.2</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>   <span class="c1">#Create plot at time t for each value of t</span>
    <span class="n">new_plot</span><span class="o">+=</span><span class="n">plot</span><span class="p">(</span><span class="n">wf2_real</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">2.2</span><span class="p">,</span><span class="n">ymax</span><span class="o">=</span><span class="mf">2.2</span><span class="p">)</span>
    <span class="n">plot_graph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_plot</span><span class="p">)</span>    <span class="c1">#Add the new plot to the list of images</span>

<span class="n">a</span><span class="o">=</span><span class="n">animate</span><span class="p">(</span><span class="n">plot_graph</span><span class="p">)</span>    <span class="c1">#Combine all plots contained in plot_graph into an animation</span>
<span class="n">a</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1">#Show the animation</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h2>For You To Try:<a class="headerlink" href="#id14" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Plot the imaginary part of the wave function and animate it.</p>
<ul>
<li><p>How does this graph differ from the real part?</p></li>
</ul>
</li>
<li><p>Plot the probability density of the wave function</p></li>
</ul>
</section>
<section id="step-potential-e-v-0">
<h2>Step Potential: <span class="math notranslate nohighlight">\(E&gt;V_0\)</span><a class="headerlink" href="#step-potential-e-v-0" title="Link to this heading">#</a></h2>
<p>For this next example we will find the wave function for a particle incident on a step potential with the particle energy larger than the step height.</p>
<p>We expect that the particle reflection coefficient is no longer 100% in this case but classically we might not expect to see <em>any</em> reflection, but the graph at the bottom of the next cell shows that the reflection probability varies as a function of the energy difference between the particle and step potential.</p>
<p>The setup is the same as for the <span class="math notranslate nohighlight">\(E&lt;V_0\)</span> case except the wave function in region II is complex (and thus oscillatory).</p>
<p>The two wave functions are:</p>
<p><span class="math notranslate nohighlight">\(\psi_I(x) = A e^{ik_1 x} + B e^{-ik_1 x}\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\psi_{II}(x) = C e^{ik_2 x} + D e^{-ik_2 x}.\)</span></p>
<p>If we assume there is no particles entering from the right then we must have <span class="math notranslate nohighlight">\(D=0\)</span>.</p>
<p>The boundary conditions require:</p>
<p><span class="math notranslate nohighlight">\(\psi_I(0) = \psi_{II}(0)\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\frac{d \psi_I(x)}{dx}_{x=0} = \frac{d \psi_{II}(x)}{dx}_{x=0} .\)</span></p>
<p>The function for the reflection probability <span class="math notranslate nohighlight">\(R\)</span> and the transmission probability <span class="math notranslate nohighlight">\(T\)</span> are plotted at the bottom of the next cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Step potential with E&gt;V_0</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">V_0</span><span class="p">,</span><span class="n">k_1</span><span class="p">,</span><span class="n">k_2</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;A,B,C,D,m,E,V_0,k_1,k_2&#39;</span><span class="p">)</span>
<span class="n">Ener</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;Ener&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\mathcal</span><span class="si">{E}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1">#Declare Ener as energy variable but will display a script E when show() </span>
<span class="n">hbar</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;hbar&#39;</span><span class="p">,</span><span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\hbar&#39;</span><span class="p">)</span>  <span class="c1">#Declares hbar as a variable and displays hbar symbol when show() </span>
<span class="n">assume</span><span class="p">(</span><span class="n">k_1</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>
<span class="n">assume</span><span class="p">(</span><span class="n">k_2</span><span class="p">,</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>

<span class="n">D</span><span class="o">=</span><span class="mi">0</span>

<span class="n">psi_3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">A</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">k_1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">k_1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">psi_4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">C</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">k_2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">k_2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">psi_3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">psi_4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">#Continuity of w.f.</span>
<span class="n">eqn1</span> <span class="o">=</span> <span class="n">psi_3</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="n">psi_4</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">eqn1</span><span class="p">)</span>

<span class="c1">#Continuity of derivative of w.f.</span>
<span class="n">eqn2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">psi_3</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="n">diff</span><span class="p">(</span><span class="n">psi_4</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span>

<span class="n">eqn2A</span><span class="o">=</span><span class="n">eqn2</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">eqn2A</span><span class="p">)</span>


<span class="c1">#Solve equations (long-hand solution)</span>
<span class="n">eqn2B</span><span class="o">=</span><span class="n">eqn2A</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">eqn2B</span><span class="p">)</span>

<span class="n">B_ans1</span><span class="o">=</span><span class="n">solve</span><span class="p">(</span><span class="n">eqn2B</span><span class="p">,</span><span class="n">B</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">show</span><span class="p">(</span><span class="n">B_ans1</span><span class="p">)</span>
<span class="n">B_ans2</span><span class="o">=</span><span class="n">B_ans1</span><span class="o">.</span><span class="n">divide_both_sides</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">B_ans2</span><span class="p">)</span>
<span class="n">eqn3</span><span class="o">=</span><span class="n">B_ans2</span><span class="o">.</span><span class="n">lhs</span><span class="p">()</span><span class="o">==</span><span class="n">B_ans2</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span><span class="o">.</span><span class="n">combine</span><span class="p">()</span>


<span class="n">show</span><span class="p">(</span><span class="n">eqn3</span><span class="p">)</span>
<span class="n">R</span><span class="o">=</span><span class="p">(</span><span class="n">eqn3</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span><span class="o">*</span><span class="n">conjugate</span><span class="p">(</span><span class="n">eqn3</span><span class="o">.</span><span class="n">rhs</span><span class="p">()))</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="n">R_plot</span><span class="o">=</span><span class="n">R</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k_1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">P</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">R_plot</span><span class="p">,[</span><span class="n">k_2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Reflection and Transmission Probability&#39;</span><span class="p">,</span><span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$k_2$ as a fraction of $k_1$&#39;</span><span class="p">,</span> <span class="s1">&#39;Probability&#39;</span><span class="p">],</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;Reflection Probability&#39;</span><span class="p">,</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#P.show()</span>

<span class="n">eqn4</span><span class="o">=</span><span class="n">eqn1</span><span class="o">.</span><span class="n">divide_both_sides</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="n">show</span><span class="p">(</span><span class="n">eqn4</span><span class="p">)</span>

<span class="n">eqn5</span><span class="o">=</span><span class="n">eqn4</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">*</span><span class="n">B_ans2</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span><span class="o">.</span><span class="n">combine</span><span class="p">())</span>
<span class="n">eqn5</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#Find T and R</span>
<span class="n">T</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">R</span><span class="p">)</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
<span class="n">T</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">T_plot</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k_1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">T_plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">P</span><span class="o">+=</span><span class="n">plot</span><span class="p">(</span><span class="n">T_plot</span><span class="p">,[</span><span class="n">k_2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;Transmission Probability&#39;</span><span class="p">)</span>
<span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="solve-a-system-of-equations">
<h2>Solve a system of equations<a class="headerlink" href="#solve-a-system-of-equations" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">solve()</span></code> returns a list of solutions</p>
<ul>
<li><p>Arguments of <code class="docutils literal notranslate"><span class="pre">solve()</span></code> are a list of equations to satisfy and a list of variables to solve for</p></li>
<li><p>e.g. <code class="docutils literal notranslate"><span class="pre">solve([x+y==1,x-y==3],[x,y])</span></code></p></li>
<li><p>Note that equations must have double equals signs to work;</p></li>
</ul>
</li>
</ul>
<section id="barrier-tunneling">
<h3>Barrier Tunneling<a class="headerlink" href="#barrier-tunneling" title="Link to this heading">#</a></h3>
<p>This example calculates the wave function for a particle hitting a barrier.  It demonstrates that the particle does in fact tunnel through the barrier</p>
<p>We now need to have wave functions in each of the three regions.</p>
<p><span class="math notranslate nohighlight">\(\psi_I(x) = A e^{ik_1 x} + B e^{-ik_1 x}\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\psi_{II}(x) = C e^{ik_2 x} + D e^{-ik_2 x}\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\psi_{III}(x) = F e^{ik_1 x} + G e^{-ik_1 x}.\)</span></p>
<p>With  no particles incident from the right we can set <span class="math notranslate nohighlight">\(G=0\)</span>.</p>
<p>The wave function and derivatives of the wave functions must be continuous at both boundaries.  Rather than solving this set of equations long-hand, we’ll use the <code class="docutils literal notranslate"><span class="pre">solve()</span></code> function to find <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(C\)</span>, <span class="math notranslate nohighlight">\(D\)</span>, and <span class="math notranslate nohighlight">\(F\)</span>.</p>
<p>The transmission probability is</p>
<p><span class="math notranslate nohighlight">\(T=\frac{FF^*}{AA^*} = \left| \frac{F}{A} \right|^2.\)</span></p>
<p>In this case the transmission probability through the barrier is non-zero, even though the particle should not be able to penetrate the barrier classically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Barrier: E&lt;V_0</span>

<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">V_0</span><span class="p">,</span><span class="n">k_1</span><span class="p">,</span><span class="n">k_2</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;A,B,C,D,F,G,m,E,V_0,k_1,k_2,a&#39;</span><span class="p">)</span>

<span class="n">G</span><span class="o">=</span><span class="mi">0</span>

<span class="n">psi_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">A</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">k_1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">k_1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">psi_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">C</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">k_2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">k_2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="n">psi_3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">=</span><span class="n">F</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">k_1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">G</span><span class="o">*</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">k_1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">psi_1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">psi_2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">psi_3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#Continuity of w.f. at boundaries</span>

<span class="n">eqn1A</span><span class="o">=</span><span class="n">psi_1</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="n">psi_2</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">eqn1A</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">eqn1B</span><span class="o">=</span><span class="n">psi_2</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">==</span><span class="n">psi_3</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">eqn1B</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#Continuity of derivatives of w.f.</span>
<span class="n">eqn2A</span><span class="o">=</span><span class="n">diff</span><span class="p">(</span><span class="n">psi_1</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="n">diff</span><span class="p">(</span><span class="n">psi_2</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">eqn2A</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">eqn2B</span><span class="o">=</span><span class="n">diff</span><span class="p">(</span><span class="n">psi_2</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">)</span><span class="o">==</span><span class="n">diff</span><span class="p">(</span><span class="n">psi_3</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="n">eqn2B</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#Solve the equations (quick and easy solution)</span>
<span class="n">soln</span><span class="o">=</span><span class="n">solve</span><span class="p">([</span><span class="n">eqn1A</span><span class="p">,</span><span class="n">eqn1B</span><span class="p">,</span><span class="n">eqn2A</span><span class="p">,</span><span class="n">eqn2B</span><span class="p">],[</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">F</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">soln</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>   <span class="c1">#Print off all solutions in the list of solutions</span>
    <span class="n">i</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">#soln is a list of lists which is structured like this: soln=[[ans0,ans1,ans2,ans3]]...</span>
<span class="c1">#... which means soln[0]=[ans0,ans1,ans2,ans3].  This means soln[0][3] returns ans3</span>

<span class="c1">#Find T and R</span>
<span class="n">F_1</span><span class="o">=</span><span class="n">soln</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">F_2</span><span class="o">=</span><span class="n">F_1</span><span class="o">/</span><span class="n">A</span>
<span class="n">B_1</span><span class="o">=</span><span class="n">soln</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="n">B_2</span><span class="o">=</span><span class="n">B_1</span><span class="o">/</span><span class="n">A</span>

<span class="n">F_2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">B_2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">R</span><span class="o">=</span><span class="p">(</span><span class="n">B_2</span><span class="o">*</span><span class="n">conjugate</span><span class="p">(</span><span class="n">B_2</span><span class="p">))</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
<span class="n">R</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">T</span><span class="o">=</span><span class="p">(</span><span class="n">F_2</span><span class="o">*</span><span class="n">conjugate</span><span class="p">(</span><span class="n">F_2</span><span class="p">))</span><span class="o">.</span><span class="n">full_simplify</span><span class="p">()</span>
<span class="n">T</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">R_plot</span><span class="o">=</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="n">T_plot</span><span class="o">=</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">k_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>

<span class="n">R_plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">T_plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">P</span><span class="o">=</span><span class="n">plot</span><span class="p">(</span><span class="n">R_plot</span><span class="p">,[</span><span class="n">k_2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Transmission and Reflection from a Barrier&#39;</span><span class="p">,</span><span class="n">axes_labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$k_2$ as a fraction of $k_1$&#39;</span><span class="p">,</span> <span class="s1">&#39;Probability&#39;</span><span class="p">],</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;Reflection probability&#39;</span><span class="p">,</span><span class="n">axes_labels_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">P</span><span class="o">+=</span><span class="n">plot</span><span class="p">(</span><span class="n">T_plot</span><span class="p">,[</span><span class="n">k_2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="s1">&#39;Transmission probability&#39;</span><span class="p">)</span>
<span class="n">P</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id15">
<h2>For You To Try<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Type ‘solve?’ into the cell below and hit Shift+Enter to see the documentation for the <code class="docutils literal notranslate"><span class="pre">solve()</span></code> command</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">solve()</span></code> to find the solutions to the equations:</p>
<ul>
<li><p>x+3y = 2</p></li>
<li><p>2y-4z=1</p></li>
<li><p>x-z=2</p></li>
</ul>
</li>
<li><p>Go back and solve the first two cases</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Insert your work here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h2>Projects and Problem Ideas<a class="headerlink" href="#id16" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Calculate the reflection and transmisison probabilities for a barrier when E&gt;V_0</p></li>
<li><p>Calculate the wave function and energy of a particle bound in a delta function well for E&lt;0 (there is a single bound state)</p></li>
<li><p>Calculate the wave function for an unbound particle near a delta function well (E&gt;0)</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sagemath"
        },
        kernelOptions: {
            name: "sagemath",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sagemath'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1. Free particle wave function</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-variables-and-functions">Defining variables and functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-free-particle-wave-function-solution-to-schrodinger-s-equation">What is the free particle wave function solution to Schrodinger’s equation?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-functions">Plotting functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-does-the-free-particle-wave-function-look-like">What does the free particle wave function look like?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-you-to-try">For You To Try:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#animating-plots">Animating plots</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#which-way-is-the-free-particle-wave-function-moving">Which way is the free particle wave function moving?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note">Note:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-complex-functions">Working with complex functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-probability-density-for-the-free-particle-wave-function">Calculate the probability density for the free particle wave function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">For You To Try:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#taking-derivatives-of-functions">Taking derivatives of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Note:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-functionals-involved-derivatives">Defining functionals involved derivatives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#momentum-operator">Momentum Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">For You To Try:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-exampe-of-defining-functionals-involving-derivatives">Another exampe of defining functionals involving derivatives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-schrodinger-s-equation-in-sagemath">Defining Schrodinger’s equation in SageMath</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-algebraic-equations">Solving algebraic equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-values-of-k-that-satisfy-schrodinger-s-equation">Find the values of <span class="math notranslate nohighlight">\(k\)</span> that satisfy Schrodinger’s equation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">For You To Try:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-a-solution-from-a-list-of-answers">Extract a solution from a list of answers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#double-check-that-k-satisfies-the-wave-equation">Double-check that <span class="math notranslate nohighlight">\(k\)</span> satisfies the wave equation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-a-function">Integrating a function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-the-wave-function-and-find-the-probability-to-find-the-free-particle-between-to-points-in-space">Normalize the wave function and find the probability to find the free particle between to points in space</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-ways-to-do-things">Other ways to do things</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#project-ideas-and-problems-to-solve">Project Ideas and Problems to Solve</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#particle-in-1d-box-solving-differential-equations">2. Particle in 1D box - Solving differential equations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-general-solution-to-schrodinger-s-equation">Find general solution to Schrodinger’s equation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#satisfying-boundary-conditions">Satisfying boundary conditions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integrating-functions">Integrating functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deterimine-normalization-constant">Deterimine normalization constant</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-integration-examples">More integration examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-orthogonality-of-infinite-square-well-solutions">Check orthogonality of infinite square well solutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-plots-of-functions">2D plots of functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-wave-function-and-probabilty-density">Plot wave function and probabilty density</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-example-of-integration">Another example of integration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probabilities-to-find-the-particle">Probabilities to find the particle</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expanding-symbolic-answers-and-obtaining-numerical-results">Expanding symbolic answers and obtaining numerical results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-expectation-values">Calculating expectation values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependent-behavior-of-the-wave-function-and-probability-densities">Time-dependent behavior of the wave function and probability densities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">For You To Try:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#animate-plot-of-superposition-of-two-states">Animate plot of superposition of two states</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Project Ideas and Problems to Solve</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#q-harmonic-oscillator-solving-des">3. Q harmonic oscillator - Solving DEs</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fancier-2d-plotting">Fancier 2D Plotting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">For You To Try:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-harmonic-oscillator-energy-from-schrodinger-equation-and-wave-function">Calculate harmonic oscillator energy from Schrodinger equation and wave function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simplify-symbolic-expressions">Simplify Symbolic Expressions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">For You To Try:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-commutator-hat-x-hat-p">Calculate the commutator <span class="math notranslate nohighlight">\([\hat{x},\hat{p}]\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#raising-and-lowering-operators">Raising and Lowering Operators</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrate-that-a-psi-0-x-psi-1-x">Demonstrate that <span class="math notranslate nohighlight">\(a_+ \psi_{0}(x)= \psi_{1}(x)\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstrate-that-a-psi-1-x-sqrt-2-psi-2-x">Demonstrate that <span class="math notranslate nohighlight">\(a_+ \psi_{1}(x)= \sqrt{2}\psi_{2}(x)\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">For You To Try</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#projects-and-problem-ideas">Projects and Problem Ideas</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#scattering-tunneling-from-step-potentials">4. Scattering &amp; Tunneling from Step Potentials</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unbound-states-scattering-and-tunneling">Unbound States - Scattering and Tunneling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-the-wave-function-for-the-step-potential">Plotting the wave function for the step potential</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#animated-plot-of-wave-function">Animated plot of wave function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">For You To Try:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-potential-e-v-0">Step Potential: <span class="math notranslate nohighlight">\(E&gt;V_0\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solve-a-system-of-equations">Solve a system of equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#barrier-tunneling">Barrier Tunneling</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">For You To Try</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Projects and Problem Ideas</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jonny, assisted by Tom
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>